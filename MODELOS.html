
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Modelos de regresión para la predicción &#8212; Proyecto Final</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'MODELOS';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="WIND SPEED" href="EDA%20-%20WIND%20SPEED.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/Logo-Uninorte.png" class="logo__image only-light" alt="Proyecto Final - Home"/>
    <script>document.write(`<img src="_static/Logo-Uninorte.png" class="logo__image only-dark" alt="Proyecto Final - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Proyecto Final
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="EDA%20-%20WIND%20SPEED.html"><strong>WIND SPEED</strong></a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#"><strong>Modelos de regresión para la predicción</strong></a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2FMODELOS.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/MODELOS.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Modelos de regresión para la predicción</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#metodos-utiles-para-los-modelos"><strong>MÉTODOS ÚTILES PARA LOS MODELOS</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#muestra-de-pliegues"><strong>MUESTRA DE PLIEGUES</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hora-1"><strong>HORA 1</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hora-5"><strong>HORA 5</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hora-10"><strong>HORA 10</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hora-15"><strong>HORA 15</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hora-20"><strong>HORA 20</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hora-24"><strong>HORA 24</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modelos"><strong>MODELOS</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-knn"><strong>MODELO KNN</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#mejor-modelo-cada-hora"><strong>MEJOR MODELO - CADA HORA</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#hora-y-ventana-con-mejor-modelo-knn"><strong>HORA Y VENTANA CON MEJOR MODELO KNN</strong></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-regresion-lineal"><strong>MODELO REGRESIÓN LINEAL</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id1"><strong>MEJOR MODELO - CADA HORA</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#hora-y-ventana-con-mejor-modelo-reg-lineal"><strong>HORA Y VENTANA CON MEJOR MODELO REG. LINEAL</strong></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-regresion-ridge"><strong>MODELO REGRESIÓN RIDGE</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id2"><strong>MEJOR MODELO - CADA HORA</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#hora-y-ventana-con-mejor-modelo-ridge"><strong>HORA Y VENTANA CON MEJOR MODELO RIDGE</strong></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-regresion-lasso"><strong>MODELO REGRESIÓN LASSO</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id3"><strong>MEJOR MODELO - CADA HORA</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#hora-y-ventana-con-mejor-modelo-lasso"><strong>HORA Y VENTANA CON MEJOR MODELO LASSO</strong></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-decision-tree"><strong>MODELO DECISION TREE</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id4"><strong>MEJOR MODELO - CADA HORA</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#hora-y-ventana-con-mejor-modelo-arbol-de-decision"><strong>HORA Y VENTANA CON MEJOR MODELO ÁRBOL DE DECISION</strong></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-random-forest"><strong>MODELO RANDOM FOREST</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id5"><strong>MEJOR MODELO - CADA HORA</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#hora-y-ventana-con-mejor-modelo-random-forest"><strong>HORA Y VENTANA CON MEJOR MODELO RANDOM FOREST</strong></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-xgboost"><strong>MODELO XGBOOST</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id6"><strong>MEJOR MODELO - CADA HORA</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#hora-y-ventana-con-mejor-modelo-xgboost"><strong>HORA Y VENTANA CON MEJOR MODELO XGBOOST</strong></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-svr"><strong>MODELO SVR</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mejores-modelos-de-regresion"><strong>MEJORES MODELOS DE REGRESIÓN</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#optimizacion-bayesiana"><strong>Optimización Bayesiana</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id7"><strong>MODELO KNN</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-ridge"><strong>MODELO RIDGE</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-lasso"><strong>MODELO LASSO</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-decision-tree-regressor"><strong>MODELO DECISION TREE REGRESSOR</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id8"><strong>MODELO RANDOM FOREST</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id9"><strong>MODELO XGBOOST</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id10"><strong>MODELO SVR</strong></a></li>
</ul>
</li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="modelos-de-regresion-para-la-prediccion">
<h1><strong>Modelos de regresión para la predicción</strong><a class="headerlink" href="#modelos-de-regresion-para-la-prediccion" title="Link to this heading">#</a></h1>
<p>En este ejercicio, nuestro objetivo es desarrollar un modelo predictivo para estimar la velocidad del viento horaria. Para abordar este problema, utilizaremos cuatro enfoques de regresión: <strong>K-Nearest Neighbors (KNN)</strong>, <strong>Regresión Lineal</strong>, <strong>Regresión Ridge</strong>, y <strong>Regresión Lasso</strong>. La predicción se realizará considerando tanto las diferentes ventanas temporales de pronóstico (7, 14, 21 y 28 días), como el ciclo horario completo de 24 horas de un día.</p>
<p>A continuación, las librerías y módulos usados.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">stats</span>
<span class="kn">from</span> <span class="nn">sklearn.svm</span> <span class="kn">import</span> <span class="n">SVR</span>
<span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span>
<span class="kn">from</span> <span class="nn">skopt</span> <span class="kn">import</span> <span class="n">gp_minimize</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">xgboost</span> <span class="kn">import</span> <span class="n">XGBRegressor</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">r2_score</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">Ridge</span><span class="p">,</span> <span class="n">Lasso</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_squared_error</span>
<span class="kn">from</span> <span class="nn">sklearn.tree</span> <span class="kn">import</span> <span class="n">DecisionTreeRegressor</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span>
<span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">KNeighborsRegressor</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestRegressor</span>
<span class="kn">from</span> <span class="nn">skopt.space</span> <span class="kn">import</span> <span class="n">Integer</span><span class="p">,</span> <span class="n">Categorical</span><span class="p">,</span> <span class="n">Real</span>
<span class="kn">from</span> <span class="nn">statsmodels.stats.stattools</span> <span class="kn">import</span> <span class="n">jarque_bera</span>
<span class="kn">from</span> <span class="nn">statsmodels.stats.diagnostic</span> <span class="kn">import</span> <span class="n">acorr_ljungbox</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_absolute_percentage_error</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_squared_error</span><span class="p">,</span> <span class="n">mean_absolute_error</span>
</pre></div>
</div>
</div>
</div>
<p>En primer lugar, procederemos a importar la base de datos obtenida luego de finalizar el análisis exploratorio de los datos.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;C:/Users/valcd/OneDrive/Escritorio/dataparcial2.csv&quot;</span><span class="p">)</span>
<span class="n">data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>hora</th>
      <th>direccionviento</th>
      <th>velocidadviento</th>
      <th>humedadmaxima</th>
      <th>humedadminima</th>
      <th>temperaturamaxima</th>
      <th>temperaturaminima</th>
      <th>precipitaciontotal</th>
      <th>rafagamaxima</th>
      <th>presion_atm_maxima</th>
      <th>presion_atm_minima</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>12:00</td>
      <td>0.809017</td>
      <td>1.8</td>
      <td>69.0</td>
      <td>60.0</td>
      <td>22.6</td>
      <td>20.7</td>
      <td>0.0</td>
      <td>3.8</td>
      <td>888.2</td>
      <td>887.7</td>
    </tr>
    <tr>
      <th>1</th>
      <td>13:00</td>
      <td>0.965926</td>
      <td>2.7</td>
      <td>62.0</td>
      <td>55.0</td>
      <td>24.2</td>
      <td>22.5</td>
      <td>0.0</td>
      <td>4.7</td>
      <td>888.4</td>
      <td>888.2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>14:00</td>
      <td>0.891007</td>
      <td>2.0</td>
      <td>56.0</td>
      <td>50.0</td>
      <td>25.5</td>
      <td>24.3</td>
      <td>0.0</td>
      <td>4.9</td>
      <td>888.4</td>
      <td>888.1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>15:00</td>
      <td>0.848048</td>
      <td>2.5</td>
      <td>52.0</td>
      <td>44.0</td>
      <td>27.4</td>
      <td>25.0</td>
      <td>0.0</td>
      <td>5.8</td>
      <td>888.1</td>
      <td>887.4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>16:00</td>
      <td>0.224951</td>
      <td>2.4</td>
      <td>50.0</td>
      <td>43.0</td>
      <td>27.1</td>
      <td>25.5</td>
      <td>0.0</td>
      <td>5.8</td>
      <td>887.4</td>
      <td>886.5</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>87688</th>
      <td>19:00</td>
      <td>-0.615661</td>
      <td>5.6</td>
      <td>83.0</td>
      <td>78.0</td>
      <td>21.8</td>
      <td>21.1</td>
      <td>0.0</td>
      <td>12.3</td>
      <td>879.8</td>
      <td>879.1</td>
    </tr>
    <tr>
      <th>87689</th>
      <td>20:00</td>
      <td>-0.469472</td>
      <td>4.9</td>
      <td>84.0</td>
      <td>79.0</td>
      <td>21.7</td>
      <td>21.0</td>
      <td>0.0</td>
      <td>9.9</td>
      <td>879.2</td>
      <td>878.9</td>
    </tr>
    <tr>
      <th>87690</th>
      <td>21:00</td>
      <td>-0.484810</td>
      <td>4.5</td>
      <td>86.0</td>
      <td>82.0</td>
      <td>21.2</td>
      <td>20.6</td>
      <td>0.0</td>
      <td>8.9</td>
      <td>879.8</td>
      <td>879.2</td>
    </tr>
    <tr>
      <th>87691</th>
      <td>22:00</td>
      <td>-0.484810</td>
      <td>3.2</td>
      <td>88.0</td>
      <td>85.0</td>
      <td>20.6</td>
      <td>20.2</td>
      <td>0.0</td>
      <td>8.0</td>
      <td>880.5</td>
      <td>879.6</td>
    </tr>
    <tr>
      <th>87692</th>
      <td>23:00</td>
      <td>-0.573576</td>
      <td>2.3</td>
      <td>95.0</td>
      <td>88.0</td>
      <td>20.2</td>
      <td>19.3</td>
      <td>0.6</td>
      <td>7.5</td>
      <td>881.1</td>
      <td>880.5</td>
    </tr>
  </tbody>
</table>
<p>87693 rows × 11 columns</p>
</div></div></div>
</div>
<p>Luego, particionamos la base de datos en dos partes. <strong>X</strong> que corresponde a todas las variables explicativas e <strong>y</strong> que corresponde a la variable respuesta.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;hora&#39;</span><span class="p">,</span><span class="s1">&#39;velocidadviento&#39;</span><span class="p">])</span> <span class="c1"># Se toman todas las columnas excepto la objetivo</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;velocidadviento&#39;</span><span class="p">]</span> <span class="c1"># Se toma solo la columna objetivo</span>
</pre></div>
</div>
</div>
</div>
<p>Creamos este vector que contiene las ventanas de predicción para este ejercicio.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">particiones</span> <span class="o">=</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">28</span><span class="p">]</span> <span class="c1"># Vector que almacena el valor de las particiones estipuladas. En DIAS.</span>
</pre></div>
</div>
</div>
</div>
<section id="metodos-utiles-para-los-modelos">
<h2><strong>MÉTODOS ÚTILES PARA LOS MODELOS</strong><a class="headerlink" href="#metodos-utiles-para-los-modelos" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Mejor modelo por hora</span>

<span class="k">def</span> <span class="nf">mejormodelohora</span><span class="p">(</span><span class="n">particiones</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>  
    <span class="n">mejormodelo</span> <span class="o">=</span> <span class="p">[]</span>  
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">25</span><span class="p">):</span> <span class="c1"># Recorre las 24 horas del día</span>
        <span class="n">mejorrmse</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">)</span>  
        <span class="n">mejor_modelo</span> <span class="o">=</span> <span class="kc">None</span>  
        <span class="k">for</span> <span class="n">dias</span> <span class="ow">in</span> <span class="n">particiones</span><span class="p">:</span> <span class="c1"># Recorre las 7 ventanas</span>
            <span class="n">condicion</span> <span class="o">=</span> <span class="n">data</span><span class="p">[(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">i</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Dias&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">dias</span><span class="p">)]</span> 
            <span class="k">if</span> <span class="ow">not</span> <span class="n">condicion</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span> 
                <span class="c1"># Se busca la fila con menor RMSE entre todas</span>
                <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">condicion</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
                    <span class="k">if</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;RMSE&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">mejorrmse</span><span class="p">:</span>
                        <span class="n">mejorrmse</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;RMSE&#39;</span><span class="p">]</span>
                        <span class="n">mejor_modelo</span> <span class="o">=</span> <span class="n">row</span>     
        <span class="k">if</span> <span class="n">mejor_modelo</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">mejormodelo</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mejor_modelo</span><span class="p">)</span>  <span class="c1"># Se agrega la fila a un vector           </span>
    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">mejormodelo</span><span class="p">)</span> <span class="c1"># Se devuelve DataFrame</span>

<span class="c1"># Mejor modelo de cada uno </span>

<span class="k">def</span> <span class="nf">mejormodelotot</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="n">mejorrmse</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">)</span>  
    <span class="n">mejor_modelo</span> <span class="o">=</span> <span class="kc">None</span>  
    <span class="c1"># Se busca la fila con menor RMSE entre todas</span>
    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;RMSE&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">mejorrmse</span><span class="p">:</span>  
            <span class="n">mejorrmse</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;RMSE&#39;</span><span class="p">]</span>
            <span class="n">mejor_modelo</span> <span class="o">=</span> <span class="n">row</span>  
    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">mejor_modelo</span><span class="p">)</span>

<span class="c1"># Método para calcular pliegues</span>

<span class="k">def</span> <span class="nf">plieguess</span><span class="p">(</span><span class="n">inicio</span><span class="p">,</span> <span class="n">fin</span><span class="p">,</span> <span class="n">hora</span><span class="p">):</span>
    <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">inicio</span><span class="p">:</span><span class="n">fin</span><span class="p">],</span> <span class="n">y</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">inicio</span><span class="p">:</span><span class="n">fin</span><span class="p">]</span>
    <span class="c1"># Se ajusta con -1 y 23 para que no se pase por alto el primer día del test ni tampoco se tomen más de 24 observaciones</span>
    <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">fin</span> <span class="o">+</span> <span class="n">hora</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span><span class="n">fin</span> <span class="o">+</span> <span class="n">hora</span> <span class="o">+</span> <span class="mi">23</span><span class="p">],</span> <span class="n">y</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">fin</span> <span class="o">+</span> <span class="n">hora</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span><span class="n">fin</span> <span class="o">+</span> <span class="n">hora</span> <span class="o">+</span> <span class="mi">23</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span>

<span class="c1"># Método para calcular el error porcentual absoluto medio (MAPE)</span>

<span class="k">def</span> <span class="nf">errorporc</span><span class="p">(</span><span class="n">actual</span><span class="p">,</span> <span class="n">predicho</span><span class="p">):</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">actual</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">actual</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
        <span class="k">if</span> <span class="n">actual</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">res</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">actual</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="n">predicho</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="o">/</span> <span class="n">actual</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">res</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">predicho</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">actual</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">res</span>

<span class="k">def</span> <span class="nf">MAPE</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">):</span> 
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">errorporc</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">y_true</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">y_pred</span><span class="p">))))</span><span class="o">*</span><span class="mi">100</span>

<span class="c1"># Método para calcular los residuos del modelo</span>

<span class="k">def</span> <span class="nf">residuos</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">):</span>
    <span class="n">residuo</span> <span class="o">=</span> <span class="n">y_test</span> <span class="o">-</span> <span class="n">y_prediccion</span>
    <span class="n">ljung</span> <span class="o">=</span> <span class="n">acorr_ljungbox</span><span class="p">(</span><span class="n">residuo</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">],</span> <span class="n">return_df</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="s1">&#39;lb_pvalue&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">jarque</span> <span class="o">=</span> <span class="n">jarque_bera</span><span class="p">(</span><span class="n">residuo</span><span class="p">)</span>  
    <span class="n">jarque</span> <span class="o">=</span> <span class="n">jarque</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">ljung</span><span class="p">,</span> <span class="n">jarque</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="muestra-de-pliegues">
<h2><strong>MUESTRA DE PLIEGUES</strong><a class="headerlink" href="#muestra-de-pliegues" title="Link to this heading">#</a></h2>
<p>En este apartado, se presentarán ejemplos de pliegues correspondientes a las horas <code class="docutils literal notranslate"><span class="pre">1,</span> <span class="pre">5,</span> <span class="pre">10,</span> <span class="pre">15,</span> <span class="pre">20</span> <span class="pre">y</span> <span class="pre">24</span></code>, con el objetivo de ilustrar que los pliegues se están construyendo correctamente. Este enfoque busca ser práctico y proporcionar una visión general del proceso de construcción de pliegues para distintas horas seleccionadas.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">pliegues</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">hora</span><span class="p">,</span> <span class="n">dias</span><span class="p">):</span>
    <span class="n">conjuntopliegues</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">iniciotrain</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="p">(</span><span class="n">iniciotrain</span> <span class="o">+</span> <span class="p">(</span><span class="n">dias</span> <span class="o">*</span> <span class="mi">24</span><span class="p">)</span> <span class="o">+</span> <span class="n">hora</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">):</span>
        <span class="n">fintrain</span> <span class="o">=</span> <span class="n">iniciotrain</span> <span class="o">+</span> <span class="p">(</span><span class="n">dias</span> <span class="o">*</span> <span class="mi">24</span><span class="p">)</span>

        <span class="n">trn_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">iniciotrain</span><span class="p">,</span> <span class="n">fintrain</span><span class="p">)</span>
        <span class="n">tst_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">fintrain</span> <span class="o">+</span> <span class="n">hora</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">fintrain</span> <span class="o">+</span> <span class="n">hora</span> <span class="o">+</span> <span class="mi">23</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">max</span><span class="p">(</span><span class="n">tst_index</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">):</span>
            <span class="n">conjuntopliegues</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">trn_index</span><span class="p">,</span> <span class="n">tst_index</span><span class="p">))</span>

        <span class="n">iniciotrain</span> <span class="o">=</span> <span class="n">fintrain</span>
    <span class="k">return</span> <span class="n">conjuntopliegues</span>
</pre></div>
</div>
</div>
</div>
<section id="hora-1">
<h3><strong>HORA 1</strong><a class="headerlink" href="#hora-1" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">resultados</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;Pliegue&#39;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="s1">&#39;Entrenamiento 7 días&#39;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="s1">&#39;Prueba 7 días&#39;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="s1">&#39;Entrenamiento 14 días&#39;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="s1">&#39;Prueba 14 días&#39;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="s1">&#39;Entrenamiento 21 días&#39;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="s1">&#39;Prueba 21 días&#39;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="s1">&#39;Entrenamiento 28 días&#39;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="s1">&#39;Prueba 28 días&#39;</span><span class="p">:</span> <span class="p">[],</span>
<span class="p">}</span>

<span class="k">for</span> <span class="n">dias</span> <span class="ow">in</span> <span class="n">particiones</span><span class="p">:</span>
    <span class="n">plgs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">hora</span><span class="o">=</span><span class="mi">1</span>
    <span class="n">plgs</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">pliegues</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">hora</span><span class="p">,</span> <span class="n">dias</span><span class="p">))</span> 

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">trn_index</span><span class="p">,</span> <span class="n">tst_index</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">plgs</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">dias</span> <span class="o">==</span> <span class="mi">7</span><span class="p">:</span>
            <span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Pliegue&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Entrenamiento 7 días&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;range(</span><span class="si">{</span><span class="n">trn_index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">trn_index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
            <span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Prueba 7 días&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;range(</span><span class="si">{</span><span class="n">tst_index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">tst_index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">dias</span> <span class="o">==</span> <span class="mi">14</span><span class="p">:</span>
            <span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Entrenamiento 14 días&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;range(</span><span class="si">{</span><span class="n">trn_index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">trn_index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
            <span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Prueba 14 días&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;range(</span><span class="si">{</span><span class="n">tst_index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">tst_index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">dias</span> <span class="o">==</span> <span class="mi">21</span><span class="p">:</span>
            <span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Entrenamiento 21 días&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;range(</span><span class="si">{</span><span class="n">trn_index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">trn_index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
            <span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Prueba 21 días&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;range(</span><span class="si">{</span><span class="n">tst_index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">tst_index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">dias</span> <span class="o">==</span> <span class="mi">28</span><span class="p">:</span>
            <span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Entrenamiento 28 días&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;range(</span><span class="si">{</span><span class="n">trn_index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">trn_index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
            <span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Prueba 28 días&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;range(</span><span class="si">{</span><span class="n">tst_index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">tst_index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
<span class="n">colms</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Entrenamiento 7 días&#39;</span><span class="p">]),</span>
                     <span class="nb">len</span><span class="p">(</span><span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Entrenamiento 14 días&#39;</span><span class="p">]),</span>
                     <span class="nb">len</span><span class="p">(</span><span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Entrenamiento 21 días&#39;</span><span class="p">]),</span>
                     <span class="nb">len</span><span class="p">(</span><span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Entrenamiento 28 días&#39;</span><span class="p">]))</span>

<span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">resultados</span><span class="p">:</span>
    <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">resultados</span><span class="p">[</span><span class="n">key</span><span class="p">])</span> <span class="o">&lt;</span> <span class="n">colms</span><span class="p">:</span>
        <span class="n">resultados</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>

<span class="n">p1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">resultados</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p1</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Pliegue</th>
      <th>Entrenamiento 7 días</th>
      <th>Prueba 7 días</th>
      <th>Entrenamiento 14 días</th>
      <th>Prueba 14 días</th>
      <th>Entrenamiento 21 días</th>
      <th>Prueba 21 días</th>
      <th>Entrenamiento 28 días</th>
      <th>Prueba 28 días</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>range(0, 168)</td>
      <td>range(168, 192)</td>
      <td>range(0, 336)</td>
      <td>range(336, 360)</td>
      <td>range(0, 504)</td>
      <td>range(504, 528)</td>
      <td>range(0, 672)</td>
      <td>range(672, 696)</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>range(168, 336)</td>
      <td>range(336, 360)</td>
      <td>range(336, 672)</td>
      <td>range(672, 696)</td>
      <td>range(504, 1008)</td>
      <td>range(1008, 1032)</td>
      <td>range(672, 1344)</td>
      <td>range(1344, 1368)</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>range(336, 504)</td>
      <td>range(504, 528)</td>
      <td>range(672, 1008)</td>
      <td>range(1008, 1032)</td>
      <td>range(1008, 1512)</td>
      <td>range(1512, 1536)</td>
      <td>range(1344, 2016)</td>
      <td>range(2016, 2040)</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>range(504, 672)</td>
      <td>range(672, 696)</td>
      <td>range(1008, 1344)</td>
      <td>range(1344, 1368)</td>
      <td>range(1512, 2016)</td>
      <td>range(2016, 2040)</td>
      <td>range(2016, 2688)</td>
      <td>range(2688, 2712)</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>range(672, 840)</td>
      <td>range(840, 864)</td>
      <td>range(1344, 1680)</td>
      <td>range(1680, 1704)</td>
      <td>range(2016, 2520)</td>
      <td>range(2520, 2544)</td>
      <td>range(2688, 3360)</td>
      <td>range(3360, 3384)</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p1</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Pliegue</th>
      <th>Entrenamiento 7 días</th>
      <th>Prueba 7 días</th>
      <th>Entrenamiento 14 días</th>
      <th>Prueba 14 días</th>
      <th>Entrenamiento 21 días</th>
      <th>Prueba 21 días</th>
      <th>Entrenamiento 28 días</th>
      <th>Prueba 28 días</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>516</th>
      <td>517</td>
      <td>range(86688, 86856)</td>
      <td>range(86856, 86880)</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>517</th>
      <td>518</td>
      <td>range(86856, 87024)</td>
      <td>range(87024, 87048)</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>518</th>
      <td>519</td>
      <td>range(87024, 87192)</td>
      <td>range(87192, 87216)</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>519</th>
      <td>520</td>
      <td>range(87192, 87360)</td>
      <td>range(87360, 87384)</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>520</th>
      <td>521</td>
      <td>range(87360, 87528)</td>
      <td>range(87528, 87552)</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="hora-5">
<h3><strong>HORA 5</strong><a class="headerlink" href="#hora-5" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">resultados</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;Pliegue&#39;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="s1">&#39;Entrenamiento 7 días&#39;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="s1">&#39;Prueba 7 días&#39;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="s1">&#39;Entrenamiento 14 días&#39;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="s1">&#39;Prueba 14 días&#39;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="s1">&#39;Entrenamiento 21 días&#39;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="s1">&#39;Prueba 21 días&#39;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="s1">&#39;Entrenamiento 28 días&#39;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="s1">&#39;Prueba 28 días&#39;</span><span class="p">:</span> <span class="p">[],</span>
<span class="p">}</span>

<span class="k">for</span> <span class="n">dias</span> <span class="ow">in</span> <span class="n">particiones</span><span class="p">:</span>
    <span class="n">plgs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">hora</span><span class="o">=</span><span class="mi">5</span>
    <span class="n">plgs</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">pliegues</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">hora</span><span class="p">,</span> <span class="n">dias</span><span class="p">))</span> 

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">trn_index</span><span class="p">,</span> <span class="n">tst_index</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">plgs</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">dias</span> <span class="o">==</span> <span class="mi">7</span><span class="p">:</span>
            <span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Pliegue&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Entrenamiento 7 días&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;range(</span><span class="si">{</span><span class="n">trn_index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">trn_index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
            <span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Prueba 7 días&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;range(</span><span class="si">{</span><span class="n">tst_index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">tst_index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">dias</span> <span class="o">==</span> <span class="mi">14</span><span class="p">:</span>
            <span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Entrenamiento 14 días&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;range(</span><span class="si">{</span><span class="n">trn_index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">trn_index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
            <span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Prueba 14 días&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;range(</span><span class="si">{</span><span class="n">tst_index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">tst_index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">dias</span> <span class="o">==</span> <span class="mi">21</span><span class="p">:</span>
            <span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Entrenamiento 21 días&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;range(</span><span class="si">{</span><span class="n">trn_index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">trn_index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
            <span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Prueba 21 días&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;range(</span><span class="si">{</span><span class="n">tst_index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">tst_index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">dias</span> <span class="o">==</span> <span class="mi">28</span><span class="p">:</span>
            <span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Entrenamiento 28 días&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;range(</span><span class="si">{</span><span class="n">trn_index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">trn_index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
            <span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Prueba 28 días&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;range(</span><span class="si">{</span><span class="n">tst_index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">tst_index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>

<span class="n">colms</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Entrenamiento 7 días&#39;</span><span class="p">]),</span>
                     <span class="nb">len</span><span class="p">(</span><span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Entrenamiento 14 días&#39;</span><span class="p">]),</span>
                     <span class="nb">len</span><span class="p">(</span><span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Entrenamiento 21 días&#39;</span><span class="p">]),</span>
                     <span class="nb">len</span><span class="p">(</span><span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Entrenamiento 28 días&#39;</span><span class="p">]))</span>

<span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">resultados</span><span class="p">:</span>
    <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">resultados</span><span class="p">[</span><span class="n">key</span><span class="p">])</span> <span class="o">&lt;</span> <span class="n">colms</span><span class="p">:</span>
        <span class="n">resultados</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>

<span class="n">p5</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">resultados</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p5</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Pliegue</th>
      <th>Entrenamiento 7 días</th>
      <th>Prueba 7 días</th>
      <th>Entrenamiento 14 días</th>
      <th>Prueba 14 días</th>
      <th>Entrenamiento 21 días</th>
      <th>Prueba 21 días</th>
      <th>Entrenamiento 28 días</th>
      <th>Prueba 28 días</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>range(0, 168)</td>
      <td>range(172, 196)</td>
      <td>range(0, 336)</td>
      <td>range(340, 364)</td>
      <td>range(0, 504)</td>
      <td>range(508, 532)</td>
      <td>range(0, 672)</td>
      <td>range(676, 700)</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>range(168, 336)</td>
      <td>range(340, 364)</td>
      <td>range(336, 672)</td>
      <td>range(676, 700)</td>
      <td>range(504, 1008)</td>
      <td>range(1012, 1036)</td>
      <td>range(672, 1344)</td>
      <td>range(1348, 1372)</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>range(336, 504)</td>
      <td>range(508, 532)</td>
      <td>range(672, 1008)</td>
      <td>range(1012, 1036)</td>
      <td>range(1008, 1512)</td>
      <td>range(1516, 1540)</td>
      <td>range(1344, 2016)</td>
      <td>range(2020, 2044)</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>range(504, 672)</td>
      <td>range(676, 700)</td>
      <td>range(1008, 1344)</td>
      <td>range(1348, 1372)</td>
      <td>range(1512, 2016)</td>
      <td>range(2020, 2044)</td>
      <td>range(2016, 2688)</td>
      <td>range(2692, 2716)</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>range(672, 840)</td>
      <td>range(844, 868)</td>
      <td>range(1344, 1680)</td>
      <td>range(1684, 1708)</td>
      <td>range(2016, 2520)</td>
      <td>range(2524, 2548)</td>
      <td>range(2688, 3360)</td>
      <td>range(3364, 3388)</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p5</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Pliegue</th>
      <th>Entrenamiento 7 días</th>
      <th>Prueba 7 días</th>
      <th>Entrenamiento 14 días</th>
      <th>Prueba 14 días</th>
      <th>Entrenamiento 21 días</th>
      <th>Prueba 21 días</th>
      <th>Entrenamiento 28 días</th>
      <th>Prueba 28 días</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>516</th>
      <td>517</td>
      <td>range(86688, 86856)</td>
      <td>range(86860, 86884)</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>517</th>
      <td>518</td>
      <td>range(86856, 87024)</td>
      <td>range(87028, 87052)</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>518</th>
      <td>519</td>
      <td>range(87024, 87192)</td>
      <td>range(87196, 87220)</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>519</th>
      <td>520</td>
      <td>range(87192, 87360)</td>
      <td>range(87364, 87388)</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>520</th>
      <td>521</td>
      <td>range(87360, 87528)</td>
      <td>range(87532, 87556)</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="hora-10">
<h3><strong>HORA 10</strong><a class="headerlink" href="#hora-10" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">resultados</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;Pliegue&#39;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="s1">&#39;Entrenamiento 7 días&#39;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="s1">&#39;Prueba 7 días&#39;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="s1">&#39;Entrenamiento 14 días&#39;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="s1">&#39;Prueba 14 días&#39;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="s1">&#39;Entrenamiento 21 días&#39;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="s1">&#39;Prueba 21 días&#39;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="s1">&#39;Entrenamiento 28 días&#39;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="s1">&#39;Prueba 28 días&#39;</span><span class="p">:</span> <span class="p">[],</span>
<span class="p">}</span>

<span class="k">for</span> <span class="n">dias</span> <span class="ow">in</span> <span class="n">particiones</span><span class="p">:</span>
    <span class="n">plgs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">hora</span><span class="o">=</span><span class="mi">10</span>
    <span class="n">plgs</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">pliegues</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">hora</span><span class="p">,</span> <span class="n">dias</span><span class="p">))</span> 

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">trn_index</span><span class="p">,</span> <span class="n">tst_index</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">plgs</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">dias</span> <span class="o">==</span> <span class="mi">7</span><span class="p">:</span>
            <span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Pliegue&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Entrenamiento 7 días&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;range(</span><span class="si">{</span><span class="n">trn_index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">trn_index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
            <span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Prueba 7 días&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;range(</span><span class="si">{</span><span class="n">tst_index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">tst_index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">dias</span> <span class="o">==</span> <span class="mi">14</span><span class="p">:</span>
            <span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Entrenamiento 14 días&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;range(</span><span class="si">{</span><span class="n">trn_index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">trn_index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
            <span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Prueba 14 días&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;range(</span><span class="si">{</span><span class="n">tst_index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">tst_index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">dias</span> <span class="o">==</span> <span class="mi">21</span><span class="p">:</span>
            <span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Entrenamiento 21 días&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;range(</span><span class="si">{</span><span class="n">trn_index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">trn_index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
            <span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Prueba 21 días&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;range(</span><span class="si">{</span><span class="n">tst_index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">tst_index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">dias</span> <span class="o">==</span> <span class="mi">28</span><span class="p">:</span>
            <span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Entrenamiento 28 días&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;range(</span><span class="si">{</span><span class="n">trn_index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">trn_index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
            <span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Prueba 28 días&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;range(</span><span class="si">{</span><span class="n">tst_index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">tst_index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>

<span class="n">colms</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Entrenamiento 7 días&#39;</span><span class="p">]),</span>
                     <span class="nb">len</span><span class="p">(</span><span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Entrenamiento 14 días&#39;</span><span class="p">]),</span>
                     <span class="nb">len</span><span class="p">(</span><span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Entrenamiento 21 días&#39;</span><span class="p">]),</span>
                     <span class="nb">len</span><span class="p">(</span><span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Entrenamiento 28 días&#39;</span><span class="p">]))</span>

<span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">resultados</span><span class="p">:</span>
    <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">resultados</span><span class="p">[</span><span class="n">key</span><span class="p">])</span> <span class="o">&lt;</span> <span class="n">colms</span><span class="p">:</span>
        <span class="n">resultados</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>

<span class="n">p10</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">resultados</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p10</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Pliegue</th>
      <th>Entrenamiento 7 días</th>
      <th>Prueba 7 días</th>
      <th>Entrenamiento 14 días</th>
      <th>Prueba 14 días</th>
      <th>Entrenamiento 21 días</th>
      <th>Prueba 21 días</th>
      <th>Entrenamiento 28 días</th>
      <th>Prueba 28 días</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>range(0, 168)</td>
      <td>range(177, 201)</td>
      <td>range(0, 336)</td>
      <td>range(345, 369)</td>
      <td>range(0, 504)</td>
      <td>range(513, 537)</td>
      <td>range(0, 672)</td>
      <td>range(681, 705)</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>range(168, 336)</td>
      <td>range(345, 369)</td>
      <td>range(336, 672)</td>
      <td>range(681, 705)</td>
      <td>range(504, 1008)</td>
      <td>range(1017, 1041)</td>
      <td>range(672, 1344)</td>
      <td>range(1353, 1377)</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>range(336, 504)</td>
      <td>range(513, 537)</td>
      <td>range(672, 1008)</td>
      <td>range(1017, 1041)</td>
      <td>range(1008, 1512)</td>
      <td>range(1521, 1545)</td>
      <td>range(1344, 2016)</td>
      <td>range(2025, 2049)</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>range(504, 672)</td>
      <td>range(681, 705)</td>
      <td>range(1008, 1344)</td>
      <td>range(1353, 1377)</td>
      <td>range(1512, 2016)</td>
      <td>range(2025, 2049)</td>
      <td>range(2016, 2688)</td>
      <td>range(2697, 2721)</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>range(672, 840)</td>
      <td>range(849, 873)</td>
      <td>range(1344, 1680)</td>
      <td>range(1689, 1713)</td>
      <td>range(2016, 2520)</td>
      <td>range(2529, 2553)</td>
      <td>range(2688, 3360)</td>
      <td>range(3369, 3393)</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p10</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Pliegue</th>
      <th>Entrenamiento 7 días</th>
      <th>Prueba 7 días</th>
      <th>Entrenamiento 14 días</th>
      <th>Prueba 14 días</th>
      <th>Entrenamiento 21 días</th>
      <th>Prueba 21 días</th>
      <th>Entrenamiento 28 días</th>
      <th>Prueba 28 días</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>516</th>
      <td>517</td>
      <td>range(86688, 86856)</td>
      <td>range(86865, 86889)</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>517</th>
      <td>518</td>
      <td>range(86856, 87024)</td>
      <td>range(87033, 87057)</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>518</th>
      <td>519</td>
      <td>range(87024, 87192)</td>
      <td>range(87201, 87225)</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>519</th>
      <td>520</td>
      <td>range(87192, 87360)</td>
      <td>range(87369, 87393)</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>520</th>
      <td>521</td>
      <td>range(87360, 87528)</td>
      <td>range(87537, 87561)</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="hora-15">
<h3><strong>HORA 15</strong><a class="headerlink" href="#hora-15" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">resultados</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;Pliegue&#39;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="s1">&#39;Entrenamiento 7 días&#39;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="s1">&#39;Prueba 7 días&#39;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="s1">&#39;Entrenamiento 14 días&#39;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="s1">&#39;Prueba 14 días&#39;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="s1">&#39;Entrenamiento 21 días&#39;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="s1">&#39;Prueba 21 días&#39;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="s1">&#39;Entrenamiento 28 días&#39;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="s1">&#39;Prueba 28 días&#39;</span><span class="p">:</span> <span class="p">[],</span>
<span class="p">}</span>

<span class="k">for</span> <span class="n">dias</span> <span class="ow">in</span> <span class="n">particiones</span><span class="p">:</span>
    <span class="n">plgs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">hora</span><span class="o">=</span><span class="mi">15</span>
    <span class="n">plgs</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">pliegues</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">hora</span><span class="p">,</span> <span class="n">dias</span><span class="p">))</span> 

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">trn_index</span><span class="p">,</span> <span class="n">tst_index</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">plgs</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">dias</span> <span class="o">==</span> <span class="mi">7</span><span class="p">:</span>
            <span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Pliegue&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Entrenamiento 7 días&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;range(</span><span class="si">{</span><span class="n">trn_index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">trn_index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
            <span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Prueba 7 días&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;range(</span><span class="si">{</span><span class="n">tst_index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">tst_index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">dias</span> <span class="o">==</span> <span class="mi">14</span><span class="p">:</span>
            <span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Entrenamiento 14 días&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;range(</span><span class="si">{</span><span class="n">trn_index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">trn_index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
            <span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Prueba 14 días&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;range(</span><span class="si">{</span><span class="n">tst_index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">tst_index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">dias</span> <span class="o">==</span> <span class="mi">21</span><span class="p">:</span>
            <span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Entrenamiento 21 días&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;range(</span><span class="si">{</span><span class="n">trn_index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">trn_index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
            <span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Prueba 21 días&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;range(</span><span class="si">{</span><span class="n">tst_index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">tst_index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">dias</span> <span class="o">==</span> <span class="mi">28</span><span class="p">:</span>
            <span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Entrenamiento 28 días&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;range(</span><span class="si">{</span><span class="n">trn_index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">trn_index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
            <span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Prueba 28 días&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;range(</span><span class="si">{</span><span class="n">tst_index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">tst_index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>

<span class="n">colms</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Entrenamiento 7 días&#39;</span><span class="p">]),</span>
                     <span class="nb">len</span><span class="p">(</span><span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Entrenamiento 14 días&#39;</span><span class="p">]),</span>
                     <span class="nb">len</span><span class="p">(</span><span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Entrenamiento 21 días&#39;</span><span class="p">]),</span>
                     <span class="nb">len</span><span class="p">(</span><span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Entrenamiento 28 días&#39;</span><span class="p">]))</span>

<span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">resultados</span><span class="p">:</span>
    <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">resultados</span><span class="p">[</span><span class="n">key</span><span class="p">])</span> <span class="o">&lt;</span> <span class="n">colms</span><span class="p">:</span>
        <span class="n">resultados</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>

<span class="n">p15</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">resultados</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p15</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Pliegue</th>
      <th>Entrenamiento 7 días</th>
      <th>Prueba 7 días</th>
      <th>Entrenamiento 14 días</th>
      <th>Prueba 14 días</th>
      <th>Entrenamiento 21 días</th>
      <th>Prueba 21 días</th>
      <th>Entrenamiento 28 días</th>
      <th>Prueba 28 días</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>range(0, 168)</td>
      <td>range(182, 206)</td>
      <td>range(0, 336)</td>
      <td>range(350, 374)</td>
      <td>range(0, 504)</td>
      <td>range(518, 542)</td>
      <td>range(0, 672)</td>
      <td>range(686, 710)</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>range(168, 336)</td>
      <td>range(350, 374)</td>
      <td>range(336, 672)</td>
      <td>range(686, 710)</td>
      <td>range(504, 1008)</td>
      <td>range(1022, 1046)</td>
      <td>range(672, 1344)</td>
      <td>range(1358, 1382)</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>range(336, 504)</td>
      <td>range(518, 542)</td>
      <td>range(672, 1008)</td>
      <td>range(1022, 1046)</td>
      <td>range(1008, 1512)</td>
      <td>range(1526, 1550)</td>
      <td>range(1344, 2016)</td>
      <td>range(2030, 2054)</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>range(504, 672)</td>
      <td>range(686, 710)</td>
      <td>range(1008, 1344)</td>
      <td>range(1358, 1382)</td>
      <td>range(1512, 2016)</td>
      <td>range(2030, 2054)</td>
      <td>range(2016, 2688)</td>
      <td>range(2702, 2726)</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>range(672, 840)</td>
      <td>range(854, 878)</td>
      <td>range(1344, 1680)</td>
      <td>range(1694, 1718)</td>
      <td>range(2016, 2520)</td>
      <td>range(2534, 2558)</td>
      <td>range(2688, 3360)</td>
      <td>range(3374, 3398)</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p15</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Pliegue</th>
      <th>Entrenamiento 7 días</th>
      <th>Prueba 7 días</th>
      <th>Entrenamiento 14 días</th>
      <th>Prueba 14 días</th>
      <th>Entrenamiento 21 días</th>
      <th>Prueba 21 días</th>
      <th>Entrenamiento 28 días</th>
      <th>Prueba 28 días</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>516</th>
      <td>517</td>
      <td>range(86688, 86856)</td>
      <td>range(86870, 86894)</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>517</th>
      <td>518</td>
      <td>range(86856, 87024)</td>
      <td>range(87038, 87062)</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>518</th>
      <td>519</td>
      <td>range(87024, 87192)</td>
      <td>range(87206, 87230)</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>519</th>
      <td>520</td>
      <td>range(87192, 87360)</td>
      <td>range(87374, 87398)</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>520</th>
      <td>521</td>
      <td>range(87360, 87528)</td>
      <td>range(87542, 87566)</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="hora-20">
<h3><strong>HORA 20</strong><a class="headerlink" href="#hora-20" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">resultados</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;Pliegue&#39;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="s1">&#39;Entrenamiento 7 días&#39;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="s1">&#39;Prueba 7 días&#39;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="s1">&#39;Entrenamiento 14 días&#39;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="s1">&#39;Prueba 14 días&#39;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="s1">&#39;Entrenamiento 21 días&#39;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="s1">&#39;Prueba 21 días&#39;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="s1">&#39;Entrenamiento 28 días&#39;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="s1">&#39;Prueba 28 días&#39;</span><span class="p">:</span> <span class="p">[],</span>
<span class="p">}</span>

<span class="k">for</span> <span class="n">dias</span> <span class="ow">in</span> <span class="n">particiones</span><span class="p">:</span>
    <span class="n">plgs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">hora</span><span class="o">=</span><span class="mi">20</span>
    <span class="n">plgs</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">pliegues</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">hora</span><span class="p">,</span> <span class="n">dias</span><span class="p">))</span> 

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">trn_index</span><span class="p">,</span> <span class="n">tst_index</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">plgs</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">dias</span> <span class="o">==</span> <span class="mi">7</span><span class="p">:</span>
            <span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Pliegue&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Entrenamiento 7 días&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;range(</span><span class="si">{</span><span class="n">trn_index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">trn_index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
            <span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Prueba 7 días&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;range(</span><span class="si">{</span><span class="n">tst_index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">tst_index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">dias</span> <span class="o">==</span> <span class="mi">14</span><span class="p">:</span>
            <span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Entrenamiento 14 días&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;range(</span><span class="si">{</span><span class="n">trn_index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">trn_index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
            <span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Prueba 14 días&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;range(</span><span class="si">{</span><span class="n">tst_index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">tst_index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">dias</span> <span class="o">==</span> <span class="mi">21</span><span class="p">:</span>
            <span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Entrenamiento 21 días&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;range(</span><span class="si">{</span><span class="n">trn_index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">trn_index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
            <span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Prueba 21 días&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;range(</span><span class="si">{</span><span class="n">tst_index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">tst_index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">dias</span> <span class="o">==</span> <span class="mi">28</span><span class="p">:</span>
            <span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Entrenamiento 28 días&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;range(</span><span class="si">{</span><span class="n">trn_index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">trn_index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
            <span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Prueba 28 días&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;range(</span><span class="si">{</span><span class="n">tst_index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">tst_index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>

<span class="n">colms</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Entrenamiento 7 días&#39;</span><span class="p">]),</span>
                     <span class="nb">len</span><span class="p">(</span><span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Entrenamiento 14 días&#39;</span><span class="p">]),</span>
                     <span class="nb">len</span><span class="p">(</span><span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Entrenamiento 21 días&#39;</span><span class="p">]),</span>
                     <span class="nb">len</span><span class="p">(</span><span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Entrenamiento 28 días&#39;</span><span class="p">]))</span>

<span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">resultados</span><span class="p">:</span>
    <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">resultados</span><span class="p">[</span><span class="n">key</span><span class="p">])</span> <span class="o">&lt;</span> <span class="n">colms</span><span class="p">:</span>
        <span class="n">resultados</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>

<span class="n">p20</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">resultados</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p20</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Pliegue</th>
      <th>Entrenamiento 7 días</th>
      <th>Prueba 7 días</th>
      <th>Entrenamiento 14 días</th>
      <th>Prueba 14 días</th>
      <th>Entrenamiento 21 días</th>
      <th>Prueba 21 días</th>
      <th>Entrenamiento 28 días</th>
      <th>Prueba 28 días</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>range(0, 168)</td>
      <td>range(187, 211)</td>
      <td>range(0, 336)</td>
      <td>range(355, 379)</td>
      <td>range(0, 504)</td>
      <td>range(523, 547)</td>
      <td>range(0, 672)</td>
      <td>range(691, 715)</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>range(168, 336)</td>
      <td>range(355, 379)</td>
      <td>range(336, 672)</td>
      <td>range(691, 715)</td>
      <td>range(504, 1008)</td>
      <td>range(1027, 1051)</td>
      <td>range(672, 1344)</td>
      <td>range(1363, 1387)</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>range(336, 504)</td>
      <td>range(523, 547)</td>
      <td>range(672, 1008)</td>
      <td>range(1027, 1051)</td>
      <td>range(1008, 1512)</td>
      <td>range(1531, 1555)</td>
      <td>range(1344, 2016)</td>
      <td>range(2035, 2059)</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>range(504, 672)</td>
      <td>range(691, 715)</td>
      <td>range(1008, 1344)</td>
      <td>range(1363, 1387)</td>
      <td>range(1512, 2016)</td>
      <td>range(2035, 2059)</td>
      <td>range(2016, 2688)</td>
      <td>range(2707, 2731)</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>range(672, 840)</td>
      <td>range(859, 883)</td>
      <td>range(1344, 1680)</td>
      <td>range(1699, 1723)</td>
      <td>range(2016, 2520)</td>
      <td>range(2539, 2563)</td>
      <td>range(2688, 3360)</td>
      <td>range(3379, 3403)</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p20</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Pliegue</th>
      <th>Entrenamiento 7 días</th>
      <th>Prueba 7 días</th>
      <th>Entrenamiento 14 días</th>
      <th>Prueba 14 días</th>
      <th>Entrenamiento 21 días</th>
      <th>Prueba 21 días</th>
      <th>Entrenamiento 28 días</th>
      <th>Prueba 28 días</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>516</th>
      <td>517</td>
      <td>range(86688, 86856)</td>
      <td>range(86875, 86899)</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>517</th>
      <td>518</td>
      <td>range(86856, 87024)</td>
      <td>range(87043, 87067)</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>518</th>
      <td>519</td>
      <td>range(87024, 87192)</td>
      <td>range(87211, 87235)</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>519</th>
      <td>520</td>
      <td>range(87192, 87360)</td>
      <td>range(87379, 87403)</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>520</th>
      <td>521</td>
      <td>range(87360, 87528)</td>
      <td>range(87547, 87571)</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="hora-24">
<h3><strong>HORA 24</strong><a class="headerlink" href="#hora-24" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">resultados</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;Pliegue&#39;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="s1">&#39;Entrenamiento 7 días&#39;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="s1">&#39;Prueba 7 días&#39;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="s1">&#39;Entrenamiento 14 días&#39;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="s1">&#39;Prueba 14 días&#39;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="s1">&#39;Entrenamiento 21 días&#39;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="s1">&#39;Prueba 21 días&#39;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="s1">&#39;Entrenamiento 28 días&#39;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="s1">&#39;Prueba 28 días&#39;</span><span class="p">:</span> <span class="p">[],</span>
<span class="p">}</span>

<span class="k">for</span> <span class="n">dias</span> <span class="ow">in</span> <span class="n">particiones</span><span class="p">:</span>
    <span class="n">plgs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">hora</span><span class="o">=</span><span class="mi">24</span>
    <span class="n">plgs</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">pliegues</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">hora</span><span class="p">,</span> <span class="n">dias</span><span class="p">))</span> 

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">trn_index</span><span class="p">,</span> <span class="n">tst_index</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">plgs</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">dias</span> <span class="o">==</span> <span class="mi">7</span><span class="p">:</span>
            <span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Pliegue&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Entrenamiento 7 días&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;range(</span><span class="si">{</span><span class="n">trn_index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">trn_index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
            <span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Prueba 7 días&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;range(</span><span class="si">{</span><span class="n">tst_index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">tst_index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">dias</span> <span class="o">==</span> <span class="mi">14</span><span class="p">:</span>
            <span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Entrenamiento 14 días&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;range(</span><span class="si">{</span><span class="n">trn_index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">trn_index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
            <span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Prueba 14 días&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;range(</span><span class="si">{</span><span class="n">tst_index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">tst_index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">dias</span> <span class="o">==</span> <span class="mi">21</span><span class="p">:</span>
            <span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Entrenamiento 21 días&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;range(</span><span class="si">{</span><span class="n">trn_index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">trn_index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
            <span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Prueba 21 días&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;range(</span><span class="si">{</span><span class="n">tst_index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">tst_index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">dias</span> <span class="o">==</span> <span class="mi">28</span><span class="p">:</span>
            <span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Entrenamiento 28 días&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;range(</span><span class="si">{</span><span class="n">trn_index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">trn_index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
            <span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Prueba 28 días&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;range(</span><span class="si">{</span><span class="n">tst_index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">tst_index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>

<span class="n">colms</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Entrenamiento 7 días&#39;</span><span class="p">]),</span>
                     <span class="nb">len</span><span class="p">(</span><span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Entrenamiento 14 días&#39;</span><span class="p">]),</span>
                     <span class="nb">len</span><span class="p">(</span><span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Entrenamiento 21 días&#39;</span><span class="p">]),</span>
                     <span class="nb">len</span><span class="p">(</span><span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Entrenamiento 28 días&#39;</span><span class="p">]))</span>

<span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">resultados</span><span class="p">:</span>
    <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">resultados</span><span class="p">[</span><span class="n">key</span><span class="p">])</span> <span class="o">&lt;</span> <span class="n">colms</span><span class="p">:</span>
        <span class="n">resultados</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>

<span class="n">p24</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">resultados</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p24</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Pliegue</th>
      <th>Entrenamiento 7 días</th>
      <th>Prueba 7 días</th>
      <th>Entrenamiento 14 días</th>
      <th>Prueba 14 días</th>
      <th>Entrenamiento 21 días</th>
      <th>Prueba 21 días</th>
      <th>Entrenamiento 28 días</th>
      <th>Prueba 28 días</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>range(0, 168)</td>
      <td>range(191, 215)</td>
      <td>range(0, 336)</td>
      <td>range(359, 383)</td>
      <td>range(0, 504)</td>
      <td>range(527, 551)</td>
      <td>range(0, 672)</td>
      <td>range(695, 719)</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>range(168, 336)</td>
      <td>range(359, 383)</td>
      <td>range(336, 672)</td>
      <td>range(695, 719)</td>
      <td>range(504, 1008)</td>
      <td>range(1031, 1055)</td>
      <td>range(672, 1344)</td>
      <td>range(1367, 1391)</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>range(336, 504)</td>
      <td>range(527, 551)</td>
      <td>range(672, 1008)</td>
      <td>range(1031, 1055)</td>
      <td>range(1008, 1512)</td>
      <td>range(1535, 1559)</td>
      <td>range(1344, 2016)</td>
      <td>range(2039, 2063)</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>range(504, 672)</td>
      <td>range(695, 719)</td>
      <td>range(1008, 1344)</td>
      <td>range(1367, 1391)</td>
      <td>range(1512, 2016)</td>
      <td>range(2039, 2063)</td>
      <td>range(2016, 2688)</td>
      <td>range(2711, 2735)</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>range(672, 840)</td>
      <td>range(863, 887)</td>
      <td>range(1344, 1680)</td>
      <td>range(1703, 1727)</td>
      <td>range(2016, 2520)</td>
      <td>range(2543, 2567)</td>
      <td>range(2688, 3360)</td>
      <td>range(3383, 3407)</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p24</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Pliegue</th>
      <th>Entrenamiento 7 días</th>
      <th>Prueba 7 días</th>
      <th>Entrenamiento 14 días</th>
      <th>Prueba 14 días</th>
      <th>Entrenamiento 21 días</th>
      <th>Prueba 21 días</th>
      <th>Entrenamiento 28 días</th>
      <th>Prueba 28 días</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>516</th>
      <td>517</td>
      <td>range(86688, 86856)</td>
      <td>range(86879, 86903)</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>517</th>
      <td>518</td>
      <td>range(86856, 87024)</td>
      <td>range(87047, 87071)</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>518</th>
      <td>519</td>
      <td>range(87024, 87192)</td>
      <td>range(87215, 87239)</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>519</th>
      <td>520</td>
      <td>range(87192, 87360)</td>
      <td>range(87383, 87407)</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>520</th>
      <td>521</td>
      <td>range(87360, 87528)</td>
      <td>range(87551, 87575)</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Ahora, vamos a trabajar modelo por modelo, encontrando el mejor para cada ventana de predicción en cada hora. Esta decisión la tomamos basada en la métrica RMSE dado el tipo de los modelos y nuestro objetivo.</p>
<p>Como aclaración, inicialmente se intentó mostrar la métrica basada en el promedio de todas ellas. Sin embargo, observamos una situación recurrente de valores de R² negativos. Por esta razón, decidimos mostrar el modelo del mejor pliegue para cada hora.</p>
</section>
</section>
<section id="modelos">
<h2><strong>MODELOS</strong><a class="headerlink" href="#modelos" title="Link to this heading">#</a></h2>
<section id="modelo-knn">
<h3><strong>MODELO KNN</strong><a class="headerlink" href="#modelo-knn" title="Link to this heading">#</a></h3>
<p>Primeramente se entrena el modelo y predice. Se imprimen las tablas que contienen las métricas predeterminadas para cada una de las 24 horas.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">modeloknn</span> <span class="o">=</span> <span class="n">KNeighborsRegressor</span><span class="p">()</span>
<span class="n">metricas</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">hora</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">25</span><span class="p">):</span>  <span class="c1"># Ciclo controlador. Se recorre cada una de las 24 horas.</span>
    <span class="k">for</span> <span class="n">dias</span> <span class="ow">in</span> <span class="n">particiones</span><span class="p">:</span>  <span class="c1"># Ciclo que recorre cada una de las 4 ventanas de predicción.      </span>
        <span class="n">iniciotrain</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># Se inicializa en 0 para que al realizar la suma no se vaya un día más.     </span>
        <span class="k">while</span> <span class="p">(</span><span class="n">iniciotrain</span> <span class="o">+</span> <span class="p">(</span><span class="n">dias</span> <span class="o">*</span> <span class="mi">24</span><span class="p">)</span> <span class="o">+</span> <span class="n">hora</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">):</span>  <span class="c1"># Mientras que el tamaño del pliegue más la hora en la que se está iterando sea menor que la longitud de los datos           </span>
            <span class="n">fintrain</span> <span class="o">=</span> <span class="n">iniciotrain</span> <span class="o">+</span> <span class="p">(</span><span class="n">dias</span> <span class="o">*</span> <span class="mi">24</span><span class="p">)</span> <span class="c1"># Se suma con dias*24 porque es la cantidad de observaciones a escoger. La cantidad de horas totales teniendo en cuanta la cantidad de días.          </span>
            <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">plieguess</span><span class="p">(</span><span class="n">iniciotrain</span><span class="p">,</span> <span class="n">fintrain</span><span class="p">,</span> <span class="n">hora</span><span class="p">)</span>           
            <span class="n">modeloknn</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
            <span class="n">y_prediccion</span><span class="o">=</span> <span class="n">modeloknn</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>               
            <span class="n">rmse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">,</span> <span class="n">squared</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="n">mape</span> <span class="o">=</span> <span class="n">MAPE</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">)</span>
            <span class="n">r2</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">)</span>           
            <span class="n">metricas</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
                <span class="s1">&#39;Modelo&#39;</span><span class="p">:</span> <span class="s1">&#39;Regresión KNN&#39;</span><span class="p">,</span>
                <span class="s1">&#39;Dias&#39;</span><span class="p">:</span> <span class="n">dias</span><span class="p">,</span>
                <span class="s1">&#39;Hora&#39;</span><span class="p">:</span> <span class="n">hora</span><span class="p">,</span>
                <span class="s1">&#39;MAPE&#39;</span><span class="p">:</span> <span class="n">mape</span><span class="p">,</span>
                <span class="s1">&#39;RMSE&#39;</span><span class="p">:</span> <span class="n">rmse</span><span class="p">,</span>
                <span class="s1">&#39;R^2&#39;</span><span class="p">:</span> <span class="n">r2</span><span class="p">,</span>
            <span class="p">})</span>           
            <span class="n">iniciotrain</span> <span class="o">=</span> <span class="n">fintrain</span>  <span class="c1"># Se actualiza a la última posición del pliegue actual</span>
<span class="n">dataknn</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">metricas</span><span class="p">)</span>
<span class="n">dataknn</span> <span class="o">=</span> <span class="n">dataknn</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dataknn</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;Modelo&#39;</span><span class="p">,</span> <span class="s1">&#39;Hora&#39;</span><span class="p">,</span> <span class="s1">&#39;Dias&#39;</span><span class="p">])[</span><span class="s1">&#39;RMSE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">idxmin</span><span class="p">()]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1"># Envía el mejor pliegue. Menor RMSE.</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataknn</span><span class="p">[</span><span class="n">dataknn</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Regresión KNN</td>
      <td>7</td>
      <td>1</td>
      <td>14.168936</td>
      <td>0.442361</td>
      <td>0.739740</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Regresión KNN</td>
      <td>14</td>
      <td>1</td>
      <td>16.629903</td>
      <td>0.485575</td>
      <td>0.744979</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Regresión KNN</td>
      <td>21</td>
      <td>1</td>
      <td>22.281085</td>
      <td>0.427025</td>
      <td>0.604244</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Regresión KNN</td>
      <td>28</td>
      <td>1</td>
      <td>14.998429</td>
      <td>0.435775</td>
      <td>0.790451</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataknn</span><span class="p">[</span><span class="n">dataknn</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>4</th>
      <td>Regresión KNN</td>
      <td>7</td>
      <td>2</td>
      <td>14.197404</td>
      <td>0.442003</td>
      <td>0.739650</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Regresión KNN</td>
      <td>14</td>
      <td>2</td>
      <td>17.000273</td>
      <td>0.487220</td>
      <td>0.743249</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Regresión KNN</td>
      <td>21</td>
      <td>2</td>
      <td>22.808862</td>
      <td>0.438482</td>
      <td>0.588184</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Regresión KNN</td>
      <td>28</td>
      <td>2</td>
      <td>9.585378</td>
      <td>0.399166</td>
      <td>0.803793</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataknn</span><span class="p">[</span><span class="n">dataknn</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">3</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>8</th>
      <td>Regresión KNN</td>
      <td>7</td>
      <td>3</td>
      <td>15.437170</td>
      <td>0.457566</td>
      <td>0.730520</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Regresión KNN</td>
      <td>14</td>
      <td>3</td>
      <td>12.820161</td>
      <td>0.450518</td>
      <td>0.688110</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Regresión KNN</td>
      <td>21</td>
      <td>3</td>
      <td>19.325406</td>
      <td>0.468277</td>
      <td>0.541501</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Regresión KNN</td>
      <td>28</td>
      <td>3</td>
      <td>9.850530</td>
      <td>0.403753</td>
      <td>0.749500</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataknn</span><span class="p">[</span><span class="n">dataknn</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">4</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>12</th>
      <td>Regresión KNN</td>
      <td>7</td>
      <td>4</td>
      <td>16.989267</td>
      <td>0.444503</td>
      <td>0.782061</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Regresión KNN</td>
      <td>14</td>
      <td>4</td>
      <td>10.401227</td>
      <td>0.483425</td>
      <td>0.716291</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Regresión KNN</td>
      <td>21</td>
      <td>4</td>
      <td>19.526820</td>
      <td>0.413199</td>
      <td>0.854273</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Regresión KNN</td>
      <td>28</td>
      <td>4</td>
      <td>12.129570</td>
      <td>0.432762</td>
      <td>0.755629</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataknn</span><span class="p">[</span><span class="n">dataknn</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">5</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>16</th>
      <td>Regresión KNN</td>
      <td>7</td>
      <td>5</td>
      <td>13.595712</td>
      <td>0.432493</td>
      <td>0.745294</td>
    </tr>
    <tr>
      <th>17</th>
      <td>Regresión KNN</td>
      <td>14</td>
      <td>5</td>
      <td>10.448847</td>
      <td>0.481196</td>
      <td>0.724071</td>
    </tr>
    <tr>
      <th>18</th>
      <td>Regresión KNN</td>
      <td>21</td>
      <td>5</td>
      <td>18.262616</td>
      <td>0.402906</td>
      <td>0.854985</td>
    </tr>
    <tr>
      <th>19</th>
      <td>Regresión KNN</td>
      <td>28</td>
      <td>5</td>
      <td>15.046237</td>
      <td>0.434166</td>
      <td>0.805614</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataknn</span><span class="p">[</span><span class="n">dataknn</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">6</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>20</th>
      <td>Regresión KNN</td>
      <td>7</td>
      <td>6</td>
      <td>14.147091</td>
      <td>0.438387</td>
      <td>0.724461</td>
    </tr>
    <tr>
      <th>21</th>
      <td>Regresión KNN</td>
      <td>14</td>
      <td>6</td>
      <td>21.678255</td>
      <td>0.468971</td>
      <td>0.485452</td>
    </tr>
    <tr>
      <th>22</th>
      <td>Regresión KNN</td>
      <td>21</td>
      <td>6</td>
      <td>17.270552</td>
      <td>0.394483</td>
      <td>0.858206</td>
    </tr>
    <tr>
      <th>23</th>
      <td>Regresión KNN</td>
      <td>28</td>
      <td>6</td>
      <td>14.149539</td>
      <td>0.402472</td>
      <td>0.848079</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataknn</span><span class="p">[</span><span class="n">dataknn</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">7</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>24</th>
      <td>Regresión KNN</td>
      <td>7</td>
      <td>7</td>
      <td>14.334712</td>
      <td>0.441324</td>
      <td>0.718410</td>
    </tr>
    <tr>
      <th>25</th>
      <td>Regresión KNN</td>
      <td>14</td>
      <td>7</td>
      <td>22.126171</td>
      <td>0.474043</td>
      <td>0.478729</td>
    </tr>
    <tr>
      <th>26</th>
      <td>Regresión KNN</td>
      <td>21</td>
      <td>7</td>
      <td>15.673330</td>
      <td>0.385962</td>
      <td>0.857199</td>
    </tr>
    <tr>
      <th>27</th>
      <td>Regresión KNN</td>
      <td>28</td>
      <td>7</td>
      <td>14.360695</td>
      <td>0.404516</td>
      <td>0.840520</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataknn</span><span class="p">[</span><span class="n">dataknn</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">8</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>28</th>
      <td>Regresión KNN</td>
      <td>7</td>
      <td>8</td>
      <td>20.195250</td>
      <td>0.436730</td>
      <td>0.551216</td>
    </tr>
    <tr>
      <th>29</th>
      <td>Regresión KNN</td>
      <td>14</td>
      <td>8</td>
      <td>20.530777</td>
      <td>0.453560</td>
      <td>0.515961</td>
    </tr>
    <tr>
      <th>30</th>
      <td>Regresión KNN</td>
      <td>21</td>
      <td>8</td>
      <td>13.559669</td>
      <td>0.381969</td>
      <td>0.881616</td>
    </tr>
    <tr>
      <th>31</th>
      <td>Regresión KNN</td>
      <td>28</td>
      <td>8</td>
      <td>13.931040</td>
      <td>0.372805</td>
      <td>0.846283</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataknn</span><span class="p">[</span><span class="n">dataknn</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">9</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>32</th>
      <td>Regresión KNN</td>
      <td>7</td>
      <td>9</td>
      <td>21.644830</td>
      <td>0.449370</td>
      <td>0.536950</td>
    </tr>
    <tr>
      <th>33</th>
      <td>Regresión KNN</td>
      <td>14</td>
      <td>9</td>
      <td>21.980356</td>
      <td>0.465743</td>
      <td>0.502592</td>
    </tr>
    <tr>
      <th>34</th>
      <td>Regresión KNN</td>
      <td>21</td>
      <td>9</td>
      <td>14.105775</td>
      <td>0.396884</td>
      <td>0.867939</td>
    </tr>
    <tr>
      <th>35</th>
      <td>Regresión KNN</td>
      <td>28</td>
      <td>9</td>
      <td>14.543433</td>
      <td>0.393510</td>
      <td>0.794901</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataknn</span><span class="p">[</span><span class="n">dataknn</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">10</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>36</th>
      <td>Regresión KNN</td>
      <td>7</td>
      <td>10</td>
      <td>21.276409</td>
      <td>0.445271</td>
      <td>0.554856</td>
    </tr>
    <tr>
      <th>37</th>
      <td>Regresión KNN</td>
      <td>14</td>
      <td>10</td>
      <td>21.611935</td>
      <td>0.461790</td>
      <td>0.521216</td>
    </tr>
    <tr>
      <th>38</th>
      <td>Regresión KNN</td>
      <td>21</td>
      <td>10</td>
      <td>14.147725</td>
      <td>0.405668</td>
      <td>0.857086</td>
    </tr>
    <tr>
      <th>39</th>
      <td>Regresión KNN</td>
      <td>28</td>
      <td>10</td>
      <td>14.403880</td>
      <td>0.390790</td>
      <td>0.778471</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataknn</span><span class="p">[</span><span class="n">dataknn</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">11</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>40</th>
      <td>Regresión KNN</td>
      <td>7</td>
      <td>11</td>
      <td>22.580330</td>
      <td>0.458421</td>
      <td>0.534562</td>
    </tr>
    <tr>
      <th>41</th>
      <td>Regresión KNN</td>
      <td>14</td>
      <td>11</td>
      <td>22.915857</td>
      <td>0.474482</td>
      <td>0.501377</td>
    </tr>
    <tr>
      <th>42</th>
      <td>Regresión KNN</td>
      <td>21</td>
      <td>11</td>
      <td>14.832047</td>
      <td>0.436616</td>
      <td>0.834112</td>
    </tr>
    <tr>
      <th>43</th>
      <td>Regresión KNN</td>
      <td>28</td>
      <td>11</td>
      <td>14.591160</td>
      <td>0.404866</td>
      <td>0.774033</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataknn</span><span class="p">[</span><span class="n">dataknn</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">12</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>44</th>
      <td>Regresión KNN</td>
      <td>7</td>
      <td>12</td>
      <td>22.439353</td>
      <td>0.463033</td>
      <td>0.510564</td>
    </tr>
    <tr>
      <th>45</th>
      <td>Regresión KNN</td>
      <td>14</td>
      <td>12</td>
      <td>22.774880</td>
      <td>0.478940</td>
      <td>0.476360</td>
    </tr>
    <tr>
      <th>46</th>
      <td>Regresión KNN</td>
      <td>21</td>
      <td>12</td>
      <td>22.527035</td>
      <td>0.470992</td>
      <td>0.493595</td>
    </tr>
    <tr>
      <th>47</th>
      <td>Regresión KNN</td>
      <td>28</td>
      <td>12</td>
      <td>14.721496</td>
      <td>0.409959</td>
      <td>0.768162</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataknn</span><span class="p">[</span><span class="n">dataknn</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">13</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>48</th>
      <td>Regresión KNN</td>
      <td>7</td>
      <td>13</td>
      <td>23.297959</td>
      <td>0.471664</td>
      <td>0.818106</td>
    </tr>
    <tr>
      <th>49</th>
      <td>Regresión KNN</td>
      <td>14</td>
      <td>13</td>
      <td>14.250504</td>
      <td>0.495665</td>
      <td>0.611983</td>
    </tr>
    <tr>
      <th>50</th>
      <td>Regresión KNN</td>
      <td>21</td>
      <td>13</td>
      <td>15.066135</td>
      <td>0.485833</td>
      <td>0.827711</td>
    </tr>
    <tr>
      <th>51</th>
      <td>Regresión KNN</td>
      <td>28</td>
      <td>13</td>
      <td>15.232860</td>
      <td>0.428874</td>
      <td>0.775648</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataknn</span><span class="p">[</span><span class="n">dataknn</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">14</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>52</th>
      <td>Regresión KNN</td>
      <td>7</td>
      <td>14</td>
      <td>23.373801</td>
      <td>0.471363</td>
      <td>0.807977</td>
    </tr>
    <tr>
      <th>53</th>
      <td>Regresión KNN</td>
      <td>14</td>
      <td>14</td>
      <td>33.690860</td>
      <td>0.500350</td>
      <td>0.456561</td>
    </tr>
    <tr>
      <th>54</th>
      <td>Regresión KNN</td>
      <td>21</td>
      <td>14</td>
      <td>34.807213</td>
      <td>0.449963</td>
      <td>0.740929</td>
    </tr>
    <tr>
      <th>55</th>
      <td>Regresión KNN</td>
      <td>28</td>
      <td>14</td>
      <td>15.464420</td>
      <td>0.436730</td>
      <td>0.774262</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataknn</span><span class="p">[</span><span class="n">dataknn</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">15</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>56</th>
      <td>Regresión KNN</td>
      <td>7</td>
      <td>15</td>
      <td>24.612642</td>
      <td>0.488040</td>
      <td>0.775284</td>
    </tr>
    <tr>
      <th>57</th>
      <td>Regresión KNN</td>
      <td>14</td>
      <td>15</td>
      <td>33.273127</td>
      <td>0.498748</td>
      <td>0.474298</td>
    </tr>
    <tr>
      <th>58</th>
      <td>Regresión KNN</td>
      <td>21</td>
      <td>15</td>
      <td>30.667001</td>
      <td>0.422749</td>
      <td>0.759011</td>
    </tr>
    <tr>
      <th>59</th>
      <td>Regresión KNN</td>
      <td>28</td>
      <td>15</td>
      <td>16.038779</td>
      <td>0.453505</td>
      <td>0.766656</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataknn</span><span class="p">[</span><span class="n">dataknn</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">16</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>60</th>
      <td>Regresión KNN</td>
      <td>7</td>
      <td>16</td>
      <td>24.262181</td>
      <td>0.486655</td>
      <td>0.783353</td>
    </tr>
    <tr>
      <th>61</th>
      <td>Regresión KNN</td>
      <td>14</td>
      <td>16</td>
      <td>27.991056</td>
      <td>0.527194</td>
      <td>0.569918</td>
    </tr>
    <tr>
      <th>62</th>
      <td>Regresión KNN</td>
      <td>21</td>
      <td>16</td>
      <td>30.681882</td>
      <td>0.422847</td>
      <td>0.760664</td>
    </tr>
    <tr>
      <th>63</th>
      <td>Regresión KNN</td>
      <td>28</td>
      <td>16</td>
      <td>15.862533</td>
      <td>0.451959</td>
      <td>0.768313</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataknn</span><span class="p">[</span><span class="n">dataknn</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">17</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>64</th>
      <td>Regresión KNN</td>
      <td>7</td>
      <td>17</td>
      <td>21.952469</td>
      <td>0.482269</td>
      <td>0.696128</td>
    </tr>
    <tr>
      <th>65</th>
      <td>Regresión KNN</td>
      <td>14</td>
      <td>17</td>
      <td>17.613207</td>
      <td>0.482200</td>
      <td>0.487958</td>
    </tr>
    <tr>
      <th>66</th>
      <td>Regresión KNN</td>
      <td>21</td>
      <td>17</td>
      <td>30.968657</td>
      <td>0.424087</td>
      <td>0.756954</td>
    </tr>
    <tr>
      <th>67</th>
      <td>Regresión KNN</td>
      <td>28</td>
      <td>17</td>
      <td>16.319961</td>
      <td>0.480122</td>
      <td>0.734253</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataknn</span><span class="p">[</span><span class="n">dataknn</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">18</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>68</th>
      <td>Regresión KNN</td>
      <td>7</td>
      <td>18</td>
      <td>21.994223</td>
      <td>0.483356</td>
      <td>0.694756</td>
    </tr>
    <tr>
      <th>69</th>
      <td>Regresión KNN</td>
      <td>14</td>
      <td>18</td>
      <td>17.780728</td>
      <td>0.482200</td>
      <td>0.325496</td>
    </tr>
    <tr>
      <th>70</th>
      <td>Regresión KNN</td>
      <td>21</td>
      <td>18</td>
      <td>26.936514</td>
      <td>0.442418</td>
      <td>0.658935</td>
    </tr>
    <tr>
      <th>71</th>
      <td>Regresión KNN</td>
      <td>28</td>
      <td>18</td>
      <td>27.490370</td>
      <td>0.465976</td>
      <td>0.621646</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataknn</span><span class="p">[</span><span class="n">dataknn</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">19</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>72</th>
      <td>Regresión KNN</td>
      <td>7</td>
      <td>19</td>
      <td>12.263832</td>
      <td>0.505849</td>
      <td>0.558980</td>
    </tr>
    <tr>
      <th>73</th>
      <td>Regresión KNN</td>
      <td>14</td>
      <td>19</td>
      <td>31.850106</td>
      <td>0.472229</td>
      <td>0.618248</td>
    </tr>
    <tr>
      <th>74</th>
      <td>Regresión KNN</td>
      <td>21</td>
      <td>19</td>
      <td>25.879966</td>
      <td>0.417712</td>
      <td>0.701304</td>
    </tr>
    <tr>
      <th>75</th>
      <td>Regresión KNN</td>
      <td>28</td>
      <td>19</td>
      <td>18.708807</td>
      <td>0.449592</td>
      <td>0.797582</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataknn</span><span class="p">[</span><span class="n">dataknn</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">20</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>76</th>
      <td>Regresión KNN</td>
      <td>7</td>
      <td>20</td>
      <td>11.985471</td>
      <td>0.502278</td>
      <td>0.573004</td>
    </tr>
    <tr>
      <th>77</th>
      <td>Regresión KNN</td>
      <td>14</td>
      <td>20</td>
      <td>32.619337</td>
      <td>0.492138</td>
      <td>0.585380</td>
    </tr>
    <tr>
      <th>78</th>
      <td>Regresión KNN</td>
      <td>21</td>
      <td>20</td>
      <td>26.585095</td>
      <td>0.438064</td>
      <td>0.671488</td>
    </tr>
    <tr>
      <th>79</th>
      <td>Regresión KNN</td>
      <td>28</td>
      <td>20</td>
      <td>26.949314</td>
      <td>0.462133</td>
      <td>0.634397</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataknn</span><span class="p">[</span><span class="n">dataknn</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">21</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>80</th>
      <td>Regresión KNN</td>
      <td>7</td>
      <td>21</td>
      <td>77.864972</td>
      <td>0.478278</td>
      <td>0.704514</td>
    </tr>
    <tr>
      <th>81</th>
      <td>Regresión KNN</td>
      <td>14</td>
      <td>21</td>
      <td>33.275902</td>
      <td>0.493896</td>
      <td>0.594840</td>
    </tr>
    <tr>
      <th>82</th>
      <td>Regresión KNN</td>
      <td>21</td>
      <td>21</td>
      <td>27.670953</td>
      <td>0.443715</td>
      <td>0.672987</td>
    </tr>
    <tr>
      <th>83</th>
      <td>Regresión KNN</td>
      <td>28</td>
      <td>21</td>
      <td>27.858404</td>
      <td>0.467582</td>
      <td>0.636862</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataknn</span><span class="p">[</span><span class="n">dataknn</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">22</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>84</th>
      <td>Regresión KNN</td>
      <td>7</td>
      <td>22</td>
      <td>11.386265</td>
      <td>0.482459</td>
      <td>0.596346</td>
    </tr>
    <tr>
      <th>85</th>
      <td>Regresión KNN</td>
      <td>14</td>
      <td>22</td>
      <td>32.937667</td>
      <td>0.482424</td>
      <td>0.630093</td>
    </tr>
    <tr>
      <th>86</th>
      <td>Regresión KNN</td>
      <td>21</td>
      <td>22</td>
      <td>26.680757</td>
      <td>0.430116</td>
      <td>0.705960</td>
    </tr>
    <tr>
      <th>87</th>
      <td>Regresión KNN</td>
      <td>28</td>
      <td>22</td>
      <td>27.456444</td>
      <td>0.463843</td>
      <td>0.658040</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataknn</span><span class="p">[</span><span class="n">dataknn</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">23</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>88</th>
      <td>Regresión KNN</td>
      <td>7</td>
      <td>23</td>
      <td>18.410448</td>
      <td>0.491410</td>
      <td>0.592242</td>
    </tr>
    <tr>
      <th>89</th>
      <td>Regresión KNN</td>
      <td>14</td>
      <td>23</td>
      <td>33.047621</td>
      <td>0.500733</td>
      <td>0.619611</td>
    </tr>
    <tr>
      <th>90</th>
      <td>Regresión KNN</td>
      <td>21</td>
      <td>23</td>
      <td>27.311544</td>
      <td>0.456435</td>
      <td>0.683936</td>
    </tr>
    <tr>
      <th>91</th>
      <td>Regresión KNN</td>
      <td>28</td>
      <td>23</td>
      <td>27.747725</td>
      <td>0.475605</td>
      <td>0.656830</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataknn</span><span class="p">[</span><span class="n">dataknn</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">24</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>92</th>
      <td>Regresión KNN</td>
      <td>7</td>
      <td>24</td>
      <td>19.703851</td>
      <td>0.449815</td>
      <td>0.685687</td>
    </tr>
    <tr>
      <th>93</th>
      <td>Regresión KNN</td>
      <td>14</td>
      <td>24</td>
      <td>26.359522</td>
      <td>0.524627</td>
      <td>0.740940</td>
    </tr>
    <tr>
      <th>94</th>
      <td>Regresión KNN</td>
      <td>21</td>
      <td>24</td>
      <td>15.496085</td>
      <td>0.469982</td>
      <td>0.587013</td>
    </tr>
    <tr>
      <th>95</th>
      <td>Regresión KNN</td>
      <td>28</td>
      <td>24</td>
      <td>23.946251</td>
      <td>0.476760</td>
      <td>0.786057</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<section id="mejor-modelo-cada-hora">
<h4><strong>MEJOR MODELO - CADA HORA</strong><a class="headerlink" href="#mejor-modelo-cada-hora" title="Link to this heading">#</a></h4>
<p>A continuación, mostramos los mejores modelos de cada hora según los 24 modelos.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mejorknnhora</span> <span class="o">=</span> <span class="n">mejormodelohora</span><span class="p">(</span><span class="n">particiones</span><span class="p">,</span> <span class="n">dataknn</span><span class="p">)</span>
<span class="n">mejorknnhora</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>Regresión KNN</td>
      <td>21</td>
      <td>1</td>
      <td>22.281085</td>
      <td>0.427025</td>
      <td>0.604244</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Regresión KNN</td>
      <td>28</td>
      <td>2</td>
      <td>9.585378</td>
      <td>0.399166</td>
      <td>0.803793</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Regresión KNN</td>
      <td>28</td>
      <td>3</td>
      <td>9.850530</td>
      <td>0.403753</td>
      <td>0.749500</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Regresión KNN</td>
      <td>21</td>
      <td>4</td>
      <td>19.526820</td>
      <td>0.413199</td>
      <td>0.854273</td>
    </tr>
    <tr>
      <th>18</th>
      <td>Regresión KNN</td>
      <td>21</td>
      <td>5</td>
      <td>18.262616</td>
      <td>0.402906</td>
      <td>0.854985</td>
    </tr>
    <tr>
      <th>22</th>
      <td>Regresión KNN</td>
      <td>21</td>
      <td>6</td>
      <td>17.270552</td>
      <td>0.394483</td>
      <td>0.858206</td>
    </tr>
    <tr>
      <th>26</th>
      <td>Regresión KNN</td>
      <td>21</td>
      <td>7</td>
      <td>15.673330</td>
      <td>0.385962</td>
      <td>0.857199</td>
    </tr>
    <tr>
      <th>31</th>
      <td>Regresión KNN</td>
      <td>28</td>
      <td>8</td>
      <td>13.931040</td>
      <td>0.372805</td>
      <td>0.846283</td>
    </tr>
    <tr>
      <th>35</th>
      <td>Regresión KNN</td>
      <td>28</td>
      <td>9</td>
      <td>14.543433</td>
      <td>0.393510</td>
      <td>0.794901</td>
    </tr>
    <tr>
      <th>39</th>
      <td>Regresión KNN</td>
      <td>28</td>
      <td>10</td>
      <td>14.403880</td>
      <td>0.390790</td>
      <td>0.778471</td>
    </tr>
    <tr>
      <th>43</th>
      <td>Regresión KNN</td>
      <td>28</td>
      <td>11</td>
      <td>14.591160</td>
      <td>0.404866</td>
      <td>0.774033</td>
    </tr>
    <tr>
      <th>47</th>
      <td>Regresión KNN</td>
      <td>28</td>
      <td>12</td>
      <td>14.721496</td>
      <td>0.409959</td>
      <td>0.768162</td>
    </tr>
    <tr>
      <th>51</th>
      <td>Regresión KNN</td>
      <td>28</td>
      <td>13</td>
      <td>15.232860</td>
      <td>0.428874</td>
      <td>0.775648</td>
    </tr>
    <tr>
      <th>55</th>
      <td>Regresión KNN</td>
      <td>28</td>
      <td>14</td>
      <td>15.464420</td>
      <td>0.436730</td>
      <td>0.774262</td>
    </tr>
    <tr>
      <th>58</th>
      <td>Regresión KNN</td>
      <td>21</td>
      <td>15</td>
      <td>30.667001</td>
      <td>0.422749</td>
      <td>0.759011</td>
    </tr>
    <tr>
      <th>62</th>
      <td>Regresión KNN</td>
      <td>21</td>
      <td>16</td>
      <td>30.681882</td>
      <td>0.422847</td>
      <td>0.760664</td>
    </tr>
    <tr>
      <th>66</th>
      <td>Regresión KNN</td>
      <td>21</td>
      <td>17</td>
      <td>30.968657</td>
      <td>0.424087</td>
      <td>0.756954</td>
    </tr>
    <tr>
      <th>70</th>
      <td>Regresión KNN</td>
      <td>21</td>
      <td>18</td>
      <td>26.936514</td>
      <td>0.442418</td>
      <td>0.658935</td>
    </tr>
    <tr>
      <th>74</th>
      <td>Regresión KNN</td>
      <td>21</td>
      <td>19</td>
      <td>25.879966</td>
      <td>0.417712</td>
      <td>0.701304</td>
    </tr>
    <tr>
      <th>78</th>
      <td>Regresión KNN</td>
      <td>21</td>
      <td>20</td>
      <td>26.585095</td>
      <td>0.438064</td>
      <td>0.671488</td>
    </tr>
    <tr>
      <th>82</th>
      <td>Regresión KNN</td>
      <td>21</td>
      <td>21</td>
      <td>27.670953</td>
      <td>0.443715</td>
      <td>0.672987</td>
    </tr>
    <tr>
      <th>86</th>
      <td>Regresión KNN</td>
      <td>21</td>
      <td>22</td>
      <td>26.680757</td>
      <td>0.430116</td>
      <td>0.705960</td>
    </tr>
    <tr>
      <th>90</th>
      <td>Regresión KNN</td>
      <td>21</td>
      <td>23</td>
      <td>27.311544</td>
      <td>0.456435</td>
      <td>0.683936</td>
    </tr>
    <tr>
      <th>92</th>
      <td>Regresión KNN</td>
      <td>7</td>
      <td>24</td>
      <td>19.703851</td>
      <td>0.449815</td>
      <td>0.685687</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="hora-y-ventana-con-mejor-modelo-knn">
<h4><strong>HORA Y VENTANA CON MEJOR MODELO KNN</strong><a class="headerlink" href="#hora-y-ventana-con-mejor-modelo-knn" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bestknn</span> <span class="o">=</span> <span class="n">mejormodelotot</span><span class="p">(</span><span class="n">mejorknnhora</span><span class="p">)</span>
<span class="n">bestknn</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>31</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Modelo</th>
      <td>Regresión KNN</td>
    </tr>
    <tr>
      <th>Dias</th>
      <td>28</td>
    </tr>
    <tr>
      <th>Hora</th>
      <td>8</td>
    </tr>
    <tr>
      <th>MAPE</th>
      <td>13.93104</td>
    </tr>
    <tr>
      <th>RMSE</th>
      <td>0.372805</td>
    </tr>
    <tr>
      <th>R^2</th>
      <td>0.846283</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Es decir, para la <strong>Regresión KNN</strong>, el mejor modelo se da cuando se  evalúa con el pliegue con el que se trabaja con la <strong>HORA</strong>: <code class="docutils literal notranslate"><span class="pre">8</span></code> en la venta de predicción de <code class="docutils literal notranslate"><span class="pre">28</span> <span class="pre">días</span></code>. Veamos los valores de <strong>Ljung-Box p-value</strong> y <strong>Jarque-Bera p-value</strong>. Antes de ello, veamos cuáles son las pruebas de hipótesis para comprender mejor los p-valores que se nos arrojen.</p>
<ul class="simple">
<li><p><strong>Prueba de Ljung-Box</strong></p></li>
</ul>
<ul class="simple">
<li><p><strong>Hipótesis nula (H₀)</strong>: No hay autocorrelación en los residuos (es decir, los residuos son independientes entre sí).</p></li>
<li><p><strong>Hipótesis alternativa (H₁)</strong>: Hay autocorrelación en los residuos</p></li>
</ul>
<ul class="simple">
<li><p><strong>Prueba de Jarque-Bera</strong></p></li>
</ul>
<ul class="simple">
<li><p><strong>Hipótesis nula (H₀)</strong>: Los residuos tienen una distribución normal.</p></li>
<li><p><strong>Hipótesis alternativa (H₁)</strong>: Los residuos no tienen una distribución normal.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">modeloknn</span> <span class="o">=</span> <span class="n">KNeighborsRegressor</span><span class="p">()</span>
<span class="n">metricas</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">dias</span> <span class="o">=</span> <span class="mi">28</span>
<span class="n">hora</span> <span class="o">=</span> <span class="mi">8</span>
<span class="n">iniciotrain</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">while</span> <span class="p">(</span><span class="n">iniciotrain</span> <span class="o">+</span> <span class="p">(</span><span class="n">dias</span> <span class="o">*</span> <span class="mi">24</span><span class="p">)</span> <span class="o">+</span> <span class="n">hora</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">):</span>     
    <span class="n">fintrain</span> <span class="o">=</span> <span class="n">iniciotrain</span> <span class="o">+</span> <span class="p">(</span><span class="n">dias</span> <span class="o">*</span> <span class="mi">24</span><span class="p">)</span>   
    <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">plieguess</span><span class="p">(</span><span class="n">iniciotrain</span><span class="p">,</span> <span class="n">fintrain</span><span class="p">,</span> <span class="n">hora</span><span class="p">)</span> 
    <span class="n">modeloknn</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
    <span class="n">y_prediccion</span><span class="o">=</span> <span class="n">modeloknn</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>      
    <span class="n">rmse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">,</span> <span class="n">squared</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">mape</span> <span class="o">=</span> <span class="n">MAPE</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">)</span>
    <span class="n">r2</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">)</span>
    <span class="n">ljungbox</span><span class="p">,</span> <span class="n">jarquebera</span> <span class="o">=</span> <span class="n">residuos</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">)</span>  
    <span class="n">metricas</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
        <span class="s1">&#39;Modelo&#39;</span><span class="p">:</span> <span class="s1">&#39;Regresión KNN&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Dias&#39;</span><span class="p">:</span> <span class="n">dias</span><span class="p">,</span>
        <span class="s1">&#39;Hora&#39;</span><span class="p">:</span> <span class="n">hora</span><span class="p">,</span>
        <span class="s1">&#39;MAPE&#39;</span><span class="p">:</span> <span class="n">mape</span><span class="p">,</span>
        <span class="s1">&#39;RMSE&#39;</span><span class="p">:</span> <span class="n">rmse</span><span class="p">,</span>
        <span class="s1">&#39;R^2&#39;</span><span class="p">:</span> <span class="n">r2</span><span class="p">,</span>
        <span class="s1">&#39;Ljung-Box p-value&#39;</span> <span class="p">:</span> <span class="n">ljungbox</span><span class="p">,</span>
        <span class="s1">&#39;Jarque-Bera p-value&#39;</span> <span class="p">:</span> <span class="n">jarquebera</span>
    <span class="p">})</span>  
    <span class="n">iniciotrain</span> <span class="o">=</span> <span class="n">fintrain</span>  <span class="c1"># Actualizar el inicio para el siguiente pliegue</span>
<span class="n">dataknn</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">metricas</span><span class="p">)</span>
<span class="n">dataknn</span> <span class="o">=</span> <span class="n">dataknn</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dataknn</span><span class="p">[</span><span class="s1">&#39;RMSE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">idxmin</span><span class="p">()]</span>
<span class="n">dataknn</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">dataknn</span><span class="p">)</span>
<span class="n">dataknn</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Modelo</th>
      <td>Regresión KNN</td>
    </tr>
    <tr>
      <th>Dias</th>
      <td>28</td>
    </tr>
    <tr>
      <th>Hora</th>
      <td>8</td>
    </tr>
    <tr>
      <th>MAPE</th>
      <td>13.93104</td>
    </tr>
    <tr>
      <th>RMSE</th>
      <td>0.372805</td>
    </tr>
    <tr>
      <th>R^2</th>
      <td>0.846283</td>
    </tr>
    <tr>
      <th>Ljung-Box p-value</th>
      <td>0.066421</td>
    </tr>
    <tr>
      <th>Jarque-Bera p-value</th>
      <td>0.533864</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>En este sentido, sobre el modelo de regresión KNN, podemos afirmar que el mejor modelo identificado tiene un <strong>MAPE</strong> de <code class="docutils literal notranslate"><span class="pre">13.93%</span></code>, lo que indica que, en promedio, las predicciones presentan una desviación porcentual consistente con respecto a los valores reales. El <strong>RMSE</strong>  es de <code class="docutils literal notranslate"><span class="pre">0.37</span></code>, lo que indica que el error promedio en las predicciones es relativamente bajo, por lo tanto, es correcto pensar que el modelo hace un buen trabajo prediciendo los valores. Por otro lado, el coeficiente de determinación <strong>R²</strong> es de <code class="docutils literal notranslate"><span class="pre">0.84</span></code>, lo que indica que el modelo explica aproximadamente el <code class="docutils literal notranslate"><span class="pre">84.6%</span></code> de la variabilidad de los datos, lo cual es un buen rendimiento en términos de ajuste del modelo.</p>
<p>Ahora, hablando sobre las pruebas hipótesis para los supuestos de los residuos, observamos que el p-valor de la prueba de <strong>Ljung-Box</strong> es <code class="docutils literal notranslate"><span class="pre">0.06</span></code>, esto quiere decir no se puede rechazar la hipótesis nula y, por lo tanto, los residuos son independientes entre sí. En particular, esto era lo que se esperaba pues eso quiere decir que todo fue correctamente modelado. Asimismo, el p-valor de la prueba de <strong>Jarque-Bera</strong> es <code class="docutils literal notranslate"><span class="pre">0.53</span></code>, lo que indica que no se puede rechazar la hipótesis de que los residuos siguen una distribución normal.</p>
</section>
</section>
<section id="modelo-regresion-lineal">
<h3><strong>MODELO REGRESIÓN LINEAL</strong><a class="headerlink" href="#modelo-regresion-lineal" title="Link to this heading">#</a></h3>
<p>Primeramente se entrena el modelo y predice. Se imprimen las tablas que contienen las métricas predeterminadas para cada una de las 24 horas.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">modeloreglin</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span>
<span class="n">metricas</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">hora</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">25</span><span class="p">):</span>  
    <span class="k">for</span> <span class="n">dias</span> <span class="ow">in</span> <span class="n">particiones</span><span class="p">:</span>        
        <span class="n">iniciotrain</span> <span class="o">=</span> <span class="mi">0</span>       
        <span class="k">while</span> <span class="p">(</span><span class="n">iniciotrain</span> <span class="o">+</span> <span class="p">(</span><span class="n">dias</span> <span class="o">*</span> <span class="mi">24</span><span class="p">)</span> <span class="o">+</span> <span class="n">hora</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">):</span>     
            <span class="n">fintrain</span> <span class="o">=</span> <span class="n">iniciotrain</span> <span class="o">+</span> <span class="p">(</span><span class="n">dias</span> <span class="o">*</span> <span class="mi">24</span><span class="p">)</span>           
            <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">plieguess</span><span class="p">(</span><span class="n">iniciotrain</span><span class="p">,</span><span class="n">fintrain</span><span class="p">,</span><span class="n">hora</span><span class="p">)</span>           
            <span class="n">modeloreglin</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
            <span class="n">y_prediccion</span><span class="o">=</span> <span class="n">modeloreglin</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>               
            <span class="n">rmse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">,</span> <span class="n">squared</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="n">mape</span> <span class="o">=</span> <span class="n">MAPE</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">)</span>
            <span class="n">r2</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">)</span>           
            <span class="n">metricas</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
                <span class="s1">&#39;Modelo&#39;</span><span class="p">:</span> <span class="s1">&#39;Regresión Lineal&#39;</span><span class="p">,</span>
                <span class="s1">&#39;Dias&#39;</span><span class="p">:</span> <span class="n">dias</span><span class="p">,</span>
                <span class="s1">&#39;Hora&#39;</span><span class="p">:</span> <span class="n">hora</span><span class="p">,</span>
                <span class="s1">&#39;MAPE&#39;</span><span class="p">:</span> <span class="n">mape</span><span class="p">,</span>
                <span class="s1">&#39;RMSE&#39;</span><span class="p">:</span> <span class="n">rmse</span><span class="p">,</span>
                <span class="s1">&#39;R^2&#39;</span><span class="p">:</span> <span class="n">r2</span><span class="p">,</span>
            <span class="p">})</span>           
            <span class="n">iniciotrain</span> <span class="o">=</span> <span class="n">fintrain</span>  
<span class="n">datareglin</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">metricas</span><span class="p">)</span>
<span class="n">datareglin</span> <span class="o">=</span> <span class="n">datareglin</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">datareglin</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;Modelo&#39;</span><span class="p">,</span> <span class="s1">&#39;Hora&#39;</span><span class="p">,</span> <span class="s1">&#39;Dias&#39;</span><span class="p">])[</span><span class="s1">&#39;RMSE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">idxmin</span><span class="p">()]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datareglin</span><span class="p">[</span><span class="n">datareglin</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Regresión Lineal</td>
      <td>7</td>
      <td>1</td>
      <td>9.177472</td>
      <td>0.285068</td>
      <td>0.615951</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Regresión Lineal</td>
      <td>14</td>
      <td>1</td>
      <td>16.747749</td>
      <td>0.328047</td>
      <td>0.913736</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Regresión Lineal</td>
      <td>21</td>
      <td>1</td>
      <td>10.534278</td>
      <td>0.317068</td>
      <td>0.892954</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Regresión Lineal</td>
      <td>28</td>
      <td>1</td>
      <td>10.916160</td>
      <td>0.320143</td>
      <td>0.890868</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datareglin</span><span class="p">[</span><span class="n">datareglin</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>4</th>
      <td>Regresión Lineal</td>
      <td>7</td>
      <td>2</td>
      <td>32.849314</td>
      <td>0.294249</td>
      <td>0.852346</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Regresión Lineal</td>
      <td>14</td>
      <td>2</td>
      <td>17.518588</td>
      <td>0.343691</td>
      <td>0.506927</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Regresión Lineal</td>
      <td>21</td>
      <td>2</td>
      <td>21.192928</td>
      <td>0.326620</td>
      <td>0.923659</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Regresión Lineal</td>
      <td>28</td>
      <td>2</td>
      <td>11.537774</td>
      <td>0.335730</td>
      <td>0.864333</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datareglin</span><span class="p">[</span><span class="n">datareglin</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">3</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>8</th>
      <td>Regresión Lineal</td>
      <td>7</td>
      <td>3</td>
      <td>33.443455</td>
      <td>0.311646</td>
      <td>0.842928</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Regresión Lineal</td>
      <td>14</td>
      <td>3</td>
      <td>10.559622</td>
      <td>0.330688</td>
      <td>0.863579</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Regresión Lineal</td>
      <td>21</td>
      <td>3</td>
      <td>10.370165</td>
      <td>0.317110</td>
      <td>0.874552</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Regresión Lineal</td>
      <td>28</td>
      <td>3</td>
      <td>10.637060</td>
      <td>0.322033</td>
      <td>0.870627</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datareglin</span><span class="p">[</span><span class="n">datareglin</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">4</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>12</th>
      <td>Regresión Lineal</td>
      <td>7</td>
      <td>4</td>
      <td>33.445497</td>
      <td>0.310303</td>
      <td>0.835795</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Regresión Lineal</td>
      <td>14</td>
      <td>4</td>
      <td>10.414414</td>
      <td>0.330499</td>
      <td>0.852527</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Regresión Lineal</td>
      <td>21</td>
      <td>4</td>
      <td>10.557081</td>
      <td>0.287760</td>
      <td>0.929322</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Regresión Lineal</td>
      <td>28</td>
      <td>4</td>
      <td>10.774141</td>
      <td>0.323534</td>
      <td>0.858678</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datareglin</span><span class="p">[</span><span class="n">datareglin</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">5</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>16</th>
      <td>Regresión Lineal</td>
      <td>7</td>
      <td>5</td>
      <td>13.549728</td>
      <td>0.327209</td>
      <td>0.880260</td>
    </tr>
    <tr>
      <th>17</th>
      <td>Regresión Lineal</td>
      <td>14</td>
      <td>5</td>
      <td>10.423193</td>
      <td>0.330925</td>
      <td>0.845664</td>
    </tr>
    <tr>
      <th>18</th>
      <td>Regresión Lineal</td>
      <td>21</td>
      <td>5</td>
      <td>10.004757</td>
      <td>0.285625</td>
      <td>0.927122</td>
    </tr>
    <tr>
      <th>19</th>
      <td>Regresión Lineal</td>
      <td>28</td>
      <td>5</td>
      <td>10.765978</td>
      <td>0.323538</td>
      <td>0.852478</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datareglin</span><span class="p">[</span><span class="n">datareglin</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">6</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>20</th>
      <td>Regresión Lineal</td>
      <td>7</td>
      <td>6</td>
      <td>8.848311</td>
      <td>0.336981</td>
      <td>0.849481</td>
    </tr>
    <tr>
      <th>21</th>
      <td>Regresión Lineal</td>
      <td>14</td>
      <td>6</td>
      <td>10.239251</td>
      <td>0.330619</td>
      <td>0.825295</td>
    </tr>
    <tr>
      <th>22</th>
      <td>Regresión Lineal</td>
      <td>21</td>
      <td>6</td>
      <td>10.164552</td>
      <td>0.288461</td>
      <td>0.924181</td>
    </tr>
    <tr>
      <th>23</th>
      <td>Regresión Lineal</td>
      <td>28</td>
      <td>6</td>
      <td>10.396090</td>
      <td>0.322318</td>
      <td>0.833958</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datareglin</span><span class="p">[</span><span class="n">datareglin</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">7</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>24</th>
      <td>Regresión Lineal</td>
      <td>7</td>
      <td>7</td>
      <td>8.804746</td>
      <td>0.336554</td>
      <td>0.849862</td>
    </tr>
    <tr>
      <th>25</th>
      <td>Regresión Lineal</td>
      <td>14</td>
      <td>7</td>
      <td>9.304360</td>
      <td>0.324804</td>
      <td>0.793134</td>
    </tr>
    <tr>
      <th>26</th>
      <td>Regresión Lineal</td>
      <td>21</td>
      <td>7</td>
      <td>9.723630</td>
      <td>0.287557</td>
      <td>0.920734</td>
    </tr>
    <tr>
      <th>27</th>
      <td>Regresión Lineal</td>
      <td>28</td>
      <td>7</td>
      <td>9.033072</td>
      <td>0.309908</td>
      <td>0.811674</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datareglin</span><span class="p">[</span><span class="n">datareglin</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">8</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>28</th>
      <td>Regresión Lineal</td>
      <td>7</td>
      <td>8</td>
      <td>9.588294</td>
      <td>0.325104</td>
      <td>0.923284</td>
    </tr>
    <tr>
      <th>29</th>
      <td>Regresión Lineal</td>
      <td>14</td>
      <td>8</td>
      <td>8.573194</td>
      <td>0.305199</td>
      <td>0.932390</td>
    </tr>
    <tr>
      <th>30</th>
      <td>Regresión Lineal</td>
      <td>21</td>
      <td>8</td>
      <td>9.452245</td>
      <td>0.290390</td>
      <td>0.931577</td>
    </tr>
    <tr>
      <th>31</th>
      <td>Regresión Lineal</td>
      <td>28</td>
      <td>8</td>
      <td>9.153729</td>
      <td>0.312764</td>
      <td>0.764512</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datareglin</span><span class="p">[</span><span class="n">datareglin</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">9</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>32</th>
      <td>Regresión Lineal</td>
      <td>7</td>
      <td>9</td>
      <td>9.913272</td>
      <td>0.329544</td>
      <td>0.918444</td>
    </tr>
    <tr>
      <th>33</th>
      <td>Regresión Lineal</td>
      <td>14</td>
      <td>9</td>
      <td>8.911726</td>
      <td>0.310895</td>
      <td>0.927414</td>
    </tr>
    <tr>
      <th>34</th>
      <td>Regresión Lineal</td>
      <td>21</td>
      <td>9</td>
      <td>8.549514</td>
      <td>0.305685</td>
      <td>0.761759</td>
    </tr>
    <tr>
      <th>35</th>
      <td>Regresión Lineal</td>
      <td>28</td>
      <td>9</td>
      <td>8.628066</td>
      <td>0.307355</td>
      <td>0.759148</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datareglin</span><span class="p">[</span><span class="n">datareglin</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">10</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>36</th>
      <td>Regresión Lineal</td>
      <td>7</td>
      <td>10</td>
      <td>9.439085</td>
      <td>0.320507</td>
      <td>0.922856</td>
    </tr>
    <tr>
      <th>37</th>
      <td>Regresión Lineal</td>
      <td>14</td>
      <td>10</td>
      <td>8.292432</td>
      <td>0.304664</td>
      <td>0.930294</td>
    </tr>
    <tr>
      <th>38</th>
      <td>Regresión Lineal</td>
      <td>21</td>
      <td>10</td>
      <td>7.861649</td>
      <td>0.297512</td>
      <td>0.727826</td>
    </tr>
    <tr>
      <th>39</th>
      <td>Regresión Lineal</td>
      <td>28</td>
      <td>10</td>
      <td>7.860082</td>
      <td>0.297620</td>
      <td>0.727629</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datareglin</span><span class="p">[</span><span class="n">datareglin</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">11</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>40</th>
      <td>Regresión Lineal</td>
      <td>7</td>
      <td>11</td>
      <td>9.268959</td>
      <td>0.319531</td>
      <td>0.925632</td>
    </tr>
    <tr>
      <th>41</th>
      <td>Regresión Lineal</td>
      <td>14</td>
      <td>11</td>
      <td>9.224217</td>
      <td>0.307089</td>
      <td>0.931310</td>
    </tr>
    <tr>
      <th>42</th>
      <td>Regresión Lineal</td>
      <td>21</td>
      <td>11</td>
      <td>8.569853</td>
      <td>0.327686</td>
      <td>0.627568</td>
    </tr>
    <tr>
      <th>43</th>
      <td>Regresión Lineal</td>
      <td>28</td>
      <td>11</td>
      <td>8.543874</td>
      <td>0.327726</td>
      <td>0.627476</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datareglin</span><span class="p">[</span><span class="n">datareglin</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">12</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>44</th>
      <td>Regresión Lineal</td>
      <td>7</td>
      <td>12</td>
      <td>8.918326</td>
      <td>0.328114</td>
      <td>0.826570</td>
    </tr>
    <tr>
      <th>45</th>
      <td>Regresión Lineal</td>
      <td>14</td>
      <td>12</td>
      <td>9.568458</td>
      <td>0.311085</td>
      <td>0.927597</td>
    </tr>
    <tr>
      <th>46</th>
      <td>Regresión Lineal</td>
      <td>21</td>
      <td>12</td>
      <td>9.327503</td>
      <td>0.339157</td>
      <td>0.667123</td>
    </tr>
    <tr>
      <th>47</th>
      <td>Regresión Lineal</td>
      <td>28</td>
      <td>12</td>
      <td>9.312118</td>
      <td>0.339457</td>
      <td>0.666535</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datareglin</span><span class="p">[</span><span class="n">datareglin</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">13</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>48</th>
      <td>Regresión Lineal</td>
      <td>7</td>
      <td>13</td>
      <td>9.382491</td>
      <td>0.324169</td>
      <td>0.912348</td>
    </tr>
    <tr>
      <th>49</th>
      <td>Regresión Lineal</td>
      <td>14</td>
      <td>13</td>
      <td>10.689670</td>
      <td>0.330093</td>
      <td>0.912710</td>
    </tr>
    <tr>
      <th>50</th>
      <td>Regresión Lineal</td>
      <td>21</td>
      <td>13</td>
      <td>10.990716</td>
      <td>0.330334</td>
      <td>0.836930</td>
    </tr>
    <tr>
      <th>51</th>
      <td>Regresión Lineal</td>
      <td>28</td>
      <td>13</td>
      <td>10.400529</td>
      <td>0.348362</td>
      <td>0.735132</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datareglin</span><span class="p">[</span><span class="n">datareglin</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">14</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>52</th>
      <td>Regresión Lineal</td>
      <td>7</td>
      <td>14</td>
      <td>9.681186</td>
      <td>0.331589</td>
      <td>0.897773</td>
    </tr>
    <tr>
      <th>53</th>
      <td>Regresión Lineal</td>
      <td>14</td>
      <td>14</td>
      <td>11.367153</td>
      <td>0.335554</td>
      <td>0.874767</td>
    </tr>
    <tr>
      <th>54</th>
      <td>Regresión Lineal</td>
      <td>21</td>
      <td>14</td>
      <td>10.839294</td>
      <td>0.328147</td>
      <td>0.880235</td>
    </tr>
    <tr>
      <th>55</th>
      <td>Regresión Lineal</td>
      <td>28</td>
      <td>14</td>
      <td>11.377768</td>
      <td>0.354212</td>
      <td>0.778691</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datareglin</span><span class="p">[</span><span class="n">datareglin</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">15</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>56</th>
      <td>Regresión Lineal</td>
      <td>7</td>
      <td>15</td>
      <td>9.716426</td>
      <td>0.320803</td>
      <td>0.914474</td>
    </tr>
    <tr>
      <th>57</th>
      <td>Regresión Lineal</td>
      <td>14</td>
      <td>15</td>
      <td>10.729919</td>
      <td>0.325164</td>
      <td>0.918944</td>
    </tr>
    <tr>
      <th>58</th>
      <td>Regresión Lineal</td>
      <td>21</td>
      <td>15</td>
      <td>11.026138</td>
      <td>0.332625</td>
      <td>0.884374</td>
    </tr>
    <tr>
      <th>59</th>
      <td>Regresión Lineal</td>
      <td>28</td>
      <td>15</td>
      <td>11.525345</td>
      <td>0.352318</td>
      <td>0.904841</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datareglin</span><span class="p">[</span><span class="n">datareglin</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">16</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>60</th>
      <td>Regresión Lineal</td>
      <td>7</td>
      <td>16</td>
      <td>9.734261</td>
      <td>0.320850</td>
      <td>0.913853</td>
    </tr>
    <tr>
      <th>61</th>
      <td>Regresión Lineal</td>
      <td>14</td>
      <td>16</td>
      <td>11.400478</td>
      <td>0.298717</td>
      <td>0.820333</td>
    </tr>
    <tr>
      <th>62</th>
      <td>Regresión Lineal</td>
      <td>21</td>
      <td>16</td>
      <td>11.709318</td>
      <td>0.303815</td>
      <td>0.814148</td>
    </tr>
    <tr>
      <th>63</th>
      <td>Regresión Lineal</td>
      <td>28</td>
      <td>16</td>
      <td>11.616939</td>
      <td>0.351351</td>
      <td>0.909002</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datareglin</span><span class="p">[</span><span class="n">datareglin</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">17</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>64</th>
      <td>Regresión Lineal</td>
      <td>7</td>
      <td>17</td>
      <td>9.767949</td>
      <td>0.321807</td>
      <td>0.912484</td>
    </tr>
    <tr>
      <th>65</th>
      <td>Regresión Lineal</td>
      <td>14</td>
      <td>17</td>
      <td>11.078443</td>
      <td>0.294690</td>
      <td>0.825242</td>
    </tr>
    <tr>
      <th>66</th>
      <td>Regresión Lineal</td>
      <td>21</td>
      <td>17</td>
      <td>11.501212</td>
      <td>0.301307</td>
      <td>0.817306</td>
    </tr>
    <tr>
      <th>67</th>
      <td>Regresión Lineal</td>
      <td>28</td>
      <td>17</td>
      <td>12.432456</td>
      <td>0.354202</td>
      <td>0.913671</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datareglin</span><span class="p">[</span><span class="n">datareglin</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">18</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>68</th>
      <td>Regresión Lineal</td>
      <td>7</td>
      <td>18</td>
      <td>9.821034</td>
      <td>0.322261</td>
      <td>0.911551</td>
    </tr>
    <tr>
      <th>69</th>
      <td>Regresión Lineal</td>
      <td>14</td>
      <td>18</td>
      <td>11.425107</td>
      <td>0.300634</td>
      <td>0.811023</td>
    </tr>
    <tr>
      <th>70</th>
      <td>Regresión Lineal</td>
      <td>21</td>
      <td>18</td>
      <td>9.746803</td>
      <td>0.294125</td>
      <td>0.922208</td>
    </tr>
    <tr>
      <th>71</th>
      <td>Regresión Lineal</td>
      <td>28</td>
      <td>18</td>
      <td>14.333517</td>
      <td>0.363456</td>
      <td>0.915048</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datareglin</span><span class="p">[</span><span class="n">datareglin</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">19</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>72</th>
      <td>Regresión Lineal</td>
      <td>7</td>
      <td>19</td>
      <td>9.155890</td>
      <td>0.318370</td>
      <td>0.910779</td>
    </tr>
    <tr>
      <th>73</th>
      <td>Regresión Lineal</td>
      <td>14</td>
      <td>19</td>
      <td>11.769794</td>
      <td>0.310477</td>
      <td>0.798818</td>
    </tr>
    <tr>
      <th>74</th>
      <td>Regresión Lineal</td>
      <td>21</td>
      <td>19</td>
      <td>12.203842</td>
      <td>0.318390</td>
      <td>0.788433</td>
    </tr>
    <tr>
      <th>75</th>
      <td>Regresión Lineal</td>
      <td>28</td>
      <td>19</td>
      <td>14.455682</td>
      <td>0.363497</td>
      <td>0.917611</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datareglin</span><span class="p">[</span><span class="n">datareglin</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">20</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>76</th>
      <td>Regresión Lineal</td>
      <td>7</td>
      <td>20</td>
      <td>9.244699</td>
      <td>0.319080</td>
      <td>0.907675</td>
    </tr>
    <tr>
      <th>77</th>
      <td>Regresión Lineal</td>
      <td>14</td>
      <td>20</td>
      <td>12.479213</td>
      <td>0.316882</td>
      <td>0.803850</td>
    </tr>
    <tr>
      <th>78</th>
      <td>Regresión Lineal</td>
      <td>21</td>
      <td>20</td>
      <td>12.823667</td>
      <td>0.322744</td>
      <td>0.796526</td>
    </tr>
    <tr>
      <th>79</th>
      <td>Regresión Lineal</td>
      <td>28</td>
      <td>20</td>
      <td>19.920405</td>
      <td>0.364837</td>
      <td>0.878763</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datareglin</span><span class="p">[</span><span class="n">datareglin</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">21</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>80</th>
      <td>Regresión Lineal</td>
      <td>7</td>
      <td>21</td>
      <td>9.550341</td>
      <td>0.320914</td>
      <td>0.903901</td>
    </tr>
    <tr>
      <th>81</th>
      <td>Regresión Lineal</td>
      <td>14</td>
      <td>21</td>
      <td>13.127729</td>
      <td>0.318740</td>
      <td>0.835023</td>
    </tr>
    <tr>
      <th>82</th>
      <td>Regresión Lineal</td>
      <td>21</td>
      <td>21</td>
      <td>13.461162</td>
      <td>0.324463</td>
      <td>0.829046</td>
    </tr>
    <tr>
      <th>83</th>
      <td>Regresión Lineal</td>
      <td>28</td>
      <td>21</td>
      <td>18.111398</td>
      <td>0.348050</td>
      <td>0.889621</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datareglin</span><span class="p">[</span><span class="n">datareglin</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">22</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>84</th>
      <td>Regresión Lineal</td>
      <td>7</td>
      <td>22</td>
      <td>20.552661</td>
      <td>0.320673</td>
      <td>0.934216</td>
    </tr>
    <tr>
      <th>85</th>
      <td>Regresión Lineal</td>
      <td>14</td>
      <td>22</td>
      <td>12.505027</td>
      <td>0.297012</td>
      <td>0.855119</td>
    </tr>
    <tr>
      <th>86</th>
      <td>Regresión Lineal</td>
      <td>21</td>
      <td>22</td>
      <td>12.826851</td>
      <td>0.299112</td>
      <td>0.853063</td>
    </tr>
    <tr>
      <th>87</th>
      <td>Regresión Lineal</td>
      <td>28</td>
      <td>22</td>
      <td>18.280789</td>
      <td>0.350195</td>
      <td>0.887816</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datareglin</span><span class="p">[</span><span class="n">datareglin</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">23</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>88</th>
      <td>Regresión Lineal</td>
      <td>7</td>
      <td>23</td>
      <td>18.599626</td>
      <td>0.309120</td>
      <td>0.941401</td>
    </tr>
    <tr>
      <th>89</th>
      <td>Regresión Lineal</td>
      <td>14</td>
      <td>23</td>
      <td>12.497507</td>
      <td>0.296824</td>
      <td>0.851230</td>
    </tr>
    <tr>
      <th>90</th>
      <td>Regresión Lineal</td>
      <td>21</td>
      <td>23</td>
      <td>12.673602</td>
      <td>0.297410</td>
      <td>0.850643</td>
    </tr>
    <tr>
      <th>91</th>
      <td>Regresión Lineal</td>
      <td>28</td>
      <td>23</td>
      <td>17.566880</td>
      <td>0.354919</td>
      <td>0.885505</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datareglin</span><span class="p">[</span><span class="n">datareglin</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">24</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>92</th>
      <td>Regresión Lineal</td>
      <td>7</td>
      <td>24</td>
      <td>18.938325</td>
      <td>0.309440</td>
      <td>0.942142</td>
    </tr>
    <tr>
      <th>93</th>
      <td>Regresión Lineal</td>
      <td>14</td>
      <td>24</td>
      <td>13.323152</td>
      <td>0.287042</td>
      <td>0.872007</td>
    </tr>
    <tr>
      <th>94</th>
      <td>Regresión Lineal</td>
      <td>21</td>
      <td>24</td>
      <td>13.383824</td>
      <td>0.284638</td>
      <td>0.874142</td>
    </tr>
    <tr>
      <th>95</th>
      <td>Regresión Lineal</td>
      <td>28</td>
      <td>24</td>
      <td>20.368887</td>
      <td>0.384005</td>
      <td>0.867319</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<section id="id1">
<h4><strong>MEJOR MODELO - CADA HORA</strong><a class="headerlink" href="#id1" title="Link to this heading">#</a></h4>
<p>A continuación, mostramos los mejores modelos de cada hora según los 24 modelos.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mejorreglinhora</span> <span class="o">=</span> <span class="n">mejormodelohora</span><span class="p">(</span><span class="n">particiones</span><span class="p">,</span> <span class="n">datareglin</span><span class="p">)</span>
<span class="n">mejorreglinhora</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Regresión Lineal</td>
      <td>7</td>
      <td>1</td>
      <td>9.177472</td>
      <td>0.285068</td>
      <td>0.615951</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Regresión Lineal</td>
      <td>7</td>
      <td>2</td>
      <td>32.849314</td>
      <td>0.294249</td>
      <td>0.852346</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Regresión Lineal</td>
      <td>7</td>
      <td>3</td>
      <td>33.443455</td>
      <td>0.311646</td>
      <td>0.842928</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Regresión Lineal</td>
      <td>21</td>
      <td>4</td>
      <td>10.557081</td>
      <td>0.287760</td>
      <td>0.929322</td>
    </tr>
    <tr>
      <th>18</th>
      <td>Regresión Lineal</td>
      <td>21</td>
      <td>5</td>
      <td>10.004757</td>
      <td>0.285625</td>
      <td>0.927122</td>
    </tr>
    <tr>
      <th>22</th>
      <td>Regresión Lineal</td>
      <td>21</td>
      <td>6</td>
      <td>10.164552</td>
      <td>0.288461</td>
      <td>0.924181</td>
    </tr>
    <tr>
      <th>26</th>
      <td>Regresión Lineal</td>
      <td>21</td>
      <td>7</td>
      <td>9.723630</td>
      <td>0.287557</td>
      <td>0.920734</td>
    </tr>
    <tr>
      <th>30</th>
      <td>Regresión Lineal</td>
      <td>21</td>
      <td>8</td>
      <td>9.452245</td>
      <td>0.290390</td>
      <td>0.931577</td>
    </tr>
    <tr>
      <th>34</th>
      <td>Regresión Lineal</td>
      <td>21</td>
      <td>9</td>
      <td>8.549514</td>
      <td>0.305685</td>
      <td>0.761759</td>
    </tr>
    <tr>
      <th>38</th>
      <td>Regresión Lineal</td>
      <td>21</td>
      <td>10</td>
      <td>7.861649</td>
      <td>0.297512</td>
      <td>0.727826</td>
    </tr>
    <tr>
      <th>41</th>
      <td>Regresión Lineal</td>
      <td>14</td>
      <td>11</td>
      <td>9.224217</td>
      <td>0.307089</td>
      <td>0.931310</td>
    </tr>
    <tr>
      <th>45</th>
      <td>Regresión Lineal</td>
      <td>14</td>
      <td>12</td>
      <td>9.568458</td>
      <td>0.311085</td>
      <td>0.927597</td>
    </tr>
    <tr>
      <th>48</th>
      <td>Regresión Lineal</td>
      <td>7</td>
      <td>13</td>
      <td>9.382491</td>
      <td>0.324169</td>
      <td>0.912348</td>
    </tr>
    <tr>
      <th>54</th>
      <td>Regresión Lineal</td>
      <td>21</td>
      <td>14</td>
      <td>10.839294</td>
      <td>0.328147</td>
      <td>0.880235</td>
    </tr>
    <tr>
      <th>56</th>
      <td>Regresión Lineal</td>
      <td>7</td>
      <td>15</td>
      <td>9.716426</td>
      <td>0.320803</td>
      <td>0.914474</td>
    </tr>
    <tr>
      <th>61</th>
      <td>Regresión Lineal</td>
      <td>14</td>
      <td>16</td>
      <td>11.400478</td>
      <td>0.298717</td>
      <td>0.820333</td>
    </tr>
    <tr>
      <th>65</th>
      <td>Regresión Lineal</td>
      <td>14</td>
      <td>17</td>
      <td>11.078443</td>
      <td>0.294690</td>
      <td>0.825242</td>
    </tr>
    <tr>
      <th>70</th>
      <td>Regresión Lineal</td>
      <td>21</td>
      <td>18</td>
      <td>9.746803</td>
      <td>0.294125</td>
      <td>0.922208</td>
    </tr>
    <tr>
      <th>73</th>
      <td>Regresión Lineal</td>
      <td>14</td>
      <td>19</td>
      <td>11.769794</td>
      <td>0.310477</td>
      <td>0.798818</td>
    </tr>
    <tr>
      <th>77</th>
      <td>Regresión Lineal</td>
      <td>14</td>
      <td>20</td>
      <td>12.479213</td>
      <td>0.316882</td>
      <td>0.803850</td>
    </tr>
    <tr>
      <th>81</th>
      <td>Regresión Lineal</td>
      <td>14</td>
      <td>21</td>
      <td>13.127729</td>
      <td>0.318740</td>
      <td>0.835023</td>
    </tr>
    <tr>
      <th>85</th>
      <td>Regresión Lineal</td>
      <td>14</td>
      <td>22</td>
      <td>12.505027</td>
      <td>0.297012</td>
      <td>0.855119</td>
    </tr>
    <tr>
      <th>89</th>
      <td>Regresión Lineal</td>
      <td>14</td>
      <td>23</td>
      <td>12.497507</td>
      <td>0.296824</td>
      <td>0.851230</td>
    </tr>
    <tr>
      <th>94</th>
      <td>Regresión Lineal</td>
      <td>21</td>
      <td>24</td>
      <td>13.383824</td>
      <td>0.284638</td>
      <td>0.874142</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="hora-y-ventana-con-mejor-modelo-reg-lineal">
<h4><strong>HORA Y VENTANA CON MEJOR MODELO REG. LINEAL</strong><a class="headerlink" href="#hora-y-ventana-con-mejor-modelo-reg-lineal" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bestreglin</span> <span class="o">=</span> <span class="n">mejormodelotot</span><span class="p">(</span><span class="n">mejorreglinhora</span><span class="p">)</span>
<span class="n">bestreglin</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>94</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Modelo</th>
      <td>Regresión Lineal</td>
    </tr>
    <tr>
      <th>Dias</th>
      <td>21</td>
    </tr>
    <tr>
      <th>Hora</th>
      <td>24</td>
    </tr>
    <tr>
      <th>MAPE</th>
      <td>13.383824</td>
    </tr>
    <tr>
      <th>RMSE</th>
      <td>0.284638</td>
    </tr>
    <tr>
      <th>R^2</th>
      <td>0.874142</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Es decir, para la <strong>Regresión Lineal</strong>, el mejor modelo se da cuando se trabaja con la <strong>HORA</strong>: <code class="docutils literal notranslate"><span class="pre">24</span></code> en la venta de predicción de <code class="docutils literal notranslate"><span class="pre">21</span> <span class="pre">días</span></code>. Veamos los valores de <strong>Ljung-Box p-value</strong> y <strong>Jarque-Bera p-value</strong>. Antes de ello, veamos cuáles son las pruebas de hipótesis para comprender mejor los p-valores que se nos arrojen.</p>
<ul class="simple">
<li><p><strong>Prueba de Ljung-Box</strong></p></li>
</ul>
<ul class="simple">
<li><p><strong>Hipótesis nula (H₀)</strong>: No hay autocorrelación en los residuos (es decir, los residuos son independientes entre sí).</p></li>
<li><p><strong>Hipótesis alternativa (H₁)</strong>: Hay autocorrelación en los residuos</p></li>
</ul>
<ul class="simple">
<li><p><strong>Prueba de Jarque-Bera</strong></p></li>
</ul>
<ul class="simple">
<li><p><strong>Hipótesis nula (H₀)</strong>: Los residuos tienen una distribución normal.</p></li>
<li><p><strong>Hipótesis alternativa (H₁)</strong>: Los residuos no tienen una distribución normal.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">metricas</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">dias</span> <span class="o">=</span> <span class="mi">21</span>
<span class="n">hora</span> <span class="o">=</span> <span class="mi">24</span>
<span class="n">iniciotrain</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">while</span> <span class="p">(</span><span class="n">iniciotrain</span> <span class="o">+</span> <span class="p">(</span><span class="n">dias</span> <span class="o">*</span> <span class="mi">24</span><span class="p">)</span> <span class="o">+</span> <span class="n">hora</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">):</span>    
    <span class="n">fintrain</span> <span class="o">=</span> <span class="n">iniciotrain</span> <span class="o">+</span> <span class="p">(</span><span class="n">dias</span> <span class="o">*</span> <span class="mi">24</span><span class="p">)</span>   
    <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">plieguess</span><span class="p">(</span><span class="n">iniciotrain</span><span class="p">,</span> <span class="n">fintrain</span><span class="p">,</span> <span class="n">hora</span><span class="p">)</span> 
    <span class="n">modeloreglin</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
    <span class="n">y_prediccion</span><span class="o">=</span> <span class="n">modeloreglin</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>      
    <span class="n">rmse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">,</span> <span class="n">squared</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">mape</span> <span class="o">=</span> <span class="n">MAPE</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">)</span>
    <span class="n">r2</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">)</span>
    <span class="n">ljungbox</span><span class="p">,</span> <span class="n">jarquebera</span> <span class="o">=</span> <span class="n">residuos</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">)</span>  
    <span class="n">metricas</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
        <span class="s1">&#39;Modelo&#39;</span><span class="p">:</span> <span class="s1">&#39;Regresión KNN&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Dias&#39;</span><span class="p">:</span> <span class="n">dias</span><span class="p">,</span>
        <span class="s1">&#39;Hora&#39;</span><span class="p">:</span> <span class="n">hora</span><span class="p">,</span>
        <span class="s1">&#39;MAPE&#39;</span><span class="p">:</span> <span class="n">mape</span><span class="p">,</span>
        <span class="s1">&#39;RMSE&#39;</span><span class="p">:</span> <span class="n">rmse</span><span class="p">,</span>
        <span class="s1">&#39;R^2&#39;</span><span class="p">:</span> <span class="n">r2</span><span class="p">,</span>
        <span class="s1">&#39;Ljung-Box p-value&#39;</span> <span class="p">:</span> <span class="n">ljungbox</span><span class="p">,</span>
        <span class="s1">&#39;Jarque-Bera p-value&#39;</span> <span class="p">:</span> <span class="n">jarquebera</span>
    <span class="p">})</span>  
    <span class="n">iniciotrain</span> <span class="o">=</span> <span class="n">fintrain</span>  
<span class="n">datareglin</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">metricas</span><span class="p">)</span>
<span class="n">datareglin</span> <span class="o">=</span> <span class="n">datareglin</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">datareglin</span><span class="p">[</span><span class="s1">&#39;RMSE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">idxmin</span><span class="p">()]</span>
<span class="n">datareglin</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">datareglin</span><span class="p">)</span>
<span class="n">datareglin</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Modelo</th>
      <td>Regresión KNN</td>
    </tr>
    <tr>
      <th>Dias</th>
      <td>21</td>
    </tr>
    <tr>
      <th>Hora</th>
      <td>24</td>
    </tr>
    <tr>
      <th>MAPE</th>
      <td>13.383824</td>
    </tr>
    <tr>
      <th>RMSE</th>
      <td>0.284638</td>
    </tr>
    <tr>
      <th>R^2</th>
      <td>0.874142</td>
    </tr>
    <tr>
      <th>Ljung-Box p-value</th>
      <td>0.368029</td>
    </tr>
    <tr>
      <th>Jarque-Bera p-value</th>
      <td>0.30649</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>En este sentido, sobre el modelo de regresión lineal, podemos afirmar que el mejor modelo identificado tiene un <strong>MAPE</strong> de <code class="docutils literal notranslate"><span class="pre">13.38%</span></code>, lo que indica que, en promedio, las predicciones presentan una desviación porcentual consistente con respecto a los valores reales. El <strong>RMSE</strong> es de <code class="docutils literal notranslate"><span class="pre">0.28</span></code>, lo que indica que el error promedio en las predicciones es relativamente bajo, lo cual sugiere que el modelo hace un buen trabajo prediciendo los valores con precisión. Además, el coeficiente de determinación <strong>R²</strong> es de <code class="docutils literal notranslate"><span class="pre">0.87</span></code>, lo que indica que el modelo explica aproximadamente el <code class="docutils literal notranslate"><span class="pre">87.4%</span></code> de la variabilidad de los datos, lo cual es un muy buen rendimiento en términos de ajuste del modelo.</p>
<p>En cuanto a las pruebas de hipótesis para los supuestos de los residuos, observamos que el p-valor de la prueba de <strong>Ljung-Box</strong> es <code class="docutils literal notranslate"><span class="pre">0.36</span></code>. Esto significa que no se puede rechazar la hipótesis nula, por lo tanto, los residuos son independientes entre sí. Este resultado era esperado, ya que indica que no hay evidencia de autocorrelación en los residuos, lo que sugiere que el modelo ha capturado correctamente la estructura de los datos. Asimismo, el p-valor de la prueba de <strong>Jarque-Bera</strong> es <code class="docutils literal notranslate"><span class="pre">0.3</span></code>, lo que indica que no se puede rechazar la hipótesis de que los residuos siguen una distribución normal. Este resultado es favorable para la regresión lineal, ya que la normalidad de los residuos asegura la validez de las inferencias estadísticas del modelo.</p>
</section>
</section>
<section id="modelo-regresion-ridge">
<h3><strong>MODELO REGRESIÓN RIDGE</strong><a class="headerlink" href="#modelo-regresion-ridge" title="Link to this heading">#</a></h3>
<p>Primeramente se entrena el modelo y predice. Se imprimen las tablas que contienen las métricas predeterminadas para cada una de las 24 horas.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">modeloridge</span> <span class="o">=</span> <span class="n">Ridge</span><span class="p">()</span>
<span class="n">metricas</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">hora</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">25</span><span class="p">):</span>      
    <span class="k">for</span> <span class="n">dias</span> <span class="ow">in</span> <span class="n">particiones</span><span class="p">:</span>       
        <span class="n">iniciotrain</span> <span class="o">=</span> <span class="mi">0</span>        
        <span class="k">while</span> <span class="p">(</span><span class="n">iniciotrain</span> <span class="o">+</span> <span class="p">(</span><span class="n">dias</span> <span class="o">*</span> <span class="mi">24</span><span class="p">)</span> <span class="o">+</span> <span class="n">hora</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">):</span>            
            <span class="n">fintrain</span> <span class="o">=</span> <span class="n">iniciotrain</span> <span class="o">+</span> <span class="p">(</span><span class="n">dias</span> <span class="o">*</span> <span class="mi">24</span><span class="p">)</span>           
            <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">plieguess</span><span class="p">(</span><span class="n">iniciotrain</span><span class="p">,</span><span class="n">fintrain</span><span class="p">,</span><span class="n">hora</span><span class="p">)</span>            
            <span class="n">modeloridge</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
            <span class="n">y_prediccion</span><span class="o">=</span> <span class="n">modeloridge</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>               
            <span class="n">rmse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">,</span> <span class="n">squared</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="n">mape</span> <span class="o">=</span> <span class="n">MAPE</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">)</span>
            <span class="n">r2</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">)</span>
            <span class="n">metricas</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
                <span class="s1">&#39;Modelo&#39;</span><span class="p">:</span> <span class="s1">&#39;Regresión Ridge&#39;</span><span class="p">,</span>
                <span class="s1">&#39;Dias&#39;</span><span class="p">:</span> <span class="n">dias</span><span class="p">,</span>
                <span class="s1">&#39;Hora&#39;</span><span class="p">:</span> <span class="n">hora</span><span class="p">,</span>
                <span class="s1">&#39;MAPE&#39;</span><span class="p">:</span> <span class="n">mape</span><span class="p">,</span>
                <span class="s1">&#39;RMSE&#39;</span><span class="p">:</span> <span class="n">rmse</span><span class="p">,</span>
                <span class="s1">&#39;R^2&#39;</span><span class="p">:</span> <span class="n">r2</span><span class="p">,</span>
            <span class="p">})</span>           
            <span class="n">iniciotrain</span> <span class="o">=</span> <span class="n">fintrain</span>  
<span class="n">dataridge</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">metricas</span><span class="p">)</span>
<span class="n">dataridge</span> <span class="o">=</span> <span class="n">dataridge</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dataridge</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;Modelo&#39;</span><span class="p">,</span> <span class="s1">&#39;Hora&#39;</span><span class="p">,</span> <span class="s1">&#39;Dias&#39;</span><span class="p">])[</span><span class="s1">&#39;RMSE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">idxmin</span><span class="p">()]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataridge</span><span class="p">[</span><span class="n">dataridge</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Regresión Ridge</td>
      <td>7</td>
      <td>1</td>
      <td>9.392195</td>
      <td>0.290103</td>
      <td>0.602265</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Regresión Ridge</td>
      <td>14</td>
      <td>1</td>
      <td>16.678411</td>
      <td>0.327680</td>
      <td>0.913929</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Regresión Ridge</td>
      <td>21</td>
      <td>1</td>
      <td>10.524939</td>
      <td>0.317225</td>
      <td>0.892848</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Regresión Ridge</td>
      <td>28</td>
      <td>1</td>
      <td>10.868252</td>
      <td>0.320051</td>
      <td>0.890930</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataridge</span><span class="p">[</span><span class="n">dataridge</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>4</th>
      <td>Regresión Ridge</td>
      <td>7</td>
      <td>2</td>
      <td>33.507627</td>
      <td>0.296205</td>
      <td>0.850377</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Regresión Ridge</td>
      <td>14</td>
      <td>2</td>
      <td>17.659365</td>
      <td>0.345091</td>
      <td>0.502901</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Regresión Ridge</td>
      <td>21</td>
      <td>2</td>
      <td>21.192070</td>
      <td>0.326646</td>
      <td>0.923647</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Regresión Ridge</td>
      <td>28</td>
      <td>2</td>
      <td>11.507826</td>
      <td>0.335695</td>
      <td>0.864361</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataridge</span><span class="p">[</span><span class="n">dataridge</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">3</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>8</th>
      <td>Regresión Ridge</td>
      <td>7</td>
      <td>3</td>
      <td>34.182770</td>
      <td>0.314434</td>
      <td>0.840105</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Regresión Ridge</td>
      <td>14</td>
      <td>3</td>
      <td>10.551541</td>
      <td>0.331490</td>
      <td>0.862916</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Regresión Ridge</td>
      <td>21</td>
      <td>3</td>
      <td>10.341654</td>
      <td>0.317159</td>
      <td>0.874513</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Regresión Ridge</td>
      <td>28</td>
      <td>3</td>
      <td>10.604223</td>
      <td>0.321857</td>
      <td>0.870768</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataridge</span><span class="p">[</span><span class="n">dataridge</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">4</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>12</th>
      <td>Regresión Ridge</td>
      <td>7</td>
      <td>4</td>
      <td>33.743619</td>
      <td>0.312458</td>
      <td>0.833507</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Regresión Ridge</td>
      <td>14</td>
      <td>4</td>
      <td>10.394874</td>
      <td>0.331241</td>
      <td>0.851864</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Regresión Ridge</td>
      <td>21</td>
      <td>4</td>
      <td>10.547096</td>
      <td>0.287738</td>
      <td>0.929333</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Regresión Ridge</td>
      <td>28</td>
      <td>4</td>
      <td>10.731652</td>
      <td>0.323306</td>
      <td>0.858876</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataridge</span><span class="p">[</span><span class="n">dataridge</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">5</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>16</th>
      <td>Regresión Ridge</td>
      <td>7</td>
      <td>5</td>
      <td>13.299895</td>
      <td>0.321472</td>
      <td>0.884422</td>
    </tr>
    <tr>
      <th>17</th>
      <td>Regresión Ridge</td>
      <td>14</td>
      <td>5</td>
      <td>10.408561</td>
      <td>0.331712</td>
      <td>0.844930</td>
    </tr>
    <tr>
      <th>18</th>
      <td>Regresión Ridge</td>
      <td>21</td>
      <td>5</td>
      <td>10.000924</td>
      <td>0.285639</td>
      <td>0.927115</td>
    </tr>
    <tr>
      <th>19</th>
      <td>Regresión Ridge</td>
      <td>28</td>
      <td>5</td>
      <td>10.720448</td>
      <td>0.323306</td>
      <td>0.852689</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataridge</span><span class="p">[</span><span class="n">dataridge</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">6</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>20</th>
      <td>Regresión Ridge</td>
      <td>7</td>
      <td>6</td>
      <td>8.846539</td>
      <td>0.336004</td>
      <td>0.850351</td>
    </tr>
    <tr>
      <th>21</th>
      <td>Regresión Ridge</td>
      <td>14</td>
      <td>6</td>
      <td>10.226029</td>
      <td>0.331410</td>
      <td>0.824458</td>
    </tr>
    <tr>
      <th>22</th>
      <td>Regresión Ridge</td>
      <td>21</td>
      <td>6</td>
      <td>10.166551</td>
      <td>0.288539</td>
      <td>0.924140</td>
    </tr>
    <tr>
      <th>23</th>
      <td>Regresión Ridge</td>
      <td>28</td>
      <td>6</td>
      <td>10.352729</td>
      <td>0.322098</td>
      <td>0.834184</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataridge</span><span class="p">[</span><span class="n">dataridge</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">7</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>24</th>
      <td>Regresión Ridge</td>
      <td>7</td>
      <td>7</td>
      <td>8.800315</td>
      <td>0.335511</td>
      <td>0.850790</td>
    </tr>
    <tr>
      <th>25</th>
      <td>Regresión Ridge</td>
      <td>14</td>
      <td>7</td>
      <td>9.303856</td>
      <td>0.325786</td>
      <td>0.791882</td>
    </tr>
    <tr>
      <th>26</th>
      <td>Regresión Ridge</td>
      <td>21</td>
      <td>7</td>
      <td>9.724889</td>
      <td>0.287633</td>
      <td>0.920692</td>
    </tr>
    <tr>
      <th>27</th>
      <td>Regresión Ridge</td>
      <td>28</td>
      <td>7</td>
      <td>9.001938</td>
      <td>0.309867</td>
      <td>0.811724</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataridge</span><span class="p">[</span><span class="n">dataridge</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">8</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>28</th>
      <td>Regresión Ridge</td>
      <td>7</td>
      <td>8</td>
      <td>9.550950</td>
      <td>0.323094</td>
      <td>0.924230</td>
    </tr>
    <tr>
      <th>29</th>
      <td>Regresión Ridge</td>
      <td>14</td>
      <td>8</td>
      <td>8.574775</td>
      <td>0.304564</td>
      <td>0.932671</td>
    </tr>
    <tr>
      <th>30</th>
      <td>Regresión Ridge</td>
      <td>21</td>
      <td>8</td>
      <td>9.456997</td>
      <td>0.290591</td>
      <td>0.931483</td>
    </tr>
    <tr>
      <th>31</th>
      <td>Regresión Ridge</td>
      <td>28</td>
      <td>8</td>
      <td>9.116991</td>
      <td>0.312624</td>
      <td>0.764724</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataridge</span><span class="p">[</span><span class="n">dataridge</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">9</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>32</th>
      <td>Regresión Ridge</td>
      <td>7</td>
      <td>9</td>
      <td>9.923442</td>
      <td>0.327969</td>
      <td>0.919222</td>
    </tr>
    <tr>
      <th>33</th>
      <td>Regresión Ridge</td>
      <td>14</td>
      <td>9</td>
      <td>8.932504</td>
      <td>0.310440</td>
      <td>0.927626</td>
    </tr>
    <tr>
      <th>34</th>
      <td>Regresión Ridge</td>
      <td>21</td>
      <td>9</td>
      <td>8.518456</td>
      <td>0.305768</td>
      <td>0.761630</td>
    </tr>
    <tr>
      <th>35</th>
      <td>Regresión Ridge</td>
      <td>28</td>
      <td>9</td>
      <td>8.587234</td>
      <td>0.307237</td>
      <td>0.759334</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataridge</span><span class="p">[</span><span class="n">dataridge</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">10</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>36</th>
      <td>Regresión Ridge</td>
      <td>7</td>
      <td>10</td>
      <td>9.456477</td>
      <td>0.318985</td>
      <td>0.923587</td>
    </tr>
    <tr>
      <th>37</th>
      <td>Regresión Ridge</td>
      <td>14</td>
      <td>10</td>
      <td>8.317825</td>
      <td>0.304156</td>
      <td>0.930526</td>
    </tr>
    <tr>
      <th>38</th>
      <td>Regresión Ridge</td>
      <td>21</td>
      <td>10</td>
      <td>7.848215</td>
      <td>0.297924</td>
      <td>0.727072</td>
    </tr>
    <tr>
      <th>39</th>
      <td>Regresión Ridge</td>
      <td>28</td>
      <td>10</td>
      <td>7.836569</td>
      <td>0.297828</td>
      <td>0.727248</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataridge</span><span class="p">[</span><span class="n">dataridge</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">11</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>40</th>
      <td>Regresión Ridge</td>
      <td>7</td>
      <td>11</td>
      <td>9.334299</td>
      <td>0.318192</td>
      <td>0.926254</td>
    </tr>
    <tr>
      <th>41</th>
      <td>Regresión Ridge</td>
      <td>14</td>
      <td>11</td>
      <td>9.263621</td>
      <td>0.306600</td>
      <td>0.931529</td>
    </tr>
    <tr>
      <th>42</th>
      <td>Regresión Ridge</td>
      <td>21</td>
      <td>11</td>
      <td>8.556077</td>
      <td>0.327741</td>
      <td>0.627443</td>
    </tr>
    <tr>
      <th>43</th>
      <td>Regresión Ridge</td>
      <td>28</td>
      <td>11</td>
      <td>8.520033</td>
      <td>0.327603</td>
      <td>0.627756</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataridge</span><span class="p">[</span><span class="n">dataridge</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">12</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>44</th>
      <td>Regresión Ridge</td>
      <td>7</td>
      <td>12</td>
      <td>8.910700</td>
      <td>0.327205</td>
      <td>0.827530</td>
    </tr>
    <tr>
      <th>45</th>
      <td>Regresión Ridge</td>
      <td>14</td>
      <td>12</td>
      <td>9.593730</td>
      <td>0.310505</td>
      <td>0.927866</td>
    </tr>
    <tr>
      <th>46</th>
      <td>Regresión Ridge</td>
      <td>21</td>
      <td>12</td>
      <td>9.311199</td>
      <td>0.339109</td>
      <td>0.667217</td>
    </tr>
    <tr>
      <th>47</th>
      <td>Regresión Ridge</td>
      <td>28</td>
      <td>12</td>
      <td>9.286081</td>
      <td>0.339244</td>
      <td>0.666951</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataridge</span><span class="p">[</span><span class="n">dataridge</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">13</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>48</th>
      <td>Regresión Ridge</td>
      <td>7</td>
      <td>13</td>
      <td>9.375348</td>
      <td>0.322960</td>
      <td>0.913000</td>
    </tr>
    <tr>
      <th>49</th>
      <td>Regresión Ridge</td>
      <td>14</td>
      <td>13</td>
      <td>10.701350</td>
      <td>0.329380</td>
      <td>0.913087</td>
    </tr>
    <tr>
      <th>50</th>
      <td>Regresión Ridge</td>
      <td>21</td>
      <td>13</td>
      <td>11.041115</td>
      <td>0.331590</td>
      <td>0.835688</td>
    </tr>
    <tr>
      <th>51</th>
      <td>Regresión Ridge</td>
      <td>28</td>
      <td>13</td>
      <td>10.359014</td>
      <td>0.347856</td>
      <td>0.735902</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataridge</span><span class="p">[</span><span class="n">dataridge</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">14</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>52</th>
      <td>Regresión Ridge</td>
      <td>7</td>
      <td>14</td>
      <td>9.678483</td>
      <td>0.330654</td>
      <td>0.898348</td>
    </tr>
    <tr>
      <th>53</th>
      <td>Regresión Ridge</td>
      <td>14</td>
      <td>14</td>
      <td>11.399741</td>
      <td>0.335340</td>
      <td>0.911482</td>
    </tr>
    <tr>
      <th>54</th>
      <td>Regresión Ridge</td>
      <td>21</td>
      <td>14</td>
      <td>10.876954</td>
      <td>0.329189</td>
      <td>0.879473</td>
    </tr>
    <tr>
      <th>55</th>
      <td>Regresión Ridge</td>
      <td>28</td>
      <td>14</td>
      <td>11.347063</td>
      <td>0.353809</td>
      <td>0.779195</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataridge</span><span class="p">[</span><span class="n">dataridge</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">15</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>56</th>
      <td>Regresión Ridge</td>
      <td>7</td>
      <td>15</td>
      <td>9.658506</td>
      <td>0.320803</td>
      <td>0.914474</td>
    </tr>
    <tr>
      <th>57</th>
      <td>Regresión Ridge</td>
      <td>14</td>
      <td>15</td>
      <td>10.734710</td>
      <td>0.324366</td>
      <td>0.919341</td>
    </tr>
    <tr>
      <th>58</th>
      <td>Regresión Ridge</td>
      <td>21</td>
      <td>15</td>
      <td>11.046729</td>
      <td>0.332931</td>
      <td>0.884161</td>
    </tr>
    <tr>
      <th>59</th>
      <td>Regresión Ridge</td>
      <td>28</td>
      <td>15</td>
      <td>11.514650</td>
      <td>0.351784</td>
      <td>0.905129</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataridge</span><span class="p">[</span><span class="n">dataridge</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">16</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>60</th>
      <td>Regresión Ridge</td>
      <td>7</td>
      <td>16</td>
      <td>9.676899</td>
      <td>0.320858</td>
      <td>0.913848</td>
    </tr>
    <tr>
      <th>61</th>
      <td>Regresión Ridge</td>
      <td>14</td>
      <td>16</td>
      <td>11.414315</td>
      <td>0.299583</td>
      <td>0.819288</td>
    </tr>
    <tr>
      <th>62</th>
      <td>Regresión Ridge</td>
      <td>21</td>
      <td>16</td>
      <td>11.725207</td>
      <td>0.304435</td>
      <td>0.813388</td>
    </tr>
    <tr>
      <th>63</th>
      <td>Regresión Ridge</td>
      <td>28</td>
      <td>16</td>
      <td>11.608909</td>
      <td>0.350840</td>
      <td>0.909266</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataridge</span><span class="p">[</span><span class="n">dataridge</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">17</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>64</th>
      <td>Regresión Ridge</td>
      <td>7</td>
      <td>17</td>
      <td>9.714451</td>
      <td>0.321861</td>
      <td>0.912454</td>
    </tr>
    <tr>
      <th>65</th>
      <td>Regresión Ridge</td>
      <td>14</td>
      <td>17</td>
      <td>11.096922</td>
      <td>0.295617</td>
      <td>0.824140</td>
    </tr>
    <tr>
      <th>66</th>
      <td>Regresión Ridge</td>
      <td>21</td>
      <td>17</td>
      <td>10.063766</td>
      <td>0.301539</td>
      <td>0.912849</td>
    </tr>
    <tr>
      <th>67</th>
      <td>Regresión Ridge</td>
      <td>28</td>
      <td>17</td>
      <td>12.426263</td>
      <td>0.353709</td>
      <td>0.913911</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataridge</span><span class="p">[</span><span class="n">dataridge</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">18</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>68</th>
      <td>Regresión Ridge</td>
      <td>7</td>
      <td>18</td>
      <td>9.768722</td>
      <td>0.322321</td>
      <td>0.911518</td>
    </tr>
    <tr>
      <th>69</th>
      <td>Regresión Ridge</td>
      <td>14</td>
      <td>18</td>
      <td>11.442084</td>
      <td>0.301570</td>
      <td>0.809845</td>
    </tr>
    <tr>
      <th>70</th>
      <td>Regresión Ridge</td>
      <td>21</td>
      <td>18</td>
      <td>9.742538</td>
      <td>0.291576</td>
      <td>0.923551</td>
    </tr>
    <tr>
      <th>71</th>
      <td>Regresión Ridge</td>
      <td>28</td>
      <td>18</td>
      <td>14.333260</td>
      <td>0.363045</td>
      <td>0.915240</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataridge</span><span class="p">[</span><span class="n">dataridge</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">19</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>72</th>
      <td>Regresión Ridge</td>
      <td>7</td>
      <td>19</td>
      <td>9.106688</td>
      <td>0.318461</td>
      <td>0.910727</td>
    </tr>
    <tr>
      <th>73</th>
      <td>Regresión Ridge</td>
      <td>14</td>
      <td>19</td>
      <td>11.772620</td>
      <td>0.310934</td>
      <td>0.798226</td>
    </tr>
    <tr>
      <th>74</th>
      <td>Regresión Ridge</td>
      <td>21</td>
      <td>19</td>
      <td>12.212204</td>
      <td>0.318750</td>
      <td>0.787955</td>
    </tr>
    <tr>
      <th>75</th>
      <td>Regresión Ridge</td>
      <td>28</td>
      <td>19</td>
      <td>14.455156</td>
      <td>0.363084</td>
      <td>0.917798</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataridge</span><span class="p">[</span><span class="n">dataridge</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">20</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>76</th>
      <td>Regresión Ridge</td>
      <td>7</td>
      <td>20</td>
      <td>9.199970</td>
      <td>0.319161</td>
      <td>0.907628</td>
    </tr>
    <tr>
      <th>77</th>
      <td>Regresión Ridge</td>
      <td>14</td>
      <td>20</td>
      <td>12.471681</td>
      <td>0.317096</td>
      <td>0.803585</td>
    </tr>
    <tr>
      <th>78</th>
      <td>Regresión Ridge</td>
      <td>21</td>
      <td>20</td>
      <td>12.827999</td>
      <td>0.323000</td>
      <td>0.796203</td>
    </tr>
    <tr>
      <th>79</th>
      <td>Regresión Ridge</td>
      <td>28</td>
      <td>20</td>
      <td>19.877883</td>
      <td>0.364236</td>
      <td>0.879162</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataridge</span><span class="p">[</span><span class="n">dataridge</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">21</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>80</th>
      <td>Regresión Ridge</td>
      <td>7</td>
      <td>21</td>
      <td>9.530931</td>
      <td>0.321096</td>
      <td>0.903792</td>
    </tr>
    <tr>
      <th>81</th>
      <td>Regresión Ridge</td>
      <td>14</td>
      <td>21</td>
      <td>13.099762</td>
      <td>0.318826</td>
      <td>0.834935</td>
    </tr>
    <tr>
      <th>82</th>
      <td>Regresión Ridge</td>
      <td>21</td>
      <td>21</td>
      <td>13.457376</td>
      <td>0.324661</td>
      <td>0.828837</td>
    </tr>
    <tr>
      <th>83</th>
      <td>Regresión Ridge</td>
      <td>28</td>
      <td>21</td>
      <td>18.070793</td>
      <td>0.347461</td>
      <td>0.889994</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataridge</span><span class="p">[</span><span class="n">dataridge</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">22</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>84</th>
      <td>Regresión Ridge</td>
      <td>7</td>
      <td>22</td>
      <td>19.830131</td>
      <td>0.316175</td>
      <td>0.936049</td>
    </tr>
    <tr>
      <th>85</th>
      <td>Regresión Ridge</td>
      <td>14</td>
      <td>22</td>
      <td>12.476981</td>
      <td>0.296510</td>
      <td>0.855609</td>
    </tr>
    <tr>
      <th>86</th>
      <td>Regresión Ridge</td>
      <td>21</td>
      <td>22</td>
      <td>12.821964</td>
      <td>0.299030</td>
      <td>0.853144</td>
    </tr>
    <tr>
      <th>87</th>
      <td>Regresión Ridge</td>
      <td>28</td>
      <td>22</td>
      <td>18.234842</td>
      <td>0.349583</td>
      <td>0.888208</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataridge</span><span class="p">[</span><span class="n">dataridge</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">23</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>88</th>
      <td>Regresión Ridge</td>
      <td>7</td>
      <td>23</td>
      <td>19.274809</td>
      <td>0.305539</td>
      <td>0.942751</td>
    </tr>
    <tr>
      <th>89</th>
      <td>Regresión Ridge</td>
      <td>14</td>
      <td>23</td>
      <td>12.473231</td>
      <td>0.296275</td>
      <td>0.851781</td>
    </tr>
    <tr>
      <th>90</th>
      <td>Regresión Ridge</td>
      <td>21</td>
      <td>23</td>
      <td>12.669371</td>
      <td>0.297254</td>
      <td>0.850800</td>
    </tr>
    <tr>
      <th>91</th>
      <td>Regresión Ridge</td>
      <td>28</td>
      <td>23</td>
      <td>17.527472</td>
      <td>0.354436</td>
      <td>0.885817</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataridge</span><span class="p">[</span><span class="n">dataridge</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">24</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>92</th>
      <td>Regresión Ridge</td>
      <td>7</td>
      <td>24</td>
      <td>19.465046</td>
      <td>0.304991</td>
      <td>0.943794</td>
    </tr>
    <tr>
      <th>93</th>
      <td>Regresión Ridge</td>
      <td>14</td>
      <td>24</td>
      <td>13.292462</td>
      <td>0.286196</td>
      <td>0.872761</td>
    </tr>
    <tr>
      <th>94</th>
      <td>Regresión Ridge</td>
      <td>21</td>
      <td>24</td>
      <td>13.377857</td>
      <td>0.284339</td>
      <td>0.874406</td>
    </tr>
    <tr>
      <th>95</th>
      <td>Regresión Ridge</td>
      <td>28</td>
      <td>24</td>
      <td>20.318522</td>
      <td>0.383384</td>
      <td>0.867748</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<section id="id2">
<h4><strong>MEJOR MODELO - CADA HORA</strong><a class="headerlink" href="#id2" title="Link to this heading">#</a></h4>
<p>Ahora mostraremos el mejor modelo de cada hora</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mejorridgehora</span> <span class="o">=</span> <span class="n">mejormodelohora</span><span class="p">(</span><span class="n">particiones</span><span class="p">,</span> <span class="n">dataridge</span><span class="p">)</span>
<span class="n">mejorridgehora</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Regresión Ridge</td>
      <td>7</td>
      <td>1</td>
      <td>9.392195</td>
      <td>0.290103</td>
      <td>0.602265</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Regresión Ridge</td>
      <td>7</td>
      <td>2</td>
      <td>33.507627</td>
      <td>0.296205</td>
      <td>0.850377</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Regresión Ridge</td>
      <td>7</td>
      <td>3</td>
      <td>34.182770</td>
      <td>0.314434</td>
      <td>0.840105</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Regresión Ridge</td>
      <td>21</td>
      <td>4</td>
      <td>10.547096</td>
      <td>0.287738</td>
      <td>0.929333</td>
    </tr>
    <tr>
      <th>18</th>
      <td>Regresión Ridge</td>
      <td>21</td>
      <td>5</td>
      <td>10.000924</td>
      <td>0.285639</td>
      <td>0.927115</td>
    </tr>
    <tr>
      <th>22</th>
      <td>Regresión Ridge</td>
      <td>21</td>
      <td>6</td>
      <td>10.166551</td>
      <td>0.288539</td>
      <td>0.924140</td>
    </tr>
    <tr>
      <th>26</th>
      <td>Regresión Ridge</td>
      <td>21</td>
      <td>7</td>
      <td>9.724889</td>
      <td>0.287633</td>
      <td>0.920692</td>
    </tr>
    <tr>
      <th>30</th>
      <td>Regresión Ridge</td>
      <td>21</td>
      <td>8</td>
      <td>9.456997</td>
      <td>0.290591</td>
      <td>0.931483</td>
    </tr>
    <tr>
      <th>34</th>
      <td>Regresión Ridge</td>
      <td>21</td>
      <td>9</td>
      <td>8.518456</td>
      <td>0.305768</td>
      <td>0.761630</td>
    </tr>
    <tr>
      <th>39</th>
      <td>Regresión Ridge</td>
      <td>28</td>
      <td>10</td>
      <td>7.836569</td>
      <td>0.297828</td>
      <td>0.727248</td>
    </tr>
    <tr>
      <th>41</th>
      <td>Regresión Ridge</td>
      <td>14</td>
      <td>11</td>
      <td>9.263621</td>
      <td>0.306600</td>
      <td>0.931529</td>
    </tr>
    <tr>
      <th>45</th>
      <td>Regresión Ridge</td>
      <td>14</td>
      <td>12</td>
      <td>9.593730</td>
      <td>0.310505</td>
      <td>0.927866</td>
    </tr>
    <tr>
      <th>48</th>
      <td>Regresión Ridge</td>
      <td>7</td>
      <td>13</td>
      <td>9.375348</td>
      <td>0.322960</td>
      <td>0.913000</td>
    </tr>
    <tr>
      <th>54</th>
      <td>Regresión Ridge</td>
      <td>21</td>
      <td>14</td>
      <td>10.876954</td>
      <td>0.329189</td>
      <td>0.879473</td>
    </tr>
    <tr>
      <th>56</th>
      <td>Regresión Ridge</td>
      <td>7</td>
      <td>15</td>
      <td>9.658506</td>
      <td>0.320803</td>
      <td>0.914474</td>
    </tr>
    <tr>
      <th>61</th>
      <td>Regresión Ridge</td>
      <td>14</td>
      <td>16</td>
      <td>11.414315</td>
      <td>0.299583</td>
      <td>0.819288</td>
    </tr>
    <tr>
      <th>65</th>
      <td>Regresión Ridge</td>
      <td>14</td>
      <td>17</td>
      <td>11.096922</td>
      <td>0.295617</td>
      <td>0.824140</td>
    </tr>
    <tr>
      <th>70</th>
      <td>Regresión Ridge</td>
      <td>21</td>
      <td>18</td>
      <td>9.742538</td>
      <td>0.291576</td>
      <td>0.923551</td>
    </tr>
    <tr>
      <th>73</th>
      <td>Regresión Ridge</td>
      <td>14</td>
      <td>19</td>
      <td>11.772620</td>
      <td>0.310934</td>
      <td>0.798226</td>
    </tr>
    <tr>
      <th>77</th>
      <td>Regresión Ridge</td>
      <td>14</td>
      <td>20</td>
      <td>12.471681</td>
      <td>0.317096</td>
      <td>0.803585</td>
    </tr>
    <tr>
      <th>81</th>
      <td>Regresión Ridge</td>
      <td>14</td>
      <td>21</td>
      <td>13.099762</td>
      <td>0.318826</td>
      <td>0.834935</td>
    </tr>
    <tr>
      <th>85</th>
      <td>Regresión Ridge</td>
      <td>14</td>
      <td>22</td>
      <td>12.476981</td>
      <td>0.296510</td>
      <td>0.855609</td>
    </tr>
    <tr>
      <th>89</th>
      <td>Regresión Ridge</td>
      <td>14</td>
      <td>23</td>
      <td>12.473231</td>
      <td>0.296275</td>
      <td>0.851781</td>
    </tr>
    <tr>
      <th>94</th>
      <td>Regresión Ridge</td>
      <td>21</td>
      <td>24</td>
      <td>13.377857</td>
      <td>0.284339</td>
      <td>0.874406</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="hora-y-ventana-con-mejor-modelo-ridge">
<h4><strong>HORA Y VENTANA CON MEJOR MODELO RIDGE</strong><a class="headerlink" href="#hora-y-ventana-con-mejor-modelo-ridge" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bestridge</span> <span class="o">=</span> <span class="n">mejormodelotot</span><span class="p">(</span><span class="n">mejorridgehora</span><span class="p">)</span>
<span class="n">bestridge</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>94</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Modelo</th>
      <td>Regresión Ridge</td>
    </tr>
    <tr>
      <th>Dias</th>
      <td>21</td>
    </tr>
    <tr>
      <th>Hora</th>
      <td>24</td>
    </tr>
    <tr>
      <th>MAPE</th>
      <td>13.377857</td>
    </tr>
    <tr>
      <th>RMSE</th>
      <td>0.284339</td>
    </tr>
    <tr>
      <th>R^2</th>
      <td>0.874406</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Es decir, para la <strong>Regresión Ridge</strong>, el mejor modelo se da cuando se trabaja con la <strong>HORA</strong>: <code class="docutils literal notranslate"><span class="pre">24</span></code> en la venta de predicción de <code class="docutils literal notranslate"><span class="pre">21</span> <span class="pre">días</span></code>. Veamos los valores de <strong>Ljung-Box p-value</strong> y <strong>Jarque-Bera p-value</strong>. Antes de ello, veamos cuáles son las pruebas de hipótesis para comprender mejor los p-valores que se nos arrojen.</p>
<ul class="simple">
<li><p><strong>Prueba de Ljung-Box</strong></p></li>
</ul>
<ul class="simple">
<li><p><strong>Hipótesis nula (H₀)</strong>: No hay autocorrelación en los residuos (es decir, los residuos son independientes entre sí).</p></li>
<li><p><strong>Hipótesis alternativa (H₁)</strong>: Hay autocorrelación en los residuos</p></li>
</ul>
<ul class="simple">
<li><p><strong>Prueba de Jarque-Bera</strong></p></li>
</ul>
<ul class="simple">
<li><p><strong>Hipótesis nula (H₀)</strong>: Los residuos tienen una distribución normal.</p></li>
<li><p><strong>Hipótesis alternativa (H₁)</strong>: Los residuos no tienen una distribución normal.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">metricas</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">dias</span> <span class="o">=</span> <span class="mi">21</span>
<span class="n">hora</span> <span class="o">=</span> <span class="mi">24</span>
<span class="n">iniciotrain</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">while</span> <span class="p">(</span><span class="n">iniciotrain</span> <span class="o">+</span> <span class="p">(</span><span class="n">dias</span> <span class="o">*</span> <span class="mi">24</span><span class="p">)</span> <span class="o">+</span> <span class="n">hora</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">):</span>  
    <span class="n">fintrain</span> <span class="o">=</span> <span class="n">iniciotrain</span> <span class="o">+</span> <span class="p">(</span><span class="n">dias</span> <span class="o">*</span> <span class="mi">24</span><span class="p">)</span>   
    <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">plieguess</span><span class="p">(</span><span class="n">iniciotrain</span><span class="p">,</span> <span class="n">fintrain</span><span class="p">,</span> <span class="n">hora</span><span class="p">)</span>   
    <span class="n">modeloridge</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
    <span class="n">y_prediccion</span><span class="o">=</span> <span class="n">modeloridge</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>       
    <span class="n">rmse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">,</span> <span class="n">squared</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">mape</span> <span class="o">=</span> <span class="n">MAPE</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">)</span>
    <span class="n">r2</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">)</span>
    <span class="n">ljungbox</span><span class="p">,</span> <span class="n">jarquebera</span> <span class="o">=</span> <span class="n">residuos</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">)</span>   
    <span class="n">metricas</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
        <span class="s1">&#39;Modelo&#39;</span><span class="p">:</span> <span class="s1">&#39;Regresión Ridge&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Dias&#39;</span><span class="p">:</span> <span class="n">dias</span><span class="p">,</span>
        <span class="s1">&#39;Hora&#39;</span><span class="p">:</span> <span class="n">hora</span><span class="p">,</span>
        <span class="s1">&#39;MAPE&#39;</span><span class="p">:</span> <span class="n">mape</span><span class="p">,</span>
        <span class="s1">&#39;RMSE&#39;</span><span class="p">:</span> <span class="n">rmse</span><span class="p">,</span>
        <span class="s1">&#39;R^2&#39;</span><span class="p">:</span> <span class="n">r2</span><span class="p">,</span>
        <span class="s1">&#39;Ljung-Box p-value&#39;</span> <span class="p">:</span> <span class="n">ljungbox</span><span class="p">,</span>
        <span class="s1">&#39;Jarque-Bera p-value&#39;</span> <span class="p">:</span> <span class="n">jarquebera</span>
    <span class="p">})</span>   
    <span class="n">iniciotrain</span> <span class="o">=</span> <span class="n">fintrain</span>  
<span class="n">dataridge</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">metricas</span><span class="p">)</span>
<span class="n">dataridge</span> <span class="o">=</span> <span class="n">dataridge</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dataridge</span><span class="p">[</span><span class="s1">&#39;RMSE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">idxmin</span><span class="p">()]</span>
<span class="n">dataridge</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">dataridge</span><span class="p">)</span>
<span class="n">dataridge</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Modelo</th>
      <td>Regresión Ridge</td>
    </tr>
    <tr>
      <th>Dias</th>
      <td>21</td>
    </tr>
    <tr>
      <th>Hora</th>
      <td>24</td>
    </tr>
    <tr>
      <th>MAPE</th>
      <td>13.377857</td>
    </tr>
    <tr>
      <th>RMSE</th>
      <td>0.284339</td>
    </tr>
    <tr>
      <th>R^2</th>
      <td>0.874406</td>
    </tr>
    <tr>
      <th>Ljung-Box p-value</th>
      <td>0.370875</td>
    </tr>
    <tr>
      <th>Jarque-Bera p-value</th>
      <td>0.285062</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>En este sentido, sobre el modelo de regresión ridge, podemos afirmar que el mejor modelo identificado tiene un <strong>MAPE</strong> de <code class="docutils literal notranslate"><span class="pre">13.37%</span></code>, lo que indica que, en promedio, las predicciones presentan una desviación porcentual consistente con respecto a los valores reales. El <strong>RMSE</strong> de <code class="docutils literal notranslate"><span class="pre">0.28</span></code> muestra que el error promedio en las predicciones es bajo, lo que sugiere que el modelo está haciendo un buen trabajo. Además, con un <strong>R²</strong> de <code class="docutils literal notranslate"><span class="pre">0.87</span></code>, el modelo logra explicar el <code class="docutils literal notranslate"><span class="pre">87.44%</span></code> de la variabilidad de los datos, lo que representa un buen ajuste.</p>
<p>Respecto a los residuos, el <strong>p-valor</strong> de la prueba de <strong>Ljung-Box</strong> es <code class="docutils literal notranslate"><span class="pre">0.37</span></code>, lo que indica que no hay autocorrelación en los residuos, lo cual es deseable ya que los errores son independientes. El <strong>p-valor</strong> de la prueba de <strong>Jarque-Bera</strong> es <code class="docutils literal notranslate"><span class="pre">0.28</span></code>, lo que sugiere que los residuos siguen una distribución normal, lo que refuerza la validez del modelo y de sus predicciones.</p>
</section>
</section>
<section id="modelo-regresion-lasso">
<h3><strong>MODELO REGRESIÓN LASSO</strong><a class="headerlink" href="#modelo-regresion-lasso" title="Link to this heading">#</a></h3>
<p>Primeramente se entrena el modelo y predice. Se imprimen las tablas que contienen las métricas predeterminadas para cada una de las 24 horas.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">modelolasso</span> <span class="o">=</span> <span class="n">Lasso</span><span class="p">()</span>
<span class="n">metricas</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">hora</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">25</span><span class="p">):</span>  <span class="c1"># Ciclo para calcular la tabla de errores para cada hora (puedes extender hasta 24)   </span>
    <span class="k">for</span> <span class="n">dias</span> <span class="ow">in</span> <span class="n">particiones</span><span class="p">:</span>  <span class="c1"># Ciclo que recorre las particiones para las ventanas        </span>
        <span class="n">iniciotrain</span> <span class="o">=</span> <span class="mi">0</span>        
        <span class="k">while</span> <span class="p">(</span><span class="n">iniciotrain</span> <span class="o">+</span> <span class="p">(</span><span class="n">dias</span> <span class="o">*</span> <span class="mi">24</span><span class="p">)</span> <span class="o">+</span> <span class="n">hora</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">):</span>  <span class="c1"># Mientras que el tamaño del pliegue más la hora sea menor que la longitud de los datos           </span>
            <span class="n">fintrain</span> <span class="o">=</span> <span class="n">iniciotrain</span> <span class="o">+</span> <span class="p">(</span><span class="n">dias</span> <span class="o">*</span> <span class="mi">24</span><span class="p">)</span>            
            <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">plieguess</span><span class="p">(</span><span class="n">iniciotrain</span><span class="p">,</span><span class="n">fintrain</span><span class="p">,</span><span class="n">hora</span><span class="p">)</span>          
            <span class="n">modelolasso</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
            <span class="n">y_prediccion</span><span class="o">=</span> <span class="n">modelolasso</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>               
            <span class="n">rmse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">,</span> <span class="n">squared</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="n">mape</span> <span class="o">=</span> <span class="n">MAPE</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">)</span>
            <span class="n">r2</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">)</span>
            <span class="n">metricas</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
                <span class="s1">&#39;Modelo&#39;</span><span class="p">:</span> <span class="s1">&#39;Regresión Lasso&#39;</span><span class="p">,</span>
                <span class="s1">&#39;Dias&#39;</span><span class="p">:</span> <span class="n">dias</span><span class="p">,</span>
                <span class="s1">&#39;Hora&#39;</span><span class="p">:</span> <span class="n">hora</span><span class="p">,</span>
                <span class="s1">&#39;MAPE&#39;</span><span class="p">:</span> <span class="n">mape</span><span class="p">,</span>
                <span class="s1">&#39;RMSE&#39;</span><span class="p">:</span> <span class="n">rmse</span><span class="p">,</span>
                <span class="s1">&#39;R^2&#39;</span><span class="p">:</span> <span class="n">r2</span><span class="p">,</span>
            <span class="p">})</span>           
            <span class="n">iniciotrain</span> <span class="o">=</span> <span class="n">fintrain</span>  <span class="c1"># Actualizar el inicio para el siguiente pliegue</span>
<span class="n">datalasso</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">metricas</span><span class="p">)</span>
<span class="n">datalasso</span> <span class="o">=</span> <span class="n">datalasso</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">datalasso</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;Modelo&#39;</span><span class="p">,</span> <span class="s1">&#39;Hora&#39;</span><span class="p">,</span> <span class="s1">&#39;Dias&#39;</span><span class="p">])[</span><span class="s1">&#39;RMSE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">idxmin</span><span class="p">()]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datalasso</span><span class="p">[</span><span class="n">datalasso</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Regresión Lasso</td>
      <td>7</td>
      <td>1</td>
      <td>16.828920</td>
      <td>0.368981</td>
      <td>0.452636</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Regresión Lasso</td>
      <td>14</td>
      <td>1</td>
      <td>11.071418</td>
      <td>0.399412</td>
      <td>0.468694</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Regresión Lasso</td>
      <td>21</td>
      <td>1</td>
      <td>26.577377</td>
      <td>0.396785</td>
      <td>0.887498</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Regresión Lasso</td>
      <td>28</td>
      <td>1</td>
      <td>10.560179</td>
      <td>0.401422</td>
      <td>0.463333</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datalasso</span><span class="p">[</span><span class="n">datalasso</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>4</th>
      <td>Regresión Lasso</td>
      <td>7</td>
      <td>2</td>
      <td>16.526000</td>
      <td>0.368618</td>
      <td>0.432809</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Regresión Lasso</td>
      <td>14</td>
      <td>2</td>
      <td>14.921524</td>
      <td>0.423962</td>
      <td>0.481896</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Regresión Lasso</td>
      <td>21</td>
      <td>2</td>
      <td>26.271589</td>
      <td>0.395329</td>
      <td>0.888162</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Regresión Lasso</td>
      <td>28</td>
      <td>2</td>
      <td>14.907412</td>
      <td>0.418688</td>
      <td>0.494708</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datalasso</span><span class="p">[</span><span class="n">datalasso</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">3</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>8</th>
      <td>Regresión Lasso</td>
      <td>7</td>
      <td>3</td>
      <td>16.685253</td>
      <td>0.374123</td>
      <td>0.421321</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Regresión Lasso</td>
      <td>14</td>
      <td>3</td>
      <td>21.341027</td>
      <td>0.428585</td>
      <td>0.240578</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Regresión Lasso</td>
      <td>21</td>
      <td>3</td>
      <td>25.515211</td>
      <td>0.389335</td>
      <td>0.889422</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Regresión Lasso</td>
      <td>28</td>
      <td>3</td>
      <td>16.458948</td>
      <td>0.463941</td>
      <td>0.409849</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datalasso</span><span class="p">[</span><span class="n">datalasso</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">4</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>12</th>
      <td>Regresión Lasso</td>
      <td>7</td>
      <td>4</td>
      <td>15.502170</td>
      <td>0.318170</td>
      <td>0.913595</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Regresión Lasso</td>
      <td>14</td>
      <td>4</td>
      <td>24.095939</td>
      <td>0.451624</td>
      <td>0.251506</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Regresión Lasso</td>
      <td>21</td>
      <td>4</td>
      <td>9.658325</td>
      <td>0.311801</td>
      <td>0.917019</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Regresión Lasso</td>
      <td>28</td>
      <td>4</td>
      <td>10.991575</td>
      <td>0.456726</td>
      <td>0.597868</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datalasso</span><span class="p">[</span><span class="n">datalasso</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">5</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>16</th>
      <td>Regresión Lasso</td>
      <td>7</td>
      <td>5</td>
      <td>14.936429</td>
      <td>0.319067</td>
      <td>0.909057</td>
    </tr>
    <tr>
      <th>17</th>
      <td>Regresión Lasso</td>
      <td>14</td>
      <td>5</td>
      <td>19.711060</td>
      <td>0.430070</td>
      <td>0.694667</td>
    </tr>
    <tr>
      <th>18</th>
      <td>Regresión Lasso</td>
      <td>21</td>
      <td>5</td>
      <td>9.624911</td>
      <td>0.317652</td>
      <td>0.909862</td>
    </tr>
    <tr>
      <th>19</th>
      <td>Regresión Lasso</td>
      <td>28</td>
      <td>5</td>
      <td>24.431823</td>
      <td>0.456057</td>
      <td>0.518794</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datalasso</span><span class="p">[</span><span class="n">datalasso</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">6</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>20</th>
      <td>Regresión Lasso</td>
      <td>7</td>
      <td>6</td>
      <td>13.915467</td>
      <td>0.305140</td>
      <td>0.782162</td>
    </tr>
    <tr>
      <th>21</th>
      <td>Regresión Lasso</td>
      <td>14</td>
      <td>6</td>
      <td>21.404801</td>
      <td>0.415432</td>
      <td>0.596229</td>
    </tr>
    <tr>
      <th>22</th>
      <td>Regresión Lasso</td>
      <td>21</td>
      <td>6</td>
      <td>9.470311</td>
      <td>0.317293</td>
      <td>0.908268</td>
    </tr>
    <tr>
      <th>23</th>
      <td>Regresión Lasso</td>
      <td>28</td>
      <td>6</td>
      <td>23.349564</td>
      <td>0.426467</td>
      <td>0.574495</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datalasso</span><span class="p">[</span><span class="n">datalasso</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">7</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>24</th>
      <td>Regresión Lasso</td>
      <td>7</td>
      <td>7</td>
      <td>12.610870</td>
      <td>0.300416</td>
      <td>0.913486</td>
    </tr>
    <tr>
      <th>25</th>
      <td>Regresión Lasso</td>
      <td>14</td>
      <td>7</td>
      <td>21.678055</td>
      <td>0.419248</td>
      <td>0.592273</td>
    </tr>
    <tr>
      <th>26</th>
      <td>Regresión Lasso</td>
      <td>21</td>
      <td>7</td>
      <td>8.094454</td>
      <td>0.309388</td>
      <td>0.908241</td>
    </tr>
    <tr>
      <th>27</th>
      <td>Regresión Lasso</td>
      <td>28</td>
      <td>7</td>
      <td>23.636164</td>
      <td>0.430497</td>
      <td>0.570100</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datalasso</span><span class="p">[</span><span class="n">datalasso</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">8</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>28</th>
      <td>Regresión Lasso</td>
      <td>7</td>
      <td>8</td>
      <td>13.843998</td>
      <td>0.307299</td>
      <td>0.777806</td>
    </tr>
    <tr>
      <th>29</th>
      <td>Regresión Lasso</td>
      <td>14</td>
      <td>8</td>
      <td>21.295631</td>
      <td>0.415977</td>
      <td>0.592855</td>
    </tr>
    <tr>
      <th>30</th>
      <td>Regresión Lasso</td>
      <td>21</td>
      <td>8</td>
      <td>9.348193</td>
      <td>0.402198</td>
      <td>0.868745</td>
    </tr>
    <tr>
      <th>31</th>
      <td>Regresión Lasso</td>
      <td>28</td>
      <td>8</td>
      <td>17.365585</td>
      <td>0.422824</td>
      <td>0.756157</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datalasso</span><span class="p">[</span><span class="n">datalasso</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">9</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>32</th>
      <td>Regresión Lasso</td>
      <td>7</td>
      <td>9</td>
      <td>15.184648</td>
      <td>0.323291</td>
      <td>0.760334</td>
    </tr>
    <tr>
      <th>33</th>
      <td>Regresión Lasso</td>
      <td>14</td>
      <td>9</td>
      <td>15.425844</td>
      <td>0.432181</td>
      <td>0.380695</td>
    </tr>
    <tr>
      <th>34</th>
      <td>Regresión Lasso</td>
      <td>21</td>
      <td>9</td>
      <td>10.086531</td>
      <td>0.410048</td>
      <td>0.859033</td>
    </tr>
    <tr>
      <th>35</th>
      <td>Regresión Lasso</td>
      <td>28</td>
      <td>9</td>
      <td>16.812397</td>
      <td>0.418663</td>
      <td>0.763398</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datalasso</span><span class="p">[</span><span class="n">datalasso</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">10</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>36</th>
      <td>Regresión Lasso</td>
      <td>7</td>
      <td>10</td>
      <td>14.958624</td>
      <td>0.321976</td>
      <td>0.767246</td>
    </tr>
    <tr>
      <th>37</th>
      <td>Regresión Lasso</td>
      <td>14</td>
      <td>10</td>
      <td>15.273920</td>
      <td>0.436847</td>
      <td>0.567308</td>
    </tr>
    <tr>
      <th>38</th>
      <td>Regresión Lasso</td>
      <td>21</td>
      <td>10</td>
      <td>9.861386</td>
      <td>0.409547</td>
      <td>0.854340</td>
    </tr>
    <tr>
      <th>39</th>
      <td>Regresión Lasso</td>
      <td>28</td>
      <td>10</td>
      <td>16.875555</td>
      <td>0.423746</td>
      <td>0.756062</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datalasso</span><span class="p">[</span><span class="n">datalasso</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">11</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>40</th>
      <td>Regresión Lasso</td>
      <td>7</td>
      <td>11</td>
      <td>15.325772</td>
      <td>0.323349</td>
      <td>0.768434</td>
    </tr>
    <tr>
      <th>41</th>
      <td>Regresión Lasso</td>
      <td>14</td>
      <td>11</td>
      <td>15.584906</td>
      <td>0.425532</td>
      <td>0.458121</td>
    </tr>
    <tr>
      <th>42</th>
      <td>Regresión Lasso</td>
      <td>21</td>
      <td>11</td>
      <td>18.929521</td>
      <td>0.448806</td>
      <td>0.231845</td>
    </tr>
    <tr>
      <th>43</th>
      <td>Regresión Lasso</td>
      <td>28</td>
      <td>11</td>
      <td>16.912574</td>
      <td>0.424228</td>
      <td>0.760285</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datalasso</span><span class="p">[</span><span class="n">datalasso</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">12</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>44</th>
      <td>Regresión Lasso</td>
      <td>7</td>
      <td>12</td>
      <td>15.170128</td>
      <td>0.323862</td>
      <td>0.760564</td>
    </tr>
    <tr>
      <th>45</th>
      <td>Regresión Lasso</td>
      <td>14</td>
      <td>12</td>
      <td>21.781708</td>
      <td>0.430762</td>
      <td>0.576410</td>
    </tr>
    <tr>
      <th>46</th>
      <td>Regresión Lasso</td>
      <td>21</td>
      <td>12</td>
      <td>16.165107</td>
      <td>0.438918</td>
      <td>0.402605</td>
    </tr>
    <tr>
      <th>47</th>
      <td>Regresión Lasso</td>
      <td>28</td>
      <td>12</td>
      <td>16.784509</td>
      <td>0.413283</td>
      <td>0.759691</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datalasso</span><span class="p">[</span><span class="n">datalasso</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">13</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>48</th>
      <td>Regresión Lasso</td>
      <td>7</td>
      <td>13</td>
      <td>15.177607</td>
      <td>0.323928</td>
      <td>0.760466</td>
    </tr>
    <tr>
      <th>49</th>
      <td>Regresión Lasso</td>
      <td>14</td>
      <td>13</td>
      <td>10.984037</td>
      <td>0.411266</td>
      <td>0.781241</td>
    </tr>
    <tr>
      <th>50</th>
      <td>Regresión Lasso</td>
      <td>21</td>
      <td>13</td>
      <td>24.309155</td>
      <td>0.452298</td>
      <td>0.532996</td>
    </tr>
    <tr>
      <th>51</th>
      <td>Regresión Lasso</td>
      <td>28</td>
      <td>13</td>
      <td>16.604959</td>
      <td>0.410531</td>
      <td>0.754634</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datalasso</span><span class="p">[</span><span class="n">datalasso</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">14</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>52</th>
      <td>Regresión Lasso</td>
      <td>7</td>
      <td>14</td>
      <td>17.125563</td>
      <td>0.339163</td>
      <td>0.756081</td>
    </tr>
    <tr>
      <th>53</th>
      <td>Regresión Lasso</td>
      <td>14</td>
      <td>14</td>
      <td>15.329025</td>
      <td>0.445802</td>
      <td>0.843562</td>
    </tr>
    <tr>
      <th>54</th>
      <td>Regresión Lasso</td>
      <td>21</td>
      <td>14</td>
      <td>32.132686</td>
      <td>0.450928</td>
      <td>0.558615</td>
    </tr>
    <tr>
      <th>55</th>
      <td>Regresión Lasso</td>
      <td>28</td>
      <td>14</td>
      <td>28.571181</td>
      <td>0.440404</td>
      <td>0.617075</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datalasso</span><span class="p">[</span><span class="n">datalasso</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">15</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>56</th>
      <td>Regresión Lasso</td>
      <td>7</td>
      <td>15</td>
      <td>17.787283</td>
      <td>0.341383</td>
      <td>0.769785</td>
    </tr>
    <tr>
      <th>57</th>
      <td>Regresión Lasso</td>
      <td>14</td>
      <td>15</td>
      <td>11.603499</td>
      <td>0.452397</td>
      <td>0.709240</td>
    </tr>
    <tr>
      <th>58</th>
      <td>Regresión Lasso</td>
      <td>21</td>
      <td>15</td>
      <td>20.048753</td>
      <td>0.439120</td>
      <td>0.198819</td>
    </tr>
    <tr>
      <th>59</th>
      <td>Regresión Lasso</td>
      <td>28</td>
      <td>15</td>
      <td>30.537625</td>
      <td>0.454461</td>
      <td>0.609237</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datalasso</span><span class="p">[</span><span class="n">datalasso</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">16</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>60</th>
      <td>Regresión Lasso</td>
      <td>7</td>
      <td>16</td>
      <td>19.780019</td>
      <td>0.399856</td>
      <td>0.752589</td>
    </tr>
    <tr>
      <th>61</th>
      <td>Regresión Lasso</td>
      <td>14</td>
      <td>16</td>
      <td>11.308627</td>
      <td>0.418011</td>
      <td>0.717595</td>
    </tr>
    <tr>
      <th>62</th>
      <td>Regresión Lasso</td>
      <td>21</td>
      <td>16</td>
      <td>29.969346</td>
      <td>0.420054</td>
      <td>0.688845</td>
    </tr>
    <tr>
      <th>63</th>
      <td>Regresión Lasso</td>
      <td>28</td>
      <td>16</td>
      <td>15.861101</td>
      <td>0.424505</td>
      <td>0.755286</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datalasso</span><span class="p">[</span><span class="n">datalasso</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">17</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>64</th>
      <td>Regresión Lasso</td>
      <td>7</td>
      <td>17</td>
      <td>12.792681</td>
      <td>0.426477</td>
      <td>0.319667</td>
    </tr>
    <tr>
      <th>65</th>
      <td>Regresión Lasso</td>
      <td>14</td>
      <td>17</td>
      <td>21.598331</td>
      <td>0.391981</td>
      <td>0.668929</td>
    </tr>
    <tr>
      <th>66</th>
      <td>Regresión Lasso</td>
      <td>21</td>
      <td>17</td>
      <td>22.982435</td>
      <td>0.410214</td>
      <td>0.637413</td>
    </tr>
    <tr>
      <th>67</th>
      <td>Regresión Lasso</td>
      <td>28</td>
      <td>17</td>
      <td>20.433908</td>
      <td>0.375944</td>
      <td>0.695464</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datalasso</span><span class="p">[</span><span class="n">datalasso</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">18</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>68</th>
      <td>Regresión Lasso</td>
      <td>7</td>
      <td>18</td>
      <td>18.686540</td>
      <td>0.439007</td>
      <td>0.638637</td>
    </tr>
    <tr>
      <th>69</th>
      <td>Regresión Lasso</td>
      <td>14</td>
      <td>18</td>
      <td>20.109894</td>
      <td>0.381775</td>
      <td>0.667473</td>
    </tr>
    <tr>
      <th>70</th>
      <td>Regresión Lasso</td>
      <td>21</td>
      <td>18</td>
      <td>21.396307</td>
      <td>0.398646</td>
      <td>0.637433</td>
    </tr>
    <tr>
      <th>71</th>
      <td>Regresión Lasso</td>
      <td>28</td>
      <td>18</td>
      <td>19.000035</td>
      <td>0.366928</td>
      <td>0.692834</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datalasso</span><span class="p">[</span><span class="n">datalasso</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">19</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>72</th>
      <td>Regresión Lasso</td>
      <td>7</td>
      <td>19</td>
      <td>14.150000</td>
      <td>0.443148</td>
      <td>0.379818</td>
    </tr>
    <tr>
      <th>73</th>
      <td>Regresión Lasso</td>
      <td>14</td>
      <td>19</td>
      <td>20.632178</td>
      <td>0.385675</td>
      <td>0.660966</td>
    </tr>
    <tr>
      <th>74</th>
      <td>Regresión Lasso</td>
      <td>21</td>
      <td>19</td>
      <td>29.040652</td>
      <td>0.399496</td>
      <td>0.726787</td>
    </tr>
    <tr>
      <th>75</th>
      <td>Regresión Lasso</td>
      <td>28</td>
      <td>19</td>
      <td>19.533081</td>
      <td>0.372554</td>
      <td>0.683642</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datalasso</span><span class="p">[</span><span class="n">datalasso</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">20</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>76</th>
      <td>Regresión Lasso</td>
      <td>7</td>
      <td>20</td>
      <td>13.806126</td>
      <td>0.426039</td>
      <td>0.347219</td>
    </tr>
    <tr>
      <th>77</th>
      <td>Regresión Lasso</td>
      <td>14</td>
      <td>20</td>
      <td>13.900010</td>
      <td>0.418930</td>
      <td>0.368822</td>
    </tr>
    <tr>
      <th>78</th>
      <td>Regresión Lasso</td>
      <td>21</td>
      <td>20</td>
      <td>29.704581</td>
      <td>0.413583</td>
      <td>0.707180</td>
    </tr>
    <tr>
      <th>79</th>
      <td>Regresión Lasso</td>
      <td>28</td>
      <td>20</td>
      <td>20.070258</td>
      <td>0.412628</td>
      <td>0.653399</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datalasso</span><span class="p">[</span><span class="n">datalasso</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">21</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>80</th>
      <td>Regresión Lasso</td>
      <td>7</td>
      <td>21</td>
      <td>29.202370</td>
      <td>0.420930</td>
      <td>0.873416</td>
    </tr>
    <tr>
      <th>81</th>
      <td>Regresión Lasso</td>
      <td>14</td>
      <td>21</td>
      <td>14.577646</td>
      <td>0.426938</td>
      <td>0.361331</td>
    </tr>
    <tr>
      <th>82</th>
      <td>Regresión Lasso</td>
      <td>21</td>
      <td>21</td>
      <td>16.710045</td>
      <td>0.412000</td>
      <td>0.269045</td>
    </tr>
    <tr>
      <th>83</th>
      <td>Regresión Lasso</td>
      <td>28</td>
      <td>21</td>
      <td>17.818840</td>
      <td>0.428843</td>
      <td>0.208060</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datalasso</span><span class="p">[</span><span class="n">datalasso</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">22</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>84</th>
      <td>Regresión Lasso</td>
      <td>7</td>
      <td>22</td>
      <td>18.907391</td>
      <td>0.404422</td>
      <td>0.603431</td>
    </tr>
    <tr>
      <th>85</th>
      <td>Regresión Lasso</td>
      <td>14</td>
      <td>22</td>
      <td>31.979701</td>
      <td>0.404536</td>
      <td>0.881733</td>
    </tr>
    <tr>
      <th>86</th>
      <td>Regresión Lasso</td>
      <td>21</td>
      <td>22</td>
      <td>14.453964</td>
      <td>0.388631</td>
      <td>0.186044</td>
    </tr>
    <tr>
      <th>87</th>
      <td>Regresión Lasso</td>
      <td>28</td>
      <td>22</td>
      <td>15.112589</td>
      <td>0.391008</td>
      <td>0.176058</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datalasso</span><span class="p">[</span><span class="n">datalasso</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">23</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>88</th>
      <td>Regresión Lasso</td>
      <td>7</td>
      <td>23</td>
      <td>28.156628</td>
      <td>0.411089</td>
      <td>0.877318</td>
    </tr>
    <tr>
      <th>89</th>
      <td>Regresión Lasso</td>
      <td>14</td>
      <td>23</td>
      <td>19.196821</td>
      <td>0.407402</td>
      <td>0.719740</td>
    </tr>
    <tr>
      <th>90</th>
      <td>Regresión Lasso</td>
      <td>21</td>
      <td>23</td>
      <td>20.219205</td>
      <td>0.417194</td>
      <td>0.706105</td>
    </tr>
    <tr>
      <th>91</th>
      <td>Regresión Lasso</td>
      <td>28</td>
      <td>23</td>
      <td>15.071364</td>
      <td>0.432371</td>
      <td>0.322895</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datalasso</span><span class="p">[</span><span class="n">datalasso</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">24</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>92</th>
      <td>Regresión Lasso</td>
      <td>7</td>
      <td>24</td>
      <td>25.203271</td>
      <td>0.379640</td>
      <td>0.891418</td>
    </tr>
    <tr>
      <th>93</th>
      <td>Regresión Lasso</td>
      <td>14</td>
      <td>24</td>
      <td>31.139665</td>
      <td>0.402607</td>
      <td>0.877882</td>
    </tr>
    <tr>
      <th>94</th>
      <td>Regresión Lasso</td>
      <td>21</td>
      <td>24</td>
      <td>23.146897</td>
      <td>0.426096</td>
      <td>0.717961</td>
    </tr>
    <tr>
      <th>95</th>
      <td>Regresión Lasso</td>
      <td>28</td>
      <td>24</td>
      <td>15.416113</td>
      <td>0.466937</td>
      <td>0.387238</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<section id="id3">
<h4><strong>MEJOR MODELO - CADA HORA</strong><a class="headerlink" href="#id3" title="Link to this heading">#</a></h4>
<p>Ahora mostraremos el  mejor modelo de cada hora.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mejorlassohora</span> <span class="o">=</span> <span class="n">mejormodelohora</span><span class="p">(</span><span class="n">particiones</span><span class="p">,</span> <span class="n">datalasso</span><span class="p">)</span>
<span class="n">mejorlassohora</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Regresión Lasso</td>
      <td>7</td>
      <td>1</td>
      <td>16.828920</td>
      <td>0.368981</td>
      <td>0.452636</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Regresión Lasso</td>
      <td>7</td>
      <td>2</td>
      <td>16.526000</td>
      <td>0.368618</td>
      <td>0.432809</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Regresión Lasso</td>
      <td>7</td>
      <td>3</td>
      <td>16.685253</td>
      <td>0.374123</td>
      <td>0.421321</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Regresión Lasso</td>
      <td>21</td>
      <td>4</td>
      <td>9.658325</td>
      <td>0.311801</td>
      <td>0.917019</td>
    </tr>
    <tr>
      <th>18</th>
      <td>Regresión Lasso</td>
      <td>21</td>
      <td>5</td>
      <td>9.624911</td>
      <td>0.317652</td>
      <td>0.909862</td>
    </tr>
    <tr>
      <th>20</th>
      <td>Regresión Lasso</td>
      <td>7</td>
      <td>6</td>
      <td>13.915467</td>
      <td>0.305140</td>
      <td>0.782162</td>
    </tr>
    <tr>
      <th>24</th>
      <td>Regresión Lasso</td>
      <td>7</td>
      <td>7</td>
      <td>12.610870</td>
      <td>0.300416</td>
      <td>0.913486</td>
    </tr>
    <tr>
      <th>28</th>
      <td>Regresión Lasso</td>
      <td>7</td>
      <td>8</td>
      <td>13.843998</td>
      <td>0.307299</td>
      <td>0.777806</td>
    </tr>
    <tr>
      <th>32</th>
      <td>Regresión Lasso</td>
      <td>7</td>
      <td>9</td>
      <td>15.184648</td>
      <td>0.323291</td>
      <td>0.760334</td>
    </tr>
    <tr>
      <th>36</th>
      <td>Regresión Lasso</td>
      <td>7</td>
      <td>10</td>
      <td>14.958624</td>
      <td>0.321976</td>
      <td>0.767246</td>
    </tr>
    <tr>
      <th>40</th>
      <td>Regresión Lasso</td>
      <td>7</td>
      <td>11</td>
      <td>15.325772</td>
      <td>0.323349</td>
      <td>0.768434</td>
    </tr>
    <tr>
      <th>44</th>
      <td>Regresión Lasso</td>
      <td>7</td>
      <td>12</td>
      <td>15.170128</td>
      <td>0.323862</td>
      <td>0.760564</td>
    </tr>
    <tr>
      <th>48</th>
      <td>Regresión Lasso</td>
      <td>7</td>
      <td>13</td>
      <td>15.177607</td>
      <td>0.323928</td>
      <td>0.760466</td>
    </tr>
    <tr>
      <th>52</th>
      <td>Regresión Lasso</td>
      <td>7</td>
      <td>14</td>
      <td>17.125563</td>
      <td>0.339163</td>
      <td>0.756081</td>
    </tr>
    <tr>
      <th>56</th>
      <td>Regresión Lasso</td>
      <td>7</td>
      <td>15</td>
      <td>17.787283</td>
      <td>0.341383</td>
      <td>0.769785</td>
    </tr>
    <tr>
      <th>60</th>
      <td>Regresión Lasso</td>
      <td>7</td>
      <td>16</td>
      <td>19.780019</td>
      <td>0.399856</td>
      <td>0.752589</td>
    </tr>
    <tr>
      <th>67</th>
      <td>Regresión Lasso</td>
      <td>28</td>
      <td>17</td>
      <td>20.433908</td>
      <td>0.375944</td>
      <td>0.695464</td>
    </tr>
    <tr>
      <th>71</th>
      <td>Regresión Lasso</td>
      <td>28</td>
      <td>18</td>
      <td>19.000035</td>
      <td>0.366928</td>
      <td>0.692834</td>
    </tr>
    <tr>
      <th>75</th>
      <td>Regresión Lasso</td>
      <td>28</td>
      <td>19</td>
      <td>19.533081</td>
      <td>0.372554</td>
      <td>0.683642</td>
    </tr>
    <tr>
      <th>79</th>
      <td>Regresión Lasso</td>
      <td>28</td>
      <td>20</td>
      <td>20.070258</td>
      <td>0.412628</td>
      <td>0.653399</td>
    </tr>
    <tr>
      <th>82</th>
      <td>Regresión Lasso</td>
      <td>21</td>
      <td>21</td>
      <td>16.710045</td>
      <td>0.412000</td>
      <td>0.269045</td>
    </tr>
    <tr>
      <th>86</th>
      <td>Regresión Lasso</td>
      <td>21</td>
      <td>22</td>
      <td>14.453964</td>
      <td>0.388631</td>
      <td>0.186044</td>
    </tr>
    <tr>
      <th>89</th>
      <td>Regresión Lasso</td>
      <td>14</td>
      <td>23</td>
      <td>19.196821</td>
      <td>0.407402</td>
      <td>0.719740</td>
    </tr>
    <tr>
      <th>92</th>
      <td>Regresión Lasso</td>
      <td>7</td>
      <td>24</td>
      <td>25.203271</td>
      <td>0.379640</td>
      <td>0.891418</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="hora-y-ventana-con-mejor-modelo-lasso">
<h4><strong>HORA Y VENTANA CON MEJOR MODELO LASSO</strong><a class="headerlink" href="#hora-y-ventana-con-mejor-modelo-lasso" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bestlasso</span> <span class="o">=</span> <span class="n">mejormodelotot</span><span class="p">(</span><span class="n">mejorlassohora</span><span class="p">)</span>
<span class="n">bestlasso</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>24</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Modelo</th>
      <td>Regresión Lasso</td>
    </tr>
    <tr>
      <th>Dias</th>
      <td>7</td>
    </tr>
    <tr>
      <th>Hora</th>
      <td>7</td>
    </tr>
    <tr>
      <th>MAPE</th>
      <td>12.61087</td>
    </tr>
    <tr>
      <th>RMSE</th>
      <td>0.300416</td>
    </tr>
    <tr>
      <th>R^2</th>
      <td>0.913486</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Es decir, para la <strong>Regresión Lasso</strong>, el mejor modelo se da cuando se trabaja con la <strong>HORA</strong>: <code class="docutils literal notranslate"><span class="pre">7</span></code> en la venta de predicción de <code class="docutils literal notranslate"><span class="pre">7</span> <span class="pre">días</span></code>. Veamos los valores de <strong>Ljung-Box p-value</strong> y <strong>Jarque-Bera p-value</strong>. Antes de ello, veamos cuáles son las pruebas de hipótesis para comprender mejor los p-valores que se nos arrojen.</p>
<ul class="simple">
<li><p><strong>Prueba de Ljung-Box</strong></p></li>
</ul>
<ul class="simple">
<li><p><strong>Hipótesis nula (H₀)</strong>: No hay autocorrelación en los residuos (es decir, los residuos son independientes entre sí).</p></li>
<li><p><strong>Hipótesis alternativa (H₁)</strong>: Hay autocorrelación en los residuos</p></li>
</ul>
<ul class="simple">
<li><p><strong>Prueba de Jarque-Bera</strong></p></li>
</ul>
<ul class="simple">
<li><p><strong>Hipótesis nula (H₀)</strong>: Los residuos tienen una distribución normal.</p></li>
<li><p><strong>Hipótesis alternativa (H₁)</strong>: Los residuos no tienen una distribución normal.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">metricas</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">dias</span> <span class="o">=</span> <span class="mi">7</span>
<span class="n">hora</span> <span class="o">=</span> <span class="mi">7</span>
<span class="n">iniciotrain</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">while</span> <span class="p">(</span><span class="n">iniciotrain</span> <span class="o">+</span> <span class="p">(</span><span class="n">dias</span> <span class="o">*</span> <span class="mi">24</span><span class="p">)</span> <span class="o">+</span> <span class="n">hora</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">):</span>  <span class="c1"># Mientras que el tamaño del pliegue más la hora sea menor que la longitud de los datos</span>
    <span class="n">fintrain</span> <span class="o">=</span> <span class="n">iniciotrain</span> <span class="o">+</span> <span class="p">(</span><span class="n">dias</span> <span class="o">*</span> <span class="mi">24</span><span class="p">)</span>   
    <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">plieguess</span><span class="p">(</span><span class="n">iniciotrain</span><span class="p">,</span> <span class="n">fintrain</span><span class="p">,</span> <span class="n">hora</span><span class="p">)</span>   
    <span class="n">modelolasso</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
    <span class="n">y_prediccion</span><span class="o">=</span> <span class="n">modelolasso</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>       
    <span class="n">rmse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">,</span> <span class="n">squared</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">mape</span> <span class="o">=</span> <span class="n">MAPE</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">)</span>
    <span class="n">r2</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">)</span>
    <span class="n">ljungbox</span><span class="p">,</span> <span class="n">jarquebera</span> <span class="o">=</span> <span class="n">residuos</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">)</span>   
    <span class="n">metricas</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
        <span class="s1">&#39;Modelo&#39;</span><span class="p">:</span> <span class="s1">&#39;Regresión Lasso&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Dias&#39;</span><span class="p">:</span> <span class="n">dias</span><span class="p">,</span>
        <span class="s1">&#39;Hora&#39;</span><span class="p">:</span> <span class="n">hora</span><span class="p">,</span>
        <span class="s1">&#39;MAPE&#39;</span><span class="p">:</span> <span class="n">mape</span><span class="p">,</span>
        <span class="s1">&#39;RMSE&#39;</span><span class="p">:</span> <span class="n">rmse</span><span class="p">,</span>
        <span class="s1">&#39;R^2&#39;</span><span class="p">:</span> <span class="n">r2</span><span class="p">,</span>
        <span class="s1">&#39;Ljung-Box p-value&#39;</span> <span class="p">:</span> <span class="n">ljungbox</span><span class="p">,</span>
        <span class="s1">&#39;Jarque-Bera p-value&#39;</span> <span class="p">:</span> <span class="n">jarquebera</span>
    <span class="p">})</span>   
    <span class="n">iniciotrain</span> <span class="o">=</span> <span class="n">fintrain</span>  <span class="c1"># Actualizar el inicio para el siguiente pliegue</span>
<span class="n">datalasso</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">metricas</span><span class="p">)</span>
<span class="n">datalasso</span> <span class="o">=</span> <span class="n">datalasso</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">datalasso</span><span class="p">[</span><span class="s1">&#39;RMSE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">idxmin</span><span class="p">()]</span>
<span class="n">datalasso</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">datalasso</span><span class="p">)</span>
<span class="n">datalasso</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>92</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Modelo</th>
      <td>Regresión Lasso</td>
    </tr>
    <tr>
      <th>Dias</th>
      <td>7</td>
    </tr>
    <tr>
      <th>Hora</th>
      <td>7</td>
    </tr>
    <tr>
      <th>MAPE</th>
      <td>12.61087</td>
    </tr>
    <tr>
      <th>RMSE</th>
      <td>0.300416</td>
    </tr>
    <tr>
      <th>R^2</th>
      <td>0.913486</td>
    </tr>
    <tr>
      <th>Ljung-Box p-value</th>
      <td>0.298656</td>
    </tr>
    <tr>
      <th>Jarque-Bera p-value</th>
      <td>0.110608</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>En este sentido, sobre el modelo de regresión lasso, podemos afirmar que el mejor modelo identificado tiene un <strong>MAPE</strong> de <code class="docutils literal notranslate"><span class="pre">12.61%</span></code>, lo que indica que, en promedio, las predicciones presentan una desviación porcentual consistente con respecto a los valores reales. El <strong>RMSE</strong> es de <code class="docutils literal notranslate"><span class="pre">0.3</span></code>, lo que significa que el error promedio en las predicciones es bajo, y el modelo está prediciendo con bastante precisión. Además, el <strong>R²</strong> de <code class="docutils literal notranslate"><span class="pre">0.913486</span></code> muestra que el modelo explica aproximadamente el <code class="docutils literal notranslate"><span class="pre">91.35%</span></code> de la variabilidad de los datos.</p>
<p>Respecto a los residuos, el <strong>p-valor</strong> de la prueba de <strong>Ljung-Box</strong> es <code class="docutils literal notranslate"><span class="pre">0.29</span></code>, lo que indica que no hay autocorrelación significativa, lo cual es positivo ya que significa que los residuos son independientes. Por otro lado, el <strong>p-valor</strong> de la prueba de <strong>Jarque-Bera</strong> es <code class="docutils literal notranslate"><span class="pre">0.11</span></code>, lo que sugiere que no se puede rechazar la hipótesis de normalidad de los residuos, lo cual es deseable para validar las inferencias del modelo.</p>
</section>
</section>
<section id="modelo-decision-tree">
<h3><strong>MODELO DECISION TREE</strong><a class="headerlink" href="#modelo-decision-tree" title="Link to this heading">#</a></h3>
<p>Primeramente se entrena el modelo y predice. Se imprimen las tablas que contienen las métricas predeterminadas para cada una de las 24 horas.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">modelodectree</span> <span class="o">=</span> <span class="n">DecisionTreeRegressor</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">21</span><span class="p">)</span>
<span class="n">metricas</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">hora</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">25</span><span class="p">):</span>  <span class="c1"># Ciclo para calcular la tabla de errores para cada hora (puedes extender hasta 24)   </span>
    <span class="k">for</span> <span class="n">dias</span> <span class="ow">in</span> <span class="n">particiones</span><span class="p">:</span>  <span class="c1"># Ciclo que recorre las particiones para las ventanas        </span>
        <span class="n">iniciotrain</span> <span class="o">=</span> <span class="mi">0</span>        
        <span class="k">while</span> <span class="p">(</span><span class="n">iniciotrain</span> <span class="o">+</span> <span class="p">(</span><span class="n">dias</span> <span class="o">*</span> <span class="mi">24</span><span class="p">)</span> <span class="o">+</span> <span class="n">hora</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">):</span>  <span class="c1"># Mientras que el tamaño del pliegue más la hora sea menor que la longitud de los datos           </span>
            <span class="n">fintrain</span> <span class="o">=</span> <span class="n">iniciotrain</span> <span class="o">+</span> <span class="p">(</span><span class="n">dias</span> <span class="o">*</span> <span class="mi">24</span><span class="p">)</span>            
            <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">plieguess</span><span class="p">(</span><span class="n">iniciotrain</span><span class="p">,</span><span class="n">fintrain</span><span class="p">,</span><span class="n">hora</span><span class="p">)</span>          
            <span class="n">modelodectree</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
            <span class="n">y_prediccion</span><span class="o">=</span> <span class="n">modelodectree</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>               
            <span class="n">rmse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">,</span> <span class="n">squared</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="n">mape</span> <span class="o">=</span> <span class="n">MAPE</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">)</span>
            <span class="n">r2</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">)</span>
            <span class="n">metricas</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
                <span class="s1">&#39;Modelo&#39;</span><span class="p">:</span> <span class="s1">&#39;Dec. Tree Regressor&#39;</span><span class="p">,</span>
                <span class="s1">&#39;Dias&#39;</span><span class="p">:</span> <span class="n">dias</span><span class="p">,</span>
                <span class="s1">&#39;Hora&#39;</span><span class="p">:</span> <span class="n">hora</span><span class="p">,</span>
                <span class="s1">&#39;MAPE&#39;</span><span class="p">:</span> <span class="n">mape</span><span class="p">,</span>
                <span class="s1">&#39;RMSE&#39;</span><span class="p">:</span> <span class="n">rmse</span><span class="p">,</span>
                <span class="s1">&#39;R^2&#39;</span><span class="p">:</span> <span class="n">r2</span><span class="p">,</span>
            <span class="p">})</span>           
            <span class="n">iniciotrain</span> <span class="o">=</span> <span class="n">fintrain</span>  <span class="c1"># Actualizar el inicio para el siguiente pliegue</span>
<span class="n">datadectree</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">metricas</span><span class="p">)</span>
<span class="n">datadectree</span> <span class="o">=</span> <span class="n">datadectree</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">datadectree</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;Modelo&#39;</span><span class="p">,</span> <span class="s1">&#39;Hora&#39;</span><span class="p">,</span> <span class="s1">&#39;Dias&#39;</span><span class="p">])[</span><span class="s1">&#39;RMSE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">idxmin</span><span class="p">()]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datadectree</span><span class="p">[</span><span class="n">datadectree</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Dec. Tree Regressor</td>
      <td>7</td>
      <td>1</td>
      <td>11.725944</td>
      <td>0.409268</td>
      <td>0.792565</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Dec. Tree Regressor</td>
      <td>14</td>
      <td>1</td>
      <td>23.220771</td>
      <td>0.421307</td>
      <td>0.812541</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Dec. Tree Regressor</td>
      <td>21</td>
      <td>1</td>
      <td>12.435881</td>
      <td>0.432531</td>
      <td>0.837984</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Dec. Tree Regressor</td>
      <td>28</td>
      <td>1</td>
      <td>14.621119</td>
      <td>0.407738</td>
      <td>0.652389</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datadectree</span><span class="p">[</span><span class="n">datadectree</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>4</th>
      <td>Dec. Tree Regressor</td>
      <td>7</td>
      <td>2</td>
      <td>12.162452</td>
      <td>0.413824</td>
      <td>0.795709</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Dec. Tree Regressor</td>
      <td>14</td>
      <td>2</td>
      <td>22.580440</td>
      <td>0.401559</td>
      <td>0.830036</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Dec. Tree Regressor</td>
      <td>21</td>
      <td>2</td>
      <td>15.079916</td>
      <td>0.478714</td>
      <td>0.596466</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Dec. Tree Regressor</td>
      <td>28</td>
      <td>2</td>
      <td>14.046406</td>
      <td>0.382426</td>
      <td>0.694206</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datadectree</span><span class="p">[</span><span class="n">datadectree</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">3</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>8</th>
      <td>Dec. Tree Regressor</td>
      <td>7</td>
      <td>3</td>
      <td>11.637090</td>
      <td>0.403629</td>
      <td>0.800912</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Dec. Tree Regressor</td>
      <td>14</td>
      <td>3</td>
      <td>19.756365</td>
      <td>0.333542</td>
      <td>0.881850</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Dec. Tree Regressor</td>
      <td>21</td>
      <td>3</td>
      <td>15.542879</td>
      <td>0.478714</td>
      <td>0.660459</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Dec. Tree Regressor</td>
      <td>28</td>
      <td>3</td>
      <td>13.451168</td>
      <td>0.364577</td>
      <td>0.722085</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datadectree</span><span class="p">[</span><span class="n">datadectree</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">4</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>12</th>
      <td>Dec. Tree Regressor</td>
      <td>7</td>
      <td>4</td>
      <td>9.399816</td>
      <td>0.369685</td>
      <td>0.808560</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Dec. Tree Regressor</td>
      <td>14</td>
      <td>4</td>
      <td>19.728588</td>
      <td>0.340955</td>
      <td>0.874829</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Dec. Tree Regressor</td>
      <td>21</td>
      <td>4</td>
      <td>40.028767</td>
      <td>0.479149</td>
      <td>0.232190</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Dec. Tree Regressor</td>
      <td>28</td>
      <td>4</td>
      <td>13.696266</td>
      <td>0.366856</td>
      <td>0.744251</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datadectree</span><span class="p">[</span><span class="n">datadectree</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">5</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>16</th>
      <td>Dec. Tree Regressor</td>
      <td>7</td>
      <td>5</td>
      <td>16.873601</td>
      <td>0.382971</td>
      <td>0.830157</td>
    </tr>
    <tr>
      <th>17</th>
      <td>Dec. Tree Regressor</td>
      <td>14</td>
      <td>5</td>
      <td>19.614171</td>
      <td>0.340955</td>
      <td>0.875258</td>
    </tr>
    <tr>
      <th>18</th>
      <td>Dec. Tree Regressor</td>
      <td>21</td>
      <td>5</td>
      <td>37.862101</td>
      <td>0.476970</td>
      <td>0.354578</td>
    </tr>
    <tr>
      <th>19</th>
      <td>Dec. Tree Regressor</td>
      <td>28</td>
      <td>5</td>
      <td>14.423780</td>
      <td>0.388909</td>
      <td>0.698495</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datadectree</span><span class="p">[</span><span class="n">datadectree</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">6</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>20</th>
      <td>Dec. Tree Regressor</td>
      <td>7</td>
      <td>6</td>
      <td>16.573887</td>
      <td>0.380789</td>
      <td>0.829690</td>
    </tr>
    <tr>
      <th>21</th>
      <td>Dec. Tree Regressor</td>
      <td>14</td>
      <td>6</td>
      <td>20.177234</td>
      <td>0.355903</td>
      <td>0.877715</td>
    </tr>
    <tr>
      <th>22</th>
      <td>Dec. Tree Regressor</td>
      <td>21</td>
      <td>6</td>
      <td>37.732790</td>
      <td>0.478278</td>
      <td>0.504513</td>
    </tr>
    <tr>
      <th>23</th>
      <td>Dec. Tree Regressor</td>
      <td>28</td>
      <td>6</td>
      <td>14.799720</td>
      <td>0.393171</td>
      <td>0.688224</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datadectree</span><span class="p">[</span><span class="n">datadectree</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">7</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>24</th>
      <td>Dec. Tree Regressor</td>
      <td>7</td>
      <td>7</td>
      <td>10.386900</td>
      <td>0.344601</td>
      <td>0.835541</td>
    </tr>
    <tr>
      <th>25</th>
      <td>Dec. Tree Regressor</td>
      <td>14</td>
      <td>7</td>
      <td>16.151280</td>
      <td>0.494554</td>
      <td>0.646386</td>
    </tr>
    <tr>
      <th>26</th>
      <td>Dec. Tree Regressor</td>
      <td>21</td>
      <td>7</td>
      <td>37.004923</td>
      <td>0.473022</td>
      <td>0.637489</td>
    </tr>
    <tr>
      <th>27</th>
      <td>Dec. Tree Regressor</td>
      <td>28</td>
      <td>7</td>
      <td>14.502100</td>
      <td>0.390512</td>
      <td>0.685927</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datadectree</span><span class="p">[</span><span class="n">datadectree</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">8</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>28</th>
      <td>Dec. Tree Regressor</td>
      <td>7</td>
      <td>8</td>
      <td>10.930378</td>
      <td>0.350000</td>
      <td>0.834506</td>
    </tr>
    <tr>
      <th>29</th>
      <td>Dec. Tree Regressor</td>
      <td>14</td>
      <td>8</td>
      <td>11.748805</td>
      <td>0.494975</td>
      <td>0.706855</td>
    </tr>
    <tr>
      <th>30</th>
      <td>Dec. Tree Regressor</td>
      <td>21</td>
      <td>8</td>
      <td>34.705140</td>
      <td>0.437798</td>
      <td>0.702842</td>
    </tr>
    <tr>
      <th>31</th>
      <td>Dec. Tree Regressor</td>
      <td>28</td>
      <td>8</td>
      <td>14.444230</td>
      <td>0.390512</td>
      <td>0.676631</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datadectree</span><span class="p">[</span><span class="n">datadectree</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">9</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>32</th>
      <td>Dec. Tree Regressor</td>
      <td>7</td>
      <td>9</td>
      <td>16.534560</td>
      <td>0.373050</td>
      <td>0.812144</td>
    </tr>
    <tr>
      <th>33</th>
      <td>Dec. Tree Regressor</td>
      <td>14</td>
      <td>9</td>
      <td>14.736101</td>
      <td>0.462781</td>
      <td>0.680737</td>
    </tr>
    <tr>
      <th>34</th>
      <td>Dec. Tree Regressor</td>
      <td>21</td>
      <td>9</td>
      <td>33.779214</td>
      <td>0.421802</td>
      <td>0.738117</td>
    </tr>
    <tr>
      <th>35</th>
      <td>Dec. Tree Regressor</td>
      <td>28</td>
      <td>9</td>
      <td>15.254415</td>
      <td>0.403113</td>
      <td>0.649281</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datadectree</span><span class="p">[</span><span class="n">datadectree</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">10</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>36</th>
      <td>Dec. Tree Regressor</td>
      <td>7</td>
      <td>10</td>
      <td>16.867893</td>
      <td>0.375278</td>
      <td>0.808675</td>
    </tr>
    <tr>
      <th>37</th>
      <td>Dec. Tree Regressor</td>
      <td>14</td>
      <td>10</td>
      <td>14.155293</td>
      <td>0.453689</td>
      <td>0.693287</td>
    </tr>
    <tr>
      <th>38</th>
      <td>Dec. Tree Regressor</td>
      <td>21</td>
      <td>10</td>
      <td>44.057201</td>
      <td>0.466369</td>
      <td>0.724950</td>
    </tr>
    <tr>
      <th>39</th>
      <td>Dec. Tree Regressor</td>
      <td>28</td>
      <td>10</td>
      <td>16.131608</td>
      <td>0.411299</td>
      <td>0.634892</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datadectree</span><span class="p">[</span><span class="n">datadectree</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">11</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>40</th>
      <td>Dec. Tree Regressor</td>
      <td>7</td>
      <td>11</td>
      <td>16.952003</td>
      <td>0.378043</td>
      <td>0.809638</td>
    </tr>
    <tr>
      <th>41</th>
      <td>Dec. Tree Regressor</td>
      <td>14</td>
      <td>11</td>
      <td>13.674524</td>
      <td>0.449537</td>
      <td>0.707096</td>
    </tr>
    <tr>
      <th>42</th>
      <td>Dec. Tree Regressor</td>
      <td>21</td>
      <td>11</td>
      <td>17.698217</td>
      <td>0.464130</td>
      <td>0.799764</td>
    </tr>
    <tr>
      <th>43</th>
      <td>Dec. Tree Regressor</td>
      <td>28</td>
      <td>11</td>
      <td>17.057534</td>
      <td>0.411299</td>
      <td>0.680147</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datadectree</span><span class="p">[</span><span class="n">datadectree</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">12</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>44</th>
      <td>Dec. Tree Regressor</td>
      <td>7</td>
      <td>12</td>
      <td>16.850730</td>
      <td>0.376386</td>
      <td>0.800684</td>
    </tr>
    <tr>
      <th>45</th>
      <td>Dec. Tree Regressor</td>
      <td>14</td>
      <td>12</td>
      <td>12.919880</td>
      <td>0.442531</td>
      <td>0.714972</td>
    </tr>
    <tr>
      <th>46</th>
      <td>Dec. Tree Regressor</td>
      <td>21</td>
      <td>12</td>
      <td>28.419637</td>
      <td>0.418330</td>
      <td>0.739103</td>
    </tr>
    <tr>
      <th>47</th>
      <td>Dec. Tree Regressor</td>
      <td>28</td>
      <td>12</td>
      <td>16.984690</td>
      <td>0.413824</td>
      <td>0.644143</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datadectree</span><span class="p">[</span><span class="n">datadectree</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">13</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>48</th>
      <td>Dec. Tree Regressor</td>
      <td>7</td>
      <td>13</td>
      <td>16.601825</td>
      <td>0.371932</td>
      <td>0.798605</td>
    </tr>
    <tr>
      <th>49</th>
      <td>Dec. Tree Regressor</td>
      <td>14</td>
      <td>13</td>
      <td>12.329957</td>
      <td>0.397387</td>
      <td>0.764010</td>
    </tr>
    <tr>
      <th>50</th>
      <td>Dec. Tree Regressor</td>
      <td>21</td>
      <td>13</td>
      <td>26.051916</td>
      <td>0.412816</td>
      <td>0.742761</td>
    </tr>
    <tr>
      <th>51</th>
      <td>Dec. Tree Regressor</td>
      <td>28</td>
      <td>13</td>
      <td>16.071992</td>
      <td>0.406202</td>
      <td>0.633658</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datadectree</span><span class="p">[</span><span class="n">datadectree</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">14</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>52</th>
      <td>Dec. Tree Regressor</td>
      <td>7</td>
      <td>14</td>
      <td>14.292281</td>
      <td>0.385681</td>
      <td>0.808818</td>
    </tr>
    <tr>
      <th>53</th>
      <td>Dec. Tree Regressor</td>
      <td>14</td>
      <td>14</td>
      <td>11.365451</td>
      <td>0.341565</td>
      <td>0.870240</td>
    </tr>
    <tr>
      <th>54</th>
      <td>Dec. Tree Regressor</td>
      <td>21</td>
      <td>14</td>
      <td>26.395967</td>
      <td>0.413320</td>
      <td>0.726636</td>
    </tr>
    <tr>
      <th>55</th>
      <td>Dec. Tree Regressor</td>
      <td>28</td>
      <td>14</td>
      <td>15.545898</td>
      <td>0.398434</td>
      <td>0.658181</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datadectree</span><span class="p">[</span><span class="n">datadectree</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">15</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>56</th>
      <td>Dec. Tree Regressor</td>
      <td>7</td>
      <td>15</td>
      <td>14.097830</td>
      <td>0.385141</td>
      <td>0.740328</td>
    </tr>
    <tr>
      <th>57</th>
      <td>Dec. Tree Regressor</td>
      <td>14</td>
      <td>15</td>
      <td>11.365451</td>
      <td>0.341565</td>
      <td>0.878075</td>
    </tr>
    <tr>
      <th>58</th>
      <td>Dec. Tree Regressor</td>
      <td>21</td>
      <td>15</td>
      <td>28.479301</td>
      <td>0.426712</td>
      <td>0.708634</td>
    </tr>
    <tr>
      <th>59</th>
      <td>Dec. Tree Regressor</td>
      <td>28</td>
      <td>15</td>
      <td>15.930322</td>
      <td>0.401040</td>
      <td>0.670038</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datadectree</span><span class="p">[</span><span class="n">datadectree</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">16</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>60</th>
      <td>Dec. Tree Regressor</td>
      <td>7</td>
      <td>16</td>
      <td>16.346897</td>
      <td>0.410284</td>
      <td>0.578270</td>
    </tr>
    <tr>
      <th>61</th>
      <td>Dec. Tree Regressor</td>
      <td>14</td>
      <td>16</td>
      <td>11.454373</td>
      <td>0.353553</td>
      <td>0.877582</td>
    </tr>
    <tr>
      <th>62</th>
      <td>Dec. Tree Regressor</td>
      <td>21</td>
      <td>16</td>
      <td>28.435887</td>
      <td>0.428174</td>
      <td>0.673742</td>
    </tr>
    <tr>
      <th>63</th>
      <td>Dec. Tree Regressor</td>
      <td>28</td>
      <td>16</td>
      <td>15.977008</td>
      <td>0.401040</td>
      <td>0.680596</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datadectree</span><span class="p">[</span><span class="n">datadectree</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">17</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>64</th>
      <td>Dec. Tree Regressor</td>
      <td>7</td>
      <td>17</td>
      <td>12.714617</td>
      <td>0.415832</td>
      <td>0.794079</td>
    </tr>
    <tr>
      <th>65</th>
      <td>Dec. Tree Regressor</td>
      <td>14</td>
      <td>17</td>
      <td>11.258504</td>
      <td>0.362284</td>
      <td>0.874199</td>
    </tr>
    <tr>
      <th>66</th>
      <td>Dec. Tree Regressor</td>
      <td>21</td>
      <td>17</td>
      <td>14.643225</td>
      <td>0.486056</td>
      <td>0.548432</td>
    </tr>
    <tr>
      <th>67</th>
      <td>Dec. Tree Regressor</td>
      <td>28</td>
      <td>17</td>
      <td>14.819600</td>
      <td>0.382426</td>
      <td>0.709557</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datadectree</span><span class="p">[</span><span class="n">datadectree</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">18</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>68</th>
      <td>Dec. Tree Regressor</td>
      <td>7</td>
      <td>18</td>
      <td>12.533458</td>
      <td>0.414327</td>
      <td>0.795567</td>
    </tr>
    <tr>
      <th>69</th>
      <td>Dec. Tree Regressor</td>
      <td>14</td>
      <td>18</td>
      <td>12.021153</td>
      <td>0.405689</td>
      <td>0.852002</td>
    </tr>
    <tr>
      <th>70</th>
      <td>Dec. Tree Regressor</td>
      <td>21</td>
      <td>18</td>
      <td>35.252415</td>
      <td>0.468597</td>
      <td>0.513819</td>
    </tr>
    <tr>
      <th>71</th>
      <td>Dec. Tree Regressor</td>
      <td>28</td>
      <td>18</td>
      <td>15.504907</td>
      <td>0.416333</td>
      <td>0.648933</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datadectree</span><span class="p">[</span><span class="n">datadectree</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">19</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>72</th>
      <td>Dec. Tree Regressor</td>
      <td>7</td>
      <td>19</td>
      <td>12.392432</td>
      <td>0.410792</td>
      <td>0.799666</td>
    </tr>
    <tr>
      <th>73</th>
      <td>Dec. Tree Regressor</td>
      <td>14</td>
      <td>19</td>
      <td>12.356840</td>
      <td>0.417832</td>
      <td>0.853283</td>
    </tr>
    <tr>
      <th>74</th>
      <td>Dec. Tree Regressor</td>
      <td>21</td>
      <td>19</td>
      <td>17.766490</td>
      <td>0.459166</td>
      <td>0.327686</td>
    </tr>
    <tr>
      <th>75</th>
      <td>Dec. Tree Regressor</td>
      <td>28</td>
      <td>19</td>
      <td>15.833462</td>
      <td>0.423773</td>
      <td>0.663106</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datadectree</span><span class="p">[</span><span class="n">datadectree</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">20</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>76</th>
      <td>Dec. Tree Regressor</td>
      <td>7</td>
      <td>20</td>
      <td>16.215450</td>
      <td>0.420813</td>
      <td>0.781261</td>
    </tr>
    <tr>
      <th>77</th>
      <td>Dec. Tree Regressor</td>
      <td>14</td>
      <td>20</td>
      <td>12.673198</td>
      <td>0.433494</td>
      <td>0.847151</td>
    </tr>
    <tr>
      <th>78</th>
      <td>Dec. Tree Regressor</td>
      <td>21</td>
      <td>20</td>
      <td>17.627601</td>
      <td>0.455064</td>
      <td>0.335413</td>
    </tr>
    <tr>
      <th>79</th>
      <td>Dec. Tree Regressor</td>
      <td>28</td>
      <td>20</td>
      <td>14.806364</td>
      <td>0.399479</td>
      <td>0.768697</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datadectree</span><span class="p">[</span><span class="n">datadectree</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">21</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>80</th>
      <td>Dec. Tree Regressor</td>
      <td>7</td>
      <td>21</td>
      <td>16.570388</td>
      <td>0.431084</td>
      <td>0.771516</td>
    </tr>
    <tr>
      <th>81</th>
      <td>Dec. Tree Regressor</td>
      <td>14</td>
      <td>21</td>
      <td>29.634094</td>
      <td>0.459619</td>
      <td>0.668402</td>
    </tr>
    <tr>
      <th>82</th>
      <td>Dec. Tree Regressor</td>
      <td>21</td>
      <td>21</td>
      <td>17.042317</td>
      <td>0.445346</td>
      <td>0.375294</td>
    </tr>
    <tr>
      <th>83</th>
      <td>Dec. Tree Regressor</td>
      <td>28</td>
      <td>21</td>
      <td>23.507023</td>
      <td>0.464130</td>
      <td>0.856965</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datadectree</span><span class="p">[</span><span class="n">datadectree</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">22</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>84</th>
      <td>Dec. Tree Regressor</td>
      <td>7</td>
      <td>22</td>
      <td>13.862525</td>
      <td>0.447679</td>
      <td>0.796574</td>
    </tr>
    <tr>
      <th>85</th>
      <td>Dec. Tree Regressor</td>
      <td>14</td>
      <td>22</td>
      <td>13.724199</td>
      <td>0.468597</td>
      <td>0.812043</td>
    </tr>
    <tr>
      <th>86</th>
      <td>Dec. Tree Regressor</td>
      <td>21</td>
      <td>22</td>
      <td>17.158058</td>
      <td>0.447679</td>
      <td>0.384386</td>
    </tr>
    <tr>
      <th>87</th>
      <td>Dec. Tree Regressor</td>
      <td>28</td>
      <td>22</td>
      <td>17.007886</td>
      <td>0.435890</td>
      <td>0.763603</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datadectree</span><span class="p">[</span><span class="n">datadectree</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">23</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>88</th>
      <td>Dec. Tree Regressor</td>
      <td>7</td>
      <td>23</td>
      <td>13.508274</td>
      <td>0.434933</td>
      <td>0.818690</td>
    </tr>
    <tr>
      <th>89</th>
      <td>Dec. Tree Regressor</td>
      <td>14</td>
      <td>23</td>
      <td>14.308164</td>
      <td>0.475219</td>
      <td>0.808751</td>
    </tr>
    <tr>
      <th>90</th>
      <td>Dec. Tree Regressor</td>
      <td>21</td>
      <td>23</td>
      <td>18.628646</td>
      <td>0.468152</td>
      <td>0.204988</td>
    </tr>
    <tr>
      <th>91</th>
      <td>Dec. Tree Regressor</td>
      <td>28</td>
      <td>23</td>
      <td>24.353692</td>
      <td>0.460525</td>
      <td>0.864973</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datadectree</span><span class="p">[</span><span class="n">datadectree</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">24</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>92</th>
      <td>Dec. Tree Regressor</td>
      <td>7</td>
      <td>24</td>
      <td>12.992401</td>
      <td>0.405175</td>
      <td>0.852398</td>
    </tr>
    <tr>
      <th>93</th>
      <td>Dec. Tree Regressor</td>
      <td>14</td>
      <td>24</td>
      <td>14.828997</td>
      <td>0.481750</td>
      <td>0.803458</td>
    </tr>
    <tr>
      <th>94</th>
      <td>Dec. Tree Regressor</td>
      <td>21</td>
      <td>24</td>
      <td>18.325616</td>
      <td>0.455979</td>
      <td>0.290521</td>
    </tr>
    <tr>
      <th>95</th>
      <td>Dec. Tree Regressor</td>
      <td>28</td>
      <td>24</td>
      <td>25.395359</td>
      <td>0.444410</td>
      <td>0.882538</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<section id="id4">
<h4><strong>MEJOR MODELO - CADA HORA</strong><a class="headerlink" href="#id4" title="Link to this heading">#</a></h4>
<p>Ahora mostraremos el  mejor modelo de cada hora.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mejordectreehora</span> <span class="o">=</span> <span class="n">mejormodelohora</span><span class="p">(</span><span class="n">particiones</span><span class="p">,</span> <span class="n">datadectree</span><span class="p">)</span>
<span class="n">mejordectreehora</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>3</th>
      <td>Dec. Tree Regressor</td>
      <td>28</td>
      <td>1</td>
      <td>14.621119</td>
      <td>0.407738</td>
      <td>0.652389</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Dec. Tree Regressor</td>
      <td>28</td>
      <td>2</td>
      <td>14.046406</td>
      <td>0.382426</td>
      <td>0.694206</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Dec. Tree Regressor</td>
      <td>14</td>
      <td>3</td>
      <td>19.756365</td>
      <td>0.333542</td>
      <td>0.881850</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Dec. Tree Regressor</td>
      <td>14</td>
      <td>4</td>
      <td>19.728588</td>
      <td>0.340955</td>
      <td>0.874829</td>
    </tr>
    <tr>
      <th>17</th>
      <td>Dec. Tree Regressor</td>
      <td>14</td>
      <td>5</td>
      <td>19.614171</td>
      <td>0.340955</td>
      <td>0.875258</td>
    </tr>
    <tr>
      <th>21</th>
      <td>Dec. Tree Regressor</td>
      <td>14</td>
      <td>6</td>
      <td>20.177234</td>
      <td>0.355903</td>
      <td>0.877715</td>
    </tr>
    <tr>
      <th>24</th>
      <td>Dec. Tree Regressor</td>
      <td>7</td>
      <td>7</td>
      <td>10.386900</td>
      <td>0.344601</td>
      <td>0.835541</td>
    </tr>
    <tr>
      <th>28</th>
      <td>Dec. Tree Regressor</td>
      <td>7</td>
      <td>8</td>
      <td>10.930378</td>
      <td>0.350000</td>
      <td>0.834506</td>
    </tr>
    <tr>
      <th>32</th>
      <td>Dec. Tree Regressor</td>
      <td>7</td>
      <td>9</td>
      <td>16.534560</td>
      <td>0.373050</td>
      <td>0.812144</td>
    </tr>
    <tr>
      <th>36</th>
      <td>Dec. Tree Regressor</td>
      <td>7</td>
      <td>10</td>
      <td>16.867893</td>
      <td>0.375278</td>
      <td>0.808675</td>
    </tr>
    <tr>
      <th>40</th>
      <td>Dec. Tree Regressor</td>
      <td>7</td>
      <td>11</td>
      <td>16.952003</td>
      <td>0.378043</td>
      <td>0.809638</td>
    </tr>
    <tr>
      <th>44</th>
      <td>Dec. Tree Regressor</td>
      <td>7</td>
      <td>12</td>
      <td>16.850730</td>
      <td>0.376386</td>
      <td>0.800684</td>
    </tr>
    <tr>
      <th>48</th>
      <td>Dec. Tree Regressor</td>
      <td>7</td>
      <td>13</td>
      <td>16.601825</td>
      <td>0.371932</td>
      <td>0.798605</td>
    </tr>
    <tr>
      <th>53</th>
      <td>Dec. Tree Regressor</td>
      <td>14</td>
      <td>14</td>
      <td>11.365451</td>
      <td>0.341565</td>
      <td>0.870240</td>
    </tr>
    <tr>
      <th>57</th>
      <td>Dec. Tree Regressor</td>
      <td>14</td>
      <td>15</td>
      <td>11.365451</td>
      <td>0.341565</td>
      <td>0.878075</td>
    </tr>
    <tr>
      <th>61</th>
      <td>Dec. Tree Regressor</td>
      <td>14</td>
      <td>16</td>
      <td>11.454373</td>
      <td>0.353553</td>
      <td>0.877582</td>
    </tr>
    <tr>
      <th>65</th>
      <td>Dec. Tree Regressor</td>
      <td>14</td>
      <td>17</td>
      <td>11.258504</td>
      <td>0.362284</td>
      <td>0.874199</td>
    </tr>
    <tr>
      <th>69</th>
      <td>Dec. Tree Regressor</td>
      <td>14</td>
      <td>18</td>
      <td>12.021153</td>
      <td>0.405689</td>
      <td>0.852002</td>
    </tr>
    <tr>
      <th>72</th>
      <td>Dec. Tree Regressor</td>
      <td>7</td>
      <td>19</td>
      <td>12.392432</td>
      <td>0.410792</td>
      <td>0.799666</td>
    </tr>
    <tr>
      <th>79</th>
      <td>Dec. Tree Regressor</td>
      <td>28</td>
      <td>20</td>
      <td>14.806364</td>
      <td>0.399479</td>
      <td>0.768697</td>
    </tr>
    <tr>
      <th>80</th>
      <td>Dec. Tree Regressor</td>
      <td>7</td>
      <td>21</td>
      <td>16.570388</td>
      <td>0.431084</td>
      <td>0.771516</td>
    </tr>
    <tr>
      <th>87</th>
      <td>Dec. Tree Regressor</td>
      <td>28</td>
      <td>22</td>
      <td>17.007886</td>
      <td>0.435890</td>
      <td>0.763603</td>
    </tr>
    <tr>
      <th>88</th>
      <td>Dec. Tree Regressor</td>
      <td>7</td>
      <td>23</td>
      <td>13.508274</td>
      <td>0.434933</td>
      <td>0.818690</td>
    </tr>
    <tr>
      <th>92</th>
      <td>Dec. Tree Regressor</td>
      <td>7</td>
      <td>24</td>
      <td>12.992401</td>
      <td>0.405175</td>
      <td>0.852398</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="hora-y-ventana-con-mejor-modelo-arbol-de-decision">
<h4><strong>HORA Y VENTANA CON MEJOR MODELO ÁRBOL DE DECISION</strong><a class="headerlink" href="#hora-y-ventana-con-mejor-modelo-arbol-de-decision" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bestdectree</span> <span class="o">=</span> <span class="n">mejormodelotot</span><span class="p">(</span><span class="n">mejordectreehora</span><span class="p">)</span>
<span class="n">bestdectree</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>9</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Modelo</th>
      <td>Dec. Tree Regressor</td>
    </tr>
    <tr>
      <th>Dias</th>
      <td>14</td>
    </tr>
    <tr>
      <th>Hora</th>
      <td>3</td>
    </tr>
    <tr>
      <th>MAPE</th>
      <td>19.756365</td>
    </tr>
    <tr>
      <th>RMSE</th>
      <td>0.333542</td>
    </tr>
    <tr>
      <th>R^2</th>
      <td>0.88185</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Es decir, para la <strong>Regresión de Árbol de decisión</strong>, el mejor modelo se da cuando se trabaja con la <strong>HORA</strong>: <code class="docutils literal notranslate"><span class="pre">3</span></code> en la venta de predicción de <code class="docutils literal notranslate"><span class="pre">14</span> <span class="pre">días</span></code>. Veamos los valores de <strong>Ljung-Box p-value</strong> y <strong>Jarque-Bera p-value</strong>. Antes de ello, veamos cuáles son las pruebas de hipótesis para comprender mejor los p-valores que se nos arrojen.</p>
<ul class="simple">
<li><p><strong>Prueba de Ljung-Box</strong></p></li>
</ul>
<ul class="simple">
<li><p><strong>Hipótesis nula (H₀)</strong>: No hay autocorrelación en los residuos (es decir, los residuos son independientes entre sí).</p></li>
<li><p><strong>Hipótesis alternativa (H₁)</strong>: Hay autocorrelación en los residuos</p></li>
</ul>
<ul class="simple">
<li><p><strong>Prueba de Jarque-Bera</strong></p></li>
</ul>
<ul class="simple">
<li><p><strong>Hipótesis nula (H₀)</strong>: Los residuos tienen una distribución normal.</p></li>
<li><p><strong>Hipótesis alternativa (H₁)</strong>: Los residuos no tienen una distribución normal.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">metricas</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">dias</span> <span class="o">=</span> <span class="mi">14</span>
<span class="n">hora</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">iniciotrain</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">while</span> <span class="p">(</span><span class="n">iniciotrain</span> <span class="o">+</span> <span class="p">(</span><span class="n">dias</span> <span class="o">*</span> <span class="mi">24</span><span class="p">)</span> <span class="o">+</span> <span class="n">hora</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">):</span>  <span class="c1"># Mientras que el tamaño del pliegue más la hora sea menor que la longitud de los datos</span>
    <span class="n">fintrain</span> <span class="o">=</span> <span class="n">iniciotrain</span> <span class="o">+</span> <span class="p">(</span><span class="n">dias</span> <span class="o">*</span> <span class="mi">24</span><span class="p">)</span>   
    <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">plieguess</span><span class="p">(</span><span class="n">iniciotrain</span><span class="p">,</span> <span class="n">fintrain</span><span class="p">,</span> <span class="n">hora</span><span class="p">)</span>   
    <span class="n">modelodectree</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
    <span class="n">y_prediccion</span><span class="o">=</span> <span class="n">modelodectree</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>       
    <span class="n">rmse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">,</span> <span class="n">squared</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">mape</span> <span class="o">=</span> <span class="n">MAPE</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">)</span>
    <span class="n">r2</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">)</span>
    <span class="n">ljungbox</span><span class="p">,</span> <span class="n">jarquebera</span> <span class="o">=</span> <span class="n">residuos</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">)</span>   
    <span class="n">metricas</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
        <span class="s1">&#39;Modelo&#39;</span><span class="p">:</span> <span class="s1">&#39;Regresión de Árboles de decisión&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Dias&#39;</span><span class="p">:</span> <span class="n">dias</span><span class="p">,</span>
        <span class="s1">&#39;Hora&#39;</span><span class="p">:</span> <span class="n">hora</span><span class="p">,</span>
        <span class="s1">&#39;MAPE&#39;</span><span class="p">:</span> <span class="n">mape</span><span class="p">,</span>
        <span class="s1">&#39;RMSE&#39;</span><span class="p">:</span> <span class="n">rmse</span><span class="p">,</span>
        <span class="s1">&#39;R^2&#39;</span><span class="p">:</span> <span class="n">r2</span><span class="p">,</span>
        <span class="s1">&#39;Ljung-Box p-value&#39;</span> <span class="p">:</span> <span class="n">ljungbox</span><span class="p">,</span>
        <span class="s1">&#39;Jarque-Bera p-value&#39;</span> <span class="p">:</span> <span class="n">jarquebera</span>
    <span class="p">})</span>   
    <span class="n">iniciotrain</span> <span class="o">=</span> <span class="n">fintrain</span>  <span class="c1"># Actualizar el inicio para el siguiente pliegue</span>
<span class="n">datadectree</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">metricas</span><span class="p">)</span>
<span class="n">datadectree</span> <span class="o">=</span> <span class="n">datadectree</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">datadectree</span><span class="p">[</span><span class="s1">&#39;RMSE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">idxmin</span><span class="p">()]</span>
<span class="n">datadectree</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">datadectree</span><span class="p">)</span>
<span class="n">datadectree</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>250</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Modelo</th>
      <td>Regresión de Árboles de decisión</td>
    </tr>
    <tr>
      <th>Dias</th>
      <td>14</td>
    </tr>
    <tr>
      <th>Hora</th>
      <td>3</td>
    </tr>
    <tr>
      <th>MAPE</th>
      <td>19.756365</td>
    </tr>
    <tr>
      <th>RMSE</th>
      <td>0.333542</td>
    </tr>
    <tr>
      <th>R^2</th>
      <td>0.88185</td>
    </tr>
    <tr>
      <th>Ljung-Box p-value</th>
      <td>0.913537</td>
    </tr>
    <tr>
      <th>Jarque-Bera p-value</th>
      <td>0.685465</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>En este sentido, sobre el modelo de regresión de árboles de decisión, podemos afirmar que el mejor modelo identificado tiene un <strong>MAPE</strong> de <code class="docutils literal notranslate"><span class="pre">19.75%</span></code>, lo que indica que, en promedio, las predicciones presentan una desviación porcentual consistente con respecto a los valores reales. El <strong>RMSE</strong> es de <code class="docutils literal notranslate"><span class="pre">0.33</span></code>, lo que significa que el error promedio en las predicciones es bajo, y el modelo está prediciendo con bastante precisión. Además, el <strong>R²</strong> de <code class="docutils literal notranslate"><span class="pre">0.88185</span></code> muestra que el modelo explica aproximadamente el <code class="docutils literal notranslate"><span class="pre">88%</span></code> de la variabilidad de los datos.</p>
<p>Respecto a los residuos, el <strong>p-valor</strong> de la prueba de <strong>Ljung-Box</strong> es <code class="docutils literal notranslate"><span class="pre">0.91</span></code>, lo que indica que no hay autocorrelación significativa, lo cual es positivo ya que significa que los residuos son independientes. Por otro lado, el <strong>p-valor</strong> de la prueba de <strong>Jarque-Bera</strong> es <code class="docutils literal notranslate"><span class="pre">0.68</span></code>, lo que sugiere que no se puede rechazar la hipótesis de normalidad de los residuos, lo cual es deseable para validar las inferencias del modelo.</p>
</section>
</section>
<section id="modelo-random-forest">
<h3><strong>MODELO RANDOM FOREST</strong><a class="headerlink" href="#modelo-random-forest" title="Link to this heading">#</a></h3>
<p>Primeramente se entrena el modelo y predice. Se imprimen las tablas que contienen las métricas predeterminadas para cada una de las 24 horas.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">modeloranfor</span> <span class="o">=</span> <span class="n">RandomForestRegressor</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">21</span><span class="p">)</span>
<span class="n">metricas</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">hora</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">25</span><span class="p">):</span>  <span class="c1"># Ciclo para calcular la tabla de errores para cada hora (puedes extender hasta 24)   </span>
    <span class="k">for</span> <span class="n">dias</span> <span class="ow">in</span> <span class="n">particiones</span><span class="p">:</span>  <span class="c1"># Ciclo que recorre las particiones para las ventanas        </span>
        <span class="n">iniciotrain</span> <span class="o">=</span> <span class="mi">0</span>        
        <span class="k">while</span> <span class="p">(</span><span class="n">iniciotrain</span> <span class="o">+</span> <span class="p">(</span><span class="n">dias</span> <span class="o">*</span> <span class="mi">24</span><span class="p">)</span> <span class="o">+</span> <span class="n">hora</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">):</span>  <span class="c1"># Mientras que el tamaño del pliegue más la hora sea menor que la longitud de los datos           </span>
            <span class="n">fintrain</span> <span class="o">=</span> <span class="n">iniciotrain</span> <span class="o">+</span> <span class="p">(</span><span class="n">dias</span> <span class="o">*</span> <span class="mi">24</span><span class="p">)</span>            
            <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">plieguess</span><span class="p">(</span><span class="n">iniciotrain</span><span class="p">,</span><span class="n">fintrain</span><span class="p">,</span><span class="n">hora</span><span class="p">)</span>          
            <span class="n">modeloranfor</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
            <span class="n">y_prediccion</span><span class="o">=</span> <span class="n">modeloranfor</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>               
            <span class="n">rmse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">,</span> <span class="n">squared</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="n">mape</span> <span class="o">=</span> <span class="n">MAPE</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">)</span>
            <span class="n">r2</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">)</span>
            <span class="n">metricas</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
                <span class="s1">&#39;Modelo&#39;</span><span class="p">:</span> <span class="s1">&#39;Random Forest Regressor&#39;</span><span class="p">,</span>
                <span class="s1">&#39;Dias&#39;</span><span class="p">:</span> <span class="n">dias</span><span class="p">,</span>
                <span class="s1">&#39;Hora&#39;</span><span class="p">:</span> <span class="n">hora</span><span class="p">,</span>
                <span class="s1">&#39;MAPE&#39;</span><span class="p">:</span> <span class="n">mape</span><span class="p">,</span>
                <span class="s1">&#39;RMSE&#39;</span><span class="p">:</span> <span class="n">rmse</span><span class="p">,</span>
                <span class="s1">&#39;R^2&#39;</span><span class="p">:</span> <span class="n">r2</span><span class="p">,</span>
            <span class="p">})</span>           
            <span class="n">iniciotrain</span> <span class="o">=</span> <span class="n">fintrain</span>  <span class="c1"># Actualizar el inicio para el siguiente pliegue</span>
<span class="n">dataranfor</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">metricas</span><span class="p">)</span>
<span class="n">dataranfor</span> <span class="o">=</span> <span class="n">dataranfor</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dataranfor</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;Modelo&#39;</span><span class="p">,</span> <span class="s1">&#39;Hora&#39;</span><span class="p">,</span> <span class="s1">&#39;Dias&#39;</span><span class="p">])[</span><span class="s1">&#39;RMSE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">idxmin</span><span class="p">()]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataranfor</span><span class="p">[</span><span class="n">dataranfor</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Random Forest Regressor</td>
      <td>7</td>
      <td>1</td>
      <td>14.587155</td>
      <td>0.319547</td>
      <td>0.589477</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Random Forest Regressor</td>
      <td>14</td>
      <td>1</td>
      <td>13.296714</td>
      <td>0.371093</td>
      <td>0.853367</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Random Forest Regressor</td>
      <td>21</td>
      <td>1</td>
      <td>10.123394</td>
      <td>0.351219</td>
      <td>0.830440</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Random Forest Regressor</td>
      <td>28</td>
      <td>1</td>
      <td>8.207430</td>
      <td>0.319029</td>
      <td>0.883263</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataranfor</span><span class="p">[</span><span class="n">dataranfor</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>4</th>
      <td>Random Forest Regressor</td>
      <td>7</td>
      <td>2</td>
      <td>15.725313</td>
      <td>0.340399</td>
      <td>0.516329</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Random Forest Regressor</td>
      <td>14</td>
      <td>2</td>
      <td>43.718554</td>
      <td>0.361427</td>
      <td>0.777231</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Random Forest Regressor</td>
      <td>21</td>
      <td>2</td>
      <td>10.554991</td>
      <td>0.363241</td>
      <td>0.813342</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Random Forest Regressor</td>
      <td>28</td>
      <td>2</td>
      <td>8.396050</td>
      <td>0.328231</td>
      <td>0.867331</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataranfor</span><span class="p">[</span><span class="n">dataranfor</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">3</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>8</th>
      <td>Random Forest Regressor</td>
      <td>7</td>
      <td>3</td>
      <td>15.849051</td>
      <td>0.343362</td>
      <td>0.512568</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Random Forest Regressor</td>
      <td>14</td>
      <td>3</td>
      <td>11.846154</td>
      <td>0.347037</td>
      <td>0.849756</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Random Forest Regressor</td>
      <td>21</td>
      <td>3</td>
      <td>12.759570</td>
      <td>0.359708</td>
      <td>0.838585</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Random Forest Regressor</td>
      <td>28</td>
      <td>3</td>
      <td>8.814232</td>
      <td>0.336858</td>
      <td>0.825630</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataranfor</span><span class="p">[</span><span class="n">dataranfor</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">4</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>12</th>
      <td>Random Forest Regressor</td>
      <td>7</td>
      <td>4</td>
      <td>10.367274</td>
      <td>0.347053</td>
      <td>0.824434</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Random Forest Regressor</td>
      <td>14</td>
      <td>4</td>
      <td>11.575534</td>
      <td>0.349333</td>
      <td>0.835241</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Random Forest Regressor</td>
      <td>21</td>
      <td>4</td>
      <td>10.205367</td>
      <td>0.356533</td>
      <td>0.814711</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Random Forest Regressor</td>
      <td>28</td>
      <td>4</td>
      <td>10.578121</td>
      <td>0.354930</td>
      <td>0.835625</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataranfor</span><span class="p">[</span><span class="n">dataranfor</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">5</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>16</th>
      <td>Random Forest Regressor</td>
      <td>7</td>
      <td>5</td>
      <td>8.244985</td>
      <td>0.297177</td>
      <td>0.875757</td>
    </tr>
    <tr>
      <th>17</th>
      <td>Random Forest Regressor</td>
      <td>14</td>
      <td>5</td>
      <td>11.180424</td>
      <td>0.348059</td>
      <td>0.829268</td>
    </tr>
    <tr>
      <th>18</th>
      <td>Random Forest Regressor</td>
      <td>21</td>
      <td>5</td>
      <td>12.052961</td>
      <td>0.361640</td>
      <td>0.815685</td>
    </tr>
    <tr>
      <th>19</th>
      <td>Random Forest Regressor</td>
      <td>28</td>
      <td>5</td>
      <td>12.096350</td>
      <td>0.360157</td>
      <td>0.866237</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataranfor</span><span class="p">[</span><span class="n">dataranfor</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">6</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>20</th>
      <td>Random Forest Regressor</td>
      <td>7</td>
      <td>6</td>
      <td>8.989032</td>
      <td>0.349453</td>
      <td>0.838240</td>
    </tr>
    <tr>
      <th>21</th>
      <td>Random Forest Regressor</td>
      <td>14</td>
      <td>6</td>
      <td>35.501081</td>
      <td>0.341823</td>
      <td>0.842366</td>
    </tr>
    <tr>
      <th>22</th>
      <td>Random Forest Regressor</td>
      <td>21</td>
      <td>6</td>
      <td>11.798001</td>
      <td>0.367862</td>
      <td>0.783719</td>
    </tr>
    <tr>
      <th>23</th>
      <td>Random Forest Regressor</td>
      <td>28</td>
      <td>6</td>
      <td>34.104880</td>
      <td>0.344321</td>
      <td>0.840054</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataranfor</span><span class="p">[</span><span class="n">dataranfor</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">7</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>24</th>
      <td>Random Forest Regressor</td>
      <td>7</td>
      <td>7</td>
      <td>8.540227</td>
      <td>0.344108</td>
      <td>0.854410</td>
    </tr>
    <tr>
      <th>25</th>
      <td>Random Forest Regressor</td>
      <td>14</td>
      <td>7</td>
      <td>35.239678</td>
      <td>0.341913</td>
      <td>0.840751</td>
    </tr>
    <tr>
      <th>26</th>
      <td>Random Forest Regressor</td>
      <td>21</td>
      <td>7</td>
      <td>11.692499</td>
      <td>0.368609</td>
      <td>0.733574</td>
    </tr>
    <tr>
      <th>27</th>
      <td>Random Forest Regressor</td>
      <td>28</td>
      <td>7</td>
      <td>32.719480</td>
      <td>0.338944</td>
      <td>0.843504</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataranfor</span><span class="p">[</span><span class="n">dataranfor</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">8</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>28</th>
      <td>Random Forest Regressor</td>
      <td>7</td>
      <td>8</td>
      <td>8.543529</td>
      <td>0.324479</td>
      <td>0.842448</td>
    </tr>
    <tr>
      <th>29</th>
      <td>Random Forest Regressor</td>
      <td>14</td>
      <td>8</td>
      <td>36.921406</td>
      <td>0.337739</td>
      <td>0.849028</td>
    </tr>
    <tr>
      <th>30</th>
      <td>Random Forest Regressor</td>
      <td>21</td>
      <td>8</td>
      <td>11.223006</td>
      <td>0.327578</td>
      <td>0.871549</td>
    </tr>
    <tr>
      <th>31</th>
      <td>Random Forest Regressor</td>
      <td>28</td>
      <td>8</td>
      <td>34.259268</td>
      <td>0.330896</td>
      <td>0.855084</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataranfor</span><span class="p">[</span><span class="n">dataranfor</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">9</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>32</th>
      <td>Random Forest Regressor</td>
      <td>7</td>
      <td>9</td>
      <td>13.784948</td>
      <td>0.344385</td>
      <td>0.839905</td>
    </tr>
    <tr>
      <th>33</th>
      <td>Random Forest Regressor</td>
      <td>14</td>
      <td>9</td>
      <td>36.180021</td>
      <td>0.336623</td>
      <td>0.848910</td>
    </tr>
    <tr>
      <th>34</th>
      <td>Random Forest Regressor</td>
      <td>21</td>
      <td>9</td>
      <td>11.859334</td>
      <td>0.363544</td>
      <td>0.845869</td>
    </tr>
    <tr>
      <th>35</th>
      <td>Random Forest Regressor</td>
      <td>28</td>
      <td>9</td>
      <td>35.157694</td>
      <td>0.334272</td>
      <td>0.851012</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataranfor</span><span class="p">[</span><span class="n">dataranfor</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">10</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>36</th>
      <td>Random Forest Regressor</td>
      <td>7</td>
      <td>10</td>
      <td>14.024654</td>
      <td>0.350104</td>
      <td>0.833482</td>
    </tr>
    <tr>
      <th>37</th>
      <td>Random Forest Regressor</td>
      <td>14</td>
      <td>10</td>
      <td>33.307523</td>
      <td>0.337023</td>
      <td>0.918843</td>
    </tr>
    <tr>
      <th>38</th>
      <td>Random Forest Regressor</td>
      <td>21</td>
      <td>10</td>
      <td>9.872589</td>
      <td>0.340077</td>
      <td>0.810987</td>
    </tr>
    <tr>
      <th>39</th>
      <td>Random Forest Regressor</td>
      <td>28</td>
      <td>10</td>
      <td>36.900867</td>
      <td>0.347889</td>
      <td>0.847282</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataranfor</span><span class="p">[</span><span class="n">dataranfor</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">11</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>40</th>
      <td>Random Forest Regressor</td>
      <td>7</td>
      <td>11</td>
      <td>9.149338</td>
      <td>0.356541</td>
      <td>0.796402</td>
    </tr>
    <tr>
      <th>41</th>
      <td>Random Forest Regressor</td>
      <td>14</td>
      <td>11</td>
      <td>39.973119</td>
      <td>0.352263</td>
      <td>0.849892</td>
    </tr>
    <tr>
      <th>42</th>
      <td>Random Forest Regressor</td>
      <td>21</td>
      <td>11</td>
      <td>9.850530</td>
      <td>0.340157</td>
      <td>0.812952</td>
    </tr>
    <tr>
      <th>43</th>
      <td>Random Forest Regressor</td>
      <td>28</td>
      <td>11</td>
      <td>36.921030</td>
      <td>0.347328</td>
      <td>0.854068</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataranfor</span><span class="p">[</span><span class="n">dataranfor</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">12</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>44</th>
      <td>Random Forest Regressor</td>
      <td>7</td>
      <td>12</td>
      <td>9.352724</td>
      <td>0.358121</td>
      <td>0.778215</td>
    </tr>
    <tr>
      <th>45</th>
      <td>Random Forest Regressor</td>
      <td>14</td>
      <td>12</td>
      <td>10.239932</td>
      <td>0.332746</td>
      <td>0.847268</td>
    </tr>
    <tr>
      <th>46</th>
      <td>Random Forest Regressor</td>
      <td>21</td>
      <td>12</td>
      <td>9.855670</td>
      <td>0.340182</td>
      <td>0.813578</td>
    </tr>
    <tr>
      <th>47</th>
      <td>Random Forest Regressor</td>
      <td>28</td>
      <td>12</td>
      <td>35.057790</td>
      <td>0.340621</td>
      <td>0.866031</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataranfor</span><span class="p">[</span><span class="n">dataranfor</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">13</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>48</th>
      <td>Random Forest Regressor</td>
      <td>7</td>
      <td>13</td>
      <td>9.160777</td>
      <td>0.361392</td>
      <td>0.714949</td>
    </tr>
    <tr>
      <th>49</th>
      <td>Random Forest Regressor</td>
      <td>14</td>
      <td>13</td>
      <td>33.166571</td>
      <td>0.353238</td>
      <td>0.906824</td>
    </tr>
    <tr>
      <th>50</th>
      <td>Random Forest Regressor</td>
      <td>21</td>
      <td>13</td>
      <td>11.904451</td>
      <td>0.361345</td>
      <td>0.804876</td>
    </tr>
    <tr>
      <th>51</th>
      <td>Random Forest Regressor</td>
      <td>28</td>
      <td>13</td>
      <td>35.781326</td>
      <td>0.342384</td>
      <td>0.869010</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataranfor</span><span class="p">[</span><span class="n">dataranfor</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">14</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>52</th>
      <td>Random Forest Regressor</td>
      <td>7</td>
      <td>14</td>
      <td>14.856088</td>
      <td>0.309298</td>
      <td>0.922011</td>
    </tr>
    <tr>
      <th>53</th>
      <td>Random Forest Regressor</td>
      <td>14</td>
      <td>14</td>
      <td>40.577549</td>
      <td>0.325746</td>
      <td>0.881384</td>
    </tr>
    <tr>
      <th>54</th>
      <td>Random Forest Regressor</td>
      <td>21</td>
      <td>14</td>
      <td>11.436820</td>
      <td>0.343181</td>
      <td>0.869009</td>
    </tr>
    <tr>
      <th>55</th>
      <td>Random Forest Regressor</td>
      <td>28</td>
      <td>14</td>
      <td>36.202412</td>
      <td>0.324096</td>
      <td>0.882582</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataranfor</span><span class="p">[</span><span class="n">dataranfor</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">15</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>56</th>
      <td>Random Forest Regressor</td>
      <td>7</td>
      <td>15</td>
      <td>15.043887</td>
      <td>0.303468</td>
      <td>0.922661</td>
    </tr>
    <tr>
      <th>57</th>
      <td>Random Forest Regressor</td>
      <td>14</td>
      <td>15</td>
      <td>40.419655</td>
      <td>0.322988</td>
      <td>0.883384</td>
    </tr>
    <tr>
      <th>58</th>
      <td>Random Forest Regressor</td>
      <td>21</td>
      <td>15</td>
      <td>11.463560</td>
      <td>0.343723</td>
      <td>0.876530</td>
    </tr>
    <tr>
      <th>59</th>
      <td>Random Forest Regressor</td>
      <td>28</td>
      <td>15</td>
      <td>35.538444</td>
      <td>0.312766</td>
      <td>0.890648</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataranfor</span><span class="p">[</span><span class="n">dataranfor</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">16</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>60</th>
      <td>Random Forest Regressor</td>
      <td>7</td>
      <td>16</td>
      <td>14.420871</td>
      <td>0.295082</td>
      <td>0.927673</td>
    </tr>
    <tr>
      <th>61</th>
      <td>Random Forest Regressor</td>
      <td>14</td>
      <td>16</td>
      <td>40.051346</td>
      <td>0.324133</td>
      <td>0.882042</td>
    </tr>
    <tr>
      <th>62</th>
      <td>Random Forest Regressor</td>
      <td>21</td>
      <td>16</td>
      <td>11.345833</td>
      <td>0.343825</td>
      <td>0.884227</td>
    </tr>
    <tr>
      <th>63</th>
      <td>Random Forest Regressor</td>
      <td>28</td>
      <td>16</td>
      <td>36.343489</td>
      <td>0.322866</td>
      <td>0.882963</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataranfor</span><span class="p">[</span><span class="n">dataranfor</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">17</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>64</th>
      <td>Random Forest Regressor</td>
      <td>7</td>
      <td>17</td>
      <td>16.938331</td>
      <td>0.308502</td>
      <td>0.924962</td>
    </tr>
    <tr>
      <th>65</th>
      <td>Random Forest Regressor</td>
      <td>14</td>
      <td>17</td>
      <td>11.440404</td>
      <td>0.333969</td>
      <td>0.879845</td>
    </tr>
    <tr>
      <th>66</th>
      <td>Random Forest Regressor</td>
      <td>21</td>
      <td>17</td>
      <td>10.571972</td>
      <td>0.318654</td>
      <td>0.902675</td>
    </tr>
    <tr>
      <th>67</th>
      <td>Random Forest Regressor</td>
      <td>28</td>
      <td>17</td>
      <td>36.207674</td>
      <td>0.339938</td>
      <td>0.874561</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataranfor</span><span class="p">[</span><span class="n">dataranfor</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">18</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>68</th>
      <td>Random Forest Regressor</td>
      <td>7</td>
      <td>18</td>
      <td>16.757775</td>
      <td>0.293530</td>
      <td>0.933849</td>
    </tr>
    <tr>
      <th>69</th>
      <td>Random Forest Regressor</td>
      <td>14</td>
      <td>18</td>
      <td>16.541824</td>
      <td>0.336897</td>
      <td>0.851712</td>
    </tr>
    <tr>
      <th>70</th>
      <td>Random Forest Regressor</td>
      <td>21</td>
      <td>18</td>
      <td>10.547109</td>
      <td>0.328592</td>
      <td>0.902908</td>
    </tr>
    <tr>
      <th>71</th>
      <td>Random Forest Regressor</td>
      <td>28</td>
      <td>18</td>
      <td>14.233706</td>
      <td>0.307910</td>
      <td>0.876132</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataranfor</span><span class="p">[</span><span class="n">dataranfor</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">19</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>72</th>
      <td>Random Forest Regressor</td>
      <td>7</td>
      <td>19</td>
      <td>9.376283</td>
      <td>0.309255</td>
      <td>0.866070</td>
    </tr>
    <tr>
      <th>73</th>
      <td>Random Forest Regressor</td>
      <td>14</td>
      <td>19</td>
      <td>8.836264</td>
      <td>0.304405</td>
      <td>0.887530</td>
    </tr>
    <tr>
      <th>74</th>
      <td>Random Forest Regressor</td>
      <td>21</td>
      <td>19</td>
      <td>9.275490</td>
      <td>0.360962</td>
      <td>0.917098</td>
    </tr>
    <tr>
      <th>75</th>
      <td>Random Forest Regressor</td>
      <td>28</td>
      <td>19</td>
      <td>9.136501</td>
      <td>0.316221</td>
      <td>0.878630</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataranfor</span><span class="p">[</span><span class="n">dataranfor</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">20</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>76</th>
      <td>Random Forest Regressor</td>
      <td>7</td>
      <td>20</td>
      <td>9.862329</td>
      <td>0.336423</td>
      <td>0.866058</td>
    </tr>
    <tr>
      <th>77</th>
      <td>Random Forest Regressor</td>
      <td>14</td>
      <td>20</td>
      <td>8.642423</td>
      <td>0.300039</td>
      <td>0.890734</td>
    </tr>
    <tr>
      <th>78</th>
      <td>Random Forest Regressor</td>
      <td>21</td>
      <td>20</td>
      <td>8.273224</td>
      <td>0.318898</td>
      <td>0.934574</td>
    </tr>
    <tr>
      <th>79</th>
      <td>Random Forest Regressor</td>
      <td>28</td>
      <td>20</td>
      <td>9.184509</td>
      <td>0.318035</td>
      <td>0.877233</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataranfor</span><span class="p">[</span><span class="n">dataranfor</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">21</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>80</th>
      <td>Random Forest Regressor</td>
      <td>7</td>
      <td>21</td>
      <td>9.691860</td>
      <td>0.334092</td>
      <td>0.876770</td>
    </tr>
    <tr>
      <th>81</th>
      <td>Random Forest Regressor</td>
      <td>14</td>
      <td>21</td>
      <td>10.948531</td>
      <td>0.331100</td>
      <td>0.814273</td>
    </tr>
    <tr>
      <th>82</th>
      <td>Random Forest Regressor</td>
      <td>21</td>
      <td>21</td>
      <td>8.020218</td>
      <td>0.317440</td>
      <td>0.931987</td>
    </tr>
    <tr>
      <th>83</th>
      <td>Random Forest Regressor</td>
      <td>28</td>
      <td>21</td>
      <td>14.740918</td>
      <td>0.318579</td>
      <td>0.893258</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataranfor</span><span class="p">[</span><span class="n">dataranfor</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">22</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>84</th>
      <td>Random Forest Regressor</td>
      <td>7</td>
      <td>22</td>
      <td>11.502699</td>
      <td>0.349263</td>
      <td>0.773688</td>
    </tr>
    <tr>
      <th>85</th>
      <td>Random Forest Regressor</td>
      <td>14</td>
      <td>22</td>
      <td>11.475675</td>
      <td>0.347641</td>
      <td>0.775785</td>
    </tr>
    <tr>
      <th>86</th>
      <td>Random Forest Regressor</td>
      <td>21</td>
      <td>22</td>
      <td>8.308262</td>
      <td>0.319676</td>
      <td>0.931025</td>
    </tr>
    <tr>
      <th>87</th>
      <td>Random Forest Regressor</td>
      <td>28</td>
      <td>22</td>
      <td>16.151250</td>
      <td>0.356881</td>
      <td>0.866245</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataranfor</span><span class="p">[</span><span class="n">dataranfor</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">23</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>88</th>
      <td>Random Forest Regressor</td>
      <td>7</td>
      <td>23</td>
      <td>9.976841</td>
      <td>0.347732</td>
      <td>0.867478</td>
    </tr>
    <tr>
      <th>89</th>
      <td>Random Forest Regressor</td>
      <td>14</td>
      <td>23</td>
      <td>10.174627</td>
      <td>0.391507</td>
      <td>0.807735</td>
    </tr>
    <tr>
      <th>90</th>
      <td>Random Forest Regressor</td>
      <td>21</td>
      <td>23</td>
      <td>8.187997</td>
      <td>0.318721</td>
      <td>0.930409</td>
    </tr>
    <tr>
      <th>91</th>
      <td>Random Forest Regressor</td>
      <td>28</td>
      <td>23</td>
      <td>18.628004</td>
      <td>0.371673</td>
      <td>0.925861</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataranfor</span><span class="p">[</span><span class="n">dataranfor</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">24</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>92</th>
      <td>Random Forest Regressor</td>
      <td>7</td>
      <td>24</td>
      <td>16.790171</td>
      <td>0.353114</td>
      <td>0.819218</td>
    </tr>
    <tr>
      <th>93</th>
      <td>Random Forest Regressor</td>
      <td>14</td>
      <td>24</td>
      <td>18.958008</td>
      <td>0.371878</td>
      <td>0.850897</td>
    </tr>
    <tr>
      <th>94</th>
      <td>Random Forest Regressor</td>
      <td>21</td>
      <td>24</td>
      <td>7.742838</td>
      <td>0.313599</td>
      <td>0.934291</td>
    </tr>
    <tr>
      <th>95</th>
      <td>Random Forest Regressor</td>
      <td>28</td>
      <td>24</td>
      <td>13.004556</td>
      <td>0.372332</td>
      <td>0.818039</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<section id="id5">
<h4><strong>MEJOR MODELO - CADA HORA</strong><a class="headerlink" href="#id5" title="Link to this heading">#</a></h4>
<p>Ahora mostraremos el mejor modelo de cada hora.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mejorranforhora</span> <span class="o">=</span> <span class="n">mejormodelohora</span><span class="p">(</span><span class="n">particiones</span><span class="p">,</span> <span class="n">dataranfor</span><span class="p">)</span>
<span class="n">mejorranforhora</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>3</th>
      <td>Random Forest Regressor</td>
      <td>28</td>
      <td>1</td>
      <td>8.207430</td>
      <td>0.319029</td>
      <td>0.883263</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Random Forest Regressor</td>
      <td>28</td>
      <td>2</td>
      <td>8.396050</td>
      <td>0.328231</td>
      <td>0.867331</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Random Forest Regressor</td>
      <td>28</td>
      <td>3</td>
      <td>8.814232</td>
      <td>0.336858</td>
      <td>0.825630</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Random Forest Regressor</td>
      <td>7</td>
      <td>4</td>
      <td>10.367274</td>
      <td>0.347053</td>
      <td>0.824434</td>
    </tr>
    <tr>
      <th>16</th>
      <td>Random Forest Regressor</td>
      <td>7</td>
      <td>5</td>
      <td>8.244985</td>
      <td>0.297177</td>
      <td>0.875757</td>
    </tr>
    <tr>
      <th>21</th>
      <td>Random Forest Regressor</td>
      <td>14</td>
      <td>6</td>
      <td>35.501081</td>
      <td>0.341823</td>
      <td>0.842366</td>
    </tr>
    <tr>
      <th>27</th>
      <td>Random Forest Regressor</td>
      <td>28</td>
      <td>7</td>
      <td>32.719480</td>
      <td>0.338944</td>
      <td>0.843504</td>
    </tr>
    <tr>
      <th>28</th>
      <td>Random Forest Regressor</td>
      <td>7</td>
      <td>8</td>
      <td>8.543529</td>
      <td>0.324479</td>
      <td>0.842448</td>
    </tr>
    <tr>
      <th>35</th>
      <td>Random Forest Regressor</td>
      <td>28</td>
      <td>9</td>
      <td>35.157694</td>
      <td>0.334272</td>
      <td>0.851012</td>
    </tr>
    <tr>
      <th>37</th>
      <td>Random Forest Regressor</td>
      <td>14</td>
      <td>10</td>
      <td>33.307523</td>
      <td>0.337023</td>
      <td>0.918843</td>
    </tr>
    <tr>
      <th>42</th>
      <td>Random Forest Regressor</td>
      <td>21</td>
      <td>11</td>
      <td>9.850530</td>
      <td>0.340157</td>
      <td>0.812952</td>
    </tr>
    <tr>
      <th>45</th>
      <td>Random Forest Regressor</td>
      <td>14</td>
      <td>12</td>
      <td>10.239932</td>
      <td>0.332746</td>
      <td>0.847268</td>
    </tr>
    <tr>
      <th>51</th>
      <td>Random Forest Regressor</td>
      <td>28</td>
      <td>13</td>
      <td>35.781326</td>
      <td>0.342384</td>
      <td>0.869010</td>
    </tr>
    <tr>
      <th>52</th>
      <td>Random Forest Regressor</td>
      <td>7</td>
      <td>14</td>
      <td>14.856088</td>
      <td>0.309298</td>
      <td>0.922011</td>
    </tr>
    <tr>
      <th>56</th>
      <td>Random Forest Regressor</td>
      <td>7</td>
      <td>15</td>
      <td>15.043887</td>
      <td>0.303468</td>
      <td>0.922661</td>
    </tr>
    <tr>
      <th>60</th>
      <td>Random Forest Regressor</td>
      <td>7</td>
      <td>16</td>
      <td>14.420871</td>
      <td>0.295082</td>
      <td>0.927673</td>
    </tr>
    <tr>
      <th>64</th>
      <td>Random Forest Regressor</td>
      <td>7</td>
      <td>17</td>
      <td>16.938331</td>
      <td>0.308502</td>
      <td>0.924962</td>
    </tr>
    <tr>
      <th>68</th>
      <td>Random Forest Regressor</td>
      <td>7</td>
      <td>18</td>
      <td>16.757775</td>
      <td>0.293530</td>
      <td>0.933849</td>
    </tr>
    <tr>
      <th>73</th>
      <td>Random Forest Regressor</td>
      <td>14</td>
      <td>19</td>
      <td>8.836264</td>
      <td>0.304405</td>
      <td>0.887530</td>
    </tr>
    <tr>
      <th>77</th>
      <td>Random Forest Regressor</td>
      <td>14</td>
      <td>20</td>
      <td>8.642423</td>
      <td>0.300039</td>
      <td>0.890734</td>
    </tr>
    <tr>
      <th>82</th>
      <td>Random Forest Regressor</td>
      <td>21</td>
      <td>21</td>
      <td>8.020218</td>
      <td>0.317440</td>
      <td>0.931987</td>
    </tr>
    <tr>
      <th>86</th>
      <td>Random Forest Regressor</td>
      <td>21</td>
      <td>22</td>
      <td>8.308262</td>
      <td>0.319676</td>
      <td>0.931025</td>
    </tr>
    <tr>
      <th>90</th>
      <td>Random Forest Regressor</td>
      <td>21</td>
      <td>23</td>
      <td>8.187997</td>
      <td>0.318721</td>
      <td>0.930409</td>
    </tr>
    <tr>
      <th>94</th>
      <td>Random Forest Regressor</td>
      <td>21</td>
      <td>24</td>
      <td>7.742838</td>
      <td>0.313599</td>
      <td>0.934291</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="hora-y-ventana-con-mejor-modelo-random-forest">
<h4><strong>HORA Y VENTANA CON MEJOR MODELO RANDOM FOREST</strong><a class="headerlink" href="#hora-y-ventana-con-mejor-modelo-random-forest" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bestranfor</span> <span class="o">=</span> <span class="n">mejormodelotot</span><span class="p">(</span><span class="n">mejorranforhora</span><span class="p">)</span>
<span class="n">bestranfor</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>68</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Modelo</th>
      <td>Random Forest Regressor</td>
    </tr>
    <tr>
      <th>Dias</th>
      <td>7</td>
    </tr>
    <tr>
      <th>Hora</th>
      <td>18</td>
    </tr>
    <tr>
      <th>MAPE</th>
      <td>16.757775</td>
    </tr>
    <tr>
      <th>RMSE</th>
      <td>0.29353</td>
    </tr>
    <tr>
      <th>R^2</th>
      <td>0.933849</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Es decir, para la <strong>Regresión de Random Forest</strong>, el mejor modelo se da cuando se trabaja con la <strong>HORA</strong>: <code class="docutils literal notranslate"><span class="pre">18</span></code> en la venta de predicción de <code class="docutils literal notranslate"><span class="pre">7</span> <span class="pre">días</span></code>. Veamos los valores de <strong>Ljung-Box p-value</strong> y <strong>Jarque-Bera p-value</strong>. Antes de ello, veamos cuáles son las pruebas de hipótesis para comprender mejor los p-valores que se nos arrojen.</p>
<ul class="simple">
<li><p><strong>Prueba de Ljung-Box</strong></p></li>
</ul>
<ul class="simple">
<li><p><strong>Hipótesis nula (H₀)</strong>: No hay autocorrelación en los residuos (es decir, los residuos son independientes entre sí).</p></li>
<li><p><strong>Hipótesis alternativa (H₁)</strong>: Hay autocorrelación en los residuos</p></li>
</ul>
<ul class="simple">
<li><p><strong>Prueba de Jarque-Bera</strong></p></li>
</ul>
<ul class="simple">
<li><p><strong>Hipótesis nula (H₀)</strong>: Los residuos tienen una distribución normal.</p></li>
<li><p><strong>Hipótesis alternativa (H₁)</strong>: Los residuos no tienen una distribución normal.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">metricas</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">dias</span> <span class="o">=</span> <span class="mi">7</span>
<span class="n">hora</span> <span class="o">=</span> <span class="mi">18</span>
<span class="n">iniciotrain</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">while</span> <span class="p">(</span><span class="n">iniciotrain</span> <span class="o">+</span> <span class="p">(</span><span class="n">dias</span> <span class="o">*</span> <span class="mi">24</span><span class="p">)</span> <span class="o">+</span> <span class="n">hora</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">):</span>  
    <span class="n">fintrain</span> <span class="o">=</span> <span class="n">iniciotrain</span> <span class="o">+</span> <span class="p">(</span><span class="n">dias</span> <span class="o">*</span> <span class="mi">24</span><span class="p">)</span>   
    <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">plieguess</span><span class="p">(</span><span class="n">iniciotrain</span><span class="p">,</span> <span class="n">fintrain</span><span class="p">,</span> <span class="n">hora</span><span class="p">)</span>   
    <span class="n">modeloranfor</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
    <span class="n">y_prediccion</span><span class="o">=</span> <span class="n">modeloranfor</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>       
    <span class="n">rmse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">,</span> <span class="n">squared</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">mape</span> <span class="o">=</span> <span class="n">MAPE</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">)</span>
    <span class="n">r2</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">)</span>
    <span class="n">ljungbox</span><span class="p">,</span> <span class="n">jarquebera</span> <span class="o">=</span> <span class="n">residuos</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">)</span>   
    <span class="n">metricas</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
        <span class="s1">&#39;Modelo&#39;</span><span class="p">:</span> <span class="s1">&#39;Regresión Random Forest&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Dias&#39;</span><span class="p">:</span> <span class="n">dias</span><span class="p">,</span>
        <span class="s1">&#39;Hora&#39;</span><span class="p">:</span> <span class="n">hora</span><span class="p">,</span>
        <span class="s1">&#39;MAPE&#39;</span><span class="p">:</span> <span class="n">mape</span><span class="p">,</span>
        <span class="s1">&#39;RMSE&#39;</span><span class="p">:</span> <span class="n">rmse</span><span class="p">,</span>
        <span class="s1">&#39;R^2&#39;</span><span class="p">:</span> <span class="n">r2</span><span class="p">,</span>
        <span class="s1">&#39;Ljung-Box p-value&#39;</span> <span class="p">:</span> <span class="n">ljungbox</span><span class="p">,</span>
        <span class="s1">&#39;Jarque-Bera p-value&#39;</span> <span class="p">:</span> <span class="n">jarquebera</span>
    <span class="p">})</span>   
    <span class="n">iniciotrain</span> <span class="o">=</span> <span class="n">fintrain</span>  
<span class="n">dataranfor</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">metricas</span><span class="p">)</span>
<span class="n">dataranfor</span> <span class="o">=</span> <span class="n">dataranfor</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dataranfor</span><span class="p">[</span><span class="s1">&#39;RMSE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">idxmin</span><span class="p">()]</span>
<span class="n">dataranfor</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">dataranfor</span><span class="p">)</span>
<span class="n">dataranfor</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>4</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Modelo</th>
      <td>Regresión Random Forest</td>
    </tr>
    <tr>
      <th>Dias</th>
      <td>7</td>
    </tr>
    <tr>
      <th>Hora</th>
      <td>18</td>
    </tr>
    <tr>
      <th>MAPE</th>
      <td>16.757775</td>
    </tr>
    <tr>
      <th>RMSE</th>
      <td>0.29353</td>
    </tr>
    <tr>
      <th>R^2</th>
      <td>0.933849</td>
    </tr>
    <tr>
      <th>Ljung-Box p-value</th>
      <td>0.541553</td>
    </tr>
    <tr>
      <th>Jarque-Bera p-value</th>
      <td>0.630275</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>En este sentido, sobre el modelo de regresión de random forest, podemos afirmar que el mejor modelo identificado tiene un <strong>MAPE</strong> de <code class="docutils literal notranslate"><span class="pre">16.75%</span></code>, lo que indica que, en promedio, las predicciones presentan una desviación porcentual consistente con respecto a los valores reales. El <strong>RMSE</strong> es de <code class="docutils literal notranslate"><span class="pre">0.29</span></code>, lo que significa que el error promedio en las predicciones es bajo, y el modelo está prediciendo con bastante precisión. Además, el <strong>R²</strong> de <code class="docutils literal notranslate"><span class="pre">0.933849</span></code> muestra que el modelo explica aproximadamente el <code class="docutils literal notranslate"><span class="pre">93%</span></code> de la variabilidad de los datos.</p>
<p>Respecto a los residuos, el <strong>p-valor</strong> de la prueba de <strong>Ljung-Box</strong> es <code class="docutils literal notranslate"><span class="pre">0.54</span></code>, lo que indica que no hay autocorrelación significativa, lo cual es positivo ya que significa que los residuos son independientes. Por otro lado, el <strong>p-valor</strong> de la prueba de <strong>Jarque-Bera</strong> es <code class="docutils literal notranslate"><span class="pre">0.63</span></code>, lo que sugiere que no se puede rechazar la hipótesis de normalidad de los residuos, lo cual es deseable para validar las inferencias del modelo.</p>
</section>
</section>
<section id="modelo-xgboost">
<h3><strong>MODELO XGBOOST</strong><a class="headerlink" href="#modelo-xgboost" title="Link to this heading">#</a></h3>
<p>Primeramente se entrena el modelo y predice. Se imprimen las tablas que contienen las métricas predeterminadas para cada una de las 24 horas.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">modeloxgboost</span> <span class="o">=</span> <span class="n">XGBRegressor</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">21</span><span class="p">)</span>
<span class="n">metricas</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">hora</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">25</span><span class="p">):</span>  <span class="c1"># Ciclo para calcular la tabla de errores para cada hora (puedes extender hasta 24)   </span>
    <span class="k">for</span> <span class="n">dias</span> <span class="ow">in</span> <span class="n">particiones</span><span class="p">:</span>  <span class="c1"># Ciclo que recorre las particiones para las ventanas        </span>
        <span class="n">iniciotrain</span> <span class="o">=</span> <span class="mi">0</span>        
        <span class="k">while</span> <span class="p">(</span><span class="n">iniciotrain</span> <span class="o">+</span> <span class="p">(</span><span class="n">dias</span> <span class="o">*</span> <span class="mi">24</span><span class="p">)</span> <span class="o">+</span> <span class="n">hora</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">):</span>  <span class="c1"># Mientras que el tamaño del pliegue más la hora sea menor que la longitud de los datos           </span>
            <span class="n">fintrain</span> <span class="o">=</span> <span class="n">iniciotrain</span> <span class="o">+</span> <span class="p">(</span><span class="n">dias</span> <span class="o">*</span> <span class="mi">24</span><span class="p">)</span>            
            <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">plieguess</span><span class="p">(</span><span class="n">iniciotrain</span><span class="p">,</span><span class="n">fintrain</span><span class="p">,</span><span class="n">hora</span><span class="p">)</span>          
            <span class="n">modeloxgboost</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
            <span class="n">y_prediccion</span><span class="o">=</span> <span class="n">modeloxgboost</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>               
            <span class="n">rmse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">,</span> <span class="n">squared</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="n">mape</span> <span class="o">=</span> <span class="n">MAPE</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">)</span>
            <span class="n">r2</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">)</span>
            <span class="n">metricas</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
                <span class="s1">&#39;Modelo&#39;</span><span class="p">:</span> <span class="s1">&#39;XGBoost Regressor&#39;</span><span class="p">,</span>
                <span class="s1">&#39;Dias&#39;</span><span class="p">:</span> <span class="n">dias</span><span class="p">,</span>
                <span class="s1">&#39;Hora&#39;</span><span class="p">:</span> <span class="n">hora</span><span class="p">,</span>
                <span class="s1">&#39;MAPE&#39;</span><span class="p">:</span> <span class="n">mape</span><span class="p">,</span>
                <span class="s1">&#39;RMSE&#39;</span><span class="p">:</span> <span class="n">rmse</span><span class="p">,</span>
                <span class="s1">&#39;R^2&#39;</span><span class="p">:</span> <span class="n">r2</span><span class="p">,</span>
            <span class="p">})</span>           
            <span class="n">iniciotrain</span> <span class="o">=</span> <span class="n">fintrain</span>  <span class="c1"># Actualizar el inicio para el siguiente pliegue</span>
<span class="n">dataxgboost</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">metricas</span><span class="p">)</span>
<span class="n">dataxgboost</span> <span class="o">=</span> <span class="n">dataxgboost</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dataxgboost</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;Modelo&#39;</span><span class="p">,</span> <span class="s1">&#39;Hora&#39;</span><span class="p">,</span> <span class="s1">&#39;Dias&#39;</span><span class="p">])[</span><span class="s1">&#39;RMSE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">idxmin</span><span class="p">()]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataxgboost</span><span class="p">[</span><span class="n">dataxgboost</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>XGBoost Regressor</td>
      <td>7</td>
      <td>1</td>
      <td>16.833912</td>
      <td>0.346743</td>
      <td>0.516628</td>
    </tr>
    <tr>
      <th>1</th>
      <td>XGBoost Regressor</td>
      <td>14</td>
      <td>1</td>
      <td>10.502251</td>
      <td>0.303328</td>
      <td>0.877628</td>
    </tr>
    <tr>
      <th>2</th>
      <td>XGBoost Regressor</td>
      <td>21</td>
      <td>1</td>
      <td>9.294955</td>
      <td>0.295592</td>
      <td>0.883791</td>
    </tr>
    <tr>
      <th>3</th>
      <td>XGBoost Regressor</td>
      <td>28</td>
      <td>1</td>
      <td>8.144435</td>
      <td>0.333526</td>
      <td>0.872413</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataxgboost</span><span class="p">[</span><span class="n">dataxgboost</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>4</th>
      <td>XGBoost Regressor</td>
      <td>7</td>
      <td>2</td>
      <td>16.880350</td>
      <td>0.366205</td>
      <td>0.933824</td>
    </tr>
    <tr>
      <th>5</th>
      <td>XGBoost Regressor</td>
      <td>14</td>
      <td>2</td>
      <td>11.420851</td>
      <td>0.322746</td>
      <td>0.861187</td>
    </tr>
    <tr>
      <th>6</th>
      <td>XGBoost Regressor</td>
      <td>21</td>
      <td>2</td>
      <td>9.864716</td>
      <td>0.304509</td>
      <td>0.876431</td>
    </tr>
    <tr>
      <th>7</th>
      <td>XGBoost Regressor</td>
      <td>28</td>
      <td>2</td>
      <td>8.333556</td>
      <td>0.340232</td>
      <td>0.857452</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataxgboost</span><span class="p">[</span><span class="n">dataxgboost</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">3</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>8</th>
      <td>XGBoost Regressor</td>
      <td>7</td>
      <td>3</td>
      <td>16.730185</td>
      <td>0.365116</td>
      <td>0.934217</td>
    </tr>
    <tr>
      <th>9</th>
      <td>XGBoost Regressor</td>
      <td>14</td>
      <td>3</td>
      <td>11.415457</td>
      <td>0.322403</td>
      <td>0.866212</td>
    </tr>
    <tr>
      <th>10</th>
      <td>XGBoost Regressor</td>
      <td>21</td>
      <td>3</td>
      <td>10.279032</td>
      <td>0.308488</td>
      <td>0.877511</td>
    </tr>
    <tr>
      <th>11</th>
      <td>XGBoost Regressor</td>
      <td>28</td>
      <td>3</td>
      <td>8.960251</td>
      <td>0.353046</td>
      <td>0.808469</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataxgboost</span><span class="p">[</span><span class="n">dataxgboost</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">4</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>12</th>
      <td>XGBoost Regressor</td>
      <td>7</td>
      <td>4</td>
      <td>15.946125</td>
      <td>0.352291</td>
      <td>0.940426</td>
    </tr>
    <tr>
      <th>13</th>
      <td>XGBoost Regressor</td>
      <td>14</td>
      <td>4</td>
      <td>12.340872</td>
      <td>0.348405</td>
      <td>0.843359</td>
    </tr>
    <tr>
      <th>14</th>
      <td>XGBoost Regressor</td>
      <td>21</td>
      <td>4</td>
      <td>11.370401</td>
      <td>0.333986</td>
      <td>0.856056</td>
    </tr>
    <tr>
      <th>15</th>
      <td>XGBoost Regressor</td>
      <td>28</td>
      <td>4</td>
      <td>10.660560</td>
      <td>0.367249</td>
      <td>0.824016</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataxgboost</span><span class="p">[</span><span class="n">dataxgboost</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">5</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>16</th>
      <td>XGBoost Regressor</td>
      <td>7</td>
      <td>5</td>
      <td>15.997940</td>
      <td>0.351374</td>
      <td>0.941392</td>
    </tr>
    <tr>
      <th>17</th>
      <td>XGBoost Regressor</td>
      <td>14</td>
      <td>5</td>
      <td>25.552719</td>
      <td>0.347793</td>
      <td>0.860921</td>
    </tr>
    <tr>
      <th>18</th>
      <td>XGBoost Regressor</td>
      <td>21</td>
      <td>5</td>
      <td>10.862324</td>
      <td>0.330553</td>
      <td>0.851213</td>
    </tr>
    <tr>
      <th>19</th>
      <td>XGBoost Regressor</td>
      <td>28</td>
      <td>5</td>
      <td>11.998971</td>
      <td>0.371034</td>
      <td>0.858035</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataxgboost</span><span class="p">[</span><span class="n">dataxgboost</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">6</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>20</th>
      <td>XGBoost Regressor</td>
      <td>7</td>
      <td>6</td>
      <td>12.894152</td>
      <td>0.338513</td>
      <td>0.850804</td>
    </tr>
    <tr>
      <th>21</th>
      <td>XGBoost Regressor</td>
      <td>14</td>
      <td>6</td>
      <td>11.908280</td>
      <td>0.350266</td>
      <td>0.824101</td>
    </tr>
    <tr>
      <th>22</th>
      <td>XGBoost Regressor</td>
      <td>21</td>
      <td>6</td>
      <td>10.992183</td>
      <td>0.335949</td>
      <td>0.838187</td>
    </tr>
    <tr>
      <th>23</th>
      <td>XGBoost Regressor</td>
      <td>28</td>
      <td>6</td>
      <td>13.070347</td>
      <td>0.379816</td>
      <td>0.864701</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataxgboost</span><span class="p">[</span><span class="n">dataxgboost</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">7</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>24</th>
      <td>XGBoost Regressor</td>
      <td>7</td>
      <td>7</td>
      <td>12.868393</td>
      <td>0.338169</td>
      <td>0.847055</td>
    </tr>
    <tr>
      <th>25</th>
      <td>XGBoost Regressor</td>
      <td>14</td>
      <td>7</td>
      <td>11.377327</td>
      <td>0.344083</td>
      <td>0.828829</td>
    </tr>
    <tr>
      <th>26</th>
      <td>XGBoost Regressor</td>
      <td>21</td>
      <td>7</td>
      <td>10.707124</td>
      <td>0.333277</td>
      <td>0.839412</td>
    </tr>
    <tr>
      <th>27</th>
      <td>XGBoost Regressor</td>
      <td>28</td>
      <td>7</td>
      <td>12.493917</td>
      <td>0.368344</td>
      <td>0.901246</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataxgboost</span><span class="p">[</span><span class="n">dataxgboost</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">8</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>28</th>
      <td>XGBoost Regressor</td>
      <td>7</td>
      <td>8</td>
      <td>15.405598</td>
      <td>0.329977</td>
      <td>0.944157</td>
    </tr>
    <tr>
      <th>29</th>
      <td>XGBoost Regressor</td>
      <td>14</td>
      <td>8</td>
      <td>12.512486</td>
      <td>0.356621</td>
      <td>0.820648</td>
    </tr>
    <tr>
      <th>30</th>
      <td>XGBoost Regressor</td>
      <td>21</td>
      <td>8</td>
      <td>11.380069</td>
      <td>0.340315</td>
      <td>0.836674</td>
    </tr>
    <tr>
      <th>31</th>
      <td>XGBoost Regressor</td>
      <td>28</td>
      <td>8</td>
      <td>12.473994</td>
      <td>0.370844</td>
      <td>0.900178</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataxgboost</span><span class="p">[</span><span class="n">dataxgboost</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">9</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>32</th>
      <td>XGBoost Regressor</td>
      <td>7</td>
      <td>9</td>
      <td>15.327656</td>
      <td>0.329015</td>
      <td>0.941876</td>
    </tr>
    <tr>
      <th>33</th>
      <td>XGBoost Regressor</td>
      <td>14</td>
      <td>9</td>
      <td>12.346688</td>
      <td>0.356436</td>
      <td>0.810609</td>
    </tr>
    <tr>
      <th>34</th>
      <td>XGBoost Regressor</td>
      <td>21</td>
      <td>9</td>
      <td>10.869383</td>
      <td>0.336480</td>
      <td>0.831223</td>
    </tr>
    <tr>
      <th>35</th>
      <td>XGBoost Regressor</td>
      <td>28</td>
      <td>9</td>
      <td>13.146732</td>
      <td>0.380430</td>
      <td>0.804638</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataxgboost</span><span class="p">[</span><span class="n">dataxgboost</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">10</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>36</th>
      <td>XGBoost Regressor</td>
      <td>7</td>
      <td>10</td>
      <td>15.370188</td>
      <td>0.317740</td>
      <td>0.937797</td>
    </tr>
    <tr>
      <th>37</th>
      <td>XGBoost Regressor</td>
      <td>14</td>
      <td>10</td>
      <td>11.527086</td>
      <td>0.339944</td>
      <td>0.827801</td>
    </tr>
    <tr>
      <th>38</th>
      <td>XGBoost Regressor</td>
      <td>21</td>
      <td>10</td>
      <td>10.374697</td>
      <td>0.329519</td>
      <td>0.838200</td>
    </tr>
    <tr>
      <th>39</th>
      <td>XGBoost Regressor</td>
      <td>28</td>
      <td>10</td>
      <td>22.801216</td>
      <td>0.367135</td>
      <td>0.876025</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataxgboost</span><span class="p">[</span><span class="n">dataxgboost</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">11</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>40</th>
      <td>XGBoost Regressor</td>
      <td>7</td>
      <td>11</td>
      <td>15.674963</td>
      <td>0.321396</td>
      <td>0.933267</td>
    </tr>
    <tr>
      <th>41</th>
      <td>XGBoost Regressor</td>
      <td>14</td>
      <td>11</td>
      <td>11.330231</td>
      <td>0.337854</td>
      <td>0.834556</td>
    </tr>
    <tr>
      <th>42</th>
      <td>XGBoost Regressor</td>
      <td>21</td>
      <td>11</td>
      <td>9.984161</td>
      <td>0.325034</td>
      <td>0.846872</td>
    </tr>
    <tr>
      <th>43</th>
      <td>XGBoost Regressor</td>
      <td>28</td>
      <td>11</td>
      <td>13.047855</td>
      <td>0.357401</td>
      <td>0.823910</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataxgboost</span><span class="p">[</span><span class="n">dataxgboost</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">12</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>44</th>
      <td>XGBoost Regressor</td>
      <td>7</td>
      <td>12</td>
      <td>15.567116</td>
      <td>0.315710</td>
      <td>0.927987</td>
    </tr>
    <tr>
      <th>45</th>
      <td>XGBoost Regressor</td>
      <td>14</td>
      <td>12</td>
      <td>10.641930</td>
      <td>0.329503</td>
      <td>0.841977</td>
    </tr>
    <tr>
      <th>46</th>
      <td>XGBoost Regressor</td>
      <td>21</td>
      <td>12</td>
      <td>9.063869</td>
      <td>0.312853</td>
      <td>0.857544</td>
    </tr>
    <tr>
      <th>47</th>
      <td>XGBoost Regressor</td>
      <td>28</td>
      <td>12</td>
      <td>12.486707</td>
      <td>0.334852</td>
      <td>0.845329</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataxgboost</span><span class="p">[</span><span class="n">dataxgboost</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">13</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>48</th>
      <td>XGBoost Regressor</td>
      <td>7</td>
      <td>13</td>
      <td>15.428204</td>
      <td>0.310866</td>
      <td>0.926199</td>
    </tr>
    <tr>
      <th>49</th>
      <td>XGBoost Regressor</td>
      <td>14</td>
      <td>13</td>
      <td>10.241665</td>
      <td>0.310943</td>
      <td>0.855514</td>
    </tr>
    <tr>
      <th>50</th>
      <td>XGBoost Regressor</td>
      <td>21</td>
      <td>13</td>
      <td>8.419974</td>
      <td>0.271692</td>
      <td>0.889689</td>
    </tr>
    <tr>
      <th>51</th>
      <td>XGBoost Regressor</td>
      <td>28</td>
      <td>13</td>
      <td>12.811080</td>
      <td>0.349024</td>
      <td>0.851413</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataxgboost</span><span class="p">[</span><span class="n">dataxgboost</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">14</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>52</th>
      <td>XGBoost Regressor</td>
      <td>7</td>
      <td>14</td>
      <td>15.959922</td>
      <td>0.310045</td>
      <td>0.921634</td>
    </tr>
    <tr>
      <th>53</th>
      <td>XGBoost Regressor</td>
      <td>14</td>
      <td>14</td>
      <td>10.236957</td>
      <td>0.312314</td>
      <td>0.891513</td>
    </tr>
    <tr>
      <th>54</th>
      <td>XGBoost Regressor</td>
      <td>21</td>
      <td>14</td>
      <td>8.309295</td>
      <td>0.270052</td>
      <td>0.918887</td>
    </tr>
    <tr>
      <th>55</th>
      <td>XGBoost Regressor</td>
      <td>28</td>
      <td>14</td>
      <td>13.349935</td>
      <td>0.364969</td>
      <td>0.842351</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataxgboost</span><span class="p">[</span><span class="n">dataxgboost</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">15</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>56</th>
      <td>XGBoost Regressor</td>
      <td>7</td>
      <td>15</td>
      <td>17.720484</td>
      <td>0.352748</td>
      <td>0.895503</td>
    </tr>
    <tr>
      <th>57</th>
      <td>XGBoost Regressor</td>
      <td>14</td>
      <td>15</td>
      <td>10.174567</td>
      <td>0.310807</td>
      <td>0.899045</td>
    </tr>
    <tr>
      <th>58</th>
      <td>XGBoost Regressor</td>
      <td>21</td>
      <td>15</td>
      <td>8.396927</td>
      <td>0.271855</td>
      <td>0.922764</td>
    </tr>
    <tr>
      <th>59</th>
      <td>XGBoost Regressor</td>
      <td>28</td>
      <td>15</td>
      <td>43.762307</td>
      <td>0.348137</td>
      <td>0.864516</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataxgboost</span><span class="p">[</span><span class="n">dataxgboost</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">16</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>60</th>
      <td>XGBoost Regressor</td>
      <td>7</td>
      <td>16</td>
      <td>17.743347</td>
      <td>0.352583</td>
      <td>0.896739</td>
    </tr>
    <tr>
      <th>61</th>
      <td>XGBoost Regressor</td>
      <td>14</td>
      <td>16</td>
      <td>10.257051</td>
      <td>0.311900</td>
      <td>0.904728</td>
    </tr>
    <tr>
      <th>62</th>
      <td>XGBoost Regressor</td>
      <td>21</td>
      <td>16</td>
      <td>9.129478</td>
      <td>0.316870</td>
      <td>0.901668</td>
    </tr>
    <tr>
      <th>63</th>
      <td>XGBoost Regressor</td>
      <td>28</td>
      <td>16</td>
      <td>44.983340</td>
      <td>0.358318</td>
      <td>0.855849</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataxgboost</span><span class="p">[</span><span class="n">dataxgboost</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">17</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>64</th>
      <td>XGBoost Regressor</td>
      <td>7</td>
      <td>17</td>
      <td>17.450758</td>
      <td>0.351052</td>
      <td>0.783160</td>
    </tr>
    <tr>
      <th>65</th>
      <td>XGBoost Regressor</td>
      <td>14</td>
      <td>17</td>
      <td>9.941006</td>
      <td>0.307929</td>
      <td>0.909116</td>
    </tr>
    <tr>
      <th>66</th>
      <td>XGBoost Regressor</td>
      <td>21</td>
      <td>17</td>
      <td>8.242218</td>
      <td>0.287356</td>
      <td>0.920855</td>
    </tr>
    <tr>
      <th>67</th>
      <td>XGBoost Regressor</td>
      <td>28</td>
      <td>17</td>
      <td>13.309117</td>
      <td>0.361624</td>
      <td>0.834800</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataxgboost</span><span class="p">[</span><span class="n">dataxgboost</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">18</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>68</th>
      <td>XGBoost Regressor</td>
      <td>7</td>
      <td>18</td>
      <td>19.273251</td>
      <td>0.349303</td>
      <td>0.906323</td>
    </tr>
    <tr>
      <th>69</th>
      <td>XGBoost Regressor</td>
      <td>14</td>
      <td>18</td>
      <td>9.772140</td>
      <td>0.306508</td>
      <td>0.915520</td>
    </tr>
    <tr>
      <th>70</th>
      <td>XGBoost Regressor</td>
      <td>21</td>
      <td>18</td>
      <td>8.815294</td>
      <td>0.364407</td>
      <td>0.880590</td>
    </tr>
    <tr>
      <th>71</th>
      <td>XGBoost Regressor</td>
      <td>28</td>
      <td>18</td>
      <td>13.510378</td>
      <td>0.366035</td>
      <td>0.833559</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataxgboost</span><span class="p">[</span><span class="n">dataxgboost</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">19</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>72</th>
      <td>XGBoost Regressor</td>
      <td>7</td>
      <td>19</td>
      <td>17.696070</td>
      <td>0.352202</td>
      <td>0.763815</td>
    </tr>
    <tr>
      <th>73</th>
      <td>XGBoost Regressor</td>
      <td>14</td>
      <td>19</td>
      <td>10.247665</td>
      <td>0.348532</td>
      <td>0.897915</td>
    </tr>
    <tr>
      <th>74</th>
      <td>XGBoost Regressor</td>
      <td>21</td>
      <td>19</td>
      <td>10.253401</td>
      <td>0.383127</td>
      <td>0.906604</td>
    </tr>
    <tr>
      <th>75</th>
      <td>XGBoost Regressor</td>
      <td>28</td>
      <td>19</td>
      <td>10.370139</td>
      <td>0.357017</td>
      <td>0.845294</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataxgboost</span><span class="p">[</span><span class="n">dataxgboost</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">20</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>76</th>
      <td>XGBoost Regressor</td>
      <td>7</td>
      <td>20</td>
      <td>17.873475</td>
      <td>0.347979</td>
      <td>0.748085</td>
    </tr>
    <tr>
      <th>77</th>
      <td>XGBoost Regressor</td>
      <td>14</td>
      <td>20</td>
      <td>19.057278</td>
      <td>0.365859</td>
      <td>0.721533</td>
    </tr>
    <tr>
      <th>78</th>
      <td>XGBoost Regressor</td>
      <td>21</td>
      <td>20</td>
      <td>8.895222</td>
      <td>0.337525</td>
      <td>0.926708</td>
    </tr>
    <tr>
      <th>79</th>
      <td>XGBoost Regressor</td>
      <td>28</td>
      <td>20</td>
      <td>10.450620</td>
      <td>0.360048</td>
      <td>0.842656</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataxgboost</span><span class="p">[</span><span class="n">dataxgboost</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">21</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>80</th>
      <td>XGBoost Regressor</td>
      <td>7</td>
      <td>21</td>
      <td>19.720005</td>
      <td>0.380403</td>
      <td>0.705141</td>
    </tr>
    <tr>
      <th>81</th>
      <td>XGBoost Regressor</td>
      <td>14</td>
      <td>21</td>
      <td>10.597207</td>
      <td>0.370945</td>
      <td>0.884363</td>
    </tr>
    <tr>
      <th>82</th>
      <td>XGBoost Regressor</td>
      <td>21</td>
      <td>21</td>
      <td>8.177279</td>
      <td>0.324807</td>
      <td>0.928793</td>
    </tr>
    <tr>
      <th>83</th>
      <td>XGBoost Regressor</td>
      <td>28</td>
      <td>21</td>
      <td>20.230223</td>
      <td>0.379850</td>
      <td>0.848251</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataxgboost</span><span class="p">[</span><span class="n">dataxgboost</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">22</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>84</th>
      <td>XGBoost Regressor</td>
      <td>7</td>
      <td>22</td>
      <td>19.612573</td>
      <td>0.376235</td>
      <td>0.725437</td>
    </tr>
    <tr>
      <th>85</th>
      <td>XGBoost Regressor</td>
      <td>14</td>
      <td>22</td>
      <td>11.440127</td>
      <td>0.387420</td>
      <td>0.871524</td>
    </tr>
    <tr>
      <th>86</th>
      <td>XGBoost Regressor</td>
      <td>21</td>
      <td>22</td>
      <td>8.080962</td>
      <td>0.324480</td>
      <td>0.928937</td>
    </tr>
    <tr>
      <th>87</th>
      <td>XGBoost Regressor</td>
      <td>28</td>
      <td>22</td>
      <td>24.454711</td>
      <td>0.393698</td>
      <td>0.853881</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataxgboost</span><span class="p">[</span><span class="n">dataxgboost</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">23</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>88</th>
      <td>XGBoost Regressor</td>
      <td>7</td>
      <td>23</td>
      <td>29.560130</td>
      <td>0.369734</td>
      <td>0.916168</td>
    </tr>
    <tr>
      <th>89</th>
      <td>XGBoost Regressor</td>
      <td>14</td>
      <td>23</td>
      <td>11.741153</td>
      <td>0.391514</td>
      <td>0.870191</td>
    </tr>
    <tr>
      <th>90</th>
      <td>XGBoost Regressor</td>
      <td>21</td>
      <td>23</td>
      <td>8.237917</td>
      <td>0.325266</td>
      <td>0.927522</td>
    </tr>
    <tr>
      <th>91</th>
      <td>XGBoost Regressor</td>
      <td>28</td>
      <td>23</td>
      <td>13.925293</td>
      <td>0.390121</td>
      <td>0.821240</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataxgboost</span><span class="p">[</span><span class="n">dataxgboost</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">24</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>92</th>
      <td>XGBoost Regressor</td>
      <td>7</td>
      <td>24</td>
      <td>15.109735</td>
      <td>0.372007</td>
      <td>0.820075</td>
    </tr>
    <tr>
      <th>93</th>
      <td>XGBoost Regressor</td>
      <td>14</td>
      <td>24</td>
      <td>12.021444</td>
      <td>0.394291</td>
      <td>0.868343</td>
    </tr>
    <tr>
      <th>94</th>
      <td>XGBoost Regressor</td>
      <td>21</td>
      <td>24</td>
      <td>8.173927</td>
      <td>0.324058</td>
      <td>0.929835</td>
    </tr>
    <tr>
      <th>95</th>
      <td>XGBoost Regressor</td>
      <td>28</td>
      <td>24</td>
      <td>13.808262</td>
      <td>0.389825</td>
      <td>0.821511</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<section id="id6">
<h4><strong>MEJOR MODELO - CADA HORA</strong><a class="headerlink" href="#id6" title="Link to this heading">#</a></h4>
<p>Ahora mostraremos el mejor modelo de cada hora.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mejorxgboosthora</span> <span class="o">=</span> <span class="n">mejormodelohora</span><span class="p">(</span><span class="n">particiones</span><span class="p">,</span> <span class="n">dataxgboost</span><span class="p">)</span>
<span class="n">mejorxgboosthora</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>XGBoost Regressor</td>
      <td>21</td>
      <td>1</td>
      <td>9.294955</td>
      <td>0.295592</td>
      <td>0.883791</td>
    </tr>
    <tr>
      <th>6</th>
      <td>XGBoost Regressor</td>
      <td>21</td>
      <td>2</td>
      <td>9.864716</td>
      <td>0.304509</td>
      <td>0.876431</td>
    </tr>
    <tr>
      <th>10</th>
      <td>XGBoost Regressor</td>
      <td>21</td>
      <td>3</td>
      <td>10.279032</td>
      <td>0.308488</td>
      <td>0.877511</td>
    </tr>
    <tr>
      <th>14</th>
      <td>XGBoost Regressor</td>
      <td>21</td>
      <td>4</td>
      <td>11.370401</td>
      <td>0.333986</td>
      <td>0.856056</td>
    </tr>
    <tr>
      <th>18</th>
      <td>XGBoost Regressor</td>
      <td>21</td>
      <td>5</td>
      <td>10.862324</td>
      <td>0.330553</td>
      <td>0.851213</td>
    </tr>
    <tr>
      <th>22</th>
      <td>XGBoost Regressor</td>
      <td>21</td>
      <td>6</td>
      <td>10.992183</td>
      <td>0.335949</td>
      <td>0.838187</td>
    </tr>
    <tr>
      <th>26</th>
      <td>XGBoost Regressor</td>
      <td>21</td>
      <td>7</td>
      <td>10.707124</td>
      <td>0.333277</td>
      <td>0.839412</td>
    </tr>
    <tr>
      <th>28</th>
      <td>XGBoost Regressor</td>
      <td>7</td>
      <td>8</td>
      <td>15.405598</td>
      <td>0.329977</td>
      <td>0.944157</td>
    </tr>
    <tr>
      <th>32</th>
      <td>XGBoost Regressor</td>
      <td>7</td>
      <td>9</td>
      <td>15.327656</td>
      <td>0.329015</td>
      <td>0.941876</td>
    </tr>
    <tr>
      <th>36</th>
      <td>XGBoost Regressor</td>
      <td>7</td>
      <td>10</td>
      <td>15.370188</td>
      <td>0.317740</td>
      <td>0.937797</td>
    </tr>
    <tr>
      <th>40</th>
      <td>XGBoost Regressor</td>
      <td>7</td>
      <td>11</td>
      <td>15.674963</td>
      <td>0.321396</td>
      <td>0.933267</td>
    </tr>
    <tr>
      <th>46</th>
      <td>XGBoost Regressor</td>
      <td>21</td>
      <td>12</td>
      <td>9.063869</td>
      <td>0.312853</td>
      <td>0.857544</td>
    </tr>
    <tr>
      <th>50</th>
      <td>XGBoost Regressor</td>
      <td>21</td>
      <td>13</td>
      <td>8.419974</td>
      <td>0.271692</td>
      <td>0.889689</td>
    </tr>
    <tr>
      <th>54</th>
      <td>XGBoost Regressor</td>
      <td>21</td>
      <td>14</td>
      <td>8.309295</td>
      <td>0.270052</td>
      <td>0.918887</td>
    </tr>
    <tr>
      <th>58</th>
      <td>XGBoost Regressor</td>
      <td>21</td>
      <td>15</td>
      <td>8.396927</td>
      <td>0.271855</td>
      <td>0.922764</td>
    </tr>
    <tr>
      <th>61</th>
      <td>XGBoost Regressor</td>
      <td>14</td>
      <td>16</td>
      <td>10.257051</td>
      <td>0.311900</td>
      <td>0.904728</td>
    </tr>
    <tr>
      <th>66</th>
      <td>XGBoost Regressor</td>
      <td>21</td>
      <td>17</td>
      <td>8.242218</td>
      <td>0.287356</td>
      <td>0.920855</td>
    </tr>
    <tr>
      <th>69</th>
      <td>XGBoost Regressor</td>
      <td>14</td>
      <td>18</td>
      <td>9.772140</td>
      <td>0.306508</td>
      <td>0.915520</td>
    </tr>
    <tr>
      <th>73</th>
      <td>XGBoost Regressor</td>
      <td>14</td>
      <td>19</td>
      <td>10.247665</td>
      <td>0.348532</td>
      <td>0.897915</td>
    </tr>
    <tr>
      <th>78</th>
      <td>XGBoost Regressor</td>
      <td>21</td>
      <td>20</td>
      <td>8.895222</td>
      <td>0.337525</td>
      <td>0.926708</td>
    </tr>
    <tr>
      <th>82</th>
      <td>XGBoost Regressor</td>
      <td>21</td>
      <td>21</td>
      <td>8.177279</td>
      <td>0.324807</td>
      <td>0.928793</td>
    </tr>
    <tr>
      <th>86</th>
      <td>XGBoost Regressor</td>
      <td>21</td>
      <td>22</td>
      <td>8.080962</td>
      <td>0.324480</td>
      <td>0.928937</td>
    </tr>
    <tr>
      <th>90</th>
      <td>XGBoost Regressor</td>
      <td>21</td>
      <td>23</td>
      <td>8.237917</td>
      <td>0.325266</td>
      <td>0.927522</td>
    </tr>
    <tr>
      <th>94</th>
      <td>XGBoost Regressor</td>
      <td>21</td>
      <td>24</td>
      <td>8.173927</td>
      <td>0.324058</td>
      <td>0.929835</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="hora-y-ventana-con-mejor-modelo-xgboost">
<h4><strong>HORA Y VENTANA CON MEJOR MODELO XGBOOST</strong><a class="headerlink" href="#hora-y-ventana-con-mejor-modelo-xgboost" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bestxgboost</span> <span class="o">=</span> <span class="n">mejormodelotot</span><span class="p">(</span><span class="n">mejorxgboosthora</span><span class="p">)</span>
<span class="n">bestxgboost</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>54</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Modelo</th>
      <td>XGBoost Regressor</td>
    </tr>
    <tr>
      <th>Dias</th>
      <td>21</td>
    </tr>
    <tr>
      <th>Hora</th>
      <td>14</td>
    </tr>
    <tr>
      <th>MAPE</th>
      <td>8.309295</td>
    </tr>
    <tr>
      <th>RMSE</th>
      <td>0.270052</td>
    </tr>
    <tr>
      <th>R^2</th>
      <td>0.918887</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Es decir, para la <strong>Regresión de XGBoost</strong>, el mejor modelo se da cuando se trabaja con la <strong>HORA</strong>: <code class="docutils literal notranslate"><span class="pre">14</span></code> en la venta de predicción de <code class="docutils literal notranslate"><span class="pre">21</span> <span class="pre">días</span></code>. Veamos los valores de <strong>Ljung-Box p-value</strong> y <strong>Jarque-Bera p-value</strong>. Antes de ello, veamos cuáles son las pruebas de hipótesis para comprender mejor los p-valores que se nos arrojen.</p>
<ul class="simple">
<li><p><strong>Prueba de Ljung-Box</strong></p></li>
</ul>
<ul class="simple">
<li><p><strong>Hipótesis nula (H₀)</strong>: No hay autocorrelación en los residuos (es decir, los residuos son independientes entre sí).</p></li>
<li><p><strong>Hipótesis alternativa (H₁)</strong>: Hay autocorrelación en los residuos</p></li>
</ul>
<ul class="simple">
<li><p><strong>Prueba de Jarque-Bera</strong></p></li>
</ul>
<ul class="simple">
<li><p><strong>Hipótesis nula (H₀)</strong>: Los residuos tienen una distribución normal.</p></li>
<li><p><strong>Hipótesis alternativa (H₁)</strong>: Los residuos no tienen una distribución normal.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">metricas</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">dias</span> <span class="o">=</span> <span class="mi">21</span>
<span class="n">hora</span> <span class="o">=</span> <span class="mi">14</span>
<span class="n">iniciotrain</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">while</span> <span class="p">(</span><span class="n">iniciotrain</span> <span class="o">+</span> <span class="p">(</span><span class="n">dias</span> <span class="o">*</span> <span class="mi">24</span><span class="p">)</span> <span class="o">+</span> <span class="n">hora</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">):</span>  
    <span class="n">fintrain</span> <span class="o">=</span> <span class="n">iniciotrain</span> <span class="o">+</span> <span class="p">(</span><span class="n">dias</span> <span class="o">*</span> <span class="mi">24</span><span class="p">)</span>   
    <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">plieguess</span><span class="p">(</span><span class="n">iniciotrain</span><span class="p">,</span> <span class="n">fintrain</span><span class="p">,</span> <span class="n">hora</span><span class="p">)</span>   
    <span class="n">modeloxgboost</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
    <span class="n">y_prediccion</span><span class="o">=</span> <span class="n">modeloxgboost</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>       
    <span class="n">rmse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">,</span> <span class="n">squared</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">mape</span> <span class="o">=</span> <span class="n">MAPE</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">)</span>
    <span class="n">r2</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">)</span>
    <span class="n">ljungbox</span><span class="p">,</span> <span class="n">jarquebera</span> <span class="o">=</span> <span class="n">residuos</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">)</span>   
    <span class="n">metricas</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
        <span class="s1">&#39;Modelo&#39;</span><span class="p">:</span> <span class="s1">&#39;Regresión XGBoost&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Dias&#39;</span><span class="p">:</span> <span class="n">dias</span><span class="p">,</span>
        <span class="s1">&#39;Hora&#39;</span><span class="p">:</span> <span class="n">hora</span><span class="p">,</span>
        <span class="s1">&#39;MAPE&#39;</span><span class="p">:</span> <span class="n">mape</span><span class="p">,</span>
        <span class="s1">&#39;RMSE&#39;</span><span class="p">:</span> <span class="n">rmse</span><span class="p">,</span>
        <span class="s1">&#39;R^2&#39;</span><span class="p">:</span> <span class="n">r2</span><span class="p">,</span>
        <span class="s1">&#39;Ljung-Box p-value&#39;</span> <span class="p">:</span> <span class="n">ljungbox</span><span class="p">,</span>
        <span class="s1">&#39;Jarque-Bera p-value&#39;</span> <span class="p">:</span> <span class="n">jarquebera</span>
    <span class="p">})</span>   
    <span class="n">iniciotrain</span> <span class="o">=</span> <span class="n">fintrain</span>  
<span class="n">dataxgboost</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">metricas</span><span class="p">)</span>
<span class="n">dataxgboost</span> <span class="o">=</span> <span class="n">dataxgboost</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dataxgboost</span><span class="p">[</span><span class="s1">&#39;RMSE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">idxmin</span><span class="p">()]</span>
<span class="n">dataxgboost</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">dataxgboost</span><span class="p">)</span>
<span class="n">dataxgboost</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>33</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Modelo</th>
      <td>Regresión XGBoost</td>
    </tr>
    <tr>
      <th>Dias</th>
      <td>21</td>
    </tr>
    <tr>
      <th>Hora</th>
      <td>14</td>
    </tr>
    <tr>
      <th>MAPE</th>
      <td>8.309295</td>
    </tr>
    <tr>
      <th>RMSE</th>
      <td>0.270052</td>
    </tr>
    <tr>
      <th>R^2</th>
      <td>0.918887</td>
    </tr>
    <tr>
      <th>Ljung-Box p-value</th>
      <td>0.939791</td>
    </tr>
    <tr>
      <th>Jarque-Bera p-value</th>
      <td>0.683277</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>En este sentido, sobre el modelo de regresión de xgboost, podemos afirmar que el mejor modelo identificado tiene un <strong>MAPE</strong> de <code class="docutils literal notranslate"><span class="pre">8.3%</span></code>, lo que indica que, en promedio, las predicciones presentan una desviación porcentual consistente con respecto a los valores reales. El <strong>RMSE</strong> es de <code class="docutils literal notranslate"><span class="pre">0.27</span></code>, lo que significa que el error promedio en las predicciones es bajo, y el modelo está prediciendo con bastante precisión. Además, el <strong>R²</strong> de <code class="docutils literal notranslate"><span class="pre">0.918887</span></code> muestra que el modelo explica aproximadamente el <code class="docutils literal notranslate"><span class="pre">91%</span></code> de la variabilidad de los datos.</p>
<p>Respecto a los residuos, el <strong>p-valor</strong> de la prueba de <strong>Ljung-Box</strong> es <code class="docutils literal notranslate"><span class="pre">0.93</span></code>, lo que indica que no hay autocorrelación significativa, lo cual es positivo ya que significa que los residuos son independientes. Por otro lado, el <strong>p-valor</strong> de la prueba de <strong>Jarque-Bera</strong> es <code class="docutils literal notranslate"><span class="pre">0.68</span></code>, lo que sugiere que no se puede rechazar la hipótesis de normalidad de los residuos, lo cual es deseable para validar las inferencias del modelo.</p>
</section>
</section>
<section id="modelo-svr">
<h3><strong>MODELO SVR</strong><a class="headerlink" href="#modelo-svr" title="Link to this heading">#</a></h3>
<p>Con este modelo ocurre una particularidad, y es que es muy sensible a los hiperparámetros por lo que trabajar con los predeterminados desde un principio no brinda información de utilidad para este ejercicio. Por esta razón, lo entrenaremos con los mejores hiperparámetros encontrados a partir de optimización bayesiana.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">skopt</span> <span class="kn">import</span> <span class="n">gp_minimize</span>
<span class="kn">from</span> <span class="nn">skopt.space</span> <span class="kn">import</span> <span class="n">Real</span><span class="p">,</span> <span class="n">Categorical</span>
<span class="kn">from</span> <span class="nn">sklearn.svm</span> <span class="kn">import</span> <span class="n">SVR</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_squared_error</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># Espacio de búsqueda para SVR</span>
<span class="n">espaciobusqueda_svr</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">Real</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;C&quot;</span><span class="p">),</span>  <span class="c1"># Rango continuo para el parámetro C</span>
    <span class="n">Categorical</span><span class="p">([</span><span class="s2">&quot;rbf&quot;</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;kernel&quot;</span><span class="p">),</span>  <span class="c1"># Selección del kernel</span>
    <span class="n">Categorical</span><span class="p">([</span><span class="s2">&quot;scale&quot;</span><span class="p">,</span> <span class="s2">&quot;auto&quot;</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;gamma&quot;</span><span class="p">)</span>  <span class="c1"># Opciones de gamma</span>
<span class="p">]</span>

<span class="c1"># Función objetivo para optimización</span>
<span class="k">def</span> <span class="nf">funcionobjetivo_svr</span><span class="p">(</span><span class="n">params</span><span class="p">):</span>
    <span class="n">C</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">kernel</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">gamma</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>

    <span class="c1"># Modelo SVR con los parámetros actuales</span>
    <span class="n">modelosvr</span> <span class="o">=</span> <span class="n">SVR</span><span class="p">(</span><span class="n">C</span><span class="o">=</span><span class="n">C</span><span class="p">,</span>  <span class="n">kernel</span><span class="o">=</span><span class="n">kernel</span><span class="p">,</span> <span class="n">gamma</span><span class="o">=</span><span class="n">gamma</span><span class="p">)</span>

    <span class="n">metricas</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1"># Ciclo para calcular errores por hora y partición</span>
    <span class="k">for</span> <span class="n">hora</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">25</span><span class="p">):</span>  <span class="c1"># Horas de predicción (1 a 24)</span>
        <span class="k">for</span> <span class="n">dias</span> <span class="ow">in</span> <span class="n">particiones</span><span class="p">:</span>  <span class="c1"># Ventanas de días (e.g., 7, 14, 28 días)</span>
            <span class="n">iniciotrain</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">while</span> <span class="p">(</span><span class="n">iniciotrain</span> <span class="o">+</span> <span class="p">(</span><span class="n">dias</span> <span class="o">*</span> <span class="mi">24</span><span class="p">)</span> <span class="o">+</span> <span class="n">hora</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">):</span>
                <span class="n">fintrain</span> <span class="o">=</span> <span class="n">iniciotrain</span> <span class="o">+</span> <span class="p">(</span><span class="n">dias</span> <span class="o">*</span> <span class="mi">24</span><span class="p">)</span>

                <span class="c1"># Obtener los conjuntos de entrenamiento y prueba</span>
                <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">plieguess</span><span class="p">(</span><span class="n">iniciotrain</span><span class="p">,</span> <span class="n">fintrain</span><span class="p">,</span> <span class="n">hora</span><span class="p">)</span>

                <span class="c1"># Entrenar el modelo</span>
                <span class="n">modelosvr</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

                <span class="c1"># Predicción</span>
                <span class="n">y_prediccion</span> <span class="o">=</span> <span class="n">modelosvr</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

                <span class="c1"># Calcular métricas</span>
                <span class="n">rmse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">,</span> <span class="n">squared</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                <span class="n">metricas</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rmse</span><span class="p">)</span>

                <span class="c1"># Actualizar inicio para el siguiente pliegue</span>
                <span class="n">iniciotrain</span> <span class="o">=</span> <span class="n">fintrain</span>

    <span class="c1"># Promedio de RMSE en todas las particiones y horas</span>
    <span class="n">rmse_promedio</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">metricas</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">rmse_promedio</span>  <span class="c1"># Minimizar este valor</span>

<span class="c1"># Ejecutar optimización bayesiana</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">gp_minimize</span><span class="p">(</span><span class="n">funcionobjetivo_svr</span><span class="p">,</span> <span class="n">espaciobusqueda_svr</span><span class="p">,</span> <span class="n">n_calls</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">21</span><span class="p">)</span>

<span class="c1"># Mostrar los mejores hiperparámetros encontrados</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mejores hiperparámetros encontrados:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;C = </span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, kernel = </span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">, gamma = </span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Mejores hiperparámetros encontrados:
C = 2.715390236475287, kernel = rbf, gamma = auto
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">modelosvr</span> <span class="o">=</span> <span class="n">SVR</span><span class="p">(</span><span class="n">C</span> <span class="o">=</span> <span class="mf">2.715390236475287</span><span class="p">,</span> <span class="n">kernel</span> <span class="o">=</span> <span class="s2">&quot;rbf&quot;</span><span class="p">,</span> <span class="n">gamma</span> <span class="o">=</span> <span class="s2">&quot;auto&quot;</span><span class="p">)</span>
<span class="n">metricas</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">hora</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">25</span><span class="p">):</span>  <span class="c1"># Ciclo para calcular la tabla de errores para cada hora (puedes extender hasta 24)   </span>
    <span class="k">for</span> <span class="n">dias</span> <span class="ow">in</span> <span class="n">particiones</span><span class="p">:</span>  <span class="c1"># Ciclo que recorre las particiones para las ventanas        </span>
        <span class="n">iniciotrain</span> <span class="o">=</span> <span class="mi">0</span>        
        <span class="k">while</span> <span class="p">(</span><span class="n">iniciotrain</span> <span class="o">+</span> <span class="p">(</span><span class="n">dias</span> <span class="o">*</span> <span class="mi">24</span><span class="p">)</span> <span class="o">+</span> <span class="n">hora</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">):</span>  <span class="c1"># Mientras que el tamaño del pliegue más la hora sea menor que la longitud de los datos           </span>
            <span class="n">fintrain</span> <span class="o">=</span> <span class="n">iniciotrain</span> <span class="o">+</span> <span class="p">(</span><span class="n">dias</span> <span class="o">*</span> <span class="mi">24</span><span class="p">)</span>            
            <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">plieguess</span><span class="p">(</span><span class="n">iniciotrain</span><span class="p">,</span><span class="n">fintrain</span><span class="p">,</span><span class="n">hora</span><span class="p">)</span>          
            <span class="n">modelosvr</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
            <span class="n">y_prediccion</span><span class="o">=</span> <span class="n">modelosvr</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>               
            <span class="n">rmse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">,</span> <span class="n">squared</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="n">mape</span> <span class="o">=</span> <span class="n">MAPE</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">)</span>
            <span class="n">r2</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">)</span>
            <span class="n">metricas</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
                <span class="s1">&#39;Modelo&#39;</span><span class="p">:</span> <span class="s1">&#39;Regresión con Máquinas de Vectores de Soporte&#39;</span><span class="p">,</span>
                <span class="s1">&#39;Dias&#39;</span><span class="p">:</span> <span class="n">dias</span><span class="p">,</span>
                <span class="s1">&#39;Hora&#39;</span><span class="p">:</span> <span class="n">hora</span><span class="p">,</span>
                <span class="s1">&#39;MAPE&#39;</span><span class="p">:</span> <span class="n">mape</span><span class="p">,</span>
                <span class="s1">&#39;RMSE&#39;</span><span class="p">:</span> <span class="n">rmse</span><span class="p">,</span>
                <span class="s1">&#39;R^2&#39;</span><span class="p">:</span> <span class="n">r2</span><span class="p">,</span>
            <span class="p">})</span>           
            <span class="n">iniciotrain</span> <span class="o">=</span> <span class="n">fintrain</span>  <span class="c1"># Actualizar el inicio para el siguiente pliegue</span>
<span class="n">datasvr</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">metricas</span><span class="p">)</span>
<span class="n">datasvr</span> <span class="o">=</span> <span class="n">datasvr</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">datasvr</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;Modelo&#39;</span><span class="p">,</span> <span class="s1">&#39;Hora&#39;</span><span class="p">,</span> <span class="s1">&#39;Dias&#39;</span><span class="p">])[</span><span class="s1">&#39;RMSE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">idxmin</span><span class="p">()]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datasvr</span><span class="p">[</span><span class="n">datasvr</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Regresión con Máquinas de Vectores de Soporte</td>
      <td>7</td>
      <td>1</td>
      <td>11.390603</td>
      <td>0.432495</td>
      <td>0.377035</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Regresión con Máquinas de Vectores de Soporte</td>
      <td>14</td>
      <td>1</td>
      <td>11.546627</td>
      <td>0.448884</td>
      <td>0.328927</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Regresión con Máquinas de Vectores de Soporte</td>
      <td>21</td>
      <td>1</td>
      <td>22.314503</td>
      <td>0.344937</td>
      <td>0.914979</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Regresión con Máquinas de Vectores de Soporte</td>
      <td>28</td>
      <td>1</td>
      <td>9.382886</td>
      <td>0.370740</td>
      <td>0.842353</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datasvr</span><span class="p">[</span><span class="n">datasvr</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>4</th>
      <td>Regresión con Máquinas de Vectores de Soporte</td>
      <td>7</td>
      <td>2</td>
      <td>17.578798</td>
      <td>0.469005</td>
      <td>0.430715</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Regresión con Máquinas de Vectores de Soporte</td>
      <td>14</td>
      <td>2</td>
      <td>11.821309</td>
      <td>0.443713</td>
      <td>0.790118</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Regresión con Máquinas de Vectores de Soporte</td>
      <td>21</td>
      <td>2</td>
      <td>22.271969</td>
      <td>0.344900</td>
      <td>0.914875</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Regresión con Máquinas de Vectores de Soporte</td>
      <td>28</td>
      <td>2</td>
      <td>9.164398</td>
      <td>0.382999</td>
      <td>0.819364</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datasvr</span><span class="p">[</span><span class="n">datasvr</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">3</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>8</th>
      <td>Regresión con Máquinas de Vectores de Soporte</td>
      <td>7</td>
      <td>3</td>
      <td>12.673705</td>
      <td>0.471819</td>
      <td>0.657921</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Regresión con Máquinas de Vectores de Soporte</td>
      <td>14</td>
      <td>3</td>
      <td>11.516314</td>
      <td>0.383981</td>
      <td>0.773434</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Regresión con Máquinas de Vectores de Soporte</td>
      <td>21</td>
      <td>3</td>
      <td>21.448288</td>
      <td>0.334242</td>
      <td>0.918503</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Regresión con Máquinas de Vectores de Soporte</td>
      <td>28</td>
      <td>3</td>
      <td>9.728936</td>
      <td>0.404242</td>
      <td>0.748893</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datasvr</span><span class="p">[</span><span class="n">datasvr</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">4</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>12</th>
      <td>Regresión con Máquinas de Vectores de Soporte</td>
      <td>7</td>
      <td>4</td>
      <td>19.293517</td>
      <td>0.463854</td>
      <td>0.762672</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Regresión con Máquinas de Vectores de Soporte</td>
      <td>14</td>
      <td>4</td>
      <td>10.640141</td>
      <td>0.415762</td>
      <td>0.790152</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Regresión con Máquinas de Vectores de Soporte</td>
      <td>21</td>
      <td>4</td>
      <td>11.792695</td>
      <td>0.302481</td>
      <td>0.921906</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Regresión con Máquinas de Vectores de Soporte</td>
      <td>28</td>
      <td>4</td>
      <td>12.054015</td>
      <td>0.431517</td>
      <td>0.757033</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datasvr</span><span class="p">[</span><span class="n">datasvr</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">5</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>16</th>
      <td>Regresión con Máquinas de Vectores de Soporte</td>
      <td>7</td>
      <td>5</td>
      <td>8.752032</td>
      <td>0.462012</td>
      <td>0.759256</td>
    </tr>
    <tr>
      <th>17</th>
      <td>Regresión con Máquinas de Vectores de Soporte</td>
      <td>14</td>
      <td>5</td>
      <td>10.102836</td>
      <td>0.393873</td>
      <td>0.815131</td>
    </tr>
    <tr>
      <th>18</th>
      <td>Regresión con Máquinas de Vectores de Soporte</td>
      <td>21</td>
      <td>5</td>
      <td>13.800537</td>
      <td>0.349127</td>
      <td>0.891115</td>
    </tr>
    <tr>
      <th>19</th>
      <td>Regresión con Máquinas de Vectores de Soporte</td>
      <td>28</td>
      <td>5</td>
      <td>15.753104</td>
      <td>0.453086</td>
      <td>0.859671</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datasvr</span><span class="p">[</span><span class="n">datasvr</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">6</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>20</th>
      <td>Regresión con Máquinas de Vectores de Soporte</td>
      <td>7</td>
      <td>6</td>
      <td>8.429208</td>
      <td>0.409479</td>
      <td>0.764302</td>
    </tr>
    <tr>
      <th>21</th>
      <td>Regresión con Máquinas de Vectores de Soporte</td>
      <td>14</td>
      <td>6</td>
      <td>10.910178</td>
      <td>0.411316</td>
      <td>0.808199</td>
    </tr>
    <tr>
      <th>22</th>
      <td>Regresión con Máquinas de Vectores de Soporte</td>
      <td>21</td>
      <td>6</td>
      <td>15.195401</td>
      <td>0.362759</td>
      <td>0.880095</td>
    </tr>
    <tr>
      <th>23</th>
      <td>Regresión con Máquinas de Vectores de Soporte</td>
      <td>28</td>
      <td>6</td>
      <td>15.548423</td>
      <td>0.452943</td>
      <td>0.850778</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datasvr</span><span class="p">[</span><span class="n">datasvr</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">7</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>24</th>
      <td>Regresión con Máquinas de Vectores de Soporte</td>
      <td>7</td>
      <td>7</td>
      <td>9.077359</td>
      <td>0.430286</td>
      <td>0.711835</td>
    </tr>
    <tr>
      <th>25</th>
      <td>Regresión con Máquinas de Vectores de Soporte</td>
      <td>14</td>
      <td>7</td>
      <td>11.060049</td>
      <td>0.412423</td>
      <td>0.813933</td>
    </tr>
    <tr>
      <th>26</th>
      <td>Regresión con Máquinas de Vectores de Soporte</td>
      <td>21</td>
      <td>7</td>
      <td>15.079889</td>
      <td>0.376225</td>
      <td>0.864314</td>
    </tr>
    <tr>
      <th>27</th>
      <td>Regresión con Máquinas de Vectores de Soporte</td>
      <td>28</td>
      <td>7</td>
      <td>15.710536</td>
      <td>0.465631</td>
      <td>0.824025</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datasvr</span><span class="p">[</span><span class="n">datasvr</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">8</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>28</th>
      <td>Regresión con Máquinas de Vectores de Soporte</td>
      <td>7</td>
      <td>8</td>
      <td>8.837650</td>
      <td>0.423514</td>
      <td>0.701466</td>
    </tr>
    <tr>
      <th>29</th>
      <td>Regresión con Máquinas de Vectores de Soporte</td>
      <td>14</td>
      <td>8</td>
      <td>14.207074</td>
      <td>0.452028</td>
      <td>0.266431</td>
    </tr>
    <tr>
      <th>30</th>
      <td>Regresión con Máquinas de Vectores de Soporte</td>
      <td>21</td>
      <td>8</td>
      <td>14.898854</td>
      <td>0.398344</td>
      <td>0.871248</td>
    </tr>
    <tr>
      <th>31</th>
      <td>Regresión con Máquinas de Vectores de Soporte</td>
      <td>28</td>
      <td>8</td>
      <td>14.774928</td>
      <td>0.464361</td>
      <td>0.802764</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datasvr</span><span class="p">[</span><span class="n">datasvr</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">9</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>32</th>
      <td>Regresión con Máquinas de Vectores de Soporte</td>
      <td>7</td>
      <td>9</td>
      <td>9.318864</td>
      <td>0.445599</td>
      <td>0.649334</td>
    </tr>
    <tr>
      <th>33</th>
      <td>Regresión con Máquinas de Vectores de Soporte</td>
      <td>14</td>
      <td>9</td>
      <td>14.134803</td>
      <td>0.471677</td>
      <td>0.793029</td>
    </tr>
    <tr>
      <th>34</th>
      <td>Regresión con Máquinas de Vectores de Soporte</td>
      <td>21</td>
      <td>9</td>
      <td>14.976524</td>
      <td>0.403167</td>
      <td>0.863725</td>
    </tr>
    <tr>
      <th>35</th>
      <td>Regresión con Máquinas de Vectores de Soporte</td>
      <td>28</td>
      <td>9</td>
      <td>13.989080</td>
      <td>0.459332</td>
      <td>0.800525</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datasvr</span><span class="p">[</span><span class="n">datasvr</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">10</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>36</th>
      <td>Regresión con Máquinas de Vectores de Soporte</td>
      <td>7</td>
      <td>10</td>
      <td>21.369584</td>
      <td>0.443311</td>
      <td>0.558768</td>
    </tr>
    <tr>
      <th>37</th>
      <td>Regresión con Máquinas de Vectores de Soporte</td>
      <td>14</td>
      <td>10</td>
      <td>25.626073</td>
      <td>0.482642</td>
      <td>0.477002</td>
    </tr>
    <tr>
      <th>38</th>
      <td>Regresión con Máquinas de Vectores de Soporte</td>
      <td>21</td>
      <td>10</td>
      <td>16.387951</td>
      <td>0.438777</td>
      <td>0.832806</td>
    </tr>
    <tr>
      <th>39</th>
      <td>Regresión con Máquinas de Vectores de Soporte</td>
      <td>28</td>
      <td>10</td>
      <td>24.104725</td>
      <td>0.465747</td>
      <td>0.512976</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datasvr</span><span class="p">[</span><span class="n">datasvr</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">11</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>40</th>
      <td>Regresión con Máquinas de Vectores de Soporte</td>
      <td>7</td>
      <td>11</td>
      <td>14.195487</td>
      <td>0.445071</td>
      <td>0.407216</td>
    </tr>
    <tr>
      <th>41</th>
      <td>Regresión con Máquinas de Vectores de Soporte</td>
      <td>14</td>
      <td>11</td>
      <td>26.172979</td>
      <td>0.489652</td>
      <td>0.468985</td>
    </tr>
    <tr>
      <th>42</th>
      <td>Regresión con Máquinas de Vectores de Soporte</td>
      <td>21</td>
      <td>11</td>
      <td>24.570833</td>
      <td>0.472759</td>
      <td>0.713912</td>
    </tr>
    <tr>
      <th>43</th>
      <td>Regresión con Máquinas de Vectores de Soporte</td>
      <td>28</td>
      <td>11</td>
      <td>24.582294</td>
      <td>0.471177</td>
      <td>0.508300</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datasvr</span><span class="p">[</span><span class="n">datasvr</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">12</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>44</th>
      <td>Regresión con Máquinas de Vectores de Soporte</td>
      <td>7</td>
      <td>12</td>
      <td>21.103385</td>
      <td>0.447813</td>
      <td>0.542213</td>
    </tr>
    <tr>
      <th>45</th>
      <td>Regresión con Máquinas de Vectores de Soporte</td>
      <td>14</td>
      <td>12</td>
      <td>24.749880</td>
      <td>0.477272</td>
      <td>0.480000</td>
    </tr>
    <tr>
      <th>46</th>
      <td>Regresión con Máquinas de Vectores de Soporte</td>
      <td>21</td>
      <td>12</td>
      <td>22.784093</td>
      <td>0.462123</td>
      <td>0.735116</td>
    </tr>
    <tr>
      <th>47</th>
      <td>Regresión con Máquinas de Vectores de Soporte</td>
      <td>28</td>
      <td>12</td>
      <td>23.254580</td>
      <td>0.460824</td>
      <td>0.515224</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datasvr</span><span class="p">[</span><span class="n">datasvr</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">13</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>48</th>
      <td>Regresión con Máquinas de Vectores de Soporte</td>
      <td>7</td>
      <td>13</td>
      <td>15.116768</td>
      <td>0.439289</td>
      <td>0.050620</td>
    </tr>
    <tr>
      <th>49</th>
      <td>Regresión con Máquinas de Vectores de Soporte</td>
      <td>14</td>
      <td>13</td>
      <td>15.368353</td>
      <td>0.446158</td>
      <td>0.020696</td>
    </tr>
    <tr>
      <th>50</th>
      <td>Regresión con Máquinas de Vectores de Soporte</td>
      <td>21</td>
      <td>13</td>
      <td>21.337530</td>
      <td>0.458214</td>
      <td>0.737891</td>
    </tr>
    <tr>
      <th>51</th>
      <td>Regresión con Máquinas de Vectores de Soporte</td>
      <td>28</td>
      <td>13</td>
      <td>27.598016</td>
      <td>0.495914</td>
      <td>0.573479</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datasvr</span><span class="p">[</span><span class="n">datasvr</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">14</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>52</th>
      <td>Regresión con Máquinas de Vectores de Soporte</td>
      <td>7</td>
      <td>14</td>
      <td>16.012212</td>
      <td>0.457086</td>
      <td>-0.697835</td>
    </tr>
    <tr>
      <th>53</th>
      <td>Regresión con Máquinas de Vectores de Soporte</td>
      <td>14</td>
      <td>14</td>
      <td>16.353334</td>
      <td>0.467481</td>
      <td>-0.775933</td>
    </tr>
    <tr>
      <th>54</th>
      <td>Regresión con Máquinas de Vectores de Soporte</td>
      <td>21</td>
      <td>14</td>
      <td>28.638000</td>
      <td>0.446420</td>
      <td>0.744993</td>
    </tr>
    <tr>
      <th>55</th>
      <td>Regresión con Máquinas de Vectores de Soporte</td>
      <td>28</td>
      <td>14</td>
      <td>44.284169</td>
      <td>0.509426</td>
      <td>0.693763</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datasvr</span><span class="p">[</span><span class="n">datasvr</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">15</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>56</th>
      <td>Regresión con Máquinas de Vectores de Soporte</td>
      <td>7</td>
      <td>15</td>
      <td>15.325779</td>
      <td>0.481404</td>
      <td>0.151271</td>
    </tr>
    <tr>
      <th>57</th>
      <td>Regresión con Máquinas de Vectores de Soporte</td>
      <td>14</td>
      <td>15</td>
      <td>17.899386</td>
      <td>0.496801</td>
      <td>-1.029742</td>
    </tr>
    <tr>
      <th>58</th>
      <td>Regresión con Máquinas de Vectores de Soporte</td>
      <td>21</td>
      <td>15</td>
      <td>26.121357</td>
      <td>0.436507</td>
      <td>0.743071</td>
    </tr>
    <tr>
      <th>59</th>
      <td>Regresión con Máquinas de Vectores de Soporte</td>
      <td>28</td>
      <td>15</td>
      <td>26.247977</td>
      <td>0.490086</td>
      <td>0.578508</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datasvr</span><span class="p">[</span><span class="n">datasvr</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">16</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>60</th>
      <td>Regresión con Máquinas de Vectores de Soporte</td>
      <td>7</td>
      <td>16</td>
      <td>16.760171</td>
      <td>0.498748</td>
      <td>0.171936</td>
    </tr>
    <tr>
      <th>61</th>
      <td>Regresión con Máquinas de Vectores de Soporte</td>
      <td>14</td>
      <td>16</td>
      <td>12.418187</td>
      <td>0.476706</td>
      <td>0.632720</td>
    </tr>
    <tr>
      <th>62</th>
      <td>Regresión con Máquinas de Vectores de Soporte</td>
      <td>21</td>
      <td>16</td>
      <td>25.999325</td>
      <td>0.436258</td>
      <td>0.745243</td>
    </tr>
    <tr>
      <th>63</th>
      <td>Regresión con Máquinas de Vectores de Soporte</td>
      <td>28</td>
      <td>16</td>
      <td>20.095911</td>
      <td>0.465182</td>
      <td>0.687611</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datasvr</span><span class="p">[</span><span class="n">datasvr</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">17</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>64</th>
      <td>Regresión con Máquinas de Vectores de Soporte</td>
      <td>7</td>
      <td>17</td>
      <td>13.417774</td>
      <td>0.443169</td>
      <td>0.189875</td>
    </tr>
    <tr>
      <th>65</th>
      <td>Regresión con Máquinas de Vectores de Soporte</td>
      <td>14</td>
      <td>17</td>
      <td>12.843997</td>
      <td>0.516853</td>
      <td>0.590235</td>
    </tr>
    <tr>
      <th>66</th>
      <td>Regresión con Máquinas de Vectores de Soporte</td>
      <td>21</td>
      <td>17</td>
      <td>15.161583</td>
      <td>0.405647</td>
      <td>0.785990</td>
    </tr>
    <tr>
      <th>67</th>
      <td>Regresión con Máquinas de Vectores de Soporte</td>
      <td>28</td>
      <td>17</td>
      <td>20.489348</td>
      <td>0.472439</td>
      <td>0.685513</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datasvr</span><span class="p">[</span><span class="n">datasvr</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">18</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>68</th>
      <td>Regresión con Máquinas de Vectores de Soporte</td>
      <td>7</td>
      <td>18</td>
      <td>17.363976</td>
      <td>0.452244</td>
      <td>0.096577</td>
    </tr>
    <tr>
      <th>69</th>
      <td>Regresión con Máquinas de Vectores de Soporte</td>
      <td>14</td>
      <td>18</td>
      <td>12.200509</td>
      <td>0.495854</td>
      <td>0.591526</td>
    </tr>
    <tr>
      <th>70</th>
      <td>Regresión con Máquinas de Vectores de Soporte</td>
      <td>21</td>
      <td>18</td>
      <td>14.699264</td>
      <td>0.402570</td>
      <td>0.791764</td>
    </tr>
    <tr>
      <th>71</th>
      <td>Regresión con Máquinas de Vectores de Soporte</td>
      <td>28</td>
      <td>18</td>
      <td>20.105519</td>
      <td>0.460841</td>
      <td>0.690144</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datasvr</span><span class="p">[</span><span class="n">datasvr</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">19</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>72</th>
      <td>Regresión con Máquinas de Vectores de Soporte</td>
      <td>7</td>
      <td>19</td>
      <td>16.640146</td>
      <td>0.441262</td>
      <td>0.135414</td>
    </tr>
    <tr>
      <th>73</th>
      <td>Regresión con Máquinas de Vectores de Soporte</td>
      <td>14</td>
      <td>19</td>
      <td>12.061076</td>
      <td>0.491616</td>
      <td>0.595880</td>
    </tr>
    <tr>
      <th>74</th>
      <td>Regresión con Máquinas de Vectores de Soporte</td>
      <td>21</td>
      <td>19</td>
      <td>14.744046</td>
      <td>0.406469</td>
      <td>0.790196</td>
    </tr>
    <tr>
      <th>75</th>
      <td>Regresión con Máquinas de Vectores de Soporte</td>
      <td>28</td>
      <td>19</td>
      <td>20.409362</td>
      <td>0.458336</td>
      <td>0.685996</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datasvr</span><span class="p">[</span><span class="n">datasvr</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">20</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>76</th>
      <td>Regresión con Máquinas de Vectores de Soporte</td>
      <td>7</td>
      <td>20</td>
      <td>16.487276</td>
      <td>0.437912</td>
      <td>0.177162</td>
    </tr>
    <tr>
      <th>77</th>
      <td>Regresión con Máquinas de Vectores de Soporte</td>
      <td>14</td>
      <td>20</td>
      <td>17.333390</td>
      <td>0.511836</td>
      <td>0.105152</td>
    </tr>
    <tr>
      <th>78</th>
      <td>Regresión con Máquinas de Vectores de Soporte</td>
      <td>21</td>
      <td>20</td>
      <td>14.447647</td>
      <td>0.405500</td>
      <td>0.798862</td>
    </tr>
    <tr>
      <th>79</th>
      <td>Regresión con Máquinas de Vectores de Soporte</td>
      <td>28</td>
      <td>20</td>
      <td>17.024190</td>
      <td>0.458020</td>
      <td>0.687637</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datasvr</span><span class="p">[</span><span class="n">datasvr</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">21</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>80</th>
      <td>Regresión con Máquinas de Vectores de Soporte</td>
      <td>7</td>
      <td>21</td>
      <td>14.467681</td>
      <td>0.402565</td>
      <td>0.198611</td>
    </tr>
    <tr>
      <th>81</th>
      <td>Regresión con Máquinas de Vectores de Soporte</td>
      <td>14</td>
      <td>21</td>
      <td>18.033869</td>
      <td>0.522654</td>
      <td>0.071168</td>
    </tr>
    <tr>
      <th>82</th>
      <td>Regresión con Máquinas de Vectores de Soporte</td>
      <td>21</td>
      <td>21</td>
      <td>14.598287</td>
      <td>0.406278</td>
      <td>0.794098</td>
    </tr>
    <tr>
      <th>83</th>
      <td>Regresión con Máquinas de Vectores de Soporte</td>
      <td>28</td>
      <td>21</td>
      <td>14.841113</td>
      <td>0.437061</td>
      <td>0.684830</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datasvr</span><span class="p">[</span><span class="n">datasvr</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">22</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>84</th>
      <td>Regresión con Máquinas de Vectores de Soporte</td>
      <td>7</td>
      <td>22</td>
      <td>14.971191</td>
      <td>0.376659</td>
      <td>0.338369</td>
    </tr>
    <tr>
      <th>85</th>
      <td>Regresión con Máquinas de Vectores de Soporte</td>
      <td>14</td>
      <td>22</td>
      <td>17.940783</td>
      <td>0.522400</td>
      <td>0.072070</td>
    </tr>
    <tr>
      <th>86</th>
      <td>Regresión con Máquinas de Vectores de Soporte</td>
      <td>21</td>
      <td>22</td>
      <td>14.686454</td>
      <td>0.407468</td>
      <td>0.784021</td>
    </tr>
    <tr>
      <th>87</th>
      <td>Regresión con Máquinas de Vectores de Soporte</td>
      <td>28</td>
      <td>22</td>
      <td>14.176317</td>
      <td>0.429712</td>
      <td>0.704261</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datasvr</span><span class="p">[</span><span class="n">datasvr</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">23</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>88</th>
      <td>Regresión con Máquinas de Vectores de Soporte</td>
      <td>7</td>
      <td>23</td>
      <td>15.634712</td>
      <td>0.386272</td>
      <td>0.319157</td>
    </tr>
    <tr>
      <th>89</th>
      <td>Regresión con Máquinas de Vectores de Soporte</td>
      <td>14</td>
      <td>23</td>
      <td>17.342031</td>
      <td>0.518041</td>
      <td>0.088944</td>
    </tr>
    <tr>
      <th>90</th>
      <td>Regresión con Máquinas de Vectores de Soporte</td>
      <td>21</td>
      <td>23</td>
      <td>12.967217</td>
      <td>0.382300</td>
      <td>0.799313</td>
    </tr>
    <tr>
      <th>91</th>
      <td>Regresión con Máquinas de Vectores de Soporte</td>
      <td>28</td>
      <td>23</td>
      <td>14.727001</td>
      <td>0.439060</td>
      <td>0.682014</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datasvr</span><span class="p">[</span><span class="n">datasvr</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">24</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>92</th>
      <td>Regresión con Máquinas de Vectores de Soporte</td>
      <td>7</td>
      <td>24</td>
      <td>15.933879</td>
      <td>0.416117</td>
      <td>0.205351</td>
    </tr>
    <tr>
      <th>93</th>
      <td>Regresión con Máquinas de Vectores de Soporte</td>
      <td>14</td>
      <td>24</td>
      <td>17.488435</td>
      <td>0.518374</td>
      <td>0.043105</td>
    </tr>
    <tr>
      <th>94</th>
      <td>Regresión con Máquinas de Vectores de Soporte</td>
      <td>21</td>
      <td>24</td>
      <td>14.260821</td>
      <td>0.385665</td>
      <td>0.721905</td>
    </tr>
    <tr>
      <th>95</th>
      <td>Regresión con Máquinas de Vectores de Soporte</td>
      <td>28</td>
      <td>24</td>
      <td>14.324253</td>
      <td>0.445014</td>
      <td>0.663780</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mejorsvrhora</span> <span class="o">=</span> <span class="n">mejormodelohora</span><span class="p">(</span><span class="n">particiones</span><span class="p">,</span> <span class="n">datasvr</span><span class="p">)</span>
<span class="n">mejorsvrhora</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>Regresión con Máquinas de Vectores de Soporte</td>
      <td>21</td>
      <td>1</td>
      <td>22.314503</td>
      <td>0.344937</td>
      <td>0.914979</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Regresión con Máquinas de Vectores de Soporte</td>
      <td>21</td>
      <td>2</td>
      <td>22.271969</td>
      <td>0.344900</td>
      <td>0.914875</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Regresión con Máquinas de Vectores de Soporte</td>
      <td>21</td>
      <td>3</td>
      <td>21.448288</td>
      <td>0.334242</td>
      <td>0.918503</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Regresión con Máquinas de Vectores de Soporte</td>
      <td>21</td>
      <td>4</td>
      <td>11.792695</td>
      <td>0.302481</td>
      <td>0.921906</td>
    </tr>
    <tr>
      <th>18</th>
      <td>Regresión con Máquinas de Vectores de Soporte</td>
      <td>21</td>
      <td>5</td>
      <td>13.800537</td>
      <td>0.349127</td>
      <td>0.891115</td>
    </tr>
    <tr>
      <th>22</th>
      <td>Regresión con Máquinas de Vectores de Soporte</td>
      <td>21</td>
      <td>6</td>
      <td>15.195401</td>
      <td>0.362759</td>
      <td>0.880095</td>
    </tr>
    <tr>
      <th>26</th>
      <td>Regresión con Máquinas de Vectores de Soporte</td>
      <td>21</td>
      <td>7</td>
      <td>15.079889</td>
      <td>0.376225</td>
      <td>0.864314</td>
    </tr>
    <tr>
      <th>30</th>
      <td>Regresión con Máquinas de Vectores de Soporte</td>
      <td>21</td>
      <td>8</td>
      <td>14.898854</td>
      <td>0.398344</td>
      <td>0.871248</td>
    </tr>
    <tr>
      <th>34</th>
      <td>Regresión con Máquinas de Vectores de Soporte</td>
      <td>21</td>
      <td>9</td>
      <td>14.976524</td>
      <td>0.403167</td>
      <td>0.863725</td>
    </tr>
    <tr>
      <th>38</th>
      <td>Regresión con Máquinas de Vectores de Soporte</td>
      <td>21</td>
      <td>10</td>
      <td>16.387951</td>
      <td>0.438777</td>
      <td>0.832806</td>
    </tr>
    <tr>
      <th>40</th>
      <td>Regresión con Máquinas de Vectores de Soporte</td>
      <td>7</td>
      <td>11</td>
      <td>14.195487</td>
      <td>0.445071</td>
      <td>0.407216</td>
    </tr>
    <tr>
      <th>44</th>
      <td>Regresión con Máquinas de Vectores de Soporte</td>
      <td>7</td>
      <td>12</td>
      <td>21.103385</td>
      <td>0.447813</td>
      <td>0.542213</td>
    </tr>
    <tr>
      <th>48</th>
      <td>Regresión con Máquinas de Vectores de Soporte</td>
      <td>7</td>
      <td>13</td>
      <td>15.116768</td>
      <td>0.439289</td>
      <td>0.050620</td>
    </tr>
    <tr>
      <th>54</th>
      <td>Regresión con Máquinas de Vectores de Soporte</td>
      <td>21</td>
      <td>14</td>
      <td>28.638000</td>
      <td>0.446420</td>
      <td>0.744993</td>
    </tr>
    <tr>
      <th>58</th>
      <td>Regresión con Máquinas de Vectores de Soporte</td>
      <td>21</td>
      <td>15</td>
      <td>26.121357</td>
      <td>0.436507</td>
      <td>0.743071</td>
    </tr>
    <tr>
      <th>62</th>
      <td>Regresión con Máquinas de Vectores de Soporte</td>
      <td>21</td>
      <td>16</td>
      <td>25.999325</td>
      <td>0.436258</td>
      <td>0.745243</td>
    </tr>
    <tr>
      <th>66</th>
      <td>Regresión con Máquinas de Vectores de Soporte</td>
      <td>21</td>
      <td>17</td>
      <td>15.161583</td>
      <td>0.405647</td>
      <td>0.785990</td>
    </tr>
    <tr>
      <th>70</th>
      <td>Regresión con Máquinas de Vectores de Soporte</td>
      <td>21</td>
      <td>18</td>
      <td>14.699264</td>
      <td>0.402570</td>
      <td>0.791764</td>
    </tr>
    <tr>
      <th>74</th>
      <td>Regresión con Máquinas de Vectores de Soporte</td>
      <td>21</td>
      <td>19</td>
      <td>14.744046</td>
      <td>0.406469</td>
      <td>0.790196</td>
    </tr>
    <tr>
      <th>78</th>
      <td>Regresión con Máquinas de Vectores de Soporte</td>
      <td>21</td>
      <td>20</td>
      <td>14.447647</td>
      <td>0.405500</td>
      <td>0.798862</td>
    </tr>
    <tr>
      <th>80</th>
      <td>Regresión con Máquinas de Vectores de Soporte</td>
      <td>7</td>
      <td>21</td>
      <td>14.467681</td>
      <td>0.402565</td>
      <td>0.198611</td>
    </tr>
    <tr>
      <th>84</th>
      <td>Regresión con Máquinas de Vectores de Soporte</td>
      <td>7</td>
      <td>22</td>
      <td>14.971191</td>
      <td>0.376659</td>
      <td>0.338369</td>
    </tr>
    <tr>
      <th>90</th>
      <td>Regresión con Máquinas de Vectores de Soporte</td>
      <td>21</td>
      <td>23</td>
      <td>12.967217</td>
      <td>0.382300</td>
      <td>0.799313</td>
    </tr>
    <tr>
      <th>94</th>
      <td>Regresión con Máquinas de Vectores de Soporte</td>
      <td>21</td>
      <td>24</td>
      <td>14.260821</td>
      <td>0.385665</td>
      <td>0.721905</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bestsvr</span> <span class="o">=</span> <span class="n">mejormodelotot</span><span class="p">(</span><span class="n">mejorsvrhora</span><span class="p">)</span>
<span class="n">bestsvr</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>14</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Modelo</th>
      <td>Regresión con Máquinas de Vectores de Soporte</td>
    </tr>
    <tr>
      <th>Dias</th>
      <td>21</td>
    </tr>
    <tr>
      <th>Hora</th>
      <td>4</td>
    </tr>
    <tr>
      <th>MAPE</th>
      <td>11.792695</td>
    </tr>
    <tr>
      <th>RMSE</th>
      <td>0.302481</td>
    </tr>
    <tr>
      <th>R^2</th>
      <td>0.921906</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">metricas</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">dias</span> <span class="o">=</span> <span class="mi">21</span>
<span class="n">hora</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">iniciotrain</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">while</span> <span class="p">(</span><span class="n">iniciotrain</span> <span class="o">+</span> <span class="p">(</span><span class="n">dias</span> <span class="o">*</span> <span class="mi">24</span><span class="p">)</span> <span class="o">+</span> <span class="n">hora</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">):</span>  
    <span class="n">fintrain</span> <span class="o">=</span> <span class="n">iniciotrain</span> <span class="o">+</span> <span class="p">(</span><span class="n">dias</span> <span class="o">*</span> <span class="mi">24</span><span class="p">)</span>   
    <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">plieguess</span><span class="p">(</span><span class="n">iniciotrain</span><span class="p">,</span> <span class="n">fintrain</span><span class="p">,</span> <span class="n">hora</span><span class="p">)</span>   
    <span class="n">modelosvr</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
    <span class="n">y_prediccion</span><span class="o">=</span> <span class="n">modelosvr</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>       
    <span class="n">rmse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">,</span> <span class="n">squared</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">mape</span> <span class="o">=</span> <span class="n">MAPE</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">)</span>
    <span class="n">r2</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">)</span>
    <span class="n">ljungbox</span><span class="p">,</span> <span class="n">jarquebera</span> <span class="o">=</span> <span class="n">residuos</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">)</span>   
    <span class="n">metricas</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
        <span class="s1">&#39;Modelo&#39;</span><span class="p">:</span> <span class="s1">&#39;Regresión con Máquinas de Vectores de Soporte &#39;</span><span class="p">,</span>
        <span class="s1">&#39;Dias&#39;</span><span class="p">:</span> <span class="n">dias</span><span class="p">,</span>
        <span class="s1">&#39;Hora&#39;</span><span class="p">:</span> <span class="n">hora</span><span class="p">,</span>
        <span class="s1">&#39;MAPE&#39;</span><span class="p">:</span> <span class="n">mape</span><span class="p">,</span>
        <span class="s1">&#39;RMSE&#39;</span><span class="p">:</span> <span class="n">rmse</span><span class="p">,</span>
        <span class="s1">&#39;R^2&#39;</span><span class="p">:</span> <span class="n">r2</span><span class="p">,</span>
        <span class="s1">&#39;Ljung-Box p-value&#39;</span> <span class="p">:</span> <span class="n">ljungbox</span><span class="p">,</span>
        <span class="s1">&#39;Jarque-Bera p-value&#39;</span> <span class="p">:</span> <span class="n">jarquebera</span>
    <span class="p">})</span>   
    <span class="n">iniciotrain</span> <span class="o">=</span> <span class="n">fintrain</span>  
<span class="n">datasvr</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">metricas</span><span class="p">)</span>
<span class="n">datasvr</span> <span class="o">=</span> <span class="n">datasvr</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">datasvr</span><span class="p">[</span><span class="s1">&#39;RMSE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">idxmin</span><span class="p">()]</span>
<span class="n">datasvr</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">datasvr</span><span class="p">)</span>
<span class="n">datasvr</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>30</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Modelo</th>
      <td>Regresión con Máquinas de Vectores de Soporte</td>
    </tr>
    <tr>
      <th>Dias</th>
      <td>21</td>
    </tr>
    <tr>
      <th>Hora</th>
      <td>4</td>
    </tr>
    <tr>
      <th>MAPE</th>
      <td>11.792695</td>
    </tr>
    <tr>
      <th>RMSE</th>
      <td>0.302481</td>
    </tr>
    <tr>
      <th>R^2</th>
      <td>0.921906</td>
    </tr>
    <tr>
      <th>Ljung-Box p-value</th>
      <td>0.27866</td>
    </tr>
    <tr>
      <th>Jarque-Bera p-value</th>
      <td>0.549737</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
</section>
<section id="mejores-modelos-de-regresion">
<h2><strong>MEJORES MODELOS DE REGRESIÓN</strong><a class="headerlink" href="#mejores-modelos-de-regresion" title="Link to this heading">#</a></h2>
<p>El siguiente paso consiste en aplicar el algoritmo de <strong>Optimización Bayesiana</strong> para afinar los hiperparámetros de los modelos seleccionados, mejorando así su rendimiento. Utilizaremos la función <strong>gp_minimize</strong>, que nos permitirá identificar de manera eficiente los valores óptimos de los hiperparámetros para cada modelo.</p>
<section id="optimizacion-bayesiana">
<h3><strong>Optimización Bayesiana</strong><a class="headerlink" href="#optimizacion-bayesiana" title="Link to this heading">#</a></h3>
<p>Los siguientes algoritmos fueron construidos con base en diferentes fuentes consultadas en internet, tales como Medium y ChatGPT.</p>
<p>Cabe resaltar que al modelo de Regresión Lineal no se le aplica pues este no cuenta conn hiperparámetros.</p>
<section id="id7">
<h4><strong>MODELO KNN</strong><a class="headerlink" href="#id7" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Espacio de búsqueda</span>
<span class="n">espaciobusqueda_knn</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;n_neighbors&#39;</span><span class="p">),</span>  <span class="c1"># Número de vecinos en KNN</span>
    <span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;p&#39;</span><span class="p">),</span>  <span class="c1"># Parámetro para la métrica de distancia (1: Manhattan, 2: Euclidiana, etc.)</span>
<span class="p">]</span>

<span class="c1"># Función objetivo</span>
<span class="k">def</span> <span class="nf">funcionobjetivo_knn</span><span class="p">(</span><span class="n">params</span><span class="p">):</span>
    <span class="n">n_neighbors</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">mejorknn</span> <span class="o">=</span> <span class="n">KNeighborsRegressor</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="n">n_neighbors</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">)</span>
    
    <span class="c1"># Obtener los pliegues </span>
    <span class="n">conjuntopliegues</span> <span class="o">=</span> <span class="n">pliegues</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>  
    
    <span class="n">mse_total</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">num_pliegues</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">conjuntopliegues</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">train_indices</span><span class="p">,</span> <span class="n">test_indices</span> <span class="ow">in</span> <span class="n">conjuntopliegues</span><span class="p">:</span>
        
        <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">train_indices</span><span class="p">],</span> <span class="n">X</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">test_indices</span><span class="p">]</span>
        <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">train_indices</span><span class="p">],</span> <span class="n">y</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">test_indices</span><span class="p">]</span>
        
       
        <span class="n">mejorknn</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
        <span class="n">y_pred</span> <span class="o">=</span> <span class="n">mejorknn</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
        
        <span class="n">mse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="n">y_test</span> <span class="o">-</span> <span class="n">y_pred</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">mse_total</span> <span class="o">+=</span> <span class="n">mse</span>

    <span class="n">mse_promedio</span> <span class="o">=</span> <span class="n">mse_total</span> <span class="o">/</span> <span class="n">num_pliegues</span>
    
    <span class="c1"># Devolver el MSE promedio como la función de pérdida que gp_minimize minimizará</span>
    <span class="k">return</span> <span class="n">mse_promedio</span>

<span class="n">result</span> <span class="o">=</span> <span class="n">gp_minimize</span><span class="p">(</span><span class="n">funcionobjetivo_knn</span><span class="p">,</span> <span class="n">espaciobusqueda_knn</span><span class="p">,</span> <span class="n">n_calls</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>


<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mejores hiperparámetros: n_neighbors = </span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, p = </span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>c:\Users\valcd\miniconda3\envs\ml_venv\lib\site-packages\skopt\optimizer\optimizer.py:517: UserWarning: The objective has been evaluated at point [4, 3] before, using random point [10, 2]
  warnings.warn(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Mejores hiperparámetros: n_neighbors = 4, p = 3
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">modeloknn2</span> <span class="o">=</span> <span class="n">KNeighborsRegressor</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">metricas</span><span class="o">=</span> <span class="p">[]</span>
<span class="n">dias</span> <span class="o">=</span> <span class="mi">28</span>
<span class="n">hora</span> <span class="o">=</span> <span class="mi">8</span>
<span class="n">iniciotrain</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># Se inicializa en 0 para que al realizar la suma no se vaya un día más.     </span>
<span class="k">while</span> <span class="p">(</span><span class="n">iniciotrain</span> <span class="o">+</span> <span class="p">(</span><span class="n">dias</span> <span class="o">*</span> <span class="mi">24</span><span class="p">)</span> <span class="o">+</span> <span class="n">hora</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">):</span>  <span class="c1"># Mientras que el tamaño del pliegue más la hora en la que se está iterando sea menor que la longitud de los datos           </span>
    <span class="n">fintrain</span> <span class="o">=</span> <span class="n">iniciotrain</span> <span class="o">+</span> <span class="p">(</span><span class="n">dias</span> <span class="o">*</span> <span class="mi">24</span><span class="p">)</span> <span class="c1"># Se suma con dias*24 porque es la cantidad de observaciones a escoger. La cantidad de horas totales teniendo en cuanta la cantidad de días.          </span>
    <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">plieguess</span><span class="p">(</span><span class="n">iniciotrain</span><span class="p">,</span> <span class="n">fintrain</span><span class="p">,</span> <span class="n">hora</span><span class="p">)</span>           
    <span class="n">modeloknn2</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
    <span class="n">y_prediccion</span><span class="o">=</span> <span class="n">modeloknn2</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>               
    <span class="n">rmse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">,</span> <span class="n">squared</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">mape</span> <span class="o">=</span> <span class="n">MAPE</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">)</span>
    <span class="n">r2</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">)</span>
    <span class="n">ljungbox</span><span class="p">,</span> <span class="n">jarquebera</span> <span class="o">=</span> <span class="n">residuos</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">)</span>         
    <span class="n">metricas</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
        <span class="s1">&#39;Modelo&#39;</span><span class="p">:</span> <span class="s1">&#39;Regresión KNN&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Dias&#39;</span><span class="p">:</span> <span class="n">dias</span><span class="p">,</span>
        <span class="s1">&#39;Hora&#39;</span><span class="p">:</span> <span class="n">hora</span><span class="p">,</span>
        <span class="s1">&#39;MAPE&#39;</span><span class="p">:</span> <span class="n">mape</span><span class="p">,</span>
        <span class="s1">&#39;RMSE&#39;</span><span class="p">:</span> <span class="n">rmse</span><span class="p">,</span>
        <span class="s1">&#39;R^2&#39;</span><span class="p">:</span> <span class="n">r2</span><span class="p">,</span>
        <span class="s1">&#39;Ljung-Box p-value&#39;</span> <span class="p">:</span> <span class="n">ljungbox</span><span class="p">,</span>
        <span class="s1">&#39;Jarque-Bera p-value&#39;</span> <span class="p">:</span> <span class="n">jarquebera</span>
    <span class="p">})</span>           
    <span class="n">iniciotrain</span> <span class="o">=</span> <span class="n">fintrain</span>  <span class="c1"># Se actualiza a la última posición del pliegue actual</span>
<span class="n">dataknn</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">metricas</span><span class="p">)</span>
<span class="n">dataknn</span> <span class="o">=</span> <span class="n">dataknn</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dataknn</span><span class="p">[</span><span class="s1">&#39;RMSE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">idxmin</span><span class="p">()]</span>
<span class="n">dataknn</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">dataknn</span><span class="p">)</span>
<span class="n">dataknn</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Modelo</th>
      <td>Regresión KNN</td>
    </tr>
    <tr>
      <th>Dias</th>
      <td>28</td>
    </tr>
    <tr>
      <th>Hora</th>
      <td>8</td>
    </tr>
    <tr>
      <th>MAPE</th>
      <td>16.053301</td>
    </tr>
    <tr>
      <th>RMSE</th>
      <td>0.406618</td>
    </tr>
    <tr>
      <th>R^2</th>
      <td>0.817134</td>
    </tr>
    <tr>
      <th>Ljung-Box p-value</th>
      <td>0.273939</td>
    </tr>
    <tr>
      <th>Jarque-Bera p-value</th>
      <td>0.322049</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pickle</span>

<span class="c1"># Guardado del modelo KNN y el dataframe dataknn</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;C:/Users/valcd/OneDrive/Escritorio/MachinelearningUN/PF_MODELOS/knn_model_y_datos.pkl&quot;</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">modeloknn</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>  <span class="c1"># Guardar el modelo entrenado</span>
    <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">dataknn</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>    <span class="c1"># Guardar el dataframe con las métricas</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">metricas</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">dias</span> <span class="o">=</span> <span class="mi">28</span>
<span class="n">hora</span> <span class="o">=</span> <span class="mi">8</span>
<span class="n">iniciotrain</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">while</span> <span class="p">(</span><span class="n">iniciotrain</span> <span class="o">+</span> <span class="p">(</span><span class="n">dias</span> <span class="o">*</span> <span class="mi">24</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">):</span>  <span class="c1"># Mientras que el tamaño del pliegue más la hora sea menor que la longitud de los datos</span>
    <span class="n">fintrain</span> <span class="o">=</span> <span class="n">iniciotrain</span> <span class="o">+</span> <span class="p">(</span><span class="n">dias</span> <span class="o">*</span> <span class="mi">24</span><span class="p">)</span>   
    <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">plieguess</span><span class="p">(</span><span class="n">iniciotrain</span><span class="p">,</span> <span class="n">fintrain</span><span class="p">,</span> <span class="n">hora</span><span class="p">)</span>   
    <span class="n">modeloknn2</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
    
    <span class="c1"># Entrenamiento</span>
    <span class="n">y_predicciontrain</span> <span class="o">=</span> <span class="n">modeloknn2</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
    <span class="n">rmsetrain</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_predicciontrain</span><span class="p">,</span> <span class="n">squared</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">mapetrain</span> <span class="o">=</span> <span class="n">MAPE</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_predicciontrain</span><span class="p">)</span>
    <span class="n">r2train</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_predicciontrain</span><span class="p">)</span>
    
    <span class="c1"># Test</span>
    <span class="n">y_prediccion</span> <span class="o">=</span> <span class="n">modeloknn2</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>       
    <span class="n">rmse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">,</span> <span class="n">squared</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">mape</span> <span class="o">=</span> <span class="n">MAPE</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">)</span>
    <span class="n">r2</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">)</span>
    
    <span class="n">ljungbox</span><span class="p">,</span> <span class="n">jarquebera</span> <span class="o">=</span> <span class="n">residuos</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">)</span>   
    <span class="n">metricas</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
        <span class="s1">&#39;Modelo&#39;</span><span class="p">:</span> <span class="s1">&#39;Regresión KNN&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Dias&#39;</span><span class="p">:</span> <span class="n">dias</span><span class="p">,</span>
        <span class="s1">&#39;Hora&#39;</span><span class="p">:</span> <span class="n">hora</span><span class="p">,</span>
        <span class="s1">&#39;MAPE&#39;</span><span class="p">:</span> <span class="n">mape</span><span class="p">,</span>
        <span class="s1">&#39;RMSE&#39;</span><span class="p">:</span> <span class="n">rmse</span><span class="p">,</span>
        <span class="s1">&#39;R^2&#39;</span><span class="p">:</span> <span class="n">r2</span><span class="p">,</span>
        <span class="s1">&#39;Ljung-Box p-value&#39;</span><span class="p">:</span> <span class="n">ljungbox</span><span class="p">,</span>
        <span class="s1">&#39;Jarque-Bera p-value&#39;</span><span class="p">:</span> <span class="n">jarquebera</span>
    <span class="p">})</span>   
    <span class="n">iniciotrain</span> <span class="o">=</span> <span class="n">fintrain</span>  <span class="c1"># Actualizar el inicio para el siguiente pliegue</span>

<span class="c1"># Gráfico con lineplot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="c1"># Conjunto de entrenamiento</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y_train</span><span class="p">)),</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Velocidad del viento original&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y_predicciontrain</span><span class="p">)),</span> <span class="n">y_predicciontrain</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Velocidad del viento predicha&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#9A32CD&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Índice&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Velocidad del viento&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Regresión KNN (Entrenamiento)</span><span class="se">\n</span><span class="s2">R²: </span><span class="si">{</span><span class="n">r2train</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, RMSE: </span><span class="si">{</span><span class="n">rmsetrain</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="c1"># Conjunto de prueba</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y_test</span><span class="p">)),</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Velocidad del viento original&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y_prediccion</span><span class="p">)),</span> <span class="n">y_prediccion</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Velocidad del viento predicha&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#6B8E23&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Índice&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Velocidad del viento&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Regresión KNN (Prueba)</span><span class="se">\n</span><span class="s2">R²: </span><span class="si">{</span><span class="n">r2</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, RMSE: </span><span class="si">{</span><span class="n">rmse</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="c1"># Mostrar gráfico</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/4e3267e89fc867deafd92659764100030dd3717470d8e1b4837853343a35ee86.png" src="_images/4e3267e89fc867deafd92659764100030dd3717470d8e1b4837853343a35ee86.png" />
</div>
</div>
<p>Al observar la gráfica del conjunto de entrenamiento, podemos concluir que el modelo es bastante bueno, ya que presenta un coeficiente de determinación (R²) de <code class="docutils literal notranslate"><span class="pre">0.72</span></code> y un error cuadrático medio (RMSE) de <code class="docutils literal notranslate"><span class="pre">0.58</span></code>. Esto se refleja en que las líneas correspondientes a la velocidad del viento predicha siguen prácticamente la misma tendencia que los datos reales del conjunto de entrenamiento.</p>
<p>En cuanto al conjunto de prueba, el modelo presenta un R² de <code class="docutils literal notranslate"><span class="pre">0.72</span></code> y un RMSE de <code class="docutils literal notranslate"><span class="pre">0.54</span></code>. Aunque en su mayoría las predicciones siguen de manera coherente el comportamiento de los datos originales, se observan pequeños segmentos donde las predicciones se desvían ligeramente de la tendencia real.</p>
</section>
<section id="modelo-ridge">
<h4><strong>MODELO RIDGE</strong><a class="headerlink" href="#modelo-ridge" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># ESPACIO DE BÚSQUEDA</span>
<span class="n">espaciobusqueda</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">Real</span><span class="p">(</span><span class="mf">0.001</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;alpha&#39;</span><span class="p">),</span>  <span class="c1"># Alpha es el parámetro de regularización en Ridge</span>
<span class="p">]</span>

<span class="c1"># FUNCIÓN OBJETIVO</span>
<span class="k">def</span> <span class="nf">funcionobjetivo</span><span class="p">(</span><span class="n">params</span><span class="p">):</span>
    <span class="n">alpha</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># Parámetro es alpha</span>
    
    <span class="c1"># Modelo con parámetro</span>
    <span class="n">mejorridge</span> <span class="o">=</span> <span class="n">Ridge</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">)</span>
    
    <span class="c1"># Obtener los pliegues </span>
    <span class="n">conjuntopliegues</span> <span class="o">=</span> <span class="n">pliegues</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">21</span><span class="p">)</span>  
    
    <span class="n">mse_total</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">num_pliegues</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">conjuntopliegues</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">train_indices</span><span class="p">,</span> <span class="n">test_indices</span> <span class="ow">in</span> <span class="n">conjuntopliegues</span><span class="p">:</span>
        
        <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">train_indices</span><span class="p">],</span> <span class="n">X</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">test_indices</span><span class="p">]</span>
        <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">train_indices</span><span class="p">],</span> <span class="n">y</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">test_indices</span><span class="p">]</span>
        
       
        <span class="n">mejorridge</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
        <span class="n">y_pred</span> <span class="o">=</span> <span class="n">mejorridge</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
        
        <span class="n">mse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="n">y_test</span> <span class="o">-</span> <span class="n">y_pred</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">mse_total</span> <span class="o">+=</span> <span class="n">mse</span>

    <span class="n">mse_promedio</span> <span class="o">=</span> <span class="n">mse_total</span> <span class="o">/</span> <span class="n">num_pliegues</span>
    
    <span class="c1"># Devolver el MSE promedio como la función de pérdida que gp_minimize minimizará</span>
    <span class="k">return</span> <span class="n">mse_promedio</span>

<span class="n">result</span> <span class="o">=</span> <span class="n">gp_minimize</span><span class="p">(</span><span class="n">funcionobjetivo</span><span class="p">,</span> <span class="n">espaciobusqueda</span><span class="p">,</span> <span class="n">n_calls</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>


<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mejores hiperparámetros: alpha = </span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Mejores hiperparámetros: alpha = 10.0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">modeloridge2</span> <span class="o">=</span> <span class="n">Ridge</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">metricas</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">dias</span> <span class="o">=</span> <span class="mi">21</span>
<span class="n">hora</span> <span class="o">=</span> <span class="mi">24</span>
<span class="n">iniciotrain</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">while</span> <span class="p">(</span><span class="n">iniciotrain</span> <span class="o">+</span> <span class="p">(</span><span class="n">dias</span> <span class="o">*</span> <span class="mi">24</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">):</span>  
    <span class="n">fintrain</span> <span class="o">=</span> <span class="n">iniciotrain</span> <span class="o">+</span> <span class="p">(</span><span class="n">dias</span> <span class="o">*</span> <span class="mi">24</span><span class="p">)</span>   
    <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">plieguess</span><span class="p">(</span><span class="n">iniciotrain</span><span class="p">,</span> <span class="n">fintrain</span><span class="p">,</span> <span class="n">hora</span><span class="p">)</span>   
    <span class="n">modeloridge2</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
    <span class="n">y_prediccion</span><span class="o">=</span> <span class="n">modeloridge2</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>       
    <span class="n">rmse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">,</span> <span class="n">squared</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">mape</span> <span class="o">=</span> <span class="n">MAPE</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">)</span>
    <span class="n">r2</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">)</span>
    <span class="n">ljungbox</span><span class="p">,</span> <span class="n">jarquebera</span> <span class="o">=</span> <span class="n">residuos</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">)</span>   
    <span class="n">metricas</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
        <span class="s1">&#39;Modelo&#39;</span><span class="p">:</span> <span class="s1">&#39;Regresión Ridge&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Dias&#39;</span><span class="p">:</span> <span class="n">dias</span><span class="p">,</span>
        <span class="s1">&#39;Hora&#39;</span><span class="p">:</span> <span class="n">hora</span><span class="p">,</span>
        <span class="s1">&#39;MAPE&#39;</span><span class="p">:</span> <span class="n">mape</span><span class="p">,</span>
        <span class="s1">&#39;RMSE&#39;</span><span class="p">:</span> <span class="n">rmse</span><span class="p">,</span>
        <span class="s1">&#39;R^2&#39;</span><span class="p">:</span> <span class="n">r2</span><span class="p">,</span>
        <span class="s1">&#39;Ljung-Box p-value&#39;</span> <span class="p">:</span> <span class="n">ljungbox</span><span class="p">,</span>
        <span class="s1">&#39;Jarque-Bera p-value&#39;</span> <span class="p">:</span> <span class="n">jarquebera</span>
    <span class="p">})</span>   
    <span class="n">iniciotrain</span> <span class="o">=</span> <span class="n">fintrain</span>  
<span class="n">dataridge</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">metricas</span><span class="p">)</span>
<span class="n">dataridge</span> <span class="o">=</span> <span class="n">dataridge</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dataridge</span><span class="p">[</span><span class="s1">&#39;RMSE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">idxmin</span><span class="p">()]</span>
<span class="n">dataridge</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">dataridge</span><span class="p">)</span>
<span class="n">dataridge</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Modelo</th>
      <td>Regresión Ridge</td>
    </tr>
    <tr>
      <th>Dias</th>
      <td>21</td>
    </tr>
    <tr>
      <th>Hora</th>
      <td>24</td>
    </tr>
    <tr>
      <th>MAPE</th>
      <td>13.365581</td>
    </tr>
    <tr>
      <th>RMSE</th>
      <td>0.283596</td>
    </tr>
    <tr>
      <th>R^2</th>
      <td>0.875062</td>
    </tr>
    <tr>
      <th>Ljung-Box p-value</th>
      <td>0.384846</td>
    </tr>
    <tr>
      <th>Jarque-Bera p-value</th>
      <td>0.195623</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">metricas</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">dias</span> <span class="o">=</span> <span class="mi">21</span>
<span class="n">hora</span> <span class="o">=</span> <span class="mi">24</span>
<span class="n">iniciotrain</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">while</span> <span class="p">(</span><span class="n">iniciotrain</span> <span class="o">+</span> <span class="p">(</span><span class="n">dias</span> <span class="o">*</span> <span class="mi">24</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">):</span>  <span class="c1"># Mientras que el tamaño del pliegue más la hora sea menor que la longitud de los datos</span>
    <span class="n">fintrain</span> <span class="o">=</span> <span class="n">iniciotrain</span> <span class="o">+</span> <span class="p">(</span><span class="n">dias</span> <span class="o">*</span> <span class="mi">24</span><span class="p">)</span>   
    <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">plieguess</span><span class="p">(</span><span class="n">iniciotrain</span><span class="p">,</span> <span class="n">fintrain</span><span class="p">,</span> <span class="n">hora</span><span class="p">)</span>   
    <span class="n">modeloridge2</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
    
    <span class="c1"># Entrenamiento</span>
    <span class="n">y_predicciontrain</span> <span class="o">=</span> <span class="n">modeloridge2</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
    <span class="n">rmsetrain</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_predicciontrain</span><span class="p">,</span> <span class="n">squared</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">mapetrain</span> <span class="o">=</span> <span class="n">MAPE</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_predicciontrain</span><span class="p">)</span>
    <span class="n">r2train</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_predicciontrain</span><span class="p">)</span>
    
    <span class="c1"># Test</span>
    <span class="n">y_prediccion</span> <span class="o">=</span> <span class="n">modeloridge2</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>       
    <span class="n">rmse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">,</span> <span class="n">squared</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">mape</span> <span class="o">=</span> <span class="n">MAPE</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">)</span>
    <span class="n">r2</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">)</span>
    
    <span class="n">ljungbox</span><span class="p">,</span> <span class="n">jarquebera</span> <span class="o">=</span> <span class="n">residuos</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">)</span>   
    <span class="n">metricas</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
        <span class="s1">&#39;Modelo&#39;</span><span class="p">:</span> <span class="s1">&#39;Regresión Ridge&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Dias&#39;</span><span class="p">:</span> <span class="n">dias</span><span class="p">,</span>
        <span class="s1">&#39;Hora&#39;</span><span class="p">:</span> <span class="n">hora</span><span class="p">,</span>
        <span class="s1">&#39;MAPE&#39;</span><span class="p">:</span> <span class="n">mape</span><span class="p">,</span>
        <span class="s1">&#39;RMSE&#39;</span><span class="p">:</span> <span class="n">rmse</span><span class="p">,</span>
        <span class="s1">&#39;R^2&#39;</span><span class="p">:</span> <span class="n">r2</span><span class="p">,</span>
        <span class="s1">&#39;Ljung-Box p-value&#39;</span><span class="p">:</span> <span class="n">ljungbox</span><span class="p">,</span>
        <span class="s1">&#39;Jarque-Bera p-value&#39;</span><span class="p">:</span> <span class="n">jarquebera</span>
    <span class="p">})</span>   
    <span class="n">iniciotrain</span> <span class="o">=</span> <span class="n">fintrain</span>  <span class="c1"># Actualizar el inicio para el siguiente pliegue</span>

<span class="c1"># Gráfico con lineplot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="c1"># Conjunto de entrenamiento</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y_train</span><span class="p">)),</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Velocidad del viento original&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y_predicciontrain</span><span class="p">)),</span> <span class="n">y_predicciontrain</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Velocidad del viento predicha&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#9A32CD&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Índice&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Velocidad del viento&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Regresión Ridge (Entrenamiento)</span><span class="se">\n</span><span class="s2">R²: </span><span class="si">{</span><span class="n">r2train</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, RMSE: </span><span class="si">{</span><span class="n">rmsetrain</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="c1"># Conjunto de prueba</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y_test</span><span class="p">)),</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Velocidad del viento original&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y_prediccion</span><span class="p">)),</span> <span class="n">y_prediccion</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Velocidad del viento predicha&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#6B8E23&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Índice&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Velocidad del viento&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Regresión Ridge (Prueba)</span><span class="se">\n</span><span class="s2">R²: </span><span class="si">{</span><span class="n">r2</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, RMSE: </span><span class="si">{</span><span class="n">rmse</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="c1"># Mostrar gráfico</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/82ec4ae722ce4a0ff0485376bc7799f75945074a1668ac698012352cfad5c04e.png" src="_images/82ec4ae722ce4a0ff0485376bc7799f75945074a1668ac698012352cfad5c04e.png" />
</div>
</div>
<p>Al observar la gráfica del conjunto de entrenamiento, podemos concluir que el modelo es bastante bueno, ya que presenta un coeficiente de determinación (R²) de <code class="docutils literal notranslate"><span class="pre">0.69</span></code> y un error cuadrático medio (RMSE) de <code class="docutils literal notranslate"><span class="pre">0.58</span></code>. Esto se refleja en que las líneas correspondientes a la velocidad del viento predicha siguen prácticamente la misma tendencia que los datos reales del conjunto de entrenamiento.</p>
<p>En cuanto al conjunto de prueba, el modelo presenta un R² y un RMSE de <code class="docutils literal notranslate"><span class="pre">0.62</span></code> y Aunque en su mayoría las predicciones siguen de manera coherente el comportamiento de los datos originales, se observan pequeños segmentos donde las predicciones se desvían ligeramente de la tendencia real.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pickle</span>

<span class="c1"># Guardado del modelo y los datos adicionales</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;C:/Users/valcd/OneDrive/Escritorio/MachinelearningUN/PF_MODELOS/ridge_model_y_datos.pkl&quot;</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="c1"># Guardar el modelo entrenado</span>
    <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">modeloridge</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
    
    <span class="c1"># Guardar el dataframe con las métricas</span>
    <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">dataridge</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
    
    <span class="c1"># Guardar las variables adicionales</span>
    <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
    <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">y_prediccion</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
    <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">y_predicciontrain</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
    <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="modelo-lasso">
<h4><strong>MODELO LASSO</strong><a class="headerlink" href="#modelo-lasso" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># ESPACIO DE BÚSQUEDA</span>
<span class="n">espaciobusqueda</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">Real</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;alpha&#39;</span><span class="p">),</span>  <span class="c1"># Alpha es el parámetro de regularización en Lasso</span>
<span class="p">]</span>

<span class="c1"># FUNCIÓN OBJETIVO</span>
<span class="k">def</span> <span class="nf">funcionobjetivo</span><span class="p">(</span><span class="n">params</span><span class="p">):</span>
    <span class="n">alpha</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># Parámetro es alpha</span>
    
    <span class="c1"># Modelo Lasso con parámetro</span>
    <span class="n">mejorlasso</span> <span class="o">=</span> <span class="n">Lasso</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">)</span>
    
    <span class="c1"># Obtener los pliegues</span>
    <span class="n">conjuntopliegues</span> <span class="o">=</span> <span class="n">pliegues</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>  
    
    <span class="n">mse_total</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">num_pliegues</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">conjuntopliegues</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">train_indices</span><span class="p">,</span> <span class="n">test_indices</span> <span class="ow">in</span> <span class="n">conjuntopliegues</span><span class="p">:</span>
        
        <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">train_indices</span><span class="p">],</span> <span class="n">X</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">test_indices</span><span class="p">]</span>
        <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">train_indices</span><span class="p">],</span> <span class="n">y</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">test_indices</span><span class="p">]</span>
        
        <span class="c1"># Entrenar el modelo Lasso</span>
        <span class="n">mejorlasso</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
        <span class="n">y_pred</span> <span class="o">=</span> <span class="n">mejorlasso</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
        
        <span class="c1"># Calcular el error cuadrático medio (MSE)</span>
        <span class="n">mse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="n">y_test</span> <span class="o">-</span> <span class="n">y_pred</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">mse_total</span> <span class="o">+=</span> <span class="n">mse</span>

    <span class="n">mse_promedio</span> <span class="o">=</span> <span class="n">mse_total</span> <span class="o">/</span> <span class="n">num_pliegues</span>
    
    <span class="c1"># Devolver el MSE promedio como la función de pérdida que gp_minimize minimizará</span>
    <span class="k">return</span> <span class="n">mse_promedio</span>

<span class="c1"># Ejecutar la optimización bayesiana para minimizar el MSE promedio</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">gp_minimize</span><span class="p">(</span><span class="n">funcionobjetivo</span><span class="p">,</span> <span class="n">espaciobusqueda</span><span class="p">,</span> <span class="n">n_calls</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># Imprimir el mejor valor de alpha encontrado</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mejores hiperparámetros: alpha = </span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Mejores hiperparámetros: alpha = 0.1
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">modelolasso2</span> <span class="o">=</span> <span class="n">Lasso</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="n">metricas</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">dias</span> <span class="o">=</span> <span class="mi">7</span>
<span class="n">hora</span> <span class="o">=</span> <span class="mi">7</span>
<span class="n">iniciotrain</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">while</span> <span class="p">(</span><span class="n">iniciotrain</span> <span class="o">+</span> <span class="p">(</span><span class="n">dias</span> <span class="o">*</span> <span class="mi">24</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">):</span>  
    <span class="n">fintrain</span> <span class="o">=</span> <span class="n">iniciotrain</span> <span class="o">+</span> <span class="p">(</span><span class="n">dias</span> <span class="o">*</span> <span class="mi">24</span><span class="p">)</span>   
    <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">plieguess</span><span class="p">(</span><span class="n">iniciotrain</span><span class="p">,</span> <span class="n">fintrain</span><span class="p">,</span> <span class="n">hora</span><span class="p">)</span>   
    <span class="n">modelolasso2</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
    <span class="n">y_prediccion</span><span class="o">=</span> <span class="n">modelolasso2</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>       
    <span class="n">rmse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">,</span> <span class="n">squared</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">mape</span> <span class="o">=</span> <span class="n">MAPE</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">)</span>
    <span class="n">r2</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">)</span>
    <span class="n">ljungbox</span><span class="p">,</span> <span class="n">jarquebera</span> <span class="o">=</span> <span class="n">residuos</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">)</span>   
    <span class="n">metricas</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
        <span class="s1">&#39;Modelo&#39;</span><span class="p">:</span> <span class="s1">&#39;Regresión Lasso&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Dias&#39;</span><span class="p">:</span> <span class="n">dias</span><span class="p">,</span>
        <span class="s1">&#39;Hora&#39;</span><span class="p">:</span> <span class="n">hora</span><span class="p">,</span>
        <span class="s1">&#39;MAPE&#39;</span><span class="p">:</span> <span class="n">mape</span><span class="p">,</span>
        <span class="s1">&#39;RMSE&#39;</span><span class="p">:</span> <span class="n">rmse</span><span class="p">,</span>
        <span class="s1">&#39;R^2&#39;</span><span class="p">:</span> <span class="n">r2</span><span class="p">,</span>
        <span class="s1">&#39;Ljung-Box p-value&#39;</span> <span class="p">:</span> <span class="n">ljungbox</span><span class="p">,</span>
        <span class="s1">&#39;Jarque-Bera p-value&#39;</span> <span class="p">:</span> <span class="n">jarquebera</span>
    <span class="p">})</span>   
    <span class="n">iniciotrain</span> <span class="o">=</span> <span class="n">fintrain</span>  
<span class="n">datalasso</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">metricas</span><span class="p">)</span>
<span class="n">datalasso</span> <span class="o">=</span> <span class="n">datalasso</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">datalasso</span><span class="p">[</span><span class="s1">&#39;RMSE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">idxmin</span><span class="p">()]</span>
<span class="n">datalasso</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">datalasso</span><span class="p">)</span>
<span class="n">datalasso</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>239</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Modelo</th>
      <td>Regresión Lasso</td>
    </tr>
    <tr>
      <th>Dias</th>
      <td>7</td>
    </tr>
    <tr>
      <th>Hora</th>
      <td>7</td>
    </tr>
    <tr>
      <th>MAPE</th>
      <td>13.756313</td>
    </tr>
    <tr>
      <th>RMSE</th>
      <td>0.333403</td>
    </tr>
    <tr>
      <th>R^2</th>
      <td>0.74215</td>
    </tr>
    <tr>
      <th>Ljung-Box p-value</th>
      <td>0.666188</td>
    </tr>
    <tr>
      <th>Jarque-Bera p-value</th>
      <td>0.802302</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">metricas</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">dias</span> <span class="o">=</span> <span class="mi">7</span>
<span class="n">hora</span> <span class="o">=</span> <span class="mi">7</span>
<span class="n">iniciotrain</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">while</span> <span class="p">(</span><span class="n">iniciotrain</span> <span class="o">+</span> <span class="p">(</span><span class="n">dias</span> <span class="o">*</span> <span class="mi">24</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">):</span>  <span class="c1"># Mientras que el tamaño del pliegue más la hora sea menor que la longitud de los datos</span>
    <span class="n">fintrain</span> <span class="o">=</span> <span class="n">iniciotrain</span> <span class="o">+</span> <span class="p">(</span><span class="n">dias</span> <span class="o">*</span> <span class="mi">24</span><span class="p">)</span>   
    <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">plieguess</span><span class="p">(</span><span class="n">iniciotrain</span><span class="p">,</span> <span class="n">fintrain</span><span class="p">,</span> <span class="n">hora</span><span class="p">)</span>   
    <span class="n">modelolasso2</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
    
    <span class="c1"># Entrenamiento</span>
    <span class="n">y_predicciontrain</span> <span class="o">=</span> <span class="n">modelolasso2</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
    <span class="n">rmsetrain</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_predicciontrain</span><span class="p">,</span> <span class="n">squared</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">mapetrain</span> <span class="o">=</span> <span class="n">MAPE</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_predicciontrain</span><span class="p">)</span>
    <span class="n">r2train</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_predicciontrain</span><span class="p">)</span>
    
    <span class="c1"># Test</span>
    <span class="n">y_prediccion</span> <span class="o">=</span> <span class="n">modelolasso2</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>       
    <span class="n">rmse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">,</span> <span class="n">squared</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">mape</span> <span class="o">=</span> <span class="n">MAPE</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">)</span>
    <span class="n">r2</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">)</span>
    
    <span class="n">ljungbox</span><span class="p">,</span> <span class="n">jarquebera</span> <span class="o">=</span> <span class="n">residuos</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">)</span>   
    <span class="n">metricas</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
        <span class="s1">&#39;Modelo&#39;</span><span class="p">:</span> <span class="s1">&#39;Regresión Lasso&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Dias&#39;</span><span class="p">:</span> <span class="n">dias</span><span class="p">,</span>
        <span class="s1">&#39;Hora&#39;</span><span class="p">:</span> <span class="n">hora</span><span class="p">,</span>
        <span class="s1">&#39;MAPE&#39;</span><span class="p">:</span> <span class="n">mape</span><span class="p">,</span>
        <span class="s1">&#39;RMSE&#39;</span><span class="p">:</span> <span class="n">rmse</span><span class="p">,</span>
        <span class="s1">&#39;R^2&#39;</span><span class="p">:</span> <span class="n">r2</span><span class="p">,</span>
        <span class="s1">&#39;Ljung-Box p-value&#39;</span><span class="p">:</span> <span class="n">ljungbox</span><span class="p">,</span>
        <span class="s1">&#39;Jarque-Bera p-value&#39;</span><span class="p">:</span> <span class="n">jarquebera</span>
    <span class="p">})</span>   
    <span class="n">iniciotrain</span> <span class="o">=</span> <span class="n">fintrain</span>  <span class="c1"># Actualizar el inicio para el siguiente pliegue</span>

<span class="c1"># Gráfico con lineplot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="c1"># Conjunto de entrenamiento</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y_train</span><span class="p">)),</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Velocidad del viento original&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y_predicciontrain</span><span class="p">)),</span> <span class="n">y_predicciontrain</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Velocidad del viento predicha&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#9A32CD&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Índice&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Velocidad del viento&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Regresión Lasso (Entrenamiento)</span><span class="se">\n</span><span class="s2">R²: </span><span class="si">{</span><span class="n">r2train</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, RMSE: </span><span class="si">{</span><span class="n">rmsetrain</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="c1"># Conjunto de prueba</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y_test</span><span class="p">)),</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Velocidad del viento original&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y_prediccion</span><span class="p">)),</span> <span class="n">y_prediccion</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Velocidad del viento predicha&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#6B8E23&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Índice&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Velocidad del viento&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Regresión Lasso (Prueba)</span><span class="se">\n</span><span class="s2">R²: </span><span class="si">{</span><span class="n">r2</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, RMSE: </span><span class="si">{</span><span class="n">rmse</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="c1"># Mostrar gráfico</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/4fce95b249160f021c340dcdc5da20143d6224b375ce2a96dd6be66351c6a4e5.png" src="_images/4fce95b249160f021c340dcdc5da20143d6224b375ce2a96dd6be66351c6a4e5.png" />
</div>
</div>
<p>Al observar la gráfica del conjunto de entrenamiento, podemos concluir que el modelo es bastante bueno, ya que presenta un coeficiente de determinación (R²) de <code class="docutils literal notranslate"><span class="pre">0.71</span></code> y un error cuadrático medio (RMSE) de <code class="docutils literal notranslate"><span class="pre">0.56</span></code>. Esto se refleja en que las líneas correspondientes a la velocidad del viento predicha siguen prácticamente la misma tendencia que los datos reales del conjunto de entrenamiento.</p>
<p>En cuanto al conjunto de prueba, el modelo presenta un R² de <code class="docutils literal notranslate"><span class="pre">0.79</span></code> y un RMSE de <code class="docutils literal notranslate"><span class="pre">0.37</span></code>. Podemos observar que la línea de velocidad del viento intenta seguir la tendencia de la original, sin embargo, falla en algunos segmentos. Esto significa que el modelo puede mejorar.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pickle</span>

<span class="c1"># Guardado del modelo KNN y el dataframe dataknn</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;C:/Users/valcd/OneDrive/Escritorio/MachinelearningUN/PF_MODELOS/lasso_model_y_datos.pkl&quot;</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">modelolasso</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>  <span class="c1"># Guardar el modelo entrenado</span>
    <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">datalasso</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>    <span class="c1"># Guardar el dataframe con las métricas</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="modelo-decision-tree-regressor">
<h4><strong>MODELO DECISION TREE REGRESSOR</strong><a class="headerlink" href="#modelo-decision-tree-regressor" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># ESPACIO DE BÚSQUEDA</span>
<span class="n">espaciobusqueda</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;max_depth&#39;</span><span class="p">),</span>           <span class="c1"># Profundidad máxima</span>
       <span class="c1"># Muestras mínimas para dividir un nodo</span>
<span class="p">]</span>


<span class="c1"># FUNCIÓN OBJETIVO</span>
<span class="k">def</span> <span class="nf">funcionobjetivo</span><span class="p">(</span><span class="n">params</span><span class="p">):</span>
    <span class="n">max_depth</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># Parámetro es la profundidad máxima</span>
    
    
    <span class="c1"># Modelo Decision Tree Regressor con el parámetro</span>
    <span class="n">mejordectree</span> <span class="o">=</span> <span class="n">DecisionTreeRegressor</span><span class="p">(</span><span class="n">max_depth</span><span class="o">=</span><span class="n">max_depth</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">21</span><span class="p">)</span>
    
    <span class="c1"># Obtener los pliegues</span>
    <span class="n">conjuntopliegues</span> <span class="o">=</span> <span class="n">pliegues</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>  
    
    <span class="n">mse_total</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">num_pliegues</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">conjuntopliegues</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">train_indices</span><span class="p">,</span> <span class="n">test_indices</span> <span class="ow">in</span> <span class="n">conjuntopliegues</span><span class="p">:</span>
        <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">train_indices</span><span class="p">],</span> <span class="n">X</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">test_indices</span><span class="p">]</span>
        <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">train_indices</span><span class="p">],</span> <span class="n">y</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">test_indices</span><span class="p">]</span>
        
        <span class="c1"># Entrenar el modelo Decision Tree</span>
        <span class="n">mejordectree</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
        <span class="n">y_pred</span> <span class="o">=</span> <span class="n">mejordectree</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
        
        <span class="c1"># Calcular el error cuadrático medio (MSE)</span>
        <span class="n">mse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="n">y_test</span> <span class="o">-</span> <span class="n">y_pred</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">mse_total</span> <span class="o">+=</span> <span class="n">mse</span>

    <span class="n">mse_promedio</span> <span class="o">=</span> <span class="n">mse_total</span> <span class="o">/</span> <span class="n">num_pliegues</span>
    
    <span class="c1"># Devolver el MSE promedio como la función de pérdida</span>
    <span class="k">return</span> <span class="n">mse_promedio</span>

<span class="c1"># Ejecutar la optimización bayesiana para minimizar el MSE promedio</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">gp_minimize</span><span class="p">(</span><span class="n">funcionobjetivo</span><span class="p">,</span> <span class="n">espaciobusqueda</span><span class="p">,</span> <span class="n">n_calls</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">21</span><span class="p">)</span>

<span class="c1"># Imprimir el mejor valor de max_depth encontrado</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mejores hiperparámetros: max_depth = </span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2"> &quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Mejores hiperparámetros: max_depth = 3 
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">modelodectree2</span> <span class="o">=</span> <span class="n">DecisionTreeRegressor</span><span class="p">(</span><span class="n">max_depth</span> <span class="o">=</span> <span class="mi">150</span><span class="p">,</span> <span class="n">min_samples_split</span> <span class="o">=</span> <span class="mi">26</span> <span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">21</span><span class="p">)</span>
<span class="n">metricas</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">dias</span> <span class="o">=</span> <span class="mi">14</span>
<span class="n">hora</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">iniciotrain</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">while</span> <span class="p">(</span><span class="n">iniciotrain</span> <span class="o">+</span> <span class="p">(</span><span class="n">dias</span> <span class="o">*</span> <span class="mi">24</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">):</span>  
    <span class="n">fintrain</span> <span class="o">=</span> <span class="n">iniciotrain</span> <span class="o">+</span> <span class="p">(</span><span class="n">dias</span> <span class="o">*</span> <span class="mi">24</span><span class="p">)</span>   
    <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">plieguess</span><span class="p">(</span><span class="n">iniciotrain</span><span class="p">,</span> <span class="n">fintrain</span><span class="p">,</span> <span class="n">hora</span><span class="p">)</span>   
    <span class="n">modelodectree2</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
    <span class="n">y_prediccion</span><span class="o">=</span> <span class="n">modelodectree2</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>       
    <span class="n">rmse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">,</span> <span class="n">squared</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">mape</span> <span class="o">=</span> <span class="n">MAPE</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">)</span>
    <span class="n">r2</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">)</span>
    <span class="n">ljungbox</span><span class="p">,</span> <span class="n">jarquebera</span> <span class="o">=</span> <span class="n">residuos</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">)</span>   
    <span class="n">metricas</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
        <span class="s1">&#39;Modelo&#39;</span><span class="p">:</span> <span class="s1">&#39;Regresión Random Forest&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Dias&#39;</span><span class="p">:</span> <span class="n">dias</span><span class="p">,</span>
        <span class="s1">&#39;Hora&#39;</span><span class="p">:</span> <span class="n">hora</span><span class="p">,</span>
        <span class="s1">&#39;MAPE&#39;</span><span class="p">:</span> <span class="n">mape</span><span class="p">,</span>
        <span class="s1">&#39;RMSE&#39;</span><span class="p">:</span> <span class="n">rmse</span><span class="p">,</span>
        <span class="s1">&#39;R^2&#39;</span><span class="p">:</span> <span class="n">r2</span><span class="p">,</span>
        <span class="s1">&#39;Ljung-Box p-value&#39;</span> <span class="p">:</span> <span class="n">ljungbox</span><span class="p">,</span>
        <span class="s1">&#39;Jarque-Bera p-value&#39;</span> <span class="p">:</span> <span class="n">jarquebera</span>
    <span class="p">})</span>   
    <span class="n">iniciotrain</span> <span class="o">=</span> <span class="n">fintrain</span>  
<span class="n">datadectree</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">metricas</span><span class="p">)</span>
<span class="n">datadectree</span> <span class="o">=</span> <span class="n">datadectree</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">datadectree</span><span class="p">[</span><span class="s1">&#39;RMSE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">idxmin</span><span class="p">()]</span>
<span class="n">datadectree</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">datadectree</span><span class="p">)</span>
<span class="n">datadectree</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>250</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Modelo</th>
      <td>Regresión Random Forest</td>
    </tr>
    <tr>
      <th>Dias</th>
      <td>14</td>
    </tr>
    <tr>
      <th>Hora</th>
      <td>3</td>
    </tr>
    <tr>
      <th>MAPE</th>
      <td>18.55245</td>
    </tr>
    <tr>
      <th>RMSE</th>
      <td>0.35192</td>
    </tr>
    <tr>
      <th>R^2</th>
      <td>0.868471</td>
    </tr>
    <tr>
      <th>Ljung-Box p-value</th>
      <td>0.025182</td>
    </tr>
    <tr>
      <th>Jarque-Bera p-value</th>
      <td>0.931231</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">modelodectree2</span> <span class="o">=</span> <span class="n">DecisionTreeRegressor</span><span class="p">(</span><span class="n">max_depth</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">21</span><span class="p">)</span>

<span class="n">metricas</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">dias</span> <span class="o">=</span> <span class="mi">14</span>
<span class="n">hora</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">iniciotrain</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">while</span> <span class="p">(</span><span class="n">iniciotrain</span> <span class="o">+</span> <span class="p">(</span><span class="n">dias</span> <span class="o">*</span> <span class="mi">24</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">):</span>  <span class="c1"># Mientras que el tamaño del pliegue más la hora sea menor que la longitud de los datos</span>
    <span class="n">fintrain</span> <span class="o">=</span> <span class="n">iniciotrain</span> <span class="o">+</span> <span class="p">(</span><span class="n">dias</span> <span class="o">*</span> <span class="mi">24</span><span class="p">)</span>   
    <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">plieguess</span><span class="p">(</span><span class="n">iniciotrain</span><span class="p">,</span> <span class="n">fintrain</span><span class="p">,</span> <span class="n">hora</span><span class="p">)</span>   
    <span class="n">modelodectree2</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
    
    <span class="c1"># Entrenamiento</span>
    <span class="n">y_predicciontrain</span> <span class="o">=</span> <span class="n">modelodectree2</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
    <span class="n">rmsetrain</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_predicciontrain</span><span class="p">,</span> <span class="n">squared</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">mapetrain</span> <span class="o">=</span> <span class="n">MAPE</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_predicciontrain</span><span class="p">)</span>
    <span class="n">r2train</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_predicciontrain</span><span class="p">)</span>
    
    <span class="c1"># Test</span>
    <span class="n">y_prediccion</span> <span class="o">=</span> <span class="n">modelodectree2</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>       
    <span class="n">rmse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">,</span> <span class="n">squared</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">mape</span> <span class="o">=</span> <span class="n">MAPE</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">)</span>
    <span class="n">r2</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">)</span>
    
    <span class="n">ljungbox</span><span class="p">,</span> <span class="n">jarquebera</span> <span class="o">=</span> <span class="n">residuos</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">)</span>   
    <span class="n">metricas</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
        <span class="s1">&#39;Modelo&#39;</span><span class="p">:</span> <span class="s1">&#39;Decision Tree&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Dias&#39;</span><span class="p">:</span> <span class="n">dias</span><span class="p">,</span>
        <span class="s1">&#39;Hora&#39;</span><span class="p">:</span> <span class="n">hora</span><span class="p">,</span>
        <span class="s1">&#39;MAPE&#39;</span><span class="p">:</span> <span class="n">mape</span><span class="p">,</span>
        <span class="s1">&#39;RMSE&#39;</span><span class="p">:</span> <span class="n">rmse</span><span class="p">,</span>
        <span class="s1">&#39;R^2&#39;</span><span class="p">:</span> <span class="n">r2</span><span class="p">,</span>
        <span class="s1">&#39;Ljung-Box p-value&#39;</span><span class="p">:</span> <span class="n">ljungbox</span><span class="p">,</span>
        <span class="s1">&#39;Jarque-Bera p-value&#39;</span><span class="p">:</span> <span class="n">jarquebera</span>
    <span class="p">})</span>   
    <span class="n">iniciotrain</span> <span class="o">=</span> <span class="n">fintrain</span>  <span class="c1"># Actualizar el inicio para el siguiente pliegue</span>

<span class="c1"># Gráfico con lineplot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="c1"># Conjunto de entrenamiento</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y_train</span><span class="p">)),</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Velocidad del viento original&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y_predicciontrain</span><span class="p">)),</span> <span class="n">y_predicciontrain</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Velocidad del viento predicha&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#9A32CD&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Índice&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Velocidad del viento&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Decision Tree (Entrenamiento)</span><span class="se">\n</span><span class="s2">R²: </span><span class="si">{</span><span class="n">r2train</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, RMSE: </span><span class="si">{</span><span class="n">rmsetrain</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="c1"># Conjunto de prueba</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y_test</span><span class="p">)),</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Velocidad del viento original&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y_prediccion</span><span class="p">)),</span> <span class="n">y_prediccion</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Velocidad del viento predicha&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#6B8E23&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Índice&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Velocidad del viento&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Decision Tree (Prueba)</span><span class="se">\n</span><span class="s2">R²: </span><span class="si">{</span><span class="n">r2</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, RMSE: </span><span class="si">{</span><span class="n">rmse</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="c1"># Mostrar gráfico</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/78d70f72e1175b08ac81fe3e42459382d8df71e89201504d526229e6dcfa0b1e.png" src="_images/78d70f72e1175b08ac81fe3e42459382d8df71e89201504d526229e6dcfa0b1e.png" />
</div>
</div>
<p>Al observar la gráfica del modelo en el conjunto de entrenamiento, notamos un R² de <code class="docutils literal notranslate"><span class="pre">0.77</span></code> y un RMSE de <code class="docutils literal notranslate"><span class="pre">0.54</span></code>, lo cual indica que el modelo tiene una considerable capacidad de predicción. Esto se refleja en el patrón de la línea predicha, que sigue de manera adecuada la tendencia de los datos originales. Sin embargo, el modelo no es perfecto, ya que se observan discrepancias en algunos picos, donde las predicciones superan los valores reales.</p>
<p>Por otro lado, en el modelo del conjunto de prueba, el R² es de <code class="docutils literal notranslate"><span class="pre">0.69</span></code> y el RMSE de <code class="docutils literal notranslate"><span class="pre">0.58</span></code>, lo que indica que el desempeño es menor en comparación con el entrenamiento, aunque sigue siendo aceptable. Se observa que las líneas predichas logran, relativamente, seguir el mismo patrón que la original, salvo en aquellos casos donde las predicciones aparecen como segmentos horizontales. Este comportamiento es común en los árboles de decisión, ya que asignan valores constantes dentro de ciertas regiones.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pickle</span>

<span class="c1"># Guardado del modelo y los datos adicionales</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;C:/Users/valcd/OneDrive/Escritorio/MachinelearningUN/PF_MODELOS/dectree_y_datos.pkl&quot;</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="c1"># Guardar el modelo entrenado</span>
    <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">modelodectree2</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
    
    <span class="c1"># Guardar el dataframe con las métricas</span>
    <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">datadectree</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
    
    <span class="c1"># Guardar las variables adicionales</span>
    <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
    <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">y_prediccion</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
    <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">y_predicciontrain</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
    <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id8">
<h4><strong>MODELO RANDOM FOREST</strong><a class="headerlink" href="#id8" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">skopt</span> <span class="kn">import</span> <span class="n">gp_minimize</span>
<span class="kn">from</span> <span class="nn">skopt.space</span> <span class="kn">import</span> <span class="n">Integer</span>

<span class="c1"># ESPACIO DE BÚSQUEDA</span>
<span class="n">espaciobusqueda</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">Integer</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">150</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;n_estimators&#39;</span><span class="p">)</span> <span class="p">,</span>  <span class="c1"># Número de árboles</span>
    <span class="n">Integer</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;max_depth&#39;</span><span class="p">)</span>        <span class="c1"># Profundidad máxima</span>
<span class="p">]</span>


<span class="c1"># FUNCIÓN OBJETIVO</span>
<span class="k">def</span> <span class="nf">funcionobjetivo</span><span class="p">(</span><span class="n">params</span><span class="p">):</span>
    <span class="n">n_estimators</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>        <span class="c1"># Número de árboles</span>
    <span class="n">max_depth</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>           <span class="c1"># Profundidad máxima</span>
      <span class="c1"># Muestras mínimas en hojas</span>
    
    <span class="c1"># Modelo Random Forest con parámetros</span>
    <span class="n">rf</span> <span class="o">=</span> <span class="n">RandomForestRegressor</span><span class="p">(</span>
        <span class="n">n_estimators</span><span class="o">=</span><span class="n">n_estimators</span><span class="p">,</span>
        <span class="n">max_depth</span><span class="o">=</span><span class="n">max_depth</span><span class="p">,</span>
        <span class="n">random_state</span><span class="o">=</span><span class="mi">21</span>
    <span class="p">)</span>
    
    <span class="c1"># Obtener los pliegues</span>
    <span class="n">conjuntopliegues</span> <span class="o">=</span> <span class="n">pliegues</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">18</span><span class="p">)</span>  
    
    <span class="n">mse_total</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">num_pliegues</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">conjuntopliegues</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">train_indices</span><span class="p">,</span> <span class="n">test_indices</span> <span class="ow">in</span> <span class="n">conjuntopliegues</span><span class="p">:</span>
        <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">train_indices</span><span class="p">],</span> <span class="n">X</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">test_indices</span><span class="p">]</span>
        <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">train_indices</span><span class="p">],</span> <span class="n">y</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">test_indices</span><span class="p">]</span>
        
        <span class="c1"># Entrenar el modelo Random Forest</span>
        <span class="n">rf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
        <span class="n">y_pred</span> <span class="o">=</span> <span class="n">rf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
        
        <span class="c1"># Calcular el error cuadrático medio (MSE)</span>
        <span class="n">mse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="n">y_test</span> <span class="o">-</span> <span class="n">y_pred</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">mse_total</span> <span class="o">+=</span> <span class="n">mse</span>

    <span class="n">mse_promedio</span> <span class="o">=</span> <span class="n">mse_total</span> <span class="o">/</span> <span class="n">num_pliegues</span>
    
    <span class="c1"># Devolver el MSE promedio como la función de pérdida</span>
    <span class="k">return</span> <span class="n">mse_promedio</span>

<span class="c1"># Ejecutar la optimización bayesiana para minimizar el MSE promedio</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">gp_minimize</span><span class="p">(</span><span class="n">funcionobjetivo</span><span class="p">,</span> <span class="n">espaciobusqueda</span><span class="p">,</span> <span class="n">n_calls</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">21</span><span class="p">)</span>

<span class="c1"># Imprimir los mejores valores de hiperparámetros encontrados</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mejores hiperparámetros: n_estimators = </span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, max_depth = </span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Mejores hiperparámetros: n_estimators = 97, max_depth = 5
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">modeloranfor2</span> <span class="o">=</span> <span class="n">RandomForestRegressor</span><span class="p">(</span><span class="n">n_estimators</span> <span class="o">=</span> <span class="mi">97</span><span class="p">,</span> <span class="n">max_depth</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">21</span><span class="p">)</span>
<span class="n">metricas</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">dias</span> <span class="o">=</span> <span class="mi">7</span>
<span class="n">hora</span> <span class="o">=</span> <span class="mi">18</span>
<span class="n">iniciotrain</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">while</span> <span class="p">(</span><span class="n">iniciotrain</span> <span class="o">+</span> <span class="p">(</span><span class="n">dias</span> <span class="o">*</span> <span class="mi">24</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">):</span>  
    <span class="n">fintrain</span> <span class="o">=</span> <span class="n">iniciotrain</span> <span class="o">+</span> <span class="p">(</span><span class="n">dias</span> <span class="o">*</span> <span class="mi">24</span><span class="p">)</span>   
    <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">plieguess</span><span class="p">(</span><span class="n">iniciotrain</span><span class="p">,</span> <span class="n">fintrain</span><span class="p">,</span> <span class="n">hora</span><span class="p">)</span>   
    <span class="n">modeloranfor2</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
    <span class="n">y_prediccion</span><span class="o">=</span> <span class="n">modeloranfor2</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>       
    <span class="n">rmse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">,</span> <span class="n">squared</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">mape</span> <span class="o">=</span> <span class="n">MAPE</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">)</span>
    <span class="n">r2</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">)</span>
    <span class="n">ljungbox</span><span class="p">,</span> <span class="n">jarquebera</span> <span class="o">=</span> <span class="n">residuos</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">)</span>   
    <span class="n">metricas</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
        <span class="s1">&#39;Modelo&#39;</span><span class="p">:</span> <span class="s1">&#39;Regresión Random Forest&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Dias&#39;</span><span class="p">:</span> <span class="n">dias</span><span class="p">,</span>
        <span class="s1">&#39;Hora&#39;</span><span class="p">:</span> <span class="n">hora</span><span class="p">,</span>
        <span class="s1">&#39;MAPE&#39;</span><span class="p">:</span> <span class="n">mape</span><span class="p">,</span>
        <span class="s1">&#39;RMSE&#39;</span><span class="p">:</span> <span class="n">rmse</span><span class="p">,</span>
        <span class="s1">&#39;R^2&#39;</span><span class="p">:</span> <span class="n">r2</span><span class="p">,</span>
        <span class="s1">&#39;Ljung-Box p-value&#39;</span> <span class="p">:</span> <span class="n">ljungbox</span><span class="p">,</span>
        <span class="s1">&#39;Jarque-Bera p-value&#39;</span> <span class="p">:</span> <span class="n">jarquebera</span>
    <span class="p">})</span>   
    <span class="n">iniciotrain</span> <span class="o">=</span> <span class="n">fintrain</span>  
<span class="n">dataranfor</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">metricas</span><span class="p">)</span>
<span class="n">dataranfor</span> <span class="o">=</span> <span class="n">dataranfor</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dataranfor</span><span class="p">[</span><span class="s1">&#39;RMSE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">idxmin</span><span class="p">()]</span>
<span class="n">dataranfor</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">dataranfor</span><span class="p">)</span>
<span class="n">dataranfor</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>4</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Modelo</th>
      <td>Regresión Random Forest</td>
    </tr>
    <tr>
      <th>Dias</th>
      <td>7</td>
    </tr>
    <tr>
      <th>Hora</th>
      <td>18</td>
    </tr>
    <tr>
      <th>MAPE</th>
      <td>16.629372</td>
    </tr>
    <tr>
      <th>RMSE</th>
      <td>0.302459</td>
    </tr>
    <tr>
      <th>R^2</th>
      <td>0.929764</td>
    </tr>
    <tr>
      <th>Ljung-Box p-value</th>
      <td>0.0802</td>
    </tr>
    <tr>
      <th>Jarque-Bera p-value</th>
      <td>0.542949</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestRegressor</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_squared_error</span><span class="p">,</span> <span class="n">r2_score</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">modeloranfor2</span> <span class="o">=</span> <span class="n">RandomForestRegressor</span><span class="p">(</span><span class="n">n_estimators</span> <span class="o">=</span> <span class="mi">97</span><span class="p">,</span> <span class="n">max_depth</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">21</span><span class="p">)</span>

<span class="n">metricas</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">dias</span> <span class="o">=</span> <span class="mi">7</span>
<span class="n">hora</span> <span class="o">=</span> <span class="mi">18</span>
<span class="n">iniciotrain</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">while</span> <span class="p">(</span><span class="n">iniciotrain</span> <span class="o">+</span> <span class="p">(</span><span class="n">dias</span> <span class="o">*</span> <span class="mi">24</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">):</span>  <span class="c1"># Mientras que el tamaño del pliegue más la hora sea menor que la longitud de los datos</span>
    <span class="n">fintrain</span> <span class="o">=</span> <span class="n">iniciotrain</span> <span class="o">+</span> <span class="p">(</span><span class="n">dias</span> <span class="o">*</span> <span class="mi">24</span><span class="p">)</span>   
    <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">plieguess</span><span class="p">(</span><span class="n">iniciotrain</span><span class="p">,</span> <span class="n">fintrain</span><span class="p">,</span> <span class="n">hora</span><span class="p">)</span>   
    <span class="n">modeloranfor2</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
    
    <span class="c1"># Entrenamiento</span>
    <span class="n">y_predicciontrain</span> <span class="o">=</span> <span class="n">modeloranfor2</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
    <span class="n">rmsetrain</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_predicciontrain</span><span class="p">,</span> <span class="n">squared</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">mapetrain</span> <span class="o">=</span> <span class="n">MAPE</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_predicciontrain</span><span class="p">)</span>
    <span class="n">r2train</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_predicciontrain</span><span class="p">)</span>
    
    <span class="c1"># Test</span>
    <span class="n">y_prediccion</span> <span class="o">=</span> <span class="n">modeloranfor2</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>       
    <span class="n">rmse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">,</span> <span class="n">squared</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">mape</span> <span class="o">=</span> <span class="n">MAPE</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">)</span>
    <span class="n">r2</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">)</span>
    
    <span class="n">ljungbox</span><span class="p">,</span> <span class="n">jarquebera</span> <span class="o">=</span> <span class="n">residuos</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">)</span>   
    <span class="n">metricas</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
        <span class="s1">&#39;Modelo&#39;</span><span class="p">:</span> <span class="s1">&#39;Random Forest&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Dias&#39;</span><span class="p">:</span> <span class="n">dias</span><span class="p">,</span>
        <span class="s1">&#39;Hora&#39;</span><span class="p">:</span> <span class="n">hora</span><span class="p">,</span>
        <span class="s1">&#39;MAPE&#39;</span><span class="p">:</span> <span class="n">mape</span><span class="p">,</span>
        <span class="s1">&#39;RMSE&#39;</span><span class="p">:</span> <span class="n">rmse</span><span class="p">,</span>
        <span class="s1">&#39;R^2&#39;</span><span class="p">:</span> <span class="n">r2</span><span class="p">,</span>
        <span class="s1">&#39;Ljung-Box p-value&#39;</span><span class="p">:</span> <span class="n">ljungbox</span><span class="p">,</span>
        <span class="s1">&#39;Jarque-Bera p-value&#39;</span><span class="p">:</span> <span class="n">jarquebera</span>
    <span class="p">})</span>   
    <span class="n">iniciotrain</span> <span class="o">=</span> <span class="n">fintrain</span>  <span class="c1"># Actualizar el inicio para el siguiente pliegue</span>

<span class="c1"># Gráfico con lineplot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="c1"># Conjunto de entrenamiento</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y_train</span><span class="p">)),</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Velocidad del viento original&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y_predicciontrain</span><span class="p">)),</span> <span class="n">y_predicciontrain</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Velocidad del viento predicha&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#9A32CD&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Índice&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Velocidad del viento&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Random Forest (Entrenamiento)</span><span class="se">\n</span><span class="s2">R²: </span><span class="si">{</span><span class="n">r2train</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, RMSE: </span><span class="si">{</span><span class="n">rmsetrain</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="c1"># Conjunto de prueba</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y_test</span><span class="p">)),</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Velocidad del viento original&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y_prediccion</span><span class="p">)),</span> <span class="n">y_prediccion</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Velocidad del viento predicha&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#6B8E23&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Índice&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Velocidad del viento&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Random Forest (Prueba)</span><span class="se">\n</span><span class="s2">R²: </span><span class="si">{</span><span class="n">r2</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, RMSE: </span><span class="si">{</span><span class="n">rmse</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="c1"># Mostrar gráfico</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/8b137221bc08e1cefc90fdcc23a1c4d8f10abb9745333ff639c17fc6348c5007.png" src="_images/8b137221bc08e1cefc90fdcc23a1c4d8f10abb9745333ff639c17fc6348c5007.png" />
</div>
</div>
<p>En el conjunto de entrenamiento, el modelo Random Forest presenta un R² de <code class="docutils literal notranslate"><span class="pre">0.89</span></code> y un RMSE de <code class="docutils literal notranslate"><span class="pre">0.34</span></code>, esto se resume en que el modelo cuenta con excelente desempeño. La línea de las predicciones sigue casi perfectamente la tendencia de los datos orginales, capturando incluso picos y caídas abruptas. Esto sugiere que el modelo está bien ajustado a los datos de entrenamiento.</p>
<p>Por otro lado, en el conjunto de prueba, el modelo no logra ajustarse adecuadamente al comportamiento de los datos, como se refleja en un R² de <code class="docutils literal notranslate"><span class="pre">0.51</span></code> y un RMSE de <code class="docutils literal notranslate"><span class="pre">0.71</span></code>. Aunque las predicciones logran seguir parcialmente la tendencia original, se observan diferencias significativas respecto a los valores reales, especialmente en los puntos de mayor variación, como picos y valles. Esto indica que el modelo tiene problemas para adaptarse de manera efectiva a datos nuevos o no vistos.</p>
</section>
<section id="id9">
<h4><strong>MODELO XGBOOST</strong><a class="headerlink" href="#id9" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">skopt.space</span> <span class="kn">import</span> <span class="n">Integer</span><span class="p">,</span> <span class="n">Categorical</span>
<span class="kn">from</span> <span class="nn">xgboost</span> <span class="kn">import</span> <span class="n">XGBRegressor</span>


<span class="n">espaciobusqueda</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;xgb__max_depth&#39;</span><span class="p">),</span>  <span class="c1"># Profundidad de los árboles</span>
    <span class="n">Categorical</span><span class="p">([</span><span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">500</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;xgb__n_estimators&#39;</span><span class="p">),</span>  <span class="c1"># Número de árboles</span>
    <span class="n">Categorical</span><span class="p">([</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;xgb__learning_rate&#39;</span><span class="p">)</span>  <span class="c1"># Tasa de aprendizaje</span>
<span class="p">]</span>

<span class="c1"># Función objetivo</span>
<span class="k">def</span> <span class="nf">funcionobjetivo</span><span class="p">(</span><span class="n">params</span><span class="p">):</span>
    <span class="n">max_depth</span><span class="p">,</span> <span class="n">n_estimators</span><span class="p">,</span> <span class="n">learning_rate</span> <span class="o">=</span> <span class="n">params</span>

    <span class="c1"># Modelo XGBoost con los parámetros</span>
    <span class="n">xgb</span> <span class="o">=</span> <span class="n">XGBRegressor</span><span class="p">(</span>
        <span class="n">max_depth</span><span class="o">=</span><span class="n">max_depth</span><span class="p">,</span>
        <span class="n">n_estimators</span><span class="o">=</span><span class="n">n_estimators</span><span class="p">,</span>
        <span class="n">learning_rate</span><span class="o">=</span><span class="n">learning_rate</span><span class="p">,</span>
        <span class="n">random_state</span><span class="o">=</span><span class="mi">21</span><span class="p">,</span>
        <span class="n">verbosity</span><span class="o">=</span><span class="mi">0</span>
    <span class="p">)</span>
    
    <span class="c1"># Obtener los pliegues (debes implementar la función pliegues)</span>
    <span class="n">conjuntopliegues</span> <span class="o">=</span> <span class="n">pliegues</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">14</span><span class="p">)</span>  <span class="c1"># Divisiones temporales según tus datos</span>
    
    <span class="n">mse_total</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">num_pliegues</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">conjuntopliegues</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">train_indices</span><span class="p">,</span> <span class="n">test_indices</span> <span class="ow">in</span> <span class="n">conjuntopliegues</span><span class="p">:</span>
        <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">train_indices</span><span class="p">],</span> <span class="n">X</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">test_indices</span><span class="p">]</span>
        <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">train_indices</span><span class="p">],</span> <span class="n">y</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">test_indices</span><span class="p">]</span>
        
        <span class="c1"># Entrenar el modelo XGBoost</span>
        <span class="n">xgb</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
        <span class="n">y_pred</span> <span class="o">=</span> <span class="n">xgb</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
        
        <span class="c1"># Calcular el error cuadrático medio (MSE)</span>
        <span class="n">mse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
        <span class="n">mse_total</span> <span class="o">+=</span> <span class="n">mse</span>

    <span class="n">mse_promedio</span> <span class="o">=</span> <span class="n">mse_total</span> <span class="o">/</span> <span class="n">num_pliegues</span>
    
    <span class="c1"># Devolver el MSE promedio como función de pérdida</span>
    <span class="k">return</span> <span class="n">mse_promedio</span>

<span class="c1"># Ejecutar optimización bayesiana</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">gp_minimize</span><span class="p">(</span><span class="n">funcionobjetivo</span><span class="p">,</span> <span class="n">espaciobusqueda</span><span class="p">,</span> <span class="n">n_calls</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">21</span><span class="p">)</span>

<span class="c1"># Imprimir mejores hiperparámetros</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mejores hiperparámetros: max_depth = </span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, n_estimators = </span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">, learning_rate = </span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Mejores hiperparámetros: max_depth = 2, n_estimators = 500, learning_rate = 0.01
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">modeloxgboost2</span> <span class="o">=</span> <span class="n">XGBRegressor</span><span class="p">(</span><span class="n">max_depth</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">n_estimators</span> <span class="o">=</span> <span class="mi">500</span><span class="p">,</span> <span class="n">learning_rate</span> <span class="o">=</span> <span class="mf">0.01</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">21</span><span class="p">)</span>
<span class="n">metricas</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">dias</span> <span class="o">=</span> <span class="mi">21</span>
<span class="n">hora</span> <span class="o">=</span> <span class="mi">14</span>
<span class="n">iniciotrain</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">while</span> <span class="p">(</span><span class="n">iniciotrain</span> <span class="o">+</span> <span class="p">(</span><span class="n">dias</span> <span class="o">*</span> <span class="mi">24</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">):</span>  
    <span class="n">fintrain</span> <span class="o">=</span> <span class="n">iniciotrain</span> <span class="o">+</span> <span class="p">(</span><span class="n">dias</span> <span class="o">*</span> <span class="mi">24</span><span class="p">)</span>   
    <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">plieguess</span><span class="p">(</span><span class="n">iniciotrain</span><span class="p">,</span> <span class="n">fintrain</span><span class="p">,</span> <span class="n">hora</span><span class="p">)</span>   
    <span class="n">modeloxgboost2</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
    <span class="n">y_prediccion</span><span class="o">=</span> <span class="n">modeloxgboost2</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>       
    <span class="n">rmse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">,</span> <span class="n">squared</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">mape</span> <span class="o">=</span> <span class="n">MAPE</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">)</span>
    <span class="n">r2</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">)</span>
    <span class="n">ljungbox</span><span class="p">,</span> <span class="n">jarquebera</span> <span class="o">=</span> <span class="n">residuos</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">)</span>   
    <span class="n">metricas</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
        <span class="s1">&#39;Modelo&#39;</span><span class="p">:</span> <span class="s1">&#39;Regresión XGBoost&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Dias&#39;</span><span class="p">:</span> <span class="n">dias</span><span class="p">,</span>
        <span class="s1">&#39;Hora&#39;</span><span class="p">:</span> <span class="n">hora</span><span class="p">,</span>
        <span class="s1">&#39;MAPE&#39;</span><span class="p">:</span> <span class="n">mape</span><span class="p">,</span>
        <span class="s1">&#39;RMSE&#39;</span><span class="p">:</span> <span class="n">rmse</span><span class="p">,</span>
        <span class="s1">&#39;R^2&#39;</span><span class="p">:</span> <span class="n">r2</span><span class="p">,</span>
        <span class="s1">&#39;Ljung-Box p-value&#39;</span> <span class="p">:</span> <span class="n">ljungbox</span><span class="p">,</span>
        <span class="s1">&#39;Jarque-Bera p-value&#39;</span> <span class="p">:</span> <span class="n">jarquebera</span>
    <span class="p">})</span>   
    <span class="n">iniciotrain</span> <span class="o">=</span> <span class="n">fintrain</span>  
<span class="n">dataxgboost</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">metricas</span><span class="p">)</span>
<span class="n">dataxgboost</span> <span class="o">=</span> <span class="n">dataxgboost</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dataxgboost</span><span class="p">[</span><span class="s1">&#39;RMSE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">idxmin</span><span class="p">()]</span>
<span class="n">dataxgboost</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">dataxgboost</span><span class="p">)</span>
<span class="n">dataxgboost</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>7</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Modelo</th>
      <td>Regresión XGBoost</td>
    </tr>
    <tr>
      <th>Dias</th>
      <td>21</td>
    </tr>
    <tr>
      <th>Hora</th>
      <td>14</td>
    </tr>
    <tr>
      <th>MAPE</th>
      <td>9.791959</td>
    </tr>
    <tr>
      <th>RMSE</th>
      <td>0.303648</td>
    </tr>
    <tr>
      <th>R^2</th>
      <td>0.837365</td>
    </tr>
    <tr>
      <th>Ljung-Box p-value</th>
      <td>0.968461</td>
    </tr>
    <tr>
      <th>Jarque-Bera p-value</th>
      <td>0.672995</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">metricas</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">dias</span> <span class="o">=</span> <span class="mi">21</span>
<span class="n">hora</span> <span class="o">=</span> <span class="mi">14</span>
<span class="n">iniciotrain</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">while</span> <span class="p">(</span><span class="n">iniciotrain</span> <span class="o">+</span> <span class="p">(</span><span class="n">dias</span> <span class="o">*</span> <span class="mi">24</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">):</span>  <span class="c1"># Mientras que el tamaño del pliegue más la hora sea menor que la longitud de los datos</span>
    <span class="n">fintrain</span> <span class="o">=</span> <span class="n">iniciotrain</span> <span class="o">+</span> <span class="p">(</span><span class="n">dias</span> <span class="o">*</span> <span class="mi">24</span><span class="p">)</span>   
    <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">plieguess</span><span class="p">(</span><span class="n">iniciotrain</span><span class="p">,</span> <span class="n">fintrain</span><span class="p">,</span> <span class="n">hora</span><span class="p">)</span>   
    <span class="n">modeloxgboost2</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
    
    <span class="c1"># Entrenamiento</span>
    <span class="n">y_predicciontrain</span> <span class="o">=</span> <span class="n">modeloxgboost2</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
    <span class="n">rmsetrain</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_predicciontrain</span><span class="p">,</span> <span class="n">squared</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">mapetrain</span> <span class="o">=</span> <span class="n">MAPE</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_predicciontrain</span><span class="p">)</span>
    <span class="n">r2train</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_predicciontrain</span><span class="p">)</span>
    
    <span class="c1"># Test</span>
    <span class="n">y_prediccion</span> <span class="o">=</span> <span class="n">modeloxgboost2</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>       
    <span class="n">rmse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">,</span> <span class="n">squared</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">mape</span> <span class="o">=</span> <span class="n">MAPE</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">)</span>
    <span class="n">r2</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">)</span>
    
    <span class="n">ljungbox</span><span class="p">,</span> <span class="n">jarquebera</span> <span class="o">=</span> <span class="n">residuos</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">)</span>   
    <span class="n">metricas</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
        <span class="s1">&#39;Modelo&#39;</span><span class="p">:</span> <span class="s1">&#39;XGBoost&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Dias&#39;</span><span class="p">:</span> <span class="n">dias</span><span class="p">,</span>
        <span class="s1">&#39;Hora&#39;</span><span class="p">:</span> <span class="n">hora</span><span class="p">,</span>
        <span class="s1">&#39;MAPE&#39;</span><span class="p">:</span> <span class="n">mape</span><span class="p">,</span>
        <span class="s1">&#39;RMSE&#39;</span><span class="p">:</span> <span class="n">rmse</span><span class="p">,</span>
        <span class="s1">&#39;R^2&#39;</span><span class="p">:</span> <span class="n">r2</span><span class="p">,</span>
        <span class="s1">&#39;Ljung-Box p-value&#39;</span><span class="p">:</span> <span class="n">ljungbox</span><span class="p">,</span>
        <span class="s1">&#39;Jarque-Bera p-value&#39;</span><span class="p">:</span> <span class="n">jarquebera</span>
    <span class="p">})</span>   
    <span class="n">iniciotrain</span> <span class="o">=</span> <span class="n">fintrain</span>  <span class="c1"># Actualizar el inicio para el siguiente pliegue</span>

<span class="c1"># Gráfico con lineplot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="c1"># Conjunto de entrenamiento</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y_train</span><span class="p">)),</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Velocidad del viento original&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y_predicciontrain</span><span class="p">)),</span> <span class="n">y_predicciontrain</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Velocidad del viento predicha&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#9A32CD&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Índice&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Velocidad del viento&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;XGBoost (Entrenamiento)</span><span class="se">\n</span><span class="s2">R²: </span><span class="si">{</span><span class="n">r2train</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, RMSE: </span><span class="si">{</span><span class="n">rmsetrain</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="c1"># Conjunto de prueba</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y_test</span><span class="p">)),</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Velocidad del viento original&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y_prediccion</span><span class="p">)),</span> <span class="n">y_prediccion</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Velocidad del viento predicha&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#6B8E23&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Índice&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Velocidad del viento&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;XGBoost (Prueba)</span><span class="se">\n</span><span class="s2">R²: </span><span class="si">{</span><span class="n">r2</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, RMSE: </span><span class="si">{</span><span class="n">rmse</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="c1"># Mostrar gráfico</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/dd81c2beb042f4c06426cf5c7e4e57eb1693662ac3479915d572f4aec5616135.png" src="_images/dd81c2beb042f4c06426cf5c7e4e57eb1693662ac3479915d572f4aec5616135.png" />
</div>
</div>
<p>Al observar la gráfica del conjunto de entrenamiento, podemos concluir que el modelo es bastante bueno, ya que presenta un coeficiente de determinación (R²) de <code class="docutils literal notranslate"><span class="pre">0.76</span></code> y un error cuadrático medio (RMSE) de <code class="docutils literal notranslate"><span class="pre">0.51</span></code>. Esto se refleja en que las líneas correspondientes a la velocidad del viento predicha siguen prácticamente la misma tendencia que los datos reales del conjunto de entrenamiento.</p>
<p>En cuanto al conjunto de prueba, el modelo presenta un R² de <code class="docutils literal notranslate"><span class="pre">0.78</span></code> y un RMSE de <code class="docutils literal notranslate"><span class="pre">0.49</span></code>. Podemos observar que la línea de velocidad del viento intenta seguir la tendencia de la original, sin embargo, falla en algunos segmentos. Esto significa que el modelo puede mejorar.</p>
</section>
<section id="id10">
<h4><strong>MODELO SVR</strong><a class="headerlink" href="#id10" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">modelosvr2</span> <span class="o">=</span> <span class="n">SVR</span><span class="p">(</span><span class="n">C</span> <span class="o">=</span> <span class="mf">2.715390236475287</span><span class="p">,</span> <span class="n">kernel</span> <span class="o">=</span> <span class="s2">&quot;rbf&quot;</span><span class="p">,</span> <span class="n">gamma</span> <span class="o">=</span> <span class="s2">&quot;auto&quot;</span><span class="p">)</span>
<span class="n">metricas</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">dias</span> <span class="o">=</span> <span class="mi">21</span>
<span class="n">hora</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">iniciotrain</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">while</span> <span class="p">(</span><span class="n">iniciotrain</span> <span class="o">+</span> <span class="p">(</span><span class="n">dias</span> <span class="o">*</span> <span class="mi">24</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">):</span>  
    <span class="n">fintrain</span> <span class="o">=</span> <span class="n">iniciotrain</span> <span class="o">+</span> <span class="p">(</span><span class="n">dias</span> <span class="o">*</span> <span class="mi">24</span><span class="p">)</span>   
    <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">plieguess</span><span class="p">(</span><span class="n">iniciotrain</span><span class="p">,</span> <span class="n">fintrain</span><span class="p">,</span> <span class="n">hora</span><span class="p">)</span>   
    <span class="n">modelosvr2</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
    <span class="n">y_prediccion</span><span class="o">=</span> <span class="n">modelosvr2</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>       
    <span class="n">rmse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">,</span> <span class="n">squared</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">mape</span> <span class="o">=</span> <span class="n">MAPE</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">)</span>
    <span class="n">r2</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">)</span>
    <span class="n">ljungbox</span><span class="p">,</span> <span class="n">jarquebera</span> <span class="o">=</span> <span class="n">residuos</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">)</span>   
    <span class="n">metricas</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
        <span class="s1">&#39;Modelo&#39;</span><span class="p">:</span> <span class="s1">&#39;Regresión con Máqinas de Soporte Vectorial&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Dias&#39;</span><span class="p">:</span> <span class="n">dias</span><span class="p">,</span>
        <span class="s1">&#39;Hora&#39;</span><span class="p">:</span> <span class="n">hora</span><span class="p">,</span>
        <span class="s1">&#39;MAPE&#39;</span><span class="p">:</span> <span class="n">mape</span><span class="p">,</span>
        <span class="s1">&#39;RMSE&#39;</span><span class="p">:</span> <span class="n">rmse</span><span class="p">,</span>
        <span class="s1">&#39;R^2&#39;</span><span class="p">:</span> <span class="n">r2</span><span class="p">,</span>
        <span class="s1">&#39;Ljung-Box p-value&#39;</span> <span class="p">:</span> <span class="n">ljungbox</span><span class="p">,</span>
        <span class="s1">&#39;Jarque-Bera p-value&#39;</span> <span class="p">:</span> <span class="n">jarquebera</span>
    <span class="p">})</span>   
    <span class="n">iniciotrain</span> <span class="o">=</span> <span class="n">fintrain</span>  
<span class="n">datasvm</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">metricas</span><span class="p">)</span>
<span class="n">datasvm</span> <span class="o">=</span> <span class="n">datasvm</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">datasvm</span><span class="p">[</span><span class="s1">&#39;RMSE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">idxmin</span><span class="p">()]</span>
<span class="n">datasvm</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">datasvm</span><span class="p">)</span>
<span class="n">datasvm</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>30</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Modelo</th>
      <td>Regresión con Máqinas de Soporte Vectorial</td>
    </tr>
    <tr>
      <th>Dias</th>
      <td>21</td>
    </tr>
    <tr>
      <th>Hora</th>
      <td>4</td>
    </tr>
    <tr>
      <th>MAPE</th>
      <td>11.792695</td>
    </tr>
    <tr>
      <th>RMSE</th>
      <td>0.302481</td>
    </tr>
    <tr>
      <th>R^2</th>
      <td>0.921906</td>
    </tr>
    <tr>
      <th>Ljung-Box p-value</th>
      <td>0.27866</td>
    </tr>
    <tr>
      <th>Jarque-Bera p-value</th>
      <td>0.549737</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">modelosvr2</span> <span class="o">=</span> <span class="n">SVR</span><span class="p">(</span><span class="n">C</span> <span class="o">=</span> <span class="mf">2.715390236475287</span><span class="p">,</span> <span class="n">kernel</span> <span class="o">=</span> <span class="s2">&quot;rbf&quot;</span><span class="p">,</span> <span class="n">gamma</span> <span class="o">=</span> <span class="s2">&quot;auto&quot;</span><span class="p">)</span>
<span class="n">metricas</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">dias</span> <span class="o">=</span> <span class="mi">21</span>
<span class="n">hora</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">iniciotrain</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">while</span> <span class="p">(</span><span class="n">iniciotrain</span> <span class="o">+</span> <span class="p">(</span><span class="n">dias</span> <span class="o">*</span> <span class="mi">24</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">):</span>  <span class="c1"># Mientras que el tamaño del pliegue más la hora sea menor que la longitud de los datos</span>
    <span class="n">fintrain</span> <span class="o">=</span> <span class="n">iniciotrain</span> <span class="o">+</span> <span class="p">(</span><span class="n">dias</span> <span class="o">*</span> <span class="mi">24</span><span class="p">)</span>   
    <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">plieguess</span><span class="p">(</span><span class="n">iniciotrain</span><span class="p">,</span> <span class="n">fintrain</span><span class="p">,</span> <span class="n">hora</span><span class="p">)</span>   
    <span class="n">modelosvr2</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
    
    <span class="c1"># Entrenamiento</span>
    <span class="n">y_predicciontrain</span> <span class="o">=</span> <span class="n">modelosvr2</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
    <span class="n">rmsetrain</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_predicciontrain</span><span class="p">,</span> <span class="n">squared</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">mapetrain</span> <span class="o">=</span> <span class="n">MAPE</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_predicciontrain</span><span class="p">)</span>
    <span class="n">r2train</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_predicciontrain</span><span class="p">)</span>
    
    <span class="c1"># Test</span>
    <span class="n">y_prediccion</span> <span class="o">=</span> <span class="n">modelosvr2</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>       
    <span class="n">rmse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">,</span> <span class="n">squared</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">mape</span> <span class="o">=</span> <span class="n">MAPE</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">)</span>
    <span class="n">r2</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">)</span>
    
    <span class="n">ljungbox</span><span class="p">,</span> <span class="n">jarquebera</span> <span class="o">=</span> <span class="n">residuos</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">)</span>   
    <span class="n">metricas</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
        <span class="s1">&#39;Modelo&#39;</span><span class="p">:</span> <span class="s1">&#39;SVR&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Dias&#39;</span><span class="p">:</span> <span class="n">dias</span><span class="p">,</span>
        <span class="s1">&#39;Hora&#39;</span><span class="p">:</span> <span class="n">hora</span><span class="p">,</span>
        <span class="s1">&#39;MAPE&#39;</span><span class="p">:</span> <span class="n">mape</span><span class="p">,</span>
        <span class="s1">&#39;RMSE&#39;</span><span class="p">:</span> <span class="n">rmse</span><span class="p">,</span>
        <span class="s1">&#39;R^2&#39;</span><span class="p">:</span> <span class="n">r2</span><span class="p">,</span>
        <span class="s1">&#39;Ljung-Box p-value&#39;</span><span class="p">:</span> <span class="n">ljungbox</span><span class="p">,</span>
        <span class="s1">&#39;Jarque-Bera p-value&#39;</span><span class="p">:</span> <span class="n">jarquebera</span>
    <span class="p">})</span>   
    <span class="n">iniciotrain</span> <span class="o">=</span> <span class="n">fintrain</span>  <span class="c1"># Actualizar el inicio para el siguiente pliegue</span>

<span class="c1"># Gráfico con lineplot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="c1"># Conjunto de entrenamiento</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y_train</span><span class="p">)),</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Velocidad del viento original&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y_predicciontrain</span><span class="p">)),</span> <span class="n">y_predicciontrain</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Velocidad del viento predicha&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#9A32CD&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Índice&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Velocidad del viento&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;SVR (Entrenamiento)</span><span class="se">\n</span><span class="s2">R²: </span><span class="si">{</span><span class="n">r2train</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, RMSE: </span><span class="si">{</span><span class="n">rmsetrain</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="c1"># Conjunto de prueba</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y_test</span><span class="p">)),</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Velocidad del viento original&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y_prediccion</span><span class="p">)),</span> <span class="n">y_prediccion</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Velocidad del viento predicha&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#6B8E23&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Índice&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Velocidad del viento&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;SVR (Prueba)</span><span class="se">\n</span><span class="s2">R²: </span><span class="si">{</span><span class="n">r2</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, RMSE: </span><span class="si">{</span><span class="n">rmse</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="c1"># Mostrar gráfico</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/5348771e39c2f9b21ca784b824b18f03acc9d14e1b4e05c5fc7f645228c503d4.png" src="_images/5348771e39c2f9b21ca784b824b18f03acc9d14e1b4e05c5fc7f645228c503d4.png" />
</div>
</div>
<p>En la gráfica del modelo en el conjunto de entrenamiento, se observa que las predicciones siguen casi perfectamente la tendencia de los datos originales, al punto de que ambas líneas son prácticamente indistinguibles, incluso en los picos y valles. Esto se refleja en los valores de R² (<code class="docutils literal notranslate"><span class="pre">0.98</span></code>) y RMSE (<code class="docutils literal notranslate"><span class="pre">0.16</span></code>), que indican que el modelo logra un ajuste muy preciso en este conjunto.</p>
<p>Por otro lado, en la gráfica del conjunto de prueba, se nota que las predicciones no logran ajustarse bien al comportamiento de los datos originales. Aunque intentan seguir el patrón general, se presentan discrepancias importantes, sobre todo en los picos y valles, donde las predicciones fallan en capturar los valores extremos. Esto se ve reflejado en un R² de <code class="docutils literal notranslate"><span class="pre">0.30</span></code> y un RMSE de <code class="docutils literal notranslate"><span class="pre">1.06</span></code>, que evidencian un desempeño mucho menor en comparación con el entrenamiento.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pickle</span>

<span class="c1"># Guardado del modelo KNN y el dataframe dataknn</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;C:/Users/valcd/OneDrive/Escritorio/MachinelearningUN/PF_MODELOS/svm_model_y_datos.pkl&quot;</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">modeloridge</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>  <span class="c1"># Guardar el modelo entrenado</span>
    <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">dataridge</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>    <span class="c1"># Guardar el dataframe con las métricas</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="EDA%20-%20WIND%20SPEED.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><strong>WIND SPEED</strong></p>
      </div>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#metodos-utiles-para-los-modelos"><strong>MÉTODOS ÚTILES PARA LOS MODELOS</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#muestra-de-pliegues"><strong>MUESTRA DE PLIEGUES</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hora-1"><strong>HORA 1</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hora-5"><strong>HORA 5</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hora-10"><strong>HORA 10</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hora-15"><strong>HORA 15</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hora-20"><strong>HORA 20</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hora-24"><strong>HORA 24</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modelos"><strong>MODELOS</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-knn"><strong>MODELO KNN</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#mejor-modelo-cada-hora"><strong>MEJOR MODELO - CADA HORA</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#hora-y-ventana-con-mejor-modelo-knn"><strong>HORA Y VENTANA CON MEJOR MODELO KNN</strong></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-regresion-lineal"><strong>MODELO REGRESIÓN LINEAL</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id1"><strong>MEJOR MODELO - CADA HORA</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#hora-y-ventana-con-mejor-modelo-reg-lineal"><strong>HORA Y VENTANA CON MEJOR MODELO REG. LINEAL</strong></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-regresion-ridge"><strong>MODELO REGRESIÓN RIDGE</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id2"><strong>MEJOR MODELO - CADA HORA</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#hora-y-ventana-con-mejor-modelo-ridge"><strong>HORA Y VENTANA CON MEJOR MODELO RIDGE</strong></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-regresion-lasso"><strong>MODELO REGRESIÓN LASSO</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id3"><strong>MEJOR MODELO - CADA HORA</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#hora-y-ventana-con-mejor-modelo-lasso"><strong>HORA Y VENTANA CON MEJOR MODELO LASSO</strong></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-decision-tree"><strong>MODELO DECISION TREE</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id4"><strong>MEJOR MODELO - CADA HORA</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#hora-y-ventana-con-mejor-modelo-arbol-de-decision"><strong>HORA Y VENTANA CON MEJOR MODELO ÁRBOL DE DECISION</strong></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-random-forest"><strong>MODELO RANDOM FOREST</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id5"><strong>MEJOR MODELO - CADA HORA</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#hora-y-ventana-con-mejor-modelo-random-forest"><strong>HORA Y VENTANA CON MEJOR MODELO RANDOM FOREST</strong></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-xgboost"><strong>MODELO XGBOOST</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id6"><strong>MEJOR MODELO - CADA HORA</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#hora-y-ventana-con-mejor-modelo-xgboost"><strong>HORA Y VENTANA CON MEJOR MODELO XGBOOST</strong></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-svr"><strong>MODELO SVR</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mejores-modelos-de-regresion"><strong>MEJORES MODELOS DE REGRESIÓN</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#optimizacion-bayesiana"><strong>Optimización Bayesiana</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id7"><strong>MODELO KNN</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-ridge"><strong>MODELO RIDGE</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-lasso"><strong>MODELO LASSO</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-decision-tree-regressor"><strong>MODELO DECISION TREE REGRESSOR</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id8"><strong>MODELO RANDOM FOREST</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id9"><strong>MODELO XGBOOST</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id10"><strong>MODELO SVR</strong></a></li>
</ul>
</li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By The Jupyter Book Community
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>