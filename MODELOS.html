
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Modelos de regresión &#8212; My sample book</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'MODELOS';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="WIND SPEED" href="EDA%20-%20WIND%20SPEED.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="My sample book - Home"/>
    <script>document.write(`<img src="_static/logo.png" class="logo__image only-dark" alt="My sample book - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    PUNTO 2 - PARCIAL
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="EDA%20-%20WIND%20SPEED.html"><strong>WIND SPEED</strong></a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#"><strong>Modelos de regresión</strong></a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2FMODELOS.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/MODELOS.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Modelos de regresión</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#metodos-utiles-para-los-modelos"><strong>MÉTODOS ÚTILES PARA LOS MODELOS</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#muestra-de-pliegues"><strong>MUESTRA DE PLIEGUES</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hora-1"><strong>HORA 1</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hora-5"><strong>HORA 5</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hora-10"><strong>HORA 10</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hora-15"><strong>HORA 15</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hora-20"><strong>HORA 20</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hora-24"><strong>HORA 24</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modelos"><strong>MODELOS</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-knn"><strong>MODELO KNN</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#mejor-modelo-cada-hora"><strong>MEJOR MODELO - CADA HORA</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#hora-y-ventana-con-mejor-modelo-knn"><strong>HORA Y VENTANA CON MEJOR MODELO KNN</strong></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#regresion-lineal"><strong>REGRESIÓN LINEAL</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id1"><strong>MEJOR MODELO - CADA HORA</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#hora-y-ventana-con-mejor-modelo-reg-lineal"><strong>HORA Y VENTANA CON MEJOR MODELO REG. LINEAL</strong></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#regresion-ridge"><strong>REGRESIÓN RIDGE</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id2"><strong>MEJOR MODELO - CADA HORA</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#hora-y-ventana-con-mejor-modelo-ridge"><strong>HORA Y VENTANA CON MEJOR MODELO RIDGE</strong></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#regresion-lasso"><strong>REGRESIÓN LASSO</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id3"><strong>MEJOR MODELO - CADA HORA</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#hora-y-ventana-con-mejor-modelo-lasso"><strong>HORA Y VENTANA CON MEJOR MODELO LASSO</strong></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mejores-modelos-de-regresion"><strong>MEJORES MODELOS DE REGRESIÓN</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#optimizacion-bayesiana"><strong>Optimización Bayesiana</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id4"><strong>MODELO KNN</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-ridge"><strong>MODELO RIDGE</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-lasso"><strong>MODELO LASSO</strong></a></li>
</ul>
</li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="modelos-de-regresion">
<h1><strong>Modelos de regresión</strong><a class="headerlink" href="#modelos-de-regresion" title="Link to this heading">#</a></h1>
<p>En este ejercicio, nuestro objetivo es desarrollar un modelo predictivo para estimar la velocidad del viento horaria. Para abordar este problema, utilizaremos cuatro enfoques de regresión: <strong>K-Nearest Neighbors (KNN)</strong>, <strong>Regresión Lineal</strong>, <strong>Regresión Ridge</strong>, y <strong>Regresión Lasso</strong>. La predicción se realizará considerando tanto las diferentes ventanas temporales de pronóstico (7, 14, 21 y 28 días), como el ciclo horario completo de 24 horas de un día.</p>
<p>A continuación, las librerías y módulos usados.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">warnings</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">stats</span>
<span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span>
<span class="kn">from</span> <span class="nn">skopt</span> <span class="kn">import</span> <span class="n">gp_minimize</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">r2_score</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">Ridge</span><span class="p">,</span> <span class="n">Lasso</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_squared_error</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span>
<span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">KNeighborsRegressor</span>
<span class="kn">from</span> <span class="nn">skopt.space</span> <span class="kn">import</span> <span class="n">Integer</span><span class="p">,</span> <span class="n">Categorical</span><span class="p">,</span> <span class="n">Real</span>
<span class="kn">from</span> <span class="nn">statsmodels.stats.stattools</span> <span class="kn">import</span> <span class="n">jarque_bera</span>
<span class="kn">from</span> <span class="nn">statsmodels.stats.diagnostic</span> <span class="kn">import</span> <span class="n">acorr_ljungbox</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_absolute_percentage_error</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_squared_error</span><span class="p">,</span> <span class="n">mean_absolute_error</span>
</pre></div>
</div>
</div>
</div>
<p>En primer lugar, procederemos a importar la base de datos obtenida luego de finalizar el análisis exploratorio de los datos.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;C:/Users/valcd/OneDrive/Escritorio/dataparcial2.csv&quot;</span><span class="p">)</span>
<span class="n">data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>hora</th>
      <th>direccionviento</th>
      <th>velocidadviento</th>
      <th>humedadmaxima</th>
      <th>humedadminima</th>
      <th>temperaturamaxima</th>
      <th>temperaturaminima</th>
      <th>precipitaciontotal</th>
      <th>rafagamaxima</th>
      <th>presion_atm_maxima</th>
      <th>presion_atm_minima</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>12:00</td>
      <td>0.809017</td>
      <td>1.8</td>
      <td>69.0</td>
      <td>60.0</td>
      <td>22.6</td>
      <td>20.7</td>
      <td>0.0</td>
      <td>3.8</td>
      <td>888.2</td>
      <td>887.7</td>
    </tr>
    <tr>
      <th>1</th>
      <td>13:00</td>
      <td>0.965926</td>
      <td>2.7</td>
      <td>62.0</td>
      <td>55.0</td>
      <td>24.2</td>
      <td>22.5</td>
      <td>0.0</td>
      <td>4.7</td>
      <td>888.4</td>
      <td>888.2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>14:00</td>
      <td>0.891007</td>
      <td>2.0</td>
      <td>56.0</td>
      <td>50.0</td>
      <td>25.5</td>
      <td>24.3</td>
      <td>0.0</td>
      <td>4.9</td>
      <td>888.4</td>
      <td>888.1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>15:00</td>
      <td>0.848048</td>
      <td>2.5</td>
      <td>52.0</td>
      <td>44.0</td>
      <td>27.4</td>
      <td>25.0</td>
      <td>0.0</td>
      <td>5.8</td>
      <td>888.1</td>
      <td>887.4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>16:00</td>
      <td>0.224951</td>
      <td>2.4</td>
      <td>50.0</td>
      <td>43.0</td>
      <td>27.1</td>
      <td>25.5</td>
      <td>0.0</td>
      <td>5.8</td>
      <td>887.4</td>
      <td>886.5</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>87688</th>
      <td>19:00</td>
      <td>-0.615661</td>
      <td>5.6</td>
      <td>83.0</td>
      <td>78.0</td>
      <td>21.8</td>
      <td>21.1</td>
      <td>0.0</td>
      <td>12.3</td>
      <td>879.8</td>
      <td>879.1</td>
    </tr>
    <tr>
      <th>87689</th>
      <td>20:00</td>
      <td>-0.469472</td>
      <td>4.9</td>
      <td>84.0</td>
      <td>79.0</td>
      <td>21.7</td>
      <td>21.0</td>
      <td>0.0</td>
      <td>9.9</td>
      <td>879.2</td>
      <td>878.9</td>
    </tr>
    <tr>
      <th>87690</th>
      <td>21:00</td>
      <td>-0.484810</td>
      <td>4.5</td>
      <td>86.0</td>
      <td>82.0</td>
      <td>21.2</td>
      <td>20.6</td>
      <td>0.0</td>
      <td>8.9</td>
      <td>879.8</td>
      <td>879.2</td>
    </tr>
    <tr>
      <th>87691</th>
      <td>22:00</td>
      <td>-0.484810</td>
      <td>3.2</td>
      <td>88.0</td>
      <td>85.0</td>
      <td>20.6</td>
      <td>20.2</td>
      <td>0.0</td>
      <td>8.0</td>
      <td>880.5</td>
      <td>879.6</td>
    </tr>
    <tr>
      <th>87692</th>
      <td>23:00</td>
      <td>-0.573576</td>
      <td>2.3</td>
      <td>95.0</td>
      <td>88.0</td>
      <td>20.2</td>
      <td>19.3</td>
      <td>0.6</td>
      <td>7.5</td>
      <td>881.1</td>
      <td>880.5</td>
    </tr>
  </tbody>
</table>
<p>87693 rows × 11 columns</p>
</div></div></div>
</div>
<p>Luego, particionamos la base de datos en dos partes. <strong>X</strong> que corresponde a todas las variables explicativas e <strong>y</strong> que corresponde a la variable respuesta.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;hora&#39;</span><span class="p">,</span><span class="s1">&#39;velocidadviento&#39;</span><span class="p">])</span> <span class="c1"># Se toman todas las columnas excepto la objetivo</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;velocidadviento&#39;</span><span class="p">]</span> <span class="c1"># Se toma solo la columna objetivo</span>
</pre></div>
</div>
</div>
</div>
<p>Creamos este vector que contiene las ventanas de predicción para este ejercicio.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">particiones</span> <span class="o">=</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">28</span><span class="p">]</span> <span class="c1"># Vector que almacena el valor de las particiones estipuladas. En DIAS.</span>
</pre></div>
</div>
</div>
</div>
<section id="metodos-utiles-para-los-modelos">
<h2><strong>MÉTODOS ÚTILES PARA LOS MODELOS</strong><a class="headerlink" href="#metodos-utiles-para-los-modelos" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Mejor modelo por hora</span>

<span class="k">def</span> <span class="nf">mejormodelohora</span><span class="p">(</span><span class="n">particiones</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>  
    <span class="n">mejormodelo</span> <span class="o">=</span> <span class="p">[]</span>  
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">25</span><span class="p">):</span> <span class="c1"># Recorre las 24 horas del día</span>
        <span class="n">mejorrmse</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">)</span>  
        <span class="n">mejor_modelo</span> <span class="o">=</span> <span class="kc">None</span>  
        <span class="k">for</span> <span class="n">dias</span> <span class="ow">in</span> <span class="n">particiones</span><span class="p">:</span> <span class="c1"># Recorre las 7 ventanas</span>
            <span class="n">condicion</span> <span class="o">=</span> <span class="n">data</span><span class="p">[(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">i</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Dias&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">dias</span><span class="p">)]</span> 
            <span class="k">if</span> <span class="ow">not</span> <span class="n">condicion</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span> 
                <span class="c1"># Se busca la fila con menor RMSE entre todas</span>
                <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">condicion</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
                    <span class="k">if</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;RMSE&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">mejorrmse</span><span class="p">:</span>
                        <span class="n">mejorrmse</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;RMSE&#39;</span><span class="p">]</span>
                        <span class="n">mejor_modelo</span> <span class="o">=</span> <span class="n">row</span>     
        <span class="k">if</span> <span class="n">mejor_modelo</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">mejormodelo</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mejor_modelo</span><span class="p">)</span>  <span class="c1"># Se agrega la fila a un vector           </span>
    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">mejormodelo</span><span class="p">)</span> <span class="c1"># Se devuelve DataFrame</span>

<span class="c1"># Mejor modelo de cada uno (KNN, Regresión lineal, Ridge, Lasso)</span>

<span class="k">def</span> <span class="nf">mejormodelotot</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="n">mejorrmse</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">)</span>  
    <span class="n">mejor_modelo</span> <span class="o">=</span> <span class="kc">None</span>  
    <span class="c1"># Se busca la fila con menor RMSE entre todas</span>
    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;RMSE&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">mejorrmse</span><span class="p">:</span>  
            <span class="n">mejorrmse</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;RMSE&#39;</span><span class="p">]</span>
            <span class="n">mejor_modelo</span> <span class="o">=</span> <span class="n">row</span>  
    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">mejor_modelo</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">plieguess</span><span class="p">(</span><span class="n">inicio</span><span class="p">,</span> <span class="n">fin</span><span class="p">,</span> <span class="n">hora</span><span class="p">):</span>
    <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">inicio</span><span class="p">:</span><span class="n">fin</span><span class="p">],</span> <span class="n">y</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">inicio</span><span class="p">:</span><span class="n">fin</span><span class="p">]</span>
    <span class="c1"># Se ajusta con -1 y 23 para que no se pase por alto el primer día del test ni tampoco se tomen más de 24 observaciones</span>
    <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">fin</span> <span class="o">+</span> <span class="n">hora</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span><span class="n">fin</span> <span class="o">+</span> <span class="n">hora</span> <span class="o">+</span> <span class="mi">23</span><span class="p">],</span> <span class="n">y</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">fin</span> <span class="o">+</span> <span class="n">hora</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span><span class="n">fin</span> <span class="o">+</span> <span class="n">hora</span> <span class="o">+</span> <span class="mi">23</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span>
<span class="c1"># Método para calcular los residuos del modelo</span>

<span class="k">def</span> <span class="nf">residuos</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">):</span>
    <span class="n">residuo</span> <span class="o">=</span> <span class="n">y_test</span> <span class="o">-</span> <span class="n">y_prediccion</span>
    <span class="n">ljung</span> <span class="o">=</span> <span class="n">acorr_ljungbox</span><span class="p">(</span><span class="n">residuo</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">],</span> <span class="n">return_df</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="s1">&#39;lb_pvalue&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">jarque</span> <span class="o">=</span> <span class="n">jarque_bera</span><span class="p">(</span><span class="n">residuo</span><span class="p">)</span>  
    <span class="n">jarque</span> <span class="o">=</span> <span class="n">jarque</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">ljung</span><span class="p">,</span> <span class="n">jarque</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="muestra-de-pliegues">
<h2><strong>MUESTRA DE PLIEGUES</strong><a class="headerlink" href="#muestra-de-pliegues" title="Link to this heading">#</a></h2>
<p>En este apartado, se presentarán ejemplos de pliegues correspondientes a las horas <code class="docutils literal notranslate"><span class="pre">1,</span> <span class="pre">5,</span> <span class="pre">10,</span> <span class="pre">15,</span> <span class="pre">20</span> <span class="pre">y</span> <span class="pre">24</span></code>, con el objetivo de ilustrar que los pliegues se están construyendo correctamente. Este enfoque busca ser práctico y proporcionar una visión general del proceso de construcción de pliegues para distintas horas seleccionadas.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">pliegues</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">hora</span><span class="p">,</span> <span class="n">dias</span><span class="p">):</span>
    <span class="n">conjuntopliegues</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">iniciotrain</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="p">(</span><span class="n">iniciotrain</span> <span class="o">+</span> <span class="p">(</span><span class="n">dias</span> <span class="o">*</span> <span class="mi">24</span><span class="p">)</span> <span class="o">+</span> <span class="n">hora</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">):</span>
        <span class="n">fintrain</span> <span class="o">=</span> <span class="n">iniciotrain</span> <span class="o">+</span> <span class="p">(</span><span class="n">dias</span> <span class="o">*</span> <span class="mi">24</span><span class="p">)</span>

        <span class="n">trn_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">iniciotrain</span><span class="p">,</span> <span class="n">fintrain</span><span class="p">)</span>
        <span class="n">tst_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">fintrain</span> <span class="o">+</span> <span class="n">hora</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">fintrain</span> <span class="o">+</span> <span class="n">hora</span> <span class="o">+</span> <span class="mi">23</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">max</span><span class="p">(</span><span class="n">tst_index</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">):</span>
            <span class="n">conjuntopliegues</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">trn_index</span><span class="p">,</span> <span class="n">tst_index</span><span class="p">))</span>

        <span class="n">iniciotrain</span> <span class="o">=</span> <span class="n">fintrain</span>
    <span class="k">return</span> <span class="n">conjuntopliegues</span>
</pre></div>
</div>
</div>
</div>
<section id="hora-1">
<h3><strong>HORA 1</strong><a class="headerlink" href="#hora-1" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">resultados</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;Pliegue&#39;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="s1">&#39;Entrenamiento 7 días&#39;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="s1">&#39;Prueba 7 días&#39;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="s1">&#39;Entrenamiento 14 días&#39;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="s1">&#39;Prueba 14 días&#39;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="s1">&#39;Entrenamiento 21 días&#39;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="s1">&#39;Prueba 21 días&#39;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="s1">&#39;Entrenamiento 28 días&#39;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="s1">&#39;Prueba 28 días&#39;</span><span class="p">:</span> <span class="p">[],</span>
<span class="p">}</span>

<span class="k">for</span> <span class="n">dias</span> <span class="ow">in</span> <span class="n">particiones</span><span class="p">:</span>
    <span class="n">plgs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">hora</span><span class="o">=</span><span class="mi">1</span>
    <span class="n">plgs</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">pliegues</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">hora</span><span class="p">,</span> <span class="n">dias</span><span class="p">))</span> 

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">trn_index</span><span class="p">,</span> <span class="n">tst_index</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">plgs</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">dias</span> <span class="o">==</span> <span class="mi">7</span><span class="p">:</span>
            <span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Pliegue&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Entrenamiento 7 días&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;range(</span><span class="si">{</span><span class="n">trn_index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">trn_index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
            <span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Prueba 7 días&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;range(</span><span class="si">{</span><span class="n">tst_index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">tst_index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">dias</span> <span class="o">==</span> <span class="mi">14</span><span class="p">:</span>
            <span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Entrenamiento 14 días&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;range(</span><span class="si">{</span><span class="n">trn_index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">trn_index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
            <span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Prueba 14 días&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;range(</span><span class="si">{</span><span class="n">tst_index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">tst_index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">dias</span> <span class="o">==</span> <span class="mi">21</span><span class="p">:</span>
            <span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Entrenamiento 21 días&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;range(</span><span class="si">{</span><span class="n">trn_index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">trn_index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
            <span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Prueba 21 días&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;range(</span><span class="si">{</span><span class="n">tst_index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">tst_index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">dias</span> <span class="o">==</span> <span class="mi">28</span><span class="p">:</span>
            <span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Entrenamiento 28 días&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;range(</span><span class="si">{</span><span class="n">trn_index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">trn_index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
            <span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Prueba 28 días&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;range(</span><span class="si">{</span><span class="n">tst_index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">tst_index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
<span class="n">colms</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Entrenamiento 7 días&#39;</span><span class="p">]),</span>
                     <span class="nb">len</span><span class="p">(</span><span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Entrenamiento 14 días&#39;</span><span class="p">]),</span>
                     <span class="nb">len</span><span class="p">(</span><span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Entrenamiento 21 días&#39;</span><span class="p">]),</span>
                     <span class="nb">len</span><span class="p">(</span><span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Entrenamiento 28 días&#39;</span><span class="p">]))</span>

<span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">resultados</span><span class="p">:</span>
    <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">resultados</span><span class="p">[</span><span class="n">key</span><span class="p">])</span> <span class="o">&lt;</span> <span class="n">colms</span><span class="p">:</span>
        <span class="n">resultados</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>

<span class="n">p1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">resultados</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p1</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Pliegue</th>
      <th>Entrenamiento 7 días</th>
      <th>Prueba 7 días</th>
      <th>Entrenamiento 14 días</th>
      <th>Prueba 14 días</th>
      <th>Entrenamiento 21 días</th>
      <th>Prueba 21 días</th>
      <th>Entrenamiento 28 días</th>
      <th>Prueba 28 días</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>range(0, 168)</td>
      <td>range(168, 192)</td>
      <td>range(0, 336)</td>
      <td>range(336, 360)</td>
      <td>range(0, 504)</td>
      <td>range(504, 528)</td>
      <td>range(0, 672)</td>
      <td>range(672, 696)</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>range(168, 336)</td>
      <td>range(336, 360)</td>
      <td>range(336, 672)</td>
      <td>range(672, 696)</td>
      <td>range(504, 1008)</td>
      <td>range(1008, 1032)</td>
      <td>range(672, 1344)</td>
      <td>range(1344, 1368)</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>range(336, 504)</td>
      <td>range(504, 528)</td>
      <td>range(672, 1008)</td>
      <td>range(1008, 1032)</td>
      <td>range(1008, 1512)</td>
      <td>range(1512, 1536)</td>
      <td>range(1344, 2016)</td>
      <td>range(2016, 2040)</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>range(504, 672)</td>
      <td>range(672, 696)</td>
      <td>range(1008, 1344)</td>
      <td>range(1344, 1368)</td>
      <td>range(1512, 2016)</td>
      <td>range(2016, 2040)</td>
      <td>range(2016, 2688)</td>
      <td>range(2688, 2712)</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>range(672, 840)</td>
      <td>range(840, 864)</td>
      <td>range(1344, 1680)</td>
      <td>range(1680, 1704)</td>
      <td>range(2016, 2520)</td>
      <td>range(2520, 2544)</td>
      <td>range(2688, 3360)</td>
      <td>range(3360, 3384)</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p1</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Pliegue</th>
      <th>Entrenamiento 7 días</th>
      <th>Prueba 7 días</th>
      <th>Entrenamiento 14 días</th>
      <th>Prueba 14 días</th>
      <th>Entrenamiento 21 días</th>
      <th>Prueba 21 días</th>
      <th>Entrenamiento 28 días</th>
      <th>Prueba 28 días</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>516</th>
      <td>517</td>
      <td>range(86688, 86856)</td>
      <td>range(86856, 86880)</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>517</th>
      <td>518</td>
      <td>range(86856, 87024)</td>
      <td>range(87024, 87048)</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>518</th>
      <td>519</td>
      <td>range(87024, 87192)</td>
      <td>range(87192, 87216)</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>519</th>
      <td>520</td>
      <td>range(87192, 87360)</td>
      <td>range(87360, 87384)</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>520</th>
      <td>521</td>
      <td>range(87360, 87528)</td>
      <td>range(87528, 87552)</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="hora-5">
<h3><strong>HORA 5</strong><a class="headerlink" href="#hora-5" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">resultados</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;Pliegue&#39;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="s1">&#39;Entrenamiento 7 días&#39;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="s1">&#39;Prueba 7 días&#39;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="s1">&#39;Entrenamiento 14 días&#39;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="s1">&#39;Prueba 14 días&#39;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="s1">&#39;Entrenamiento 21 días&#39;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="s1">&#39;Prueba 21 días&#39;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="s1">&#39;Entrenamiento 28 días&#39;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="s1">&#39;Prueba 28 días&#39;</span><span class="p">:</span> <span class="p">[],</span>
<span class="p">}</span>

<span class="k">for</span> <span class="n">dias</span> <span class="ow">in</span> <span class="n">particiones</span><span class="p">:</span>
    <span class="n">plgs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">hora</span><span class="o">=</span><span class="mi">5</span>
    <span class="n">plgs</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">pliegues</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">hora</span><span class="p">,</span> <span class="n">dias</span><span class="p">))</span> 

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">trn_index</span><span class="p">,</span> <span class="n">tst_index</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">plgs</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">dias</span> <span class="o">==</span> <span class="mi">7</span><span class="p">:</span>
            <span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Pliegue&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Entrenamiento 7 días&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;range(</span><span class="si">{</span><span class="n">trn_index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">trn_index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
            <span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Prueba 7 días&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;range(</span><span class="si">{</span><span class="n">tst_index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">tst_index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">dias</span> <span class="o">==</span> <span class="mi">14</span><span class="p">:</span>
            <span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Entrenamiento 14 días&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;range(</span><span class="si">{</span><span class="n">trn_index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">trn_index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
            <span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Prueba 14 días&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;range(</span><span class="si">{</span><span class="n">tst_index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">tst_index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">dias</span> <span class="o">==</span> <span class="mi">21</span><span class="p">:</span>
            <span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Entrenamiento 21 días&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;range(</span><span class="si">{</span><span class="n">trn_index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">trn_index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
            <span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Prueba 21 días&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;range(</span><span class="si">{</span><span class="n">tst_index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">tst_index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">dias</span> <span class="o">==</span> <span class="mi">28</span><span class="p">:</span>
            <span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Entrenamiento 28 días&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;range(</span><span class="si">{</span><span class="n">trn_index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">trn_index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
            <span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Prueba 28 días&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;range(</span><span class="si">{</span><span class="n">tst_index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">tst_index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>

<span class="n">colms</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Entrenamiento 7 días&#39;</span><span class="p">]),</span>
                     <span class="nb">len</span><span class="p">(</span><span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Entrenamiento 14 días&#39;</span><span class="p">]),</span>
                     <span class="nb">len</span><span class="p">(</span><span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Entrenamiento 21 días&#39;</span><span class="p">]),</span>
                     <span class="nb">len</span><span class="p">(</span><span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Entrenamiento 28 días&#39;</span><span class="p">]))</span>

<span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">resultados</span><span class="p">:</span>
    <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">resultados</span><span class="p">[</span><span class="n">key</span><span class="p">])</span> <span class="o">&lt;</span> <span class="n">colms</span><span class="p">:</span>
        <span class="n">resultados</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>

<span class="n">p5</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">resultados</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p5</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Pliegue</th>
      <th>Entrenamiento 7 días</th>
      <th>Prueba 7 días</th>
      <th>Entrenamiento 14 días</th>
      <th>Prueba 14 días</th>
      <th>Entrenamiento 21 días</th>
      <th>Prueba 21 días</th>
      <th>Entrenamiento 28 días</th>
      <th>Prueba 28 días</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>range(0, 168)</td>
      <td>range(172, 196)</td>
      <td>range(0, 336)</td>
      <td>range(340, 364)</td>
      <td>range(0, 504)</td>
      <td>range(508, 532)</td>
      <td>range(0, 672)</td>
      <td>range(676, 700)</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>range(168, 336)</td>
      <td>range(340, 364)</td>
      <td>range(336, 672)</td>
      <td>range(676, 700)</td>
      <td>range(504, 1008)</td>
      <td>range(1012, 1036)</td>
      <td>range(672, 1344)</td>
      <td>range(1348, 1372)</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>range(336, 504)</td>
      <td>range(508, 532)</td>
      <td>range(672, 1008)</td>
      <td>range(1012, 1036)</td>
      <td>range(1008, 1512)</td>
      <td>range(1516, 1540)</td>
      <td>range(1344, 2016)</td>
      <td>range(2020, 2044)</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>range(504, 672)</td>
      <td>range(676, 700)</td>
      <td>range(1008, 1344)</td>
      <td>range(1348, 1372)</td>
      <td>range(1512, 2016)</td>
      <td>range(2020, 2044)</td>
      <td>range(2016, 2688)</td>
      <td>range(2692, 2716)</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>range(672, 840)</td>
      <td>range(844, 868)</td>
      <td>range(1344, 1680)</td>
      <td>range(1684, 1708)</td>
      <td>range(2016, 2520)</td>
      <td>range(2524, 2548)</td>
      <td>range(2688, 3360)</td>
      <td>range(3364, 3388)</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p5</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Pliegue</th>
      <th>Entrenamiento 7 días</th>
      <th>Prueba 7 días</th>
      <th>Entrenamiento 14 días</th>
      <th>Prueba 14 días</th>
      <th>Entrenamiento 21 días</th>
      <th>Prueba 21 días</th>
      <th>Entrenamiento 28 días</th>
      <th>Prueba 28 días</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>516</th>
      <td>517</td>
      <td>range(86688, 86856)</td>
      <td>range(86860, 86884)</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>517</th>
      <td>518</td>
      <td>range(86856, 87024)</td>
      <td>range(87028, 87052)</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>518</th>
      <td>519</td>
      <td>range(87024, 87192)</td>
      <td>range(87196, 87220)</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>519</th>
      <td>520</td>
      <td>range(87192, 87360)</td>
      <td>range(87364, 87388)</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>520</th>
      <td>521</td>
      <td>range(87360, 87528)</td>
      <td>range(87532, 87556)</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="hora-10">
<h3><strong>HORA 10</strong><a class="headerlink" href="#hora-10" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">resultados</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;Pliegue&#39;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="s1">&#39;Entrenamiento 7 días&#39;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="s1">&#39;Prueba 7 días&#39;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="s1">&#39;Entrenamiento 14 días&#39;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="s1">&#39;Prueba 14 días&#39;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="s1">&#39;Entrenamiento 21 días&#39;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="s1">&#39;Prueba 21 días&#39;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="s1">&#39;Entrenamiento 28 días&#39;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="s1">&#39;Prueba 28 días&#39;</span><span class="p">:</span> <span class="p">[],</span>
<span class="p">}</span>

<span class="k">for</span> <span class="n">dias</span> <span class="ow">in</span> <span class="n">particiones</span><span class="p">:</span>
    <span class="n">plgs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">hora</span><span class="o">=</span><span class="mi">10</span>
    <span class="n">plgs</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">pliegues</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">hora</span><span class="p">,</span> <span class="n">dias</span><span class="p">))</span> 

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">trn_index</span><span class="p">,</span> <span class="n">tst_index</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">plgs</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">dias</span> <span class="o">==</span> <span class="mi">7</span><span class="p">:</span>
            <span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Pliegue&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Entrenamiento 7 días&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;range(</span><span class="si">{</span><span class="n">trn_index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">trn_index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
            <span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Prueba 7 días&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;range(</span><span class="si">{</span><span class="n">tst_index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">tst_index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">dias</span> <span class="o">==</span> <span class="mi">14</span><span class="p">:</span>
            <span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Entrenamiento 14 días&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;range(</span><span class="si">{</span><span class="n">trn_index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">trn_index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
            <span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Prueba 14 días&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;range(</span><span class="si">{</span><span class="n">tst_index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">tst_index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">dias</span> <span class="o">==</span> <span class="mi">21</span><span class="p">:</span>
            <span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Entrenamiento 21 días&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;range(</span><span class="si">{</span><span class="n">trn_index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">trn_index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
            <span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Prueba 21 días&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;range(</span><span class="si">{</span><span class="n">tst_index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">tst_index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">dias</span> <span class="o">==</span> <span class="mi">28</span><span class="p">:</span>
            <span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Entrenamiento 28 días&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;range(</span><span class="si">{</span><span class="n">trn_index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">trn_index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
            <span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Prueba 28 días&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;range(</span><span class="si">{</span><span class="n">tst_index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">tst_index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>

<span class="n">colms</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Entrenamiento 7 días&#39;</span><span class="p">]),</span>
                     <span class="nb">len</span><span class="p">(</span><span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Entrenamiento 14 días&#39;</span><span class="p">]),</span>
                     <span class="nb">len</span><span class="p">(</span><span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Entrenamiento 21 días&#39;</span><span class="p">]),</span>
                     <span class="nb">len</span><span class="p">(</span><span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Entrenamiento 28 días&#39;</span><span class="p">]))</span>

<span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">resultados</span><span class="p">:</span>
    <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">resultados</span><span class="p">[</span><span class="n">key</span><span class="p">])</span> <span class="o">&lt;</span> <span class="n">colms</span><span class="p">:</span>
        <span class="n">resultados</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>

<span class="n">p10</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">resultados</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p10</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Pliegue</th>
      <th>Entrenamiento 7 días</th>
      <th>Prueba 7 días</th>
      <th>Entrenamiento 14 días</th>
      <th>Prueba 14 días</th>
      <th>Entrenamiento 21 días</th>
      <th>Prueba 21 días</th>
      <th>Entrenamiento 28 días</th>
      <th>Prueba 28 días</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>range(0, 168)</td>
      <td>range(177, 201)</td>
      <td>range(0, 336)</td>
      <td>range(345, 369)</td>
      <td>range(0, 504)</td>
      <td>range(513, 537)</td>
      <td>range(0, 672)</td>
      <td>range(681, 705)</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>range(168, 336)</td>
      <td>range(345, 369)</td>
      <td>range(336, 672)</td>
      <td>range(681, 705)</td>
      <td>range(504, 1008)</td>
      <td>range(1017, 1041)</td>
      <td>range(672, 1344)</td>
      <td>range(1353, 1377)</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>range(336, 504)</td>
      <td>range(513, 537)</td>
      <td>range(672, 1008)</td>
      <td>range(1017, 1041)</td>
      <td>range(1008, 1512)</td>
      <td>range(1521, 1545)</td>
      <td>range(1344, 2016)</td>
      <td>range(2025, 2049)</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>range(504, 672)</td>
      <td>range(681, 705)</td>
      <td>range(1008, 1344)</td>
      <td>range(1353, 1377)</td>
      <td>range(1512, 2016)</td>
      <td>range(2025, 2049)</td>
      <td>range(2016, 2688)</td>
      <td>range(2697, 2721)</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>range(672, 840)</td>
      <td>range(849, 873)</td>
      <td>range(1344, 1680)</td>
      <td>range(1689, 1713)</td>
      <td>range(2016, 2520)</td>
      <td>range(2529, 2553)</td>
      <td>range(2688, 3360)</td>
      <td>range(3369, 3393)</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p10</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Pliegue</th>
      <th>Entrenamiento 7 días</th>
      <th>Prueba 7 días</th>
      <th>Entrenamiento 14 días</th>
      <th>Prueba 14 días</th>
      <th>Entrenamiento 21 días</th>
      <th>Prueba 21 días</th>
      <th>Entrenamiento 28 días</th>
      <th>Prueba 28 días</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>516</th>
      <td>517</td>
      <td>range(86688, 86856)</td>
      <td>range(86865, 86889)</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>517</th>
      <td>518</td>
      <td>range(86856, 87024)</td>
      <td>range(87033, 87057)</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>518</th>
      <td>519</td>
      <td>range(87024, 87192)</td>
      <td>range(87201, 87225)</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>519</th>
      <td>520</td>
      <td>range(87192, 87360)</td>
      <td>range(87369, 87393)</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>520</th>
      <td>521</td>
      <td>range(87360, 87528)</td>
      <td>range(87537, 87561)</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="hora-15">
<h3><strong>HORA 15</strong><a class="headerlink" href="#hora-15" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">resultados</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;Pliegue&#39;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="s1">&#39;Entrenamiento 7 días&#39;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="s1">&#39;Prueba 7 días&#39;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="s1">&#39;Entrenamiento 14 días&#39;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="s1">&#39;Prueba 14 días&#39;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="s1">&#39;Entrenamiento 21 días&#39;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="s1">&#39;Prueba 21 días&#39;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="s1">&#39;Entrenamiento 28 días&#39;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="s1">&#39;Prueba 28 días&#39;</span><span class="p">:</span> <span class="p">[],</span>
<span class="p">}</span>

<span class="k">for</span> <span class="n">dias</span> <span class="ow">in</span> <span class="n">particiones</span><span class="p">:</span>
    <span class="n">plgs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">hora</span><span class="o">=</span><span class="mi">15</span>
    <span class="n">plgs</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">pliegues</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">hora</span><span class="p">,</span> <span class="n">dias</span><span class="p">))</span> 

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">trn_index</span><span class="p">,</span> <span class="n">tst_index</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">plgs</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">dias</span> <span class="o">==</span> <span class="mi">7</span><span class="p">:</span>
            <span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Pliegue&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Entrenamiento 7 días&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;range(</span><span class="si">{</span><span class="n">trn_index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">trn_index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
            <span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Prueba 7 días&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;range(</span><span class="si">{</span><span class="n">tst_index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">tst_index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">dias</span> <span class="o">==</span> <span class="mi">14</span><span class="p">:</span>
            <span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Entrenamiento 14 días&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;range(</span><span class="si">{</span><span class="n">trn_index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">trn_index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
            <span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Prueba 14 días&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;range(</span><span class="si">{</span><span class="n">tst_index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">tst_index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">dias</span> <span class="o">==</span> <span class="mi">21</span><span class="p">:</span>
            <span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Entrenamiento 21 días&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;range(</span><span class="si">{</span><span class="n">trn_index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">trn_index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
            <span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Prueba 21 días&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;range(</span><span class="si">{</span><span class="n">tst_index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">tst_index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">dias</span> <span class="o">==</span> <span class="mi">28</span><span class="p">:</span>
            <span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Entrenamiento 28 días&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;range(</span><span class="si">{</span><span class="n">trn_index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">trn_index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
            <span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Prueba 28 días&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;range(</span><span class="si">{</span><span class="n">tst_index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">tst_index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>

<span class="n">colms</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Entrenamiento 7 días&#39;</span><span class="p">]),</span>
                     <span class="nb">len</span><span class="p">(</span><span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Entrenamiento 14 días&#39;</span><span class="p">]),</span>
                     <span class="nb">len</span><span class="p">(</span><span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Entrenamiento 21 días&#39;</span><span class="p">]),</span>
                     <span class="nb">len</span><span class="p">(</span><span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Entrenamiento 28 días&#39;</span><span class="p">]))</span>

<span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">resultados</span><span class="p">:</span>
    <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">resultados</span><span class="p">[</span><span class="n">key</span><span class="p">])</span> <span class="o">&lt;</span> <span class="n">colms</span><span class="p">:</span>
        <span class="n">resultados</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>

<span class="n">p15</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">resultados</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p15</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Pliegue</th>
      <th>Entrenamiento 7 días</th>
      <th>Prueba 7 días</th>
      <th>Entrenamiento 14 días</th>
      <th>Prueba 14 días</th>
      <th>Entrenamiento 21 días</th>
      <th>Prueba 21 días</th>
      <th>Entrenamiento 28 días</th>
      <th>Prueba 28 días</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>range(0, 168)</td>
      <td>range(182, 206)</td>
      <td>range(0, 336)</td>
      <td>range(350, 374)</td>
      <td>range(0, 504)</td>
      <td>range(518, 542)</td>
      <td>range(0, 672)</td>
      <td>range(686, 710)</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>range(168, 336)</td>
      <td>range(350, 374)</td>
      <td>range(336, 672)</td>
      <td>range(686, 710)</td>
      <td>range(504, 1008)</td>
      <td>range(1022, 1046)</td>
      <td>range(672, 1344)</td>
      <td>range(1358, 1382)</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>range(336, 504)</td>
      <td>range(518, 542)</td>
      <td>range(672, 1008)</td>
      <td>range(1022, 1046)</td>
      <td>range(1008, 1512)</td>
      <td>range(1526, 1550)</td>
      <td>range(1344, 2016)</td>
      <td>range(2030, 2054)</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>range(504, 672)</td>
      <td>range(686, 710)</td>
      <td>range(1008, 1344)</td>
      <td>range(1358, 1382)</td>
      <td>range(1512, 2016)</td>
      <td>range(2030, 2054)</td>
      <td>range(2016, 2688)</td>
      <td>range(2702, 2726)</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>range(672, 840)</td>
      <td>range(854, 878)</td>
      <td>range(1344, 1680)</td>
      <td>range(1694, 1718)</td>
      <td>range(2016, 2520)</td>
      <td>range(2534, 2558)</td>
      <td>range(2688, 3360)</td>
      <td>range(3374, 3398)</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p15</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Pliegue</th>
      <th>Entrenamiento 7 días</th>
      <th>Prueba 7 días</th>
      <th>Entrenamiento 14 días</th>
      <th>Prueba 14 días</th>
      <th>Entrenamiento 21 días</th>
      <th>Prueba 21 días</th>
      <th>Entrenamiento 28 días</th>
      <th>Prueba 28 días</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>516</th>
      <td>517</td>
      <td>range(86688, 86856)</td>
      <td>range(86870, 86894)</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>517</th>
      <td>518</td>
      <td>range(86856, 87024)</td>
      <td>range(87038, 87062)</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>518</th>
      <td>519</td>
      <td>range(87024, 87192)</td>
      <td>range(87206, 87230)</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>519</th>
      <td>520</td>
      <td>range(87192, 87360)</td>
      <td>range(87374, 87398)</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>520</th>
      <td>521</td>
      <td>range(87360, 87528)</td>
      <td>range(87542, 87566)</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="hora-20">
<h3><strong>HORA 20</strong><a class="headerlink" href="#hora-20" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">resultados</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;Pliegue&#39;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="s1">&#39;Entrenamiento 7 días&#39;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="s1">&#39;Prueba 7 días&#39;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="s1">&#39;Entrenamiento 14 días&#39;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="s1">&#39;Prueba 14 días&#39;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="s1">&#39;Entrenamiento 21 días&#39;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="s1">&#39;Prueba 21 días&#39;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="s1">&#39;Entrenamiento 28 días&#39;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="s1">&#39;Prueba 28 días&#39;</span><span class="p">:</span> <span class="p">[],</span>
<span class="p">}</span>

<span class="k">for</span> <span class="n">dias</span> <span class="ow">in</span> <span class="n">particiones</span><span class="p">:</span>
    <span class="n">plgs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">hora</span><span class="o">=</span><span class="mi">20</span>
    <span class="n">plgs</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">pliegues</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">hora</span><span class="p">,</span> <span class="n">dias</span><span class="p">))</span> 

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">trn_index</span><span class="p">,</span> <span class="n">tst_index</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">plgs</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">dias</span> <span class="o">==</span> <span class="mi">7</span><span class="p">:</span>
            <span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Pliegue&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Entrenamiento 7 días&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;range(</span><span class="si">{</span><span class="n">trn_index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">trn_index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
            <span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Prueba 7 días&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;range(</span><span class="si">{</span><span class="n">tst_index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">tst_index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">dias</span> <span class="o">==</span> <span class="mi">14</span><span class="p">:</span>
            <span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Entrenamiento 14 días&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;range(</span><span class="si">{</span><span class="n">trn_index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">trn_index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
            <span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Prueba 14 días&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;range(</span><span class="si">{</span><span class="n">tst_index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">tst_index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">dias</span> <span class="o">==</span> <span class="mi">21</span><span class="p">:</span>
            <span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Entrenamiento 21 días&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;range(</span><span class="si">{</span><span class="n">trn_index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">trn_index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
            <span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Prueba 21 días&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;range(</span><span class="si">{</span><span class="n">tst_index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">tst_index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">dias</span> <span class="o">==</span> <span class="mi">28</span><span class="p">:</span>
            <span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Entrenamiento 28 días&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;range(</span><span class="si">{</span><span class="n">trn_index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">trn_index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
            <span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Prueba 28 días&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;range(</span><span class="si">{</span><span class="n">tst_index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">tst_index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>

<span class="n">colms</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Entrenamiento 7 días&#39;</span><span class="p">]),</span>
                     <span class="nb">len</span><span class="p">(</span><span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Entrenamiento 14 días&#39;</span><span class="p">]),</span>
                     <span class="nb">len</span><span class="p">(</span><span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Entrenamiento 21 días&#39;</span><span class="p">]),</span>
                     <span class="nb">len</span><span class="p">(</span><span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Entrenamiento 28 días&#39;</span><span class="p">]))</span>

<span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">resultados</span><span class="p">:</span>
    <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">resultados</span><span class="p">[</span><span class="n">key</span><span class="p">])</span> <span class="o">&lt;</span> <span class="n">colms</span><span class="p">:</span>
        <span class="n">resultados</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>

<span class="n">p20</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">resultados</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p20</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Pliegue</th>
      <th>Entrenamiento 7 días</th>
      <th>Prueba 7 días</th>
      <th>Entrenamiento 14 días</th>
      <th>Prueba 14 días</th>
      <th>Entrenamiento 21 días</th>
      <th>Prueba 21 días</th>
      <th>Entrenamiento 28 días</th>
      <th>Prueba 28 días</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>range(0, 168)</td>
      <td>range(187, 211)</td>
      <td>range(0, 336)</td>
      <td>range(355, 379)</td>
      <td>range(0, 504)</td>
      <td>range(523, 547)</td>
      <td>range(0, 672)</td>
      <td>range(691, 715)</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>range(168, 336)</td>
      <td>range(355, 379)</td>
      <td>range(336, 672)</td>
      <td>range(691, 715)</td>
      <td>range(504, 1008)</td>
      <td>range(1027, 1051)</td>
      <td>range(672, 1344)</td>
      <td>range(1363, 1387)</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>range(336, 504)</td>
      <td>range(523, 547)</td>
      <td>range(672, 1008)</td>
      <td>range(1027, 1051)</td>
      <td>range(1008, 1512)</td>
      <td>range(1531, 1555)</td>
      <td>range(1344, 2016)</td>
      <td>range(2035, 2059)</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>range(504, 672)</td>
      <td>range(691, 715)</td>
      <td>range(1008, 1344)</td>
      <td>range(1363, 1387)</td>
      <td>range(1512, 2016)</td>
      <td>range(2035, 2059)</td>
      <td>range(2016, 2688)</td>
      <td>range(2707, 2731)</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>range(672, 840)</td>
      <td>range(859, 883)</td>
      <td>range(1344, 1680)</td>
      <td>range(1699, 1723)</td>
      <td>range(2016, 2520)</td>
      <td>range(2539, 2563)</td>
      <td>range(2688, 3360)</td>
      <td>range(3379, 3403)</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p20</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Pliegue</th>
      <th>Entrenamiento 7 días</th>
      <th>Prueba 7 días</th>
      <th>Entrenamiento 14 días</th>
      <th>Prueba 14 días</th>
      <th>Entrenamiento 21 días</th>
      <th>Prueba 21 días</th>
      <th>Entrenamiento 28 días</th>
      <th>Prueba 28 días</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>516</th>
      <td>517</td>
      <td>range(86688, 86856)</td>
      <td>range(86875, 86899)</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>517</th>
      <td>518</td>
      <td>range(86856, 87024)</td>
      <td>range(87043, 87067)</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>518</th>
      <td>519</td>
      <td>range(87024, 87192)</td>
      <td>range(87211, 87235)</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>519</th>
      <td>520</td>
      <td>range(87192, 87360)</td>
      <td>range(87379, 87403)</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>520</th>
      <td>521</td>
      <td>range(87360, 87528)</td>
      <td>range(87547, 87571)</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="hora-24">
<h3><strong>HORA 24</strong><a class="headerlink" href="#hora-24" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">resultados</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;Pliegue&#39;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="s1">&#39;Entrenamiento 7 días&#39;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="s1">&#39;Prueba 7 días&#39;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="s1">&#39;Entrenamiento 14 días&#39;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="s1">&#39;Prueba 14 días&#39;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="s1">&#39;Entrenamiento 21 días&#39;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="s1">&#39;Prueba 21 días&#39;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="s1">&#39;Entrenamiento 28 días&#39;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="s1">&#39;Prueba 28 días&#39;</span><span class="p">:</span> <span class="p">[],</span>
<span class="p">}</span>

<span class="k">for</span> <span class="n">dias</span> <span class="ow">in</span> <span class="n">particiones</span><span class="p">:</span>
    <span class="n">plgs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">hora</span><span class="o">=</span><span class="mi">24</span>
    <span class="n">plgs</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">pliegues</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">hora</span><span class="p">,</span> <span class="n">dias</span><span class="p">))</span> 

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">trn_index</span><span class="p">,</span> <span class="n">tst_index</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">plgs</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">dias</span> <span class="o">==</span> <span class="mi">7</span><span class="p">:</span>
            <span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Pliegue&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Entrenamiento 7 días&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;range(</span><span class="si">{</span><span class="n">trn_index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">trn_index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
            <span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Prueba 7 días&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;range(</span><span class="si">{</span><span class="n">tst_index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">tst_index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">dias</span> <span class="o">==</span> <span class="mi">14</span><span class="p">:</span>
            <span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Entrenamiento 14 días&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;range(</span><span class="si">{</span><span class="n">trn_index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">trn_index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
            <span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Prueba 14 días&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;range(</span><span class="si">{</span><span class="n">tst_index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">tst_index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">dias</span> <span class="o">==</span> <span class="mi">21</span><span class="p">:</span>
            <span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Entrenamiento 21 días&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;range(</span><span class="si">{</span><span class="n">trn_index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">trn_index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
            <span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Prueba 21 días&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;range(</span><span class="si">{</span><span class="n">tst_index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">tst_index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">dias</span> <span class="o">==</span> <span class="mi">28</span><span class="p">:</span>
            <span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Entrenamiento 28 días&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;range(</span><span class="si">{</span><span class="n">trn_index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">trn_index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
            <span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Prueba 28 días&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;range(</span><span class="si">{</span><span class="n">tst_index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">tst_index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>

<span class="n">colms</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Entrenamiento 7 días&#39;</span><span class="p">]),</span>
                     <span class="nb">len</span><span class="p">(</span><span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Entrenamiento 14 días&#39;</span><span class="p">]),</span>
                     <span class="nb">len</span><span class="p">(</span><span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Entrenamiento 21 días&#39;</span><span class="p">]),</span>
                     <span class="nb">len</span><span class="p">(</span><span class="n">resultados</span><span class="p">[</span><span class="s1">&#39;Entrenamiento 28 días&#39;</span><span class="p">]))</span>

<span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">resultados</span><span class="p">:</span>
    <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">resultados</span><span class="p">[</span><span class="n">key</span><span class="p">])</span> <span class="o">&lt;</span> <span class="n">colms</span><span class="p">:</span>
        <span class="n">resultados</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>

<span class="n">p24</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">resultados</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p24</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Pliegue</th>
      <th>Entrenamiento 7 días</th>
      <th>Prueba 7 días</th>
      <th>Entrenamiento 14 días</th>
      <th>Prueba 14 días</th>
      <th>Entrenamiento 21 días</th>
      <th>Prueba 21 días</th>
      <th>Entrenamiento 28 días</th>
      <th>Prueba 28 días</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>range(0, 168)</td>
      <td>range(191, 215)</td>
      <td>range(0, 336)</td>
      <td>range(359, 383)</td>
      <td>range(0, 504)</td>
      <td>range(527, 551)</td>
      <td>range(0, 672)</td>
      <td>range(695, 719)</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>range(168, 336)</td>
      <td>range(359, 383)</td>
      <td>range(336, 672)</td>
      <td>range(695, 719)</td>
      <td>range(504, 1008)</td>
      <td>range(1031, 1055)</td>
      <td>range(672, 1344)</td>
      <td>range(1367, 1391)</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>range(336, 504)</td>
      <td>range(527, 551)</td>
      <td>range(672, 1008)</td>
      <td>range(1031, 1055)</td>
      <td>range(1008, 1512)</td>
      <td>range(1535, 1559)</td>
      <td>range(1344, 2016)</td>
      <td>range(2039, 2063)</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>range(504, 672)</td>
      <td>range(695, 719)</td>
      <td>range(1008, 1344)</td>
      <td>range(1367, 1391)</td>
      <td>range(1512, 2016)</td>
      <td>range(2039, 2063)</td>
      <td>range(2016, 2688)</td>
      <td>range(2711, 2735)</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>range(672, 840)</td>
      <td>range(863, 887)</td>
      <td>range(1344, 1680)</td>
      <td>range(1703, 1727)</td>
      <td>range(2016, 2520)</td>
      <td>range(2543, 2567)</td>
      <td>range(2688, 3360)</td>
      <td>range(3383, 3407)</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p24</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Pliegue</th>
      <th>Entrenamiento 7 días</th>
      <th>Prueba 7 días</th>
      <th>Entrenamiento 14 días</th>
      <th>Prueba 14 días</th>
      <th>Entrenamiento 21 días</th>
      <th>Prueba 21 días</th>
      <th>Entrenamiento 28 días</th>
      <th>Prueba 28 días</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>516</th>
      <td>517</td>
      <td>range(86688, 86856)</td>
      <td>range(86879, 86903)</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>517</th>
      <td>518</td>
      <td>range(86856, 87024)</td>
      <td>range(87047, 87071)</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>518</th>
      <td>519</td>
      <td>range(87024, 87192)</td>
      <td>range(87215, 87239)</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>519</th>
      <td>520</td>
      <td>range(87192, 87360)</td>
      <td>range(87383, 87407)</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>520</th>
      <td>521</td>
      <td>range(87360, 87528)</td>
      <td>range(87551, 87575)</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
</section>
<section id="modelos">
<h2><strong>MODELOS</strong><a class="headerlink" href="#modelos" title="Link to this heading">#</a></h2>
<p>Ahora, vamos a trabajar modelo por modelo, encontrando el mejor para cada ventana de predicción en cada hora. Esta decisión la tomamos basada en la métrica RMSE dado el tipo de los modelos y nuestro objetivo.</p>
<p>Como aclaración, inicialmente se intentó mostrar la métrica basada en el promedio de todas ellas. Sin embargo, observamos una situación recurrente de valores de R² negativos. Por esta razón, decidimos mostrar el modelo del mejor pliegue para cada hora.</p>
<section id="modelo-knn">
<h3><strong>MODELO KNN</strong><a class="headerlink" href="#modelo-knn" title="Link to this heading">#</a></h3>
<p>Primeramente se entrena el modelo y predice. Se imprimen las tablas que contienen las métricas predeterminadas para cada una de las 24 horas.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">modeloknn</span> <span class="o">=</span> <span class="n">KNeighborsRegressor</span><span class="p">()</span>
<span class="n">metricas</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">hora</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">25</span><span class="p">):</span>  <span class="c1"># Ciclo controlador. Se recorre cada una de las 24 horas.</span>
    <span class="k">for</span> <span class="n">dias</span> <span class="ow">in</span> <span class="n">particiones</span><span class="p">:</span>  <span class="c1"># Ciclo que recorre cada una de las 4 ventanas de predicción.      </span>
        <span class="n">iniciotrain</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># Se inicializa en 0 para que al realizar la suma no se vaya un día más.     </span>
        <span class="k">while</span> <span class="p">(</span><span class="n">iniciotrain</span> <span class="o">+</span> <span class="p">(</span><span class="n">dias</span> <span class="o">*</span> <span class="mi">24</span><span class="p">)</span> <span class="o">+</span> <span class="n">hora</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">):</span>  <span class="c1"># Mientras que el tamaño del pliegue más la hora en la que se está iterando sea menor que la longitud de los datos           </span>
            <span class="n">fintrain</span> <span class="o">=</span> <span class="n">iniciotrain</span> <span class="o">+</span> <span class="p">(</span><span class="n">dias</span> <span class="o">*</span> <span class="mi">24</span><span class="p">)</span> <span class="c1"># Se suma con dias*24 porque es la cantidad de observaciones a escoger. La cantidad de horas totales teniendo en cuanta la cantidad de días.          </span>
            <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">plieguess</span><span class="p">(</span><span class="n">iniciotrain</span><span class="p">,</span> <span class="n">fintrain</span><span class="p">,</span> <span class="n">hora</span><span class="p">)</span>           
            <span class="n">modeloknn</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
            <span class="n">y_prediccion</span><span class="o">=</span> <span class="n">modeloknn</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>               
            <span class="n">rmse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">,</span> <span class="n">squared</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="n">mape</span> <span class="o">=</span> <span class="n">mean_absolute_percentage_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">)</span>
            <span class="n">r2</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">)</span>           
            <span class="n">metricas</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
                <span class="s1">&#39;Modelo&#39;</span><span class="p">:</span> <span class="s1">&#39;Regresión KNN&#39;</span><span class="p">,</span>
                <span class="s1">&#39;Dias&#39;</span><span class="p">:</span> <span class="n">dias</span><span class="p">,</span>
                <span class="s1">&#39;Hora&#39;</span><span class="p">:</span> <span class="n">hora</span><span class="p">,</span>
                <span class="s1">&#39;MAPE&#39;</span><span class="p">:</span> <span class="n">mape</span><span class="p">,</span>
                <span class="s1">&#39;RMSE&#39;</span><span class="p">:</span> <span class="n">rmse</span><span class="p">,</span>
                <span class="s1">&#39;R^2&#39;</span><span class="p">:</span> <span class="n">r2</span><span class="p">,</span>
            <span class="p">})</span>           
            <span class="n">iniciotrain</span> <span class="o">=</span> <span class="n">fintrain</span>  <span class="c1"># Se actualiza a la última posición del pliegue actual</span>
<span class="n">dataknn</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">metricas</span><span class="p">)</span>
<span class="n">dataknn</span> <span class="o">=</span> <span class="n">dataknn</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dataknn</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;Modelo&#39;</span><span class="p">,</span> <span class="s1">&#39;Hora&#39;</span><span class="p">,</span> <span class="s1">&#39;Dias&#39;</span><span class="p">])[</span><span class="s1">&#39;RMSE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">idxmin</span><span class="p">()]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1"># Envía el mejor pliegue. Menor RMSE.</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataknn</span><span class="p">[</span><span class="n">dataknn</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Regresión KNN</td>
      <td>7</td>
      <td>1</td>
      <td>1.416894e-01</td>
      <td>0.442361</td>
      <td>0.739740</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Regresión KNN</td>
      <td>14</td>
      <td>1</td>
      <td>3.828060e+14</td>
      <td>0.485575</td>
      <td>0.744979</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Regresión KNN</td>
      <td>21</td>
      <td>1</td>
      <td>2.228108e-01</td>
      <td>0.427025</td>
      <td>0.604244</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Regresión KNN</td>
      <td>28</td>
      <td>1</td>
      <td>1.499843e-01</td>
      <td>0.435775</td>
      <td>0.790451</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataknn</span><span class="p">[</span><span class="n">dataknn</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>4</th>
      <td>Regresión KNN</td>
      <td>7</td>
      <td>2</td>
      <td>1.419740e-01</td>
      <td>0.442003</td>
      <td>0.739650</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Regresión KNN</td>
      <td>14</td>
      <td>2</td>
      <td>3.828060e+14</td>
      <td>0.487220</td>
      <td>0.743249</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Regresión KNN</td>
      <td>21</td>
      <td>2</td>
      <td>2.280886e-01</td>
      <td>0.438482</td>
      <td>0.588184</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Regresión KNN</td>
      <td>28</td>
      <td>2</td>
      <td>9.585378e-02</td>
      <td>0.399166</td>
      <td>0.803793</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataknn</span><span class="p">[</span><span class="n">dataknn</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">3</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>8</th>
      <td>Regresión KNN</td>
      <td>7</td>
      <td>3</td>
      <td>0.154372</td>
      <td>0.457566</td>
      <td>0.730520</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Regresión KNN</td>
      <td>14</td>
      <td>3</td>
      <td>0.128202</td>
      <td>0.450518</td>
      <td>0.688110</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Regresión KNN</td>
      <td>21</td>
      <td>3</td>
      <td>0.193254</td>
      <td>0.468277</td>
      <td>0.541501</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Regresión KNN</td>
      <td>28</td>
      <td>3</td>
      <td>0.098505</td>
      <td>0.403753</td>
      <td>0.749500</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataknn</span><span class="p">[</span><span class="n">dataknn</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">4</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>12</th>
      <td>Regresión KNN</td>
      <td>7</td>
      <td>4</td>
      <td>0.169893</td>
      <td>0.444503</td>
      <td>0.782061</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Regresión KNN</td>
      <td>14</td>
      <td>4</td>
      <td>0.104012</td>
      <td>0.483425</td>
      <td>0.716291</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Regresión KNN</td>
      <td>21</td>
      <td>4</td>
      <td>0.195268</td>
      <td>0.413199</td>
      <td>0.854273</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Regresión KNN</td>
      <td>28</td>
      <td>4</td>
      <td>0.121296</td>
      <td>0.432762</td>
      <td>0.755629</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataknn</span><span class="p">[</span><span class="n">dataknn</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">5</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>16</th>
      <td>Regresión KNN</td>
      <td>7</td>
      <td>5</td>
      <td>0.135957</td>
      <td>0.432493</td>
      <td>0.745294</td>
    </tr>
    <tr>
      <th>17</th>
      <td>Regresión KNN</td>
      <td>14</td>
      <td>5</td>
      <td>0.104488</td>
      <td>0.481196</td>
      <td>0.724071</td>
    </tr>
    <tr>
      <th>18</th>
      <td>Regresión KNN</td>
      <td>21</td>
      <td>5</td>
      <td>0.182626</td>
      <td>0.402906</td>
      <td>0.854985</td>
    </tr>
    <tr>
      <th>19</th>
      <td>Regresión KNN</td>
      <td>28</td>
      <td>5</td>
      <td>0.150462</td>
      <td>0.434166</td>
      <td>0.805614</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataknn</span><span class="p">[</span><span class="n">dataknn</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">6</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>20</th>
      <td>Regresión KNN</td>
      <td>7</td>
      <td>6</td>
      <td>0.141471</td>
      <td>0.438387</td>
      <td>0.724461</td>
    </tr>
    <tr>
      <th>21</th>
      <td>Regresión KNN</td>
      <td>14</td>
      <td>6</td>
      <td>0.216783</td>
      <td>0.468971</td>
      <td>0.485452</td>
    </tr>
    <tr>
      <th>22</th>
      <td>Regresión KNN</td>
      <td>21</td>
      <td>6</td>
      <td>0.172706</td>
      <td>0.394483</td>
      <td>0.858206</td>
    </tr>
    <tr>
      <th>23</th>
      <td>Regresión KNN</td>
      <td>28</td>
      <td>6</td>
      <td>0.141495</td>
      <td>0.402472</td>
      <td>0.848079</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataknn</span><span class="p">[</span><span class="n">dataknn</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">7</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>24</th>
      <td>Regresión KNN</td>
      <td>7</td>
      <td>7</td>
      <td>0.143347</td>
      <td>0.441324</td>
      <td>0.718410</td>
    </tr>
    <tr>
      <th>25</th>
      <td>Regresión KNN</td>
      <td>14</td>
      <td>7</td>
      <td>0.221262</td>
      <td>0.474043</td>
      <td>0.478729</td>
    </tr>
    <tr>
      <th>26</th>
      <td>Regresión KNN</td>
      <td>21</td>
      <td>7</td>
      <td>0.156733</td>
      <td>0.385962</td>
      <td>0.857199</td>
    </tr>
    <tr>
      <th>27</th>
      <td>Regresión KNN</td>
      <td>28</td>
      <td>7</td>
      <td>0.143607</td>
      <td>0.404516</td>
      <td>0.840520</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataknn</span><span class="p">[</span><span class="n">dataknn</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">8</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>28</th>
      <td>Regresión KNN</td>
      <td>7</td>
      <td>8</td>
      <td>2.019525e-01</td>
      <td>0.436730</td>
      <td>0.551216</td>
    </tr>
    <tr>
      <th>29</th>
      <td>Regresión KNN</td>
      <td>14</td>
      <td>8</td>
      <td>2.053078e-01</td>
      <td>0.453560</td>
      <td>0.515961</td>
    </tr>
    <tr>
      <th>30</th>
      <td>Regresión KNN</td>
      <td>21</td>
      <td>8</td>
      <td>1.688850e+14</td>
      <td>0.381969</td>
      <td>0.881616</td>
    </tr>
    <tr>
      <th>31</th>
      <td>Regresión KNN</td>
      <td>28</td>
      <td>8</td>
      <td>1.393104e-01</td>
      <td>0.372805</td>
      <td>0.846283</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataknn</span><span class="p">[</span><span class="n">dataknn</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">9</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>32</th>
      <td>Regresión KNN</td>
      <td>7</td>
      <td>9</td>
      <td>2.164483e-01</td>
      <td>0.449370</td>
      <td>0.536950</td>
    </tr>
    <tr>
      <th>33</th>
      <td>Regresión KNN</td>
      <td>14</td>
      <td>9</td>
      <td>2.198036e-01</td>
      <td>0.465743</td>
      <td>0.502592</td>
    </tr>
    <tr>
      <th>34</th>
      <td>Regresión KNN</td>
      <td>21</td>
      <td>9</td>
      <td>1.688850e+14</td>
      <td>0.396884</td>
      <td>0.867939</td>
    </tr>
    <tr>
      <th>35</th>
      <td>Regresión KNN</td>
      <td>28</td>
      <td>9</td>
      <td>1.454343e-01</td>
      <td>0.393510</td>
      <td>0.794901</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataknn</span><span class="p">[</span><span class="n">dataknn</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">10</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>36</th>
      <td>Regresión KNN</td>
      <td>7</td>
      <td>10</td>
      <td>2.127641e-01</td>
      <td>0.445271</td>
      <td>0.554856</td>
    </tr>
    <tr>
      <th>37</th>
      <td>Regresión KNN</td>
      <td>14</td>
      <td>10</td>
      <td>2.161194e-01</td>
      <td>0.461790</td>
      <td>0.521216</td>
    </tr>
    <tr>
      <th>38</th>
      <td>Regresión KNN</td>
      <td>21</td>
      <td>10</td>
      <td>1.688850e+14</td>
      <td>0.405668</td>
      <td>0.857086</td>
    </tr>
    <tr>
      <th>39</th>
      <td>Regresión KNN</td>
      <td>28</td>
      <td>10</td>
      <td>1.440388e-01</td>
      <td>0.390790</td>
      <td>0.778471</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataknn</span><span class="p">[</span><span class="n">dataknn</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">11</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>40</th>
      <td>Regresión KNN</td>
      <td>7</td>
      <td>11</td>
      <td>2.258033e-01</td>
      <td>0.458421</td>
      <td>0.534562</td>
    </tr>
    <tr>
      <th>41</th>
      <td>Regresión KNN</td>
      <td>14</td>
      <td>11</td>
      <td>2.291586e-01</td>
      <td>0.474482</td>
      <td>0.501377</td>
    </tr>
    <tr>
      <th>42</th>
      <td>Regresión KNN</td>
      <td>21</td>
      <td>11</td>
      <td>1.688850e+14</td>
      <td>0.436616</td>
      <td>0.834112</td>
    </tr>
    <tr>
      <th>43</th>
      <td>Regresión KNN</td>
      <td>28</td>
      <td>11</td>
      <td>1.459116e-01</td>
      <td>0.404866</td>
      <td>0.774033</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataknn</span><span class="p">[</span><span class="n">dataknn</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">12</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>44</th>
      <td>Regresión KNN</td>
      <td>7</td>
      <td>12</td>
      <td>0.224394</td>
      <td>0.463033</td>
      <td>0.510564</td>
    </tr>
    <tr>
      <th>45</th>
      <td>Regresión KNN</td>
      <td>14</td>
      <td>12</td>
      <td>0.227749</td>
      <td>0.478940</td>
      <td>0.476360</td>
    </tr>
    <tr>
      <th>46</th>
      <td>Regresión KNN</td>
      <td>21</td>
      <td>12</td>
      <td>0.225270</td>
      <td>0.470992</td>
      <td>0.493595</td>
    </tr>
    <tr>
      <th>47</th>
      <td>Regresión KNN</td>
      <td>28</td>
      <td>12</td>
      <td>0.147215</td>
      <td>0.409959</td>
      <td>0.768162</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataknn</span><span class="p">[</span><span class="n">dataknn</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">13</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>48</th>
      <td>Regresión KNN</td>
      <td>7</td>
      <td>13</td>
      <td>2.814750e+14</td>
      <td>0.471664</td>
      <td>0.818106</td>
    </tr>
    <tr>
      <th>49</th>
      <td>Regresión KNN</td>
      <td>14</td>
      <td>13</td>
      <td>1.425050e-01</td>
      <td>0.495665</td>
      <td>0.611983</td>
    </tr>
    <tr>
      <th>50</th>
      <td>Regresión KNN</td>
      <td>21</td>
      <td>13</td>
      <td>1.688850e+14</td>
      <td>0.485833</td>
      <td>0.827711</td>
    </tr>
    <tr>
      <th>51</th>
      <td>Regresión KNN</td>
      <td>28</td>
      <td>13</td>
      <td>1.523286e-01</td>
      <td>0.428874</td>
      <td>0.775648</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataknn</span><span class="p">[</span><span class="n">dataknn</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">14</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>52</th>
      <td>Regresión KNN</td>
      <td>7</td>
      <td>14</td>
      <td>2.814750e+14</td>
      <td>0.471363</td>
      <td>0.807977</td>
    </tr>
    <tr>
      <th>53</th>
      <td>Regresión KNN</td>
      <td>14</td>
      <td>14</td>
      <td>3.369086e-01</td>
      <td>0.500350</td>
      <td>0.456561</td>
    </tr>
    <tr>
      <th>54</th>
      <td>Regresión KNN</td>
      <td>21</td>
      <td>14</td>
      <td>3.480721e-01</td>
      <td>0.449963</td>
      <td>0.740929</td>
    </tr>
    <tr>
      <th>55</th>
      <td>Regresión KNN</td>
      <td>28</td>
      <td>14</td>
      <td>1.546442e-01</td>
      <td>0.436730</td>
      <td>0.774262</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataknn</span><span class="p">[</span><span class="n">dataknn</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">15</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>56</th>
      <td>Regresión KNN</td>
      <td>7</td>
      <td>15</td>
      <td>2.814750e+14</td>
      <td>0.488040</td>
      <td>0.775284</td>
    </tr>
    <tr>
      <th>57</th>
      <td>Regresión KNN</td>
      <td>14</td>
      <td>15</td>
      <td>3.327313e-01</td>
      <td>0.498748</td>
      <td>0.474298</td>
    </tr>
    <tr>
      <th>58</th>
      <td>Regresión KNN</td>
      <td>21</td>
      <td>15</td>
      <td>3.066700e-01</td>
      <td>0.422749</td>
      <td>0.759011</td>
    </tr>
    <tr>
      <th>59</th>
      <td>Regresión KNN</td>
      <td>28</td>
      <td>15</td>
      <td>1.603878e-01</td>
      <td>0.453505</td>
      <td>0.766656</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataknn</span><span class="p">[</span><span class="n">dataknn</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">16</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>60</th>
      <td>Regresión KNN</td>
      <td>7</td>
      <td>16</td>
      <td>2.814750e+14</td>
      <td>0.486655</td>
      <td>0.783353</td>
    </tr>
    <tr>
      <th>61</th>
      <td>Regresión KNN</td>
      <td>14</td>
      <td>16</td>
      <td>6.004800e+13</td>
      <td>0.527194</td>
      <td>0.569918</td>
    </tr>
    <tr>
      <th>62</th>
      <td>Regresión KNN</td>
      <td>21</td>
      <td>16</td>
      <td>3.068188e-01</td>
      <td>0.422847</td>
      <td>0.760664</td>
    </tr>
    <tr>
      <th>63</th>
      <td>Regresión KNN</td>
      <td>28</td>
      <td>16</td>
      <td>1.586253e-01</td>
      <td>0.451959</td>
      <td>0.768313</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataknn</span><span class="p">[</span><span class="n">dataknn</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">17</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>64</th>
      <td>Regresión KNN</td>
      <td>7</td>
      <td>17</td>
      <td>1.163430e+14</td>
      <td>0.482269</td>
      <td>0.696128</td>
    </tr>
    <tr>
      <th>65</th>
      <td>Regresión KNN</td>
      <td>14</td>
      <td>17</td>
      <td>1.761321e-01</td>
      <td>0.482200</td>
      <td>0.487958</td>
    </tr>
    <tr>
      <th>66</th>
      <td>Regresión KNN</td>
      <td>21</td>
      <td>17</td>
      <td>3.096866e-01</td>
      <td>0.424087</td>
      <td>0.756954</td>
    </tr>
    <tr>
      <th>67</th>
      <td>Regresión KNN</td>
      <td>28</td>
      <td>17</td>
      <td>1.631996e-01</td>
      <td>0.480122</td>
      <td>0.734253</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataknn</span><span class="p">[</span><span class="n">dataknn</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">18</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>68</th>
      <td>Regresión KNN</td>
      <td>7</td>
      <td>18</td>
      <td>1.200960e+14</td>
      <td>0.483356</td>
      <td>0.694756</td>
    </tr>
    <tr>
      <th>69</th>
      <td>Regresión KNN</td>
      <td>14</td>
      <td>18</td>
      <td>1.778073e-01</td>
      <td>0.482200</td>
      <td>0.325496</td>
    </tr>
    <tr>
      <th>70</th>
      <td>Regresión KNN</td>
      <td>21</td>
      <td>18</td>
      <td>2.693651e-01</td>
      <td>0.442418</td>
      <td>0.658935</td>
    </tr>
    <tr>
      <th>71</th>
      <td>Regresión KNN</td>
      <td>28</td>
      <td>18</td>
      <td>2.749037e-01</td>
      <td>0.465976</td>
      <td>0.621646</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataknn</span><span class="p">[</span><span class="n">dataknn</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">19</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>72</th>
      <td>Regresión KNN</td>
      <td>7</td>
      <td>19</td>
      <td>1.226383e-01</td>
      <td>0.505849</td>
      <td>0.558980</td>
    </tr>
    <tr>
      <th>73</th>
      <td>Regresión KNN</td>
      <td>14</td>
      <td>19</td>
      <td>3.185011e-01</td>
      <td>0.472229</td>
      <td>0.618248</td>
    </tr>
    <tr>
      <th>74</th>
      <td>Regresión KNN</td>
      <td>21</td>
      <td>19</td>
      <td>2.587997e-01</td>
      <td>0.417712</td>
      <td>0.701304</td>
    </tr>
    <tr>
      <th>75</th>
      <td>Regresión KNN</td>
      <td>28</td>
      <td>19</td>
      <td>2.777220e+14</td>
      <td>0.449592</td>
      <td>0.797582</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataknn</span><span class="p">[</span><span class="n">dataknn</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">20</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>76</th>
      <td>Regresión KNN</td>
      <td>7</td>
      <td>20</td>
      <td>0.119855</td>
      <td>0.502278</td>
      <td>0.573004</td>
    </tr>
    <tr>
      <th>77</th>
      <td>Regresión KNN</td>
      <td>14</td>
      <td>20</td>
      <td>0.326193</td>
      <td>0.492138</td>
      <td>0.585380</td>
    </tr>
    <tr>
      <th>78</th>
      <td>Regresión KNN</td>
      <td>21</td>
      <td>20</td>
      <td>0.265851</td>
      <td>0.438064</td>
      <td>0.671488</td>
    </tr>
    <tr>
      <th>79</th>
      <td>Regresión KNN</td>
      <td>28</td>
      <td>20</td>
      <td>0.269493</td>
      <td>0.462133</td>
      <td>0.634397</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataknn</span><span class="p">[</span><span class="n">dataknn</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">21</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>80</th>
      <td>Regresión KNN</td>
      <td>7</td>
      <td>21</td>
      <td>1.463670e+14</td>
      <td>0.478278</td>
      <td>0.704514</td>
    </tr>
    <tr>
      <th>81</th>
      <td>Regresión KNN</td>
      <td>14</td>
      <td>21</td>
      <td>3.327590e-01</td>
      <td>0.493896</td>
      <td>0.594840</td>
    </tr>
    <tr>
      <th>82</th>
      <td>Regresión KNN</td>
      <td>21</td>
      <td>21</td>
      <td>2.767095e-01</td>
      <td>0.443715</td>
      <td>0.672987</td>
    </tr>
    <tr>
      <th>83</th>
      <td>Regresión KNN</td>
      <td>28</td>
      <td>21</td>
      <td>2.785840e-01</td>
      <td>0.467582</td>
      <td>0.636862</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataknn</span><span class="p">[</span><span class="n">dataknn</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">22</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>84</th>
      <td>Regresión KNN</td>
      <td>7</td>
      <td>22</td>
      <td>0.113863</td>
      <td>0.482459</td>
      <td>0.596346</td>
    </tr>
    <tr>
      <th>85</th>
      <td>Regresión KNN</td>
      <td>14</td>
      <td>22</td>
      <td>0.329377</td>
      <td>0.482424</td>
      <td>0.630093</td>
    </tr>
    <tr>
      <th>86</th>
      <td>Regresión KNN</td>
      <td>21</td>
      <td>22</td>
      <td>0.266808</td>
      <td>0.430116</td>
      <td>0.705960</td>
    </tr>
    <tr>
      <th>87</th>
      <td>Regresión KNN</td>
      <td>28</td>
      <td>22</td>
      <td>0.274564</td>
      <td>0.463843</td>
      <td>0.658040</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataknn</span><span class="p">[</span><span class="n">dataknn</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">23</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>88</th>
      <td>Regresión KNN</td>
      <td>7</td>
      <td>23</td>
      <td>0.184104</td>
      <td>0.491410</td>
      <td>0.592242</td>
    </tr>
    <tr>
      <th>89</th>
      <td>Regresión KNN</td>
      <td>14</td>
      <td>23</td>
      <td>0.330476</td>
      <td>0.500733</td>
      <td>0.619611</td>
    </tr>
    <tr>
      <th>90</th>
      <td>Regresión KNN</td>
      <td>21</td>
      <td>23</td>
      <td>0.273115</td>
      <td>0.456435</td>
      <td>0.683936</td>
    </tr>
    <tr>
      <th>91</th>
      <td>Regresión KNN</td>
      <td>28</td>
      <td>23</td>
      <td>0.277477</td>
      <td>0.475605</td>
      <td>0.656830</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataknn</span><span class="p">[</span><span class="n">dataknn</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">24</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>92</th>
      <td>Regresión KNN</td>
      <td>7</td>
      <td>24</td>
      <td>0.197039</td>
      <td>0.449815</td>
      <td>0.685687</td>
    </tr>
    <tr>
      <th>93</th>
      <td>Regresión KNN</td>
      <td>14</td>
      <td>24</td>
      <td>0.263595</td>
      <td>0.524627</td>
      <td>0.740940</td>
    </tr>
    <tr>
      <th>94</th>
      <td>Regresión KNN</td>
      <td>21</td>
      <td>24</td>
      <td>0.154961</td>
      <td>0.469982</td>
      <td>0.587013</td>
    </tr>
    <tr>
      <th>95</th>
      <td>Regresión KNN</td>
      <td>28</td>
      <td>24</td>
      <td>0.239463</td>
      <td>0.476760</td>
      <td>0.786057</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<section id="mejor-modelo-cada-hora">
<h4><strong>MEJOR MODELO - CADA HORA</strong><a class="headerlink" href="#mejor-modelo-cada-hora" title="Link to this heading">#</a></h4>
<p>A continuación, mostramos los mejores modelos de cada hora según los 24 modelos.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mejorknnhora</span> <span class="o">=</span> <span class="n">mejormodelohora</span><span class="p">(</span><span class="n">particiones</span><span class="p">,</span> <span class="n">dataknn</span><span class="p">)</span>
<span class="n">mejorknnhora</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>Regresión KNN</td>
      <td>21</td>
      <td>1</td>
      <td>0.222811</td>
      <td>0.427025</td>
      <td>0.604244</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Regresión KNN</td>
      <td>28</td>
      <td>2</td>
      <td>0.095854</td>
      <td>0.399166</td>
      <td>0.803793</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Regresión KNN</td>
      <td>28</td>
      <td>3</td>
      <td>0.098505</td>
      <td>0.403753</td>
      <td>0.749500</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Regresión KNN</td>
      <td>21</td>
      <td>4</td>
      <td>0.195268</td>
      <td>0.413199</td>
      <td>0.854273</td>
    </tr>
    <tr>
      <th>18</th>
      <td>Regresión KNN</td>
      <td>21</td>
      <td>5</td>
      <td>0.182626</td>
      <td>0.402906</td>
      <td>0.854985</td>
    </tr>
    <tr>
      <th>22</th>
      <td>Regresión KNN</td>
      <td>21</td>
      <td>6</td>
      <td>0.172706</td>
      <td>0.394483</td>
      <td>0.858206</td>
    </tr>
    <tr>
      <th>26</th>
      <td>Regresión KNN</td>
      <td>21</td>
      <td>7</td>
      <td>0.156733</td>
      <td>0.385962</td>
      <td>0.857199</td>
    </tr>
    <tr>
      <th>31</th>
      <td>Regresión KNN</td>
      <td>28</td>
      <td>8</td>
      <td>0.139310</td>
      <td>0.372805</td>
      <td>0.846283</td>
    </tr>
    <tr>
      <th>35</th>
      <td>Regresión KNN</td>
      <td>28</td>
      <td>9</td>
      <td>0.145434</td>
      <td>0.393510</td>
      <td>0.794901</td>
    </tr>
    <tr>
      <th>39</th>
      <td>Regresión KNN</td>
      <td>28</td>
      <td>10</td>
      <td>0.144039</td>
      <td>0.390790</td>
      <td>0.778471</td>
    </tr>
    <tr>
      <th>43</th>
      <td>Regresión KNN</td>
      <td>28</td>
      <td>11</td>
      <td>0.145912</td>
      <td>0.404866</td>
      <td>0.774033</td>
    </tr>
    <tr>
      <th>47</th>
      <td>Regresión KNN</td>
      <td>28</td>
      <td>12</td>
      <td>0.147215</td>
      <td>0.409959</td>
      <td>0.768162</td>
    </tr>
    <tr>
      <th>51</th>
      <td>Regresión KNN</td>
      <td>28</td>
      <td>13</td>
      <td>0.152329</td>
      <td>0.428874</td>
      <td>0.775648</td>
    </tr>
    <tr>
      <th>55</th>
      <td>Regresión KNN</td>
      <td>28</td>
      <td>14</td>
      <td>0.154644</td>
      <td>0.436730</td>
      <td>0.774262</td>
    </tr>
    <tr>
      <th>58</th>
      <td>Regresión KNN</td>
      <td>21</td>
      <td>15</td>
      <td>0.306670</td>
      <td>0.422749</td>
      <td>0.759011</td>
    </tr>
    <tr>
      <th>62</th>
      <td>Regresión KNN</td>
      <td>21</td>
      <td>16</td>
      <td>0.306819</td>
      <td>0.422847</td>
      <td>0.760664</td>
    </tr>
    <tr>
      <th>66</th>
      <td>Regresión KNN</td>
      <td>21</td>
      <td>17</td>
      <td>0.309687</td>
      <td>0.424087</td>
      <td>0.756954</td>
    </tr>
    <tr>
      <th>70</th>
      <td>Regresión KNN</td>
      <td>21</td>
      <td>18</td>
      <td>0.269365</td>
      <td>0.442418</td>
      <td>0.658935</td>
    </tr>
    <tr>
      <th>74</th>
      <td>Regresión KNN</td>
      <td>21</td>
      <td>19</td>
      <td>0.258800</td>
      <td>0.417712</td>
      <td>0.701304</td>
    </tr>
    <tr>
      <th>78</th>
      <td>Regresión KNN</td>
      <td>21</td>
      <td>20</td>
      <td>0.265851</td>
      <td>0.438064</td>
      <td>0.671488</td>
    </tr>
    <tr>
      <th>82</th>
      <td>Regresión KNN</td>
      <td>21</td>
      <td>21</td>
      <td>0.276710</td>
      <td>0.443715</td>
      <td>0.672987</td>
    </tr>
    <tr>
      <th>86</th>
      <td>Regresión KNN</td>
      <td>21</td>
      <td>22</td>
      <td>0.266808</td>
      <td>0.430116</td>
      <td>0.705960</td>
    </tr>
    <tr>
      <th>90</th>
      <td>Regresión KNN</td>
      <td>21</td>
      <td>23</td>
      <td>0.273115</td>
      <td>0.456435</td>
      <td>0.683936</td>
    </tr>
    <tr>
      <th>92</th>
      <td>Regresión KNN</td>
      <td>7</td>
      <td>24</td>
      <td>0.197039</td>
      <td>0.449815</td>
      <td>0.685687</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="hora-y-ventana-con-mejor-modelo-knn">
<h4><strong>HORA Y VENTANA CON MEJOR MODELO KNN</strong><a class="headerlink" href="#hora-y-ventana-con-mejor-modelo-knn" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bestknn</span> <span class="o">=</span> <span class="n">mejormodelotot</span><span class="p">(</span><span class="n">mejorknnhora</span><span class="p">)</span>
<span class="n">bestknn</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>31</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Modelo</th>
      <td>Regresión KNN</td>
    </tr>
    <tr>
      <th>Dias</th>
      <td>28</td>
    </tr>
    <tr>
      <th>Hora</th>
      <td>8</td>
    </tr>
    <tr>
      <th>MAPE</th>
      <td>0.13931</td>
    </tr>
    <tr>
      <th>RMSE</th>
      <td>0.372805</td>
    </tr>
    <tr>
      <th>R^2</th>
      <td>0.846283</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Es decir, para la <strong>Regresión KNN</strong>, el mejor modelo se da cuando se  evalúa con el pliegue con el que se trabaja con la <strong>HORA</strong>: <code class="docutils literal notranslate"><span class="pre">8</span></code> en la venta de predicción de <code class="docutils literal notranslate"><span class="pre">28</span> <span class="pre">días</span></code>. Veamos los valores de <strong>Ljung-Box p-value</strong> y <strong>Jarque-Bera p-value</strong>. Antes de ello, veamos cuáles son las pruebas de hipótesis para comprender mejor los p-valores que se nos arrojen.</p>
<ul class="simple">
<li><p><strong>Prueba de Ljung-Box</strong></p></li>
</ul>
<ul class="simple">
<li><p><strong>Hipótesis nula (H₀)</strong>: No hay autocorrelación en los residuos (es decir, los residuos son independientes entre sí).</p></li>
<li><p><strong>Hipótesis alternativa (H₁)</strong>: Hay autocorrelación en los residuos</p></li>
</ul>
<ul class="simple">
<li><p><strong>Prueba de Jarque-Bera</strong></p></li>
</ul>
<ul class="simple">
<li><p><strong>Hipótesis nula (H₀)</strong>: Los residuos tienen una distribución normal.</p></li>
<li><p><strong>Hipótesis alternativa (H₁)</strong>: Los residuos no tienen una distribución normal.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">modeloknn</span> <span class="o">=</span> <span class="n">KNeighborsRegressor</span><span class="p">()</span>
<span class="n">metricas</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">dias</span> <span class="o">=</span> <span class="mi">28</span>
<span class="n">hora</span> <span class="o">=</span> <span class="mi">8</span>
<span class="n">iniciotrain</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">while</span> <span class="p">(</span><span class="n">iniciotrain</span> <span class="o">+</span> <span class="p">(</span><span class="n">dias</span> <span class="o">*</span> <span class="mi">24</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">):</span>     
    <span class="n">fintrain</span> <span class="o">=</span> <span class="n">iniciotrain</span> <span class="o">+</span> <span class="p">(</span><span class="n">dias</span> <span class="o">*</span> <span class="mi">24</span><span class="p">)</span>   
    <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">plieguess</span><span class="p">(</span><span class="n">iniciotrain</span><span class="p">,</span> <span class="n">fintrain</span><span class="p">,</span> <span class="n">hora</span><span class="p">)</span> 
    <span class="n">modeloknn</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
    <span class="n">y_prediccion</span><span class="o">=</span> <span class="n">modeloknn</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>      
    <span class="n">rmse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">,</span> <span class="n">squared</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">mape</span> <span class="o">=</span> <span class="n">mean_absolute_percentage_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">)</span>
    <span class="n">r2</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">)</span>
    <span class="n">ljungbox</span><span class="p">,</span> <span class="n">jarquebera</span> <span class="o">=</span> <span class="n">residuos</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">)</span>  
    <span class="n">metricas</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
        <span class="s1">&#39;Modelo&#39;</span><span class="p">:</span> <span class="s1">&#39;Regresión KNN&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Dias&#39;</span><span class="p">:</span> <span class="n">dias</span><span class="p">,</span>
        <span class="s1">&#39;Hora&#39;</span><span class="p">:</span> <span class="n">hora</span><span class="p">,</span>
        <span class="s1">&#39;MAPE&#39;</span><span class="p">:</span> <span class="n">mape</span><span class="p">,</span>
        <span class="s1">&#39;RMSE&#39;</span><span class="p">:</span> <span class="n">rmse</span><span class="p">,</span>
        <span class="s1">&#39;R^2&#39;</span><span class="p">:</span> <span class="n">r2</span><span class="p">,</span>
        <span class="s1">&#39;Ljung-Box p-value&#39;</span> <span class="p">:</span> <span class="n">ljungbox</span><span class="p">,</span>
        <span class="s1">&#39;Jarque-Bera p-value&#39;</span> <span class="p">:</span> <span class="n">jarquebera</span>
    <span class="p">})</span>  
    <span class="n">iniciotrain</span> <span class="o">=</span> <span class="n">fintrain</span>  <span class="c1"># Actualizar el inicio para el siguiente pliegue</span>
<span class="n">dataknn</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">metricas</span><span class="p">)</span>
<span class="n">dataknn</span> <span class="o">=</span> <span class="n">dataknn</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dataknn</span><span class="p">[</span><span class="s1">&#39;RMSE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">idxmin</span><span class="p">()]</span>
<span class="n">dataknn</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">dataknn</span><span class="p">)</span>
<span class="n">dataknn</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Modelo</th>
      <td>Regresión KNN</td>
    </tr>
    <tr>
      <th>Dias</th>
      <td>28</td>
    </tr>
    <tr>
      <th>Hora</th>
      <td>8</td>
    </tr>
    <tr>
      <th>MAPE</th>
      <td>0.13931</td>
    </tr>
    <tr>
      <th>RMSE</th>
      <td>0.372805</td>
    </tr>
    <tr>
      <th>R^2</th>
      <td>0.846283</td>
    </tr>
    <tr>
      <th>Ljung-Box p-value</th>
      <td>0.066421</td>
    </tr>
    <tr>
      <th>Jarque-Bera p-value</th>
      <td>0.533864</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>En este orden de ideas, sobre el modelo de regresión KNN, podemos afirmar que el mejor modelo predicho encontrado tiene un <strong>MAPE</strong>  de <code class="docutils literal notranslate"><span class="pre">0.13</span></code>, lo que significa que, en promedio, el modelo se desvía un <code class="docutils literal notranslate"><span class="pre">13.93%</span></code> del valor real en las predicciones. El <strong>RMSE</strong>  es de <code class="docutils literal notranslate"><span class="pre">0.37</span></code>, lo que indica que el error promedio en las predicciones es relativamente bajo, por lo tanto, es correcto pensar que el modelo hace un buen trabajo prediciendo los valores. Por otro lado, el coeficiente de determinación <strong>R²</strong> es de <code class="docutils literal notranslate"><span class="pre">0.84</span></code>, lo que indica que el modelo explica aproximadamente el <code class="docutils literal notranslate"><span class="pre">84.6%</span></code> de la variabilidad de los datos, lo cual es un buen rendimiento en términos de ajuste del modelo.</p>
<p>Ahora, hablando sobre las pruebas hipótesis para los supuestos de los residuos, observamos que el p-valor de la prueba de <strong>Ljung-Box</strong> es <code class="docutils literal notranslate"><span class="pre">0.06</span></code>, esto quiere decir no se puede rechazar la hipótesis nula y, por lo tanto, los residuos son independientes entre sí. En particular, esto era lo que se esperaba pues eso quiere decir que todo fue correctamente modelado. Asimismo, el p-valor de la prueba de <strong>Jarque-Bera</strong> es <code class="docutils literal notranslate"><span class="pre">0.53</span></code>, lo que indica que no se puede rechazar la hipótesis de que los residuos siguen una distribución normal.</p>
</section>
</section>
<section id="regresion-lineal">
<h3><strong>REGRESIÓN LINEAL</strong><a class="headerlink" href="#regresion-lineal" title="Link to this heading">#</a></h3>
<p>Primeramente se entrena el modelo y predice. Se imprimen las tablas que contienen las métricas predeterminadas para cada una de las 24 horas.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">modeloreglin</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span>
<span class="n">metricas</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">hora</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">25</span><span class="p">):</span>  
    <span class="k">for</span> <span class="n">dias</span> <span class="ow">in</span> <span class="n">particiones</span><span class="p">:</span>        
        <span class="n">iniciotrain</span> <span class="o">=</span> <span class="mi">0</span>       
        <span class="k">while</span> <span class="p">(</span><span class="n">iniciotrain</span> <span class="o">+</span> <span class="p">(</span><span class="n">dias</span> <span class="o">*</span> <span class="mi">24</span><span class="p">)</span> <span class="o">+</span> <span class="n">hora</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">):</span>     
            <span class="n">fintrain</span> <span class="o">=</span> <span class="n">iniciotrain</span> <span class="o">+</span> <span class="p">(</span><span class="n">dias</span> <span class="o">*</span> <span class="mi">24</span><span class="p">)</span>           
            <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">plieguess</span><span class="p">(</span><span class="n">iniciotrain</span><span class="p">,</span><span class="n">fintrain</span><span class="p">,</span><span class="n">hora</span><span class="p">)</span>           
            <span class="n">modeloreglin</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
            <span class="n">y_prediccion</span><span class="o">=</span> <span class="n">modeloreglin</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>               
            <span class="n">rmse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">,</span> <span class="n">squared</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="n">mape</span> <span class="o">=</span> <span class="n">mean_absolute_percentage_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">)</span>
            <span class="n">r2</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">)</span>           
            <span class="n">metricas</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
                <span class="s1">&#39;Modelo&#39;</span><span class="p">:</span> <span class="s1">&#39;Regresión Lineal&#39;</span><span class="p">,</span>
                <span class="s1">&#39;Dias&#39;</span><span class="p">:</span> <span class="n">dias</span><span class="p">,</span>
                <span class="s1">&#39;Hora&#39;</span><span class="p">:</span> <span class="n">hora</span><span class="p">,</span>
                <span class="s1">&#39;MAPE&#39;</span><span class="p">:</span> <span class="n">mape</span><span class="p">,</span>
                <span class="s1">&#39;RMSE&#39;</span><span class="p">:</span> <span class="n">rmse</span><span class="p">,</span>
                <span class="s1">&#39;R^2&#39;</span><span class="p">:</span> <span class="n">r2</span><span class="p">,</span>
            <span class="p">})</span>           
            <span class="n">iniciotrain</span> <span class="o">=</span> <span class="n">fintrain</span>  
<span class="n">datareglin</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">metricas</span><span class="p">)</span>
<span class="n">datareglin</span> <span class="o">=</span> <span class="n">datareglin</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">datareglin</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;Modelo&#39;</span><span class="p">,</span> <span class="s1">&#39;Hora&#39;</span><span class="p">,</span> <span class="s1">&#39;Dias&#39;</span><span class="p">])[</span><span class="s1">&#39;RMSE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">idxmin</span><span class="p">()]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datareglin</span><span class="p">[</span><span class="n">datareglin</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Regresión Lineal</td>
      <td>7</td>
      <td>1</td>
      <td>0.091775</td>
      <td>0.285068</td>
      <td>0.615951</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Regresión Lineal</td>
      <td>14</td>
      <td>1</td>
      <td>0.167477</td>
      <td>0.328047</td>
      <td>0.913736</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Regresión Lineal</td>
      <td>21</td>
      <td>1</td>
      <td>0.105343</td>
      <td>0.317068</td>
      <td>0.892954</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Regresión Lineal</td>
      <td>28</td>
      <td>1</td>
      <td>0.109162</td>
      <td>0.320143</td>
      <td>0.890868</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datareglin</span><span class="p">[</span><span class="n">datareglin</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>4</th>
      <td>Regresión Lineal</td>
      <td>7</td>
      <td>2</td>
      <td>4.175312e+13</td>
      <td>0.294249</td>
      <td>0.852346</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Regresión Lineal</td>
      <td>14</td>
      <td>2</td>
      <td>1.751859e-01</td>
      <td>0.343691</td>
      <td>0.506927</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Regresión Lineal</td>
      <td>21</td>
      <td>2</td>
      <td>2.119293e-01</td>
      <td>0.326620</td>
      <td>0.923659</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Regresión Lineal</td>
      <td>28</td>
      <td>2</td>
      <td>1.153777e-01</td>
      <td>0.335730</td>
      <td>0.864333</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datareglin</span><span class="p">[</span><span class="n">datareglin</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">3</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>8</th>
      <td>Regresión Lineal</td>
      <td>7</td>
      <td>3</td>
      <td>1.389724e+14</td>
      <td>0.311646</td>
      <td>0.842928</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Regresión Lineal</td>
      <td>14</td>
      <td>3</td>
      <td>1.055962e-01</td>
      <td>0.330688</td>
      <td>0.863579</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Regresión Lineal</td>
      <td>21</td>
      <td>3</td>
      <td>1.037017e-01</td>
      <td>0.317110</td>
      <td>0.874552</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Regresión Lineal</td>
      <td>28</td>
      <td>3</td>
      <td>1.063706e-01</td>
      <td>0.322033</td>
      <td>0.870627</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datareglin</span><span class="p">[</span><span class="n">datareglin</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">4</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>12</th>
      <td>Regresión Lineal</td>
      <td>7</td>
      <td>4</td>
      <td>1.103981e+14</td>
      <td>0.310303</td>
      <td>0.835795</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Regresión Lineal</td>
      <td>14</td>
      <td>4</td>
      <td>1.041441e-01</td>
      <td>0.330499</td>
      <td>0.852527</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Regresión Lineal</td>
      <td>21</td>
      <td>4</td>
      <td>1.055708e-01</td>
      <td>0.287760</td>
      <td>0.929322</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Regresión Lineal</td>
      <td>28</td>
      <td>4</td>
      <td>1.077414e-01</td>
      <td>0.323534</td>
      <td>0.858678</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datareglin</span><span class="p">[</span><span class="n">datareglin</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">5</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>16</th>
      <td>Regresión Lineal</td>
      <td>7</td>
      <td>5</td>
      <td>0.135497</td>
      <td>0.327209</td>
      <td>0.880260</td>
    </tr>
    <tr>
      <th>17</th>
      <td>Regresión Lineal</td>
      <td>14</td>
      <td>5</td>
      <td>0.104232</td>
      <td>0.330925</td>
      <td>0.845664</td>
    </tr>
    <tr>
      <th>18</th>
      <td>Regresión Lineal</td>
      <td>21</td>
      <td>5</td>
      <td>0.100048</td>
      <td>0.285625</td>
      <td>0.927122</td>
    </tr>
    <tr>
      <th>19</th>
      <td>Regresión Lineal</td>
      <td>28</td>
      <td>5</td>
      <td>0.107660</td>
      <td>0.323538</td>
      <td>0.852478</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datareglin</span><span class="p">[</span><span class="n">datareglin</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">6</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>20</th>
      <td>Regresión Lineal</td>
      <td>7</td>
      <td>6</td>
      <td>0.088483</td>
      <td>0.336981</td>
      <td>0.849481</td>
    </tr>
    <tr>
      <th>21</th>
      <td>Regresión Lineal</td>
      <td>14</td>
      <td>6</td>
      <td>0.102393</td>
      <td>0.330619</td>
      <td>0.825295</td>
    </tr>
    <tr>
      <th>22</th>
      <td>Regresión Lineal</td>
      <td>21</td>
      <td>6</td>
      <td>0.101646</td>
      <td>0.288461</td>
      <td>0.924181</td>
    </tr>
    <tr>
      <th>23</th>
      <td>Regresión Lineal</td>
      <td>28</td>
      <td>6</td>
      <td>0.103961</td>
      <td>0.322318</td>
      <td>0.833958</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datareglin</span><span class="p">[</span><span class="n">datareglin</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">7</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>24</th>
      <td>Regresión Lineal</td>
      <td>7</td>
      <td>7</td>
      <td>0.088047</td>
      <td>0.336554</td>
      <td>0.849862</td>
    </tr>
    <tr>
      <th>25</th>
      <td>Regresión Lineal</td>
      <td>14</td>
      <td>7</td>
      <td>0.093044</td>
      <td>0.324804</td>
      <td>0.793134</td>
    </tr>
    <tr>
      <th>26</th>
      <td>Regresión Lineal</td>
      <td>21</td>
      <td>7</td>
      <td>0.097236</td>
      <td>0.287557</td>
      <td>0.920734</td>
    </tr>
    <tr>
      <th>27</th>
      <td>Regresión Lineal</td>
      <td>28</td>
      <td>7</td>
      <td>0.090331</td>
      <td>0.309908</td>
      <td>0.811674</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datareglin</span><span class="p">[</span><span class="n">datareglin</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">8</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>28</th>
      <td>Regresión Lineal</td>
      <td>7</td>
      <td>8</td>
      <td>9.588294e-02</td>
      <td>0.325104</td>
      <td>0.923284</td>
    </tr>
    <tr>
      <th>29</th>
      <td>Regresión Lineal</td>
      <td>14</td>
      <td>8</td>
      <td>8.573194e-02</td>
      <td>0.305199</td>
      <td>0.932390</td>
    </tr>
    <tr>
      <th>30</th>
      <td>Regresión Lineal</td>
      <td>21</td>
      <td>8</td>
      <td>5.119509e+13</td>
      <td>0.290390</td>
      <td>0.931577</td>
    </tr>
    <tr>
      <th>31</th>
      <td>Regresión Lineal</td>
      <td>28</td>
      <td>8</td>
      <td>9.153729e-02</td>
      <td>0.312764</td>
      <td>0.764512</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datareglin</span><span class="p">[</span><span class="n">datareglin</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">9</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>32</th>
      <td>Regresión Lineal</td>
      <td>7</td>
      <td>9</td>
      <td>0.099133</td>
      <td>0.329544</td>
      <td>0.918444</td>
    </tr>
    <tr>
      <th>33</th>
      <td>Regresión Lineal</td>
      <td>14</td>
      <td>9</td>
      <td>0.089117</td>
      <td>0.310895</td>
      <td>0.927414</td>
    </tr>
    <tr>
      <th>34</th>
      <td>Regresión Lineal</td>
      <td>21</td>
      <td>9</td>
      <td>0.085495</td>
      <td>0.305685</td>
      <td>0.761759</td>
    </tr>
    <tr>
      <th>35</th>
      <td>Regresión Lineal</td>
      <td>28</td>
      <td>9</td>
      <td>0.086281</td>
      <td>0.307355</td>
      <td>0.759148</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datareglin</span><span class="p">[</span><span class="n">datareglin</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">10</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>36</th>
      <td>Regresión Lineal</td>
      <td>7</td>
      <td>10</td>
      <td>0.094391</td>
      <td>0.320507</td>
      <td>0.922856</td>
    </tr>
    <tr>
      <th>37</th>
      <td>Regresión Lineal</td>
      <td>14</td>
      <td>10</td>
      <td>0.082924</td>
      <td>0.304664</td>
      <td>0.930294</td>
    </tr>
    <tr>
      <th>38</th>
      <td>Regresión Lineal</td>
      <td>21</td>
      <td>10</td>
      <td>0.078616</td>
      <td>0.297512</td>
      <td>0.727826</td>
    </tr>
    <tr>
      <th>39</th>
      <td>Regresión Lineal</td>
      <td>28</td>
      <td>10</td>
      <td>0.078601</td>
      <td>0.297620</td>
      <td>0.727629</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datareglin</span><span class="p">[</span><span class="n">datareglin</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">11</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>40</th>
      <td>Regresión Lineal</td>
      <td>7</td>
      <td>11</td>
      <td>0.092690</td>
      <td>0.319531</td>
      <td>0.925632</td>
    </tr>
    <tr>
      <th>41</th>
      <td>Regresión Lineal</td>
      <td>14</td>
      <td>11</td>
      <td>0.092242</td>
      <td>0.307089</td>
      <td>0.931310</td>
    </tr>
    <tr>
      <th>42</th>
      <td>Regresión Lineal</td>
      <td>21</td>
      <td>11</td>
      <td>0.085699</td>
      <td>0.327686</td>
      <td>0.627568</td>
    </tr>
    <tr>
      <th>43</th>
      <td>Regresión Lineal</td>
      <td>28</td>
      <td>11</td>
      <td>0.085439</td>
      <td>0.327726</td>
      <td>0.627476</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datareglin</span><span class="p">[</span><span class="n">datareglin</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">12</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>44</th>
      <td>Regresión Lineal</td>
      <td>7</td>
      <td>12</td>
      <td>0.089183</td>
      <td>0.328114</td>
      <td>0.826570</td>
    </tr>
    <tr>
      <th>45</th>
      <td>Regresión Lineal</td>
      <td>14</td>
      <td>12</td>
      <td>0.095685</td>
      <td>0.311085</td>
      <td>0.927597</td>
    </tr>
    <tr>
      <th>46</th>
      <td>Regresión Lineal</td>
      <td>21</td>
      <td>12</td>
      <td>0.093275</td>
      <td>0.339157</td>
      <td>0.667123</td>
    </tr>
    <tr>
      <th>47</th>
      <td>Regresión Lineal</td>
      <td>28</td>
      <td>12</td>
      <td>0.093121</td>
      <td>0.339457</td>
      <td>0.666535</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datareglin</span><span class="p">[</span><span class="n">datareglin</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">13</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>48</th>
      <td>Regresión Lineal</td>
      <td>7</td>
      <td>13</td>
      <td>0.093825</td>
      <td>0.324169</td>
      <td>0.912348</td>
    </tr>
    <tr>
      <th>49</th>
      <td>Regresión Lineal</td>
      <td>14</td>
      <td>13</td>
      <td>0.106897</td>
      <td>0.330093</td>
      <td>0.912710</td>
    </tr>
    <tr>
      <th>50</th>
      <td>Regresión Lineal</td>
      <td>21</td>
      <td>13</td>
      <td>0.109907</td>
      <td>0.330334</td>
      <td>0.836930</td>
    </tr>
    <tr>
      <th>51</th>
      <td>Regresión Lineal</td>
      <td>28</td>
      <td>13</td>
      <td>0.104005</td>
      <td>0.348362</td>
      <td>0.735132</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datareglin</span><span class="p">[</span><span class="n">datareglin</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">14</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>52</th>
      <td>Regresión Lineal</td>
      <td>7</td>
      <td>14</td>
      <td>0.096812</td>
      <td>0.331589</td>
      <td>0.897773</td>
    </tr>
    <tr>
      <th>53</th>
      <td>Regresión Lineal</td>
      <td>14</td>
      <td>14</td>
      <td>0.113672</td>
      <td>0.335554</td>
      <td>0.874767</td>
    </tr>
    <tr>
      <th>54</th>
      <td>Regresión Lineal</td>
      <td>21</td>
      <td>14</td>
      <td>0.108393</td>
      <td>0.328147</td>
      <td>0.880235</td>
    </tr>
    <tr>
      <th>55</th>
      <td>Regresión Lineal</td>
      <td>28</td>
      <td>14</td>
      <td>0.113778</td>
      <td>0.354212</td>
      <td>0.778691</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datareglin</span><span class="p">[</span><span class="n">datareglin</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">15</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>56</th>
      <td>Regresión Lineal</td>
      <td>7</td>
      <td>15</td>
      <td>0.097164</td>
      <td>0.320803</td>
      <td>0.914474</td>
    </tr>
    <tr>
      <th>57</th>
      <td>Regresión Lineal</td>
      <td>14</td>
      <td>15</td>
      <td>0.107299</td>
      <td>0.325164</td>
      <td>0.918944</td>
    </tr>
    <tr>
      <th>58</th>
      <td>Regresión Lineal</td>
      <td>21</td>
      <td>15</td>
      <td>0.110261</td>
      <td>0.332625</td>
      <td>0.884374</td>
    </tr>
    <tr>
      <th>59</th>
      <td>Regresión Lineal</td>
      <td>28</td>
      <td>15</td>
      <td>0.115253</td>
      <td>0.352318</td>
      <td>0.904841</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datareglin</span><span class="p">[</span><span class="n">datareglin</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">16</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>60</th>
      <td>Regresión Lineal</td>
      <td>7</td>
      <td>16</td>
      <td>0.097343</td>
      <td>0.320850</td>
      <td>0.913853</td>
    </tr>
    <tr>
      <th>61</th>
      <td>Regresión Lineal</td>
      <td>14</td>
      <td>16</td>
      <td>0.114005</td>
      <td>0.298717</td>
      <td>0.820333</td>
    </tr>
    <tr>
      <th>62</th>
      <td>Regresión Lineal</td>
      <td>21</td>
      <td>16</td>
      <td>0.117093</td>
      <td>0.303815</td>
      <td>0.814148</td>
    </tr>
    <tr>
      <th>63</th>
      <td>Regresión Lineal</td>
      <td>28</td>
      <td>16</td>
      <td>0.116169</td>
      <td>0.351351</td>
      <td>0.909002</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datareglin</span><span class="p">[</span><span class="n">datareglin</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">17</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>64</th>
      <td>Regresión Lineal</td>
      <td>7</td>
      <td>17</td>
      <td>0.097679</td>
      <td>0.321807</td>
      <td>0.912484</td>
    </tr>
    <tr>
      <th>65</th>
      <td>Regresión Lineal</td>
      <td>14</td>
      <td>17</td>
      <td>0.110784</td>
      <td>0.294690</td>
      <td>0.825242</td>
    </tr>
    <tr>
      <th>66</th>
      <td>Regresión Lineal</td>
      <td>21</td>
      <td>17</td>
      <td>0.115012</td>
      <td>0.301307</td>
      <td>0.817306</td>
    </tr>
    <tr>
      <th>67</th>
      <td>Regresión Lineal</td>
      <td>28</td>
      <td>17</td>
      <td>0.124325</td>
      <td>0.354202</td>
      <td>0.913671</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datareglin</span><span class="p">[</span><span class="n">datareglin</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">18</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>68</th>
      <td>Regresión Lineal</td>
      <td>7</td>
      <td>18</td>
      <td>0.098210</td>
      <td>0.322261</td>
      <td>0.911551</td>
    </tr>
    <tr>
      <th>69</th>
      <td>Regresión Lineal</td>
      <td>14</td>
      <td>18</td>
      <td>0.114251</td>
      <td>0.300634</td>
      <td>0.811023</td>
    </tr>
    <tr>
      <th>70</th>
      <td>Regresión Lineal</td>
      <td>21</td>
      <td>18</td>
      <td>0.097468</td>
      <td>0.294125</td>
      <td>0.922208</td>
    </tr>
    <tr>
      <th>71</th>
      <td>Regresión Lineal</td>
      <td>28</td>
      <td>18</td>
      <td>0.143335</td>
      <td>0.363456</td>
      <td>0.915048</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datareglin</span><span class="p">[</span><span class="n">datareglin</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">19</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>72</th>
      <td>Regresión Lineal</td>
      <td>7</td>
      <td>19</td>
      <td>0.091559</td>
      <td>0.318370</td>
      <td>0.910779</td>
    </tr>
    <tr>
      <th>73</th>
      <td>Regresión Lineal</td>
      <td>14</td>
      <td>19</td>
      <td>0.117698</td>
      <td>0.310477</td>
      <td>0.798818</td>
    </tr>
    <tr>
      <th>74</th>
      <td>Regresión Lineal</td>
      <td>21</td>
      <td>19</td>
      <td>0.122038</td>
      <td>0.318390</td>
      <td>0.788433</td>
    </tr>
    <tr>
      <th>75</th>
      <td>Regresión Lineal</td>
      <td>28</td>
      <td>19</td>
      <td>0.144557</td>
      <td>0.363497</td>
      <td>0.917611</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datareglin</span><span class="p">[</span><span class="n">datareglin</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">20</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>76</th>
      <td>Regresión Lineal</td>
      <td>7</td>
      <td>20</td>
      <td>9.244699e-02</td>
      <td>0.319080</td>
      <td>0.907675</td>
    </tr>
    <tr>
      <th>77</th>
      <td>Regresión Lineal</td>
      <td>14</td>
      <td>20</td>
      <td>1.247921e-01</td>
      <td>0.316882</td>
      <td>0.803850</td>
    </tr>
    <tr>
      <th>78</th>
      <td>Regresión Lineal</td>
      <td>21</td>
      <td>20</td>
      <td>1.282367e-01</td>
      <td>0.322744</td>
      <td>0.796526</td>
    </tr>
    <tr>
      <th>79</th>
      <td>Regresión Lineal</td>
      <td>28</td>
      <td>20</td>
      <td>2.880824e+14</td>
      <td>0.364837</td>
      <td>0.878763</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datareglin</span><span class="p">[</span><span class="n">datareglin</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">21</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>80</th>
      <td>Regresión Lineal</td>
      <td>7</td>
      <td>21</td>
      <td>9.550341e-02</td>
      <td>0.320914</td>
      <td>0.903901</td>
    </tr>
    <tr>
      <th>81</th>
      <td>Regresión Lineal</td>
      <td>14</td>
      <td>21</td>
      <td>1.312773e-01</td>
      <td>0.318740</td>
      <td>0.835023</td>
    </tr>
    <tr>
      <th>82</th>
      <td>Regresión Lineal</td>
      <td>21</td>
      <td>21</td>
      <td>1.346116e-01</td>
      <td>0.324463</td>
      <td>0.829046</td>
    </tr>
    <tr>
      <th>83</th>
      <td>Regresión Lineal</td>
      <td>28</td>
      <td>21</td>
      <td>2.880824e+14</td>
      <td>0.348050</td>
      <td>0.889621</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datareglin</span><span class="p">[</span><span class="n">datareglin</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">22</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>84</th>
      <td>Regresión Lineal</td>
      <td>7</td>
      <td>22</td>
      <td>1.113444e+14</td>
      <td>0.320673</td>
      <td>0.934216</td>
    </tr>
    <tr>
      <th>85</th>
      <td>Regresión Lineal</td>
      <td>14</td>
      <td>22</td>
      <td>1.250503e-01</td>
      <td>0.297012</td>
      <td>0.855119</td>
    </tr>
    <tr>
      <th>86</th>
      <td>Regresión Lineal</td>
      <td>21</td>
      <td>22</td>
      <td>1.282685e-01</td>
      <td>0.299112</td>
      <td>0.853063</td>
    </tr>
    <tr>
      <th>87</th>
      <td>Regresión Lineal</td>
      <td>28</td>
      <td>22</td>
      <td>2.880824e+14</td>
      <td>0.350195</td>
      <td>0.887816</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datareglin</span><span class="p">[</span><span class="n">datareglin</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">23</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>88</th>
      <td>Regresión Lineal</td>
      <td>7</td>
      <td>23</td>
      <td>1.113444e+14</td>
      <td>0.309120</td>
      <td>0.941401</td>
    </tr>
    <tr>
      <th>89</th>
      <td>Regresión Lineal</td>
      <td>14</td>
      <td>23</td>
      <td>1.249751e-01</td>
      <td>0.296824</td>
      <td>0.851230</td>
    </tr>
    <tr>
      <th>90</th>
      <td>Regresión Lineal</td>
      <td>21</td>
      <td>23</td>
      <td>1.267360e-01</td>
      <td>0.297410</td>
      <td>0.850643</td>
    </tr>
    <tr>
      <th>91</th>
      <td>Regresión Lineal</td>
      <td>28</td>
      <td>23</td>
      <td>2.880824e+14</td>
      <td>0.354919</td>
      <td>0.885505</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datareglin</span><span class="p">[</span><span class="n">datareglin</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">24</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>92</th>
      <td>Regresión Lineal</td>
      <td>7</td>
      <td>24</td>
      <td>1.113444e+14</td>
      <td>0.309440</td>
      <td>0.942142</td>
    </tr>
    <tr>
      <th>93</th>
      <td>Regresión Lineal</td>
      <td>14</td>
      <td>24</td>
      <td>1.332315e-01</td>
      <td>0.287042</td>
      <td>0.872007</td>
    </tr>
    <tr>
      <th>94</th>
      <td>Regresión Lineal</td>
      <td>21</td>
      <td>24</td>
      <td>1.338382e-01</td>
      <td>0.284638</td>
      <td>0.874142</td>
    </tr>
    <tr>
      <th>95</th>
      <td>Regresión Lineal</td>
      <td>28</td>
      <td>24</td>
      <td>2.880824e+14</td>
      <td>0.384005</td>
      <td>0.867319</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<section id="id1">
<h4><strong>MEJOR MODELO - CADA HORA</strong><a class="headerlink" href="#id1" title="Link to this heading">#</a></h4>
<p>A continuación, mostramos los mejores modelos de cada hora según los 24 modelos.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mejorreglinhora</span> <span class="o">=</span> <span class="n">mejormodelohora</span><span class="p">(</span><span class="n">particiones</span><span class="p">,</span> <span class="n">datareglin</span><span class="p">)</span>
<span class="n">mejorreglinhora</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Regresión Lineal</td>
      <td>7</td>
      <td>1</td>
      <td>9.177472e-02</td>
      <td>0.285068</td>
      <td>0.615951</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Regresión Lineal</td>
      <td>7</td>
      <td>2</td>
      <td>4.175312e+13</td>
      <td>0.294249</td>
      <td>0.852346</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Regresión Lineal</td>
      <td>7</td>
      <td>3</td>
      <td>1.389724e+14</td>
      <td>0.311646</td>
      <td>0.842928</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Regresión Lineal</td>
      <td>21</td>
      <td>4</td>
      <td>1.055708e-01</td>
      <td>0.287760</td>
      <td>0.929322</td>
    </tr>
    <tr>
      <th>18</th>
      <td>Regresión Lineal</td>
      <td>21</td>
      <td>5</td>
      <td>1.000476e-01</td>
      <td>0.285625</td>
      <td>0.927122</td>
    </tr>
    <tr>
      <th>22</th>
      <td>Regresión Lineal</td>
      <td>21</td>
      <td>6</td>
      <td>1.016455e-01</td>
      <td>0.288461</td>
      <td>0.924181</td>
    </tr>
    <tr>
      <th>26</th>
      <td>Regresión Lineal</td>
      <td>21</td>
      <td>7</td>
      <td>9.723630e-02</td>
      <td>0.287557</td>
      <td>0.920734</td>
    </tr>
    <tr>
      <th>30</th>
      <td>Regresión Lineal</td>
      <td>21</td>
      <td>8</td>
      <td>5.119509e+13</td>
      <td>0.290390</td>
      <td>0.931577</td>
    </tr>
    <tr>
      <th>34</th>
      <td>Regresión Lineal</td>
      <td>21</td>
      <td>9</td>
      <td>8.549514e-02</td>
      <td>0.305685</td>
      <td>0.761759</td>
    </tr>
    <tr>
      <th>38</th>
      <td>Regresión Lineal</td>
      <td>21</td>
      <td>10</td>
      <td>7.861649e-02</td>
      <td>0.297512</td>
      <td>0.727826</td>
    </tr>
    <tr>
      <th>41</th>
      <td>Regresión Lineal</td>
      <td>14</td>
      <td>11</td>
      <td>9.224217e-02</td>
      <td>0.307089</td>
      <td>0.931310</td>
    </tr>
    <tr>
      <th>45</th>
      <td>Regresión Lineal</td>
      <td>14</td>
      <td>12</td>
      <td>9.568458e-02</td>
      <td>0.311085</td>
      <td>0.927597</td>
    </tr>
    <tr>
      <th>48</th>
      <td>Regresión Lineal</td>
      <td>7</td>
      <td>13</td>
      <td>9.382491e-02</td>
      <td>0.324169</td>
      <td>0.912348</td>
    </tr>
    <tr>
      <th>54</th>
      <td>Regresión Lineal</td>
      <td>21</td>
      <td>14</td>
      <td>1.083929e-01</td>
      <td>0.328147</td>
      <td>0.880235</td>
    </tr>
    <tr>
      <th>56</th>
      <td>Regresión Lineal</td>
      <td>7</td>
      <td>15</td>
      <td>9.716426e-02</td>
      <td>0.320803</td>
      <td>0.914474</td>
    </tr>
    <tr>
      <th>61</th>
      <td>Regresión Lineal</td>
      <td>14</td>
      <td>16</td>
      <td>1.140048e-01</td>
      <td>0.298717</td>
      <td>0.820333</td>
    </tr>
    <tr>
      <th>65</th>
      <td>Regresión Lineal</td>
      <td>14</td>
      <td>17</td>
      <td>1.107844e-01</td>
      <td>0.294690</td>
      <td>0.825242</td>
    </tr>
    <tr>
      <th>70</th>
      <td>Regresión Lineal</td>
      <td>21</td>
      <td>18</td>
      <td>9.746803e-02</td>
      <td>0.294125</td>
      <td>0.922208</td>
    </tr>
    <tr>
      <th>73</th>
      <td>Regresión Lineal</td>
      <td>14</td>
      <td>19</td>
      <td>1.176979e-01</td>
      <td>0.310477</td>
      <td>0.798818</td>
    </tr>
    <tr>
      <th>77</th>
      <td>Regresión Lineal</td>
      <td>14</td>
      <td>20</td>
      <td>1.247921e-01</td>
      <td>0.316882</td>
      <td>0.803850</td>
    </tr>
    <tr>
      <th>81</th>
      <td>Regresión Lineal</td>
      <td>14</td>
      <td>21</td>
      <td>1.312773e-01</td>
      <td>0.318740</td>
      <td>0.835023</td>
    </tr>
    <tr>
      <th>85</th>
      <td>Regresión Lineal</td>
      <td>14</td>
      <td>22</td>
      <td>1.250503e-01</td>
      <td>0.297012</td>
      <td>0.855119</td>
    </tr>
    <tr>
      <th>89</th>
      <td>Regresión Lineal</td>
      <td>14</td>
      <td>23</td>
      <td>1.249751e-01</td>
      <td>0.296824</td>
      <td>0.851230</td>
    </tr>
    <tr>
      <th>94</th>
      <td>Regresión Lineal</td>
      <td>21</td>
      <td>24</td>
      <td>1.338382e-01</td>
      <td>0.284638</td>
      <td>0.874142</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="hora-y-ventana-con-mejor-modelo-reg-lineal">
<h4><strong>HORA Y VENTANA CON MEJOR MODELO REG. LINEAL</strong><a class="headerlink" href="#hora-y-ventana-con-mejor-modelo-reg-lineal" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bestreglin</span> <span class="o">=</span> <span class="n">mejormodelotot</span><span class="p">(</span><span class="n">mejorreglinhora</span><span class="p">)</span>
<span class="n">bestreglin</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>94</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Modelo</th>
      <td>Regresión Lineal</td>
    </tr>
    <tr>
      <th>Dias</th>
      <td>21</td>
    </tr>
    <tr>
      <th>Hora</th>
      <td>24</td>
    </tr>
    <tr>
      <th>MAPE</th>
      <td>0.133838</td>
    </tr>
    <tr>
      <th>RMSE</th>
      <td>0.284638</td>
    </tr>
    <tr>
      <th>R^2</th>
      <td>0.874142</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Es decir, para la <strong>Regresión Lineal</strong>, el mejor modelo se da cuando se trabaja con la <strong>HORA</strong>: <code class="docutils literal notranslate"><span class="pre">24</span></code> en la venta de predicción de <code class="docutils literal notranslate"><span class="pre">21</span> <span class="pre">días</span></code>. Veamos los valores de <strong>Ljung-Box p-value</strong> y <strong>Jarque-Bera p-value</strong>. Antes de ello, veamos cuáles son las pruebas de hipótesis para comprender mejor los p-valores que se nos arrojen.</p>
<ul class="simple">
<li><p><strong>Prueba de Ljung-Box</strong></p></li>
</ul>
<ul class="simple">
<li><p><strong>Hipótesis nula (H₀)</strong>: No hay autocorrelación en los residuos (es decir, los residuos son independientes entre sí).</p></li>
<li><p><strong>Hipótesis alternativa (H₁)</strong>: Hay autocorrelación en los residuos</p></li>
</ul>
<ul class="simple">
<li><p><strong>Prueba de Jarque-Bera</strong></p></li>
</ul>
<ul class="simple">
<li><p><strong>Hipótesis nula (H₀)</strong>: Los residuos tienen una distribución normal.</p></li>
<li><p><strong>Hipótesis alternativa (H₁)</strong>: Los residuos no tienen una distribución normal.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">metricas</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">dias</span> <span class="o">=</span> <span class="mi">21</span>
<span class="n">hora</span> <span class="o">=</span> <span class="mi">24</span>
<span class="n">iniciotrain</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">while</span> <span class="p">(</span><span class="n">iniciotrain</span> <span class="o">+</span> <span class="p">(</span><span class="n">dias</span> <span class="o">*</span> <span class="mi">24</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">):</span>    
    <span class="n">fintrain</span> <span class="o">=</span> <span class="n">iniciotrain</span> <span class="o">+</span> <span class="p">(</span><span class="n">dias</span> <span class="o">*</span> <span class="mi">24</span><span class="p">)</span>   
    <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">plieguess</span><span class="p">(</span><span class="n">iniciotrain</span><span class="p">,</span> <span class="n">fintrain</span><span class="p">,</span> <span class="n">hora</span><span class="p">)</span> 
    <span class="n">modeloreglin</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
    <span class="n">y_prediccion</span><span class="o">=</span> <span class="n">modeloreglin</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>      
    <span class="n">rmse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">,</span> <span class="n">squared</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">mape</span> <span class="o">=</span> <span class="n">mean_absolute_percentage_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">)</span>
    <span class="n">r2</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">)</span>
    <span class="n">ljungbox</span><span class="p">,</span> <span class="n">jarquebera</span> <span class="o">=</span> <span class="n">residuos</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">)</span>  
    <span class="n">metricas</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
        <span class="s1">&#39;Modelo&#39;</span><span class="p">:</span> <span class="s1">&#39;Regresión KNN&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Dias&#39;</span><span class="p">:</span> <span class="n">dias</span><span class="p">,</span>
        <span class="s1">&#39;Hora&#39;</span><span class="p">:</span> <span class="n">hora</span><span class="p">,</span>
        <span class="s1">&#39;MAPE&#39;</span><span class="p">:</span> <span class="n">mape</span><span class="p">,</span>
        <span class="s1">&#39;RMSE&#39;</span><span class="p">:</span> <span class="n">rmse</span><span class="p">,</span>
        <span class="s1">&#39;R^2&#39;</span><span class="p">:</span> <span class="n">r2</span><span class="p">,</span>
        <span class="s1">&#39;Ljung-Box p-value&#39;</span> <span class="p">:</span> <span class="n">ljungbox</span><span class="p">,</span>
        <span class="s1">&#39;Jarque-Bera p-value&#39;</span> <span class="p">:</span> <span class="n">jarquebera</span>
    <span class="p">})</span>  
    <span class="n">iniciotrain</span> <span class="o">=</span> <span class="n">fintrain</span>  
<span class="n">datareglin</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">metricas</span><span class="p">)</span>
<span class="n">datareglin</span> <span class="o">=</span> <span class="n">datareglin</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">datareglin</span><span class="p">[</span><span class="s1">&#39;RMSE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">idxmin</span><span class="p">()]</span>
<span class="n">datareglin</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">datareglin</span><span class="p">)</span>
<span class="n">datareglin</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Modelo</th>
      <td>Regresión KNN</td>
    </tr>
    <tr>
      <th>Dias</th>
      <td>21</td>
    </tr>
    <tr>
      <th>Hora</th>
      <td>24</td>
    </tr>
    <tr>
      <th>MAPE</th>
      <td>0.133838</td>
    </tr>
    <tr>
      <th>RMSE</th>
      <td>0.284638</td>
    </tr>
    <tr>
      <th>R^2</th>
      <td>0.874142</td>
    </tr>
    <tr>
      <th>Ljung-Box p-value</th>
      <td>0.368029</td>
    </tr>
    <tr>
      <th>Jarque-Bera p-value</th>
      <td>0.30649</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Sobre la regresión lineal, podemos afirmar que el mejor modelo predicho encontrado tiene un <strong>MAPE</strong> de <code class="docutils literal notranslate"><span class="pre">0.13</span></code>, lo que significa que, en promedio, el modelo se desvía un <code class="docutils literal notranslate"><span class="pre">13.38%</span></code> del valor real en las predicciones. El <strong>RMSE</strong> es de <code class="docutils literal notranslate"><span class="pre">0.28</span></code>, lo que indica que el error promedio en las predicciones es relativamente bajo, lo cual sugiere que el modelo hace un buen trabajo prediciendo los valores con precisión. Además, el coeficiente de determinación <strong>R²</strong> es de <code class="docutils literal notranslate"><span class="pre">0.87</span></code>, lo que indica que el modelo explica aproximadamente el <code class="docutils literal notranslate"><span class="pre">87.4%</span></code> de la variabilidad de los datos, lo cual es un muy buen rendimiento en términos de ajuste del modelo.</p>
<p>En cuanto a las pruebas de hipótesis para los supuestos de los residuos, observamos que el p-valor de la prueba de <strong>Ljung-Box</strong> es <code class="docutils literal notranslate"><span class="pre">0.36</span></code>. Esto significa que no se puede rechazar la hipótesis nula, por lo tanto, los residuos son independientes entre sí. Este resultado era esperado, ya que indica que no hay evidencia de autocorrelación en los residuos, lo que sugiere que el modelo ha capturado correctamente la estructura de los datos. Asimismo, el p-valor de la prueba de <strong>Jarque-Bera</strong> es <code class="docutils literal notranslate"><span class="pre">0.3</span></code>, lo que indica que no se puede rechazar la hipótesis de que los residuos siguen una distribución normal. Este resultado es favorable para la regresión lineal, ya que la normalidad de los residuos asegura la validez de las inferencias estadísticas del modelo.</p>
</section>
</section>
<section id="regresion-ridge">
<h3><strong>REGRESIÓN RIDGE</strong><a class="headerlink" href="#regresion-ridge" title="Link to this heading">#</a></h3>
<p>Primeramente se entrena el modelo y predice. Se imprimen las tablas que contienen las métricas predeterminadas para cada una de las 24 horas.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">modeloridge</span> <span class="o">=</span> <span class="n">Ridge</span><span class="p">()</span>
<span class="n">metricas</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">hora</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">25</span><span class="p">):</span>      
    <span class="k">for</span> <span class="n">dias</span> <span class="ow">in</span> <span class="n">particiones</span><span class="p">:</span>       
        <span class="n">iniciotrain</span> <span class="o">=</span> <span class="mi">0</span>        
        <span class="k">while</span> <span class="p">(</span><span class="n">iniciotrain</span> <span class="o">+</span> <span class="p">(</span><span class="n">dias</span> <span class="o">*</span> <span class="mi">24</span><span class="p">)</span> <span class="o">+</span> <span class="n">hora</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">):</span>            
            <span class="n">fintrain</span> <span class="o">=</span> <span class="n">iniciotrain</span> <span class="o">+</span> <span class="p">(</span><span class="n">dias</span> <span class="o">*</span> <span class="mi">24</span><span class="p">)</span>           
            <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">plieguess</span><span class="p">(</span><span class="n">iniciotrain</span><span class="p">,</span><span class="n">fintrain</span><span class="p">,</span><span class="n">hora</span><span class="p">)</span>            
            <span class="n">modeloridge</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
            <span class="n">y_prediccion</span><span class="o">=</span> <span class="n">modeloridge</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>               
            <span class="n">rmse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">,</span> <span class="n">squared</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="n">mape</span> <span class="o">=</span> <span class="n">mean_absolute_percentage_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">)</span>
            <span class="n">r2</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">)</span>
            <span class="n">metricas</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
                <span class="s1">&#39;Modelo&#39;</span><span class="p">:</span> <span class="s1">&#39;Regresión Ridge&#39;</span><span class="p">,</span>
                <span class="s1">&#39;Dias&#39;</span><span class="p">:</span> <span class="n">dias</span><span class="p">,</span>
                <span class="s1">&#39;Hora&#39;</span><span class="p">:</span> <span class="n">hora</span><span class="p">,</span>
                <span class="s1">&#39;MAPE&#39;</span><span class="p">:</span> <span class="n">mape</span><span class="p">,</span>
                <span class="s1">&#39;RMSE&#39;</span><span class="p">:</span> <span class="n">rmse</span><span class="p">,</span>
                <span class="s1">&#39;R^2&#39;</span><span class="p">:</span> <span class="n">r2</span><span class="p">,</span>
            <span class="p">})</span>           
            <span class="n">iniciotrain</span> <span class="o">=</span> <span class="n">fintrain</span>  
<span class="n">dataridge</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">metricas</span><span class="p">)</span>
<span class="n">dataridge</span> <span class="o">=</span> <span class="n">dataridge</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dataridge</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;Modelo&#39;</span><span class="p">,</span> <span class="s1">&#39;Hora&#39;</span><span class="p">,</span> <span class="s1">&#39;Dias&#39;</span><span class="p">])[</span><span class="s1">&#39;RMSE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">idxmin</span><span class="p">()]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataridge</span><span class="p">[</span><span class="n">dataridge</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Regresión Ridge</td>
      <td>7</td>
      <td>1</td>
      <td>0.093922</td>
      <td>0.290103</td>
      <td>0.602265</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Regresión Ridge</td>
      <td>14</td>
      <td>1</td>
      <td>0.166784</td>
      <td>0.327680</td>
      <td>0.913929</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Regresión Ridge</td>
      <td>21</td>
      <td>1</td>
      <td>0.105249</td>
      <td>0.317225</td>
      <td>0.892848</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Regresión Ridge</td>
      <td>28</td>
      <td>1</td>
      <td>0.108683</td>
      <td>0.320051</td>
      <td>0.890930</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataridge</span><span class="p">[</span><span class="n">dataridge</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>4</th>
      <td>Regresión Ridge</td>
      <td>7</td>
      <td>2</td>
      <td>5.224016e+13</td>
      <td>0.296205</td>
      <td>0.850377</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Regresión Ridge</td>
      <td>14</td>
      <td>2</td>
      <td>1.765936e-01</td>
      <td>0.345091</td>
      <td>0.502901</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Regresión Ridge</td>
      <td>21</td>
      <td>2</td>
      <td>2.119207e-01</td>
      <td>0.326646</td>
      <td>0.923647</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Regresión Ridge</td>
      <td>28</td>
      <td>2</td>
      <td>1.150783e-01</td>
      <td>0.335695</td>
      <td>0.864361</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataridge</span><span class="p">[</span><span class="n">dataridge</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">3</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>8</th>
      <td>Regresión Ridge</td>
      <td>7</td>
      <td>3</td>
      <td>1.518622e+14</td>
      <td>0.314434</td>
      <td>0.840105</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Regresión Ridge</td>
      <td>14</td>
      <td>3</td>
      <td>1.055154e-01</td>
      <td>0.331490</td>
      <td>0.862916</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Regresión Ridge</td>
      <td>21</td>
      <td>3</td>
      <td>1.034165e-01</td>
      <td>0.317159</td>
      <td>0.874513</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Regresión Ridge</td>
      <td>28</td>
      <td>3</td>
      <td>1.060422e-01</td>
      <td>0.321857</td>
      <td>0.870768</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataridge</span><span class="p">[</span><span class="n">dataridge</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">4</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>12</th>
      <td>Regresión Ridge</td>
      <td>7</td>
      <td>4</td>
      <td>1.192589e+14</td>
      <td>0.312458</td>
      <td>0.833507</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Regresión Ridge</td>
      <td>14</td>
      <td>4</td>
      <td>1.039487e-01</td>
      <td>0.331241</td>
      <td>0.851864</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Regresión Ridge</td>
      <td>21</td>
      <td>4</td>
      <td>1.054710e-01</td>
      <td>0.287738</td>
      <td>0.929333</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Regresión Ridge</td>
      <td>28</td>
      <td>4</td>
      <td>1.073165e-01</td>
      <td>0.323306</td>
      <td>0.858876</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataridge</span><span class="p">[</span><span class="n">dataridge</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">5</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>16</th>
      <td>Regresión Ridge</td>
      <td>7</td>
      <td>5</td>
      <td>0.132999</td>
      <td>0.321472</td>
      <td>0.884422</td>
    </tr>
    <tr>
      <th>17</th>
      <td>Regresión Ridge</td>
      <td>14</td>
      <td>5</td>
      <td>0.104086</td>
      <td>0.331712</td>
      <td>0.844930</td>
    </tr>
    <tr>
      <th>18</th>
      <td>Regresión Ridge</td>
      <td>21</td>
      <td>5</td>
      <td>0.100009</td>
      <td>0.285639</td>
      <td>0.927115</td>
    </tr>
    <tr>
      <th>19</th>
      <td>Regresión Ridge</td>
      <td>28</td>
      <td>5</td>
      <td>0.107204</td>
      <td>0.323306</td>
      <td>0.852689</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataridge</span><span class="p">[</span><span class="n">dataridge</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">6</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>20</th>
      <td>Regresión Ridge</td>
      <td>7</td>
      <td>6</td>
      <td>0.088465</td>
      <td>0.336004</td>
      <td>0.850351</td>
    </tr>
    <tr>
      <th>21</th>
      <td>Regresión Ridge</td>
      <td>14</td>
      <td>6</td>
      <td>0.102260</td>
      <td>0.331410</td>
      <td>0.824458</td>
    </tr>
    <tr>
      <th>22</th>
      <td>Regresión Ridge</td>
      <td>21</td>
      <td>6</td>
      <td>0.101666</td>
      <td>0.288539</td>
      <td>0.924140</td>
    </tr>
    <tr>
      <th>23</th>
      <td>Regresión Ridge</td>
      <td>28</td>
      <td>6</td>
      <td>0.103527</td>
      <td>0.322098</td>
      <td>0.834184</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataridge</span><span class="p">[</span><span class="n">dataridge</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">7</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>24</th>
      <td>Regresión Ridge</td>
      <td>7</td>
      <td>7</td>
      <td>0.088003</td>
      <td>0.335511</td>
      <td>0.850790</td>
    </tr>
    <tr>
      <th>25</th>
      <td>Regresión Ridge</td>
      <td>14</td>
      <td>7</td>
      <td>0.093039</td>
      <td>0.325786</td>
      <td>0.791882</td>
    </tr>
    <tr>
      <th>26</th>
      <td>Regresión Ridge</td>
      <td>21</td>
      <td>7</td>
      <td>0.097249</td>
      <td>0.287633</td>
      <td>0.920692</td>
    </tr>
    <tr>
      <th>27</th>
      <td>Regresión Ridge</td>
      <td>28</td>
      <td>7</td>
      <td>0.090019</td>
      <td>0.309867</td>
      <td>0.811724</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataridge</span><span class="p">[</span><span class="n">dataridge</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">8</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>28</th>
      <td>Regresión Ridge</td>
      <td>7</td>
      <td>8</td>
      <td>9.550950e-02</td>
      <td>0.323094</td>
      <td>0.924230</td>
    </tr>
    <tr>
      <th>29</th>
      <td>Regresión Ridge</td>
      <td>14</td>
      <td>8</td>
      <td>8.574775e-02</td>
      <td>0.304564</td>
      <td>0.932671</td>
    </tr>
    <tr>
      <th>30</th>
      <td>Regresión Ridge</td>
      <td>21</td>
      <td>8</td>
      <td>5.187032e+13</td>
      <td>0.290591</td>
      <td>0.931483</td>
    </tr>
    <tr>
      <th>31</th>
      <td>Regresión Ridge</td>
      <td>28</td>
      <td>8</td>
      <td>9.116991e-02</td>
      <td>0.312624</td>
      <td>0.764724</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataridge</span><span class="p">[</span><span class="n">dataridge</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">9</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>32</th>
      <td>Regresión Ridge</td>
      <td>7</td>
      <td>9</td>
      <td>0.099234</td>
      <td>0.327969</td>
      <td>0.919222</td>
    </tr>
    <tr>
      <th>33</th>
      <td>Regresión Ridge</td>
      <td>14</td>
      <td>9</td>
      <td>0.089325</td>
      <td>0.310440</td>
      <td>0.927626</td>
    </tr>
    <tr>
      <th>34</th>
      <td>Regresión Ridge</td>
      <td>21</td>
      <td>9</td>
      <td>0.085185</td>
      <td>0.305768</td>
      <td>0.761630</td>
    </tr>
    <tr>
      <th>35</th>
      <td>Regresión Ridge</td>
      <td>28</td>
      <td>9</td>
      <td>0.085872</td>
      <td>0.307237</td>
      <td>0.759334</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataridge</span><span class="p">[</span><span class="n">dataridge</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">10</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>36</th>
      <td>Regresión Ridge</td>
      <td>7</td>
      <td>10</td>
      <td>0.094565</td>
      <td>0.318985</td>
      <td>0.923587</td>
    </tr>
    <tr>
      <th>37</th>
      <td>Regresión Ridge</td>
      <td>14</td>
      <td>10</td>
      <td>0.083178</td>
      <td>0.304156</td>
      <td>0.930526</td>
    </tr>
    <tr>
      <th>38</th>
      <td>Regresión Ridge</td>
      <td>21</td>
      <td>10</td>
      <td>0.078482</td>
      <td>0.297924</td>
      <td>0.727072</td>
    </tr>
    <tr>
      <th>39</th>
      <td>Regresión Ridge</td>
      <td>28</td>
      <td>10</td>
      <td>0.078366</td>
      <td>0.297828</td>
      <td>0.727248</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataridge</span><span class="p">[</span><span class="n">dataridge</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">11</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>40</th>
      <td>Regresión Ridge</td>
      <td>7</td>
      <td>11</td>
      <td>0.093343</td>
      <td>0.318192</td>
      <td>0.926254</td>
    </tr>
    <tr>
      <th>41</th>
      <td>Regresión Ridge</td>
      <td>14</td>
      <td>11</td>
      <td>0.092636</td>
      <td>0.306600</td>
      <td>0.931529</td>
    </tr>
    <tr>
      <th>42</th>
      <td>Regresión Ridge</td>
      <td>21</td>
      <td>11</td>
      <td>0.085561</td>
      <td>0.327741</td>
      <td>0.627443</td>
    </tr>
    <tr>
      <th>43</th>
      <td>Regresión Ridge</td>
      <td>28</td>
      <td>11</td>
      <td>0.085200</td>
      <td>0.327603</td>
      <td>0.627756</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataridge</span><span class="p">[</span><span class="n">dataridge</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">12</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>44</th>
      <td>Regresión Ridge</td>
      <td>7</td>
      <td>12</td>
      <td>0.089107</td>
      <td>0.327205</td>
      <td>0.827530</td>
    </tr>
    <tr>
      <th>45</th>
      <td>Regresión Ridge</td>
      <td>14</td>
      <td>12</td>
      <td>0.095937</td>
      <td>0.310505</td>
      <td>0.927866</td>
    </tr>
    <tr>
      <th>46</th>
      <td>Regresión Ridge</td>
      <td>21</td>
      <td>12</td>
      <td>0.093112</td>
      <td>0.339109</td>
      <td>0.667217</td>
    </tr>
    <tr>
      <th>47</th>
      <td>Regresión Ridge</td>
      <td>28</td>
      <td>12</td>
      <td>0.092861</td>
      <td>0.339244</td>
      <td>0.666951</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataridge</span><span class="p">[</span><span class="n">dataridge</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">13</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>48</th>
      <td>Regresión Ridge</td>
      <td>7</td>
      <td>13</td>
      <td>0.093753</td>
      <td>0.322960</td>
      <td>0.913000</td>
    </tr>
    <tr>
      <th>49</th>
      <td>Regresión Ridge</td>
      <td>14</td>
      <td>13</td>
      <td>0.107013</td>
      <td>0.329380</td>
      <td>0.913087</td>
    </tr>
    <tr>
      <th>50</th>
      <td>Regresión Ridge</td>
      <td>21</td>
      <td>13</td>
      <td>0.110411</td>
      <td>0.331590</td>
      <td>0.835688</td>
    </tr>
    <tr>
      <th>51</th>
      <td>Regresión Ridge</td>
      <td>28</td>
      <td>13</td>
      <td>0.103590</td>
      <td>0.347856</td>
      <td>0.735902</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataridge</span><span class="p">[</span><span class="n">dataridge</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">14</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>52</th>
      <td>Regresión Ridge</td>
      <td>7</td>
      <td>14</td>
      <td>0.096785</td>
      <td>0.330654</td>
      <td>0.898348</td>
    </tr>
    <tr>
      <th>53</th>
      <td>Regresión Ridge</td>
      <td>14</td>
      <td>14</td>
      <td>0.113997</td>
      <td>0.335340</td>
      <td>0.911482</td>
    </tr>
    <tr>
      <th>54</th>
      <td>Regresión Ridge</td>
      <td>21</td>
      <td>14</td>
      <td>0.108770</td>
      <td>0.329189</td>
      <td>0.879473</td>
    </tr>
    <tr>
      <th>55</th>
      <td>Regresión Ridge</td>
      <td>28</td>
      <td>14</td>
      <td>0.113471</td>
      <td>0.353809</td>
      <td>0.779195</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataridge</span><span class="p">[</span><span class="n">dataridge</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">15</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>56</th>
      <td>Regresión Ridge</td>
      <td>7</td>
      <td>15</td>
      <td>0.096585</td>
      <td>0.320803</td>
      <td>0.914474</td>
    </tr>
    <tr>
      <th>57</th>
      <td>Regresión Ridge</td>
      <td>14</td>
      <td>15</td>
      <td>0.107347</td>
      <td>0.324366</td>
      <td>0.919341</td>
    </tr>
    <tr>
      <th>58</th>
      <td>Regresión Ridge</td>
      <td>21</td>
      <td>15</td>
      <td>0.110467</td>
      <td>0.332931</td>
      <td>0.884161</td>
    </tr>
    <tr>
      <th>59</th>
      <td>Regresión Ridge</td>
      <td>28</td>
      <td>15</td>
      <td>0.115147</td>
      <td>0.351784</td>
      <td>0.905129</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataridge</span><span class="p">[</span><span class="n">dataridge</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">16</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>60</th>
      <td>Regresión Ridge</td>
      <td>7</td>
      <td>16</td>
      <td>0.096769</td>
      <td>0.320858</td>
      <td>0.913848</td>
    </tr>
    <tr>
      <th>61</th>
      <td>Regresión Ridge</td>
      <td>14</td>
      <td>16</td>
      <td>0.114143</td>
      <td>0.299583</td>
      <td>0.819288</td>
    </tr>
    <tr>
      <th>62</th>
      <td>Regresión Ridge</td>
      <td>21</td>
      <td>16</td>
      <td>0.117252</td>
      <td>0.304435</td>
      <td>0.813388</td>
    </tr>
    <tr>
      <th>63</th>
      <td>Regresión Ridge</td>
      <td>28</td>
      <td>16</td>
      <td>0.116089</td>
      <td>0.350840</td>
      <td>0.909266</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataridge</span><span class="p">[</span><span class="n">dataridge</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">17</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>64</th>
      <td>Regresión Ridge</td>
      <td>7</td>
      <td>17</td>
      <td>0.097145</td>
      <td>0.321861</td>
      <td>0.912454</td>
    </tr>
    <tr>
      <th>65</th>
      <td>Regresión Ridge</td>
      <td>14</td>
      <td>17</td>
      <td>0.110969</td>
      <td>0.295617</td>
      <td>0.824140</td>
    </tr>
    <tr>
      <th>66</th>
      <td>Regresión Ridge</td>
      <td>21</td>
      <td>17</td>
      <td>0.100638</td>
      <td>0.301539</td>
      <td>0.912849</td>
    </tr>
    <tr>
      <th>67</th>
      <td>Regresión Ridge</td>
      <td>28</td>
      <td>17</td>
      <td>0.124263</td>
      <td>0.353709</td>
      <td>0.913911</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataridge</span><span class="p">[</span><span class="n">dataridge</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">18</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>68</th>
      <td>Regresión Ridge</td>
      <td>7</td>
      <td>18</td>
      <td>0.097687</td>
      <td>0.322321</td>
      <td>0.911518</td>
    </tr>
    <tr>
      <th>69</th>
      <td>Regresión Ridge</td>
      <td>14</td>
      <td>18</td>
      <td>0.114421</td>
      <td>0.301570</td>
      <td>0.809845</td>
    </tr>
    <tr>
      <th>70</th>
      <td>Regresión Ridge</td>
      <td>21</td>
      <td>18</td>
      <td>0.097425</td>
      <td>0.291576</td>
      <td>0.923551</td>
    </tr>
    <tr>
      <th>71</th>
      <td>Regresión Ridge</td>
      <td>28</td>
      <td>18</td>
      <td>0.143333</td>
      <td>0.363045</td>
      <td>0.915240</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataridge</span><span class="p">[</span><span class="n">dataridge</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">19</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>72</th>
      <td>Regresión Ridge</td>
      <td>7</td>
      <td>19</td>
      <td>0.091067</td>
      <td>0.318461</td>
      <td>0.910727</td>
    </tr>
    <tr>
      <th>73</th>
      <td>Regresión Ridge</td>
      <td>14</td>
      <td>19</td>
      <td>0.117726</td>
      <td>0.310934</td>
      <td>0.798226</td>
    </tr>
    <tr>
      <th>74</th>
      <td>Regresión Ridge</td>
      <td>21</td>
      <td>19</td>
      <td>0.122122</td>
      <td>0.318750</td>
      <td>0.787955</td>
    </tr>
    <tr>
      <th>75</th>
      <td>Regresión Ridge</td>
      <td>28</td>
      <td>19</td>
      <td>0.144552</td>
      <td>0.363084</td>
      <td>0.917798</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataridge</span><span class="p">[</span><span class="n">dataridge</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">20</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>76</th>
      <td>Regresión Ridge</td>
      <td>7</td>
      <td>20</td>
      <td>9.199970e-02</td>
      <td>0.319161</td>
      <td>0.907628</td>
    </tr>
    <tr>
      <th>77</th>
      <td>Regresión Ridge</td>
      <td>14</td>
      <td>20</td>
      <td>1.247168e-01</td>
      <td>0.317096</td>
      <td>0.803585</td>
    </tr>
    <tr>
      <th>78</th>
      <td>Regresión Ridge</td>
      <td>21</td>
      <td>20</td>
      <td>1.282800e-01</td>
      <td>0.323000</td>
      <td>0.796203</td>
    </tr>
    <tr>
      <th>79</th>
      <td>Regresión Ridge</td>
      <td>28</td>
      <td>20</td>
      <td>2.870396e+14</td>
      <td>0.364236</td>
      <td>0.879162</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataridge</span><span class="p">[</span><span class="n">dataridge</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">21</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>80</th>
      <td>Regresión Ridge</td>
      <td>7</td>
      <td>21</td>
      <td>9.530931e-02</td>
      <td>0.321096</td>
      <td>0.903792</td>
    </tr>
    <tr>
      <th>81</th>
      <td>Regresión Ridge</td>
      <td>14</td>
      <td>21</td>
      <td>1.309976e-01</td>
      <td>0.318826</td>
      <td>0.834935</td>
    </tr>
    <tr>
      <th>82</th>
      <td>Regresión Ridge</td>
      <td>21</td>
      <td>21</td>
      <td>1.345738e-01</td>
      <td>0.324661</td>
      <td>0.828837</td>
    </tr>
    <tr>
      <th>83</th>
      <td>Regresión Ridge</td>
      <td>28</td>
      <td>21</td>
      <td>2.870396e+14</td>
      <td>0.347461</td>
      <td>0.889994</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataridge</span><span class="p">[</span><span class="n">dataridge</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">22</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>84</th>
      <td>Regresión Ridge</td>
      <td>7</td>
      <td>22</td>
      <td>1.123130e+14</td>
      <td>0.316175</td>
      <td>0.936049</td>
    </tr>
    <tr>
      <th>85</th>
      <td>Regresión Ridge</td>
      <td>14</td>
      <td>22</td>
      <td>1.247698e-01</td>
      <td>0.296510</td>
      <td>0.855609</td>
    </tr>
    <tr>
      <th>86</th>
      <td>Regresión Ridge</td>
      <td>21</td>
      <td>22</td>
      <td>1.282196e-01</td>
      <td>0.299030</td>
      <td>0.853144</td>
    </tr>
    <tr>
      <th>87</th>
      <td>Regresión Ridge</td>
      <td>28</td>
      <td>22</td>
      <td>2.870396e+14</td>
      <td>0.349583</td>
      <td>0.888208</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataridge</span><span class="p">[</span><span class="n">dataridge</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">23</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>88</th>
      <td>Regresión Ridge</td>
      <td>7</td>
      <td>23</td>
      <td>1.123130e+14</td>
      <td>0.305539</td>
      <td>0.942751</td>
    </tr>
    <tr>
      <th>89</th>
      <td>Regresión Ridge</td>
      <td>14</td>
      <td>23</td>
      <td>1.247323e-01</td>
      <td>0.296275</td>
      <td>0.851781</td>
    </tr>
    <tr>
      <th>90</th>
      <td>Regresión Ridge</td>
      <td>21</td>
      <td>23</td>
      <td>1.266937e-01</td>
      <td>0.297254</td>
      <td>0.850800</td>
    </tr>
    <tr>
      <th>91</th>
      <td>Regresión Ridge</td>
      <td>28</td>
      <td>23</td>
      <td>2.870396e+14</td>
      <td>0.354436</td>
      <td>0.885817</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataridge</span><span class="p">[</span><span class="n">dataridge</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">24</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>92</th>
      <td>Regresión Ridge</td>
      <td>7</td>
      <td>24</td>
      <td>1.123130e+14</td>
      <td>0.304991</td>
      <td>0.943794</td>
    </tr>
    <tr>
      <th>93</th>
      <td>Regresión Ridge</td>
      <td>14</td>
      <td>24</td>
      <td>1.329246e-01</td>
      <td>0.286196</td>
      <td>0.872761</td>
    </tr>
    <tr>
      <th>94</th>
      <td>Regresión Ridge</td>
      <td>21</td>
      <td>24</td>
      <td>1.337786e-01</td>
      <td>0.284339</td>
      <td>0.874406</td>
    </tr>
    <tr>
      <th>95</th>
      <td>Regresión Ridge</td>
      <td>28</td>
      <td>24</td>
      <td>2.870396e+14</td>
      <td>0.383384</td>
      <td>0.867748</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<section id="id2">
<h4><strong>MEJOR MODELO - CADA HORA</strong><a class="headerlink" href="#id2" title="Link to this heading">#</a></h4>
<p>Ahora mostraremos el mejor modelo de cada hora</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mejorridgehora</span> <span class="o">=</span> <span class="n">mejormodelohora</span><span class="p">(</span><span class="n">particiones</span><span class="p">,</span> <span class="n">dataridge</span><span class="p">)</span>
<span class="n">mejorridgehora</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Regresión Ridge</td>
      <td>7</td>
      <td>1</td>
      <td>9.392195e-02</td>
      <td>0.290103</td>
      <td>0.602265</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Regresión Ridge</td>
      <td>7</td>
      <td>2</td>
      <td>5.224016e+13</td>
      <td>0.296205</td>
      <td>0.850377</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Regresión Ridge</td>
      <td>7</td>
      <td>3</td>
      <td>1.518622e+14</td>
      <td>0.314434</td>
      <td>0.840105</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Regresión Ridge</td>
      <td>21</td>
      <td>4</td>
      <td>1.054710e-01</td>
      <td>0.287738</td>
      <td>0.929333</td>
    </tr>
    <tr>
      <th>18</th>
      <td>Regresión Ridge</td>
      <td>21</td>
      <td>5</td>
      <td>1.000092e-01</td>
      <td>0.285639</td>
      <td>0.927115</td>
    </tr>
    <tr>
      <th>22</th>
      <td>Regresión Ridge</td>
      <td>21</td>
      <td>6</td>
      <td>1.016655e-01</td>
      <td>0.288539</td>
      <td>0.924140</td>
    </tr>
    <tr>
      <th>26</th>
      <td>Regresión Ridge</td>
      <td>21</td>
      <td>7</td>
      <td>9.724889e-02</td>
      <td>0.287633</td>
      <td>0.920692</td>
    </tr>
    <tr>
      <th>30</th>
      <td>Regresión Ridge</td>
      <td>21</td>
      <td>8</td>
      <td>5.187032e+13</td>
      <td>0.290591</td>
      <td>0.931483</td>
    </tr>
    <tr>
      <th>34</th>
      <td>Regresión Ridge</td>
      <td>21</td>
      <td>9</td>
      <td>8.518456e-02</td>
      <td>0.305768</td>
      <td>0.761630</td>
    </tr>
    <tr>
      <th>39</th>
      <td>Regresión Ridge</td>
      <td>28</td>
      <td>10</td>
      <td>7.836569e-02</td>
      <td>0.297828</td>
      <td>0.727248</td>
    </tr>
    <tr>
      <th>41</th>
      <td>Regresión Ridge</td>
      <td>14</td>
      <td>11</td>
      <td>9.263621e-02</td>
      <td>0.306600</td>
      <td>0.931529</td>
    </tr>
    <tr>
      <th>45</th>
      <td>Regresión Ridge</td>
      <td>14</td>
      <td>12</td>
      <td>9.593730e-02</td>
      <td>0.310505</td>
      <td>0.927866</td>
    </tr>
    <tr>
      <th>48</th>
      <td>Regresión Ridge</td>
      <td>7</td>
      <td>13</td>
      <td>9.375348e-02</td>
      <td>0.322960</td>
      <td>0.913000</td>
    </tr>
    <tr>
      <th>54</th>
      <td>Regresión Ridge</td>
      <td>21</td>
      <td>14</td>
      <td>1.087695e-01</td>
      <td>0.329189</td>
      <td>0.879473</td>
    </tr>
    <tr>
      <th>56</th>
      <td>Regresión Ridge</td>
      <td>7</td>
      <td>15</td>
      <td>9.658506e-02</td>
      <td>0.320803</td>
      <td>0.914474</td>
    </tr>
    <tr>
      <th>61</th>
      <td>Regresión Ridge</td>
      <td>14</td>
      <td>16</td>
      <td>1.141431e-01</td>
      <td>0.299583</td>
      <td>0.819288</td>
    </tr>
    <tr>
      <th>65</th>
      <td>Regresión Ridge</td>
      <td>14</td>
      <td>17</td>
      <td>1.109692e-01</td>
      <td>0.295617</td>
      <td>0.824140</td>
    </tr>
    <tr>
      <th>70</th>
      <td>Regresión Ridge</td>
      <td>21</td>
      <td>18</td>
      <td>9.742538e-02</td>
      <td>0.291576</td>
      <td>0.923551</td>
    </tr>
    <tr>
      <th>73</th>
      <td>Regresión Ridge</td>
      <td>14</td>
      <td>19</td>
      <td>1.177262e-01</td>
      <td>0.310934</td>
      <td>0.798226</td>
    </tr>
    <tr>
      <th>77</th>
      <td>Regresión Ridge</td>
      <td>14</td>
      <td>20</td>
      <td>1.247168e-01</td>
      <td>0.317096</td>
      <td>0.803585</td>
    </tr>
    <tr>
      <th>81</th>
      <td>Regresión Ridge</td>
      <td>14</td>
      <td>21</td>
      <td>1.309976e-01</td>
      <td>0.318826</td>
      <td>0.834935</td>
    </tr>
    <tr>
      <th>85</th>
      <td>Regresión Ridge</td>
      <td>14</td>
      <td>22</td>
      <td>1.247698e-01</td>
      <td>0.296510</td>
      <td>0.855609</td>
    </tr>
    <tr>
      <th>89</th>
      <td>Regresión Ridge</td>
      <td>14</td>
      <td>23</td>
      <td>1.247323e-01</td>
      <td>0.296275</td>
      <td>0.851781</td>
    </tr>
    <tr>
      <th>94</th>
      <td>Regresión Ridge</td>
      <td>21</td>
      <td>24</td>
      <td>1.337786e-01</td>
      <td>0.284339</td>
      <td>0.874406</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="hora-y-ventana-con-mejor-modelo-ridge">
<h4><strong>HORA Y VENTANA CON MEJOR MODELO RIDGE</strong><a class="headerlink" href="#hora-y-ventana-con-mejor-modelo-ridge" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bestridge</span> <span class="o">=</span> <span class="n">mejormodelotot</span><span class="p">(</span><span class="n">mejorridgehora</span><span class="p">)</span>
<span class="n">bestridge</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>94</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Modelo</th>
      <td>Regresión Ridge</td>
    </tr>
    <tr>
      <th>Dias</th>
      <td>21</td>
    </tr>
    <tr>
      <th>Hora</th>
      <td>24</td>
    </tr>
    <tr>
      <th>MAPE</th>
      <td>0.133779</td>
    </tr>
    <tr>
      <th>RMSE</th>
      <td>0.284339</td>
    </tr>
    <tr>
      <th>R^2</th>
      <td>0.874406</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Es decir, para la <strong>Regresión Ridge</strong>, el mejor modelo se da cuando se trabaja con la <strong>HORA</strong>: <code class="docutils literal notranslate"><span class="pre">24</span></code> en la venta de predicción de <code class="docutils literal notranslate"><span class="pre">21</span> <span class="pre">días</span></code>. Veamos los valores de <strong>Ljung-Box p-value</strong> y <strong>Jarque-Bera p-value</strong>. Antes de ello, veamos cuáles son las pruebas de hipótesis para comprender mejor los p-valores que se nos arrojen.</p>
<ul class="simple">
<li><p><strong>Prueba de Ljung-Box</strong></p></li>
</ul>
<ul class="simple">
<li><p><strong>Hipótesis nula (H₀)</strong>: No hay autocorrelación en los residuos (es decir, los residuos son independientes entre sí).</p></li>
<li><p><strong>Hipótesis alternativa (H₁)</strong>: Hay autocorrelación en los residuos</p></li>
</ul>
<ul class="simple">
<li><p><strong>Prueba de Jarque-Bera</strong></p></li>
</ul>
<ul class="simple">
<li><p><strong>Hipótesis nula (H₀)</strong>: Los residuos tienen una distribución normal.</p></li>
<li><p><strong>Hipótesis alternativa (H₁)</strong>: Los residuos no tienen una distribución normal.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">metricas</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">dias</span> <span class="o">=</span> <span class="mi">21</span>
<span class="n">hora</span> <span class="o">=</span> <span class="mi">24</span>
<span class="n">iniciotrain</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">while</span> <span class="p">(</span><span class="n">iniciotrain</span> <span class="o">+</span> <span class="p">(</span><span class="n">dias</span> <span class="o">*</span> <span class="mi">24</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">):</span>  
    <span class="n">fintrain</span> <span class="o">=</span> <span class="n">iniciotrain</span> <span class="o">+</span> <span class="p">(</span><span class="n">dias</span> <span class="o">*</span> <span class="mi">24</span><span class="p">)</span>   
    <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">plieguess</span><span class="p">(</span><span class="n">iniciotrain</span><span class="p">,</span> <span class="n">fintrain</span><span class="p">,</span> <span class="n">hora</span><span class="p">)</span>   
    <span class="n">modeloridge</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
    <span class="n">y_prediccion</span><span class="o">=</span> <span class="n">modeloridge</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>       
    <span class="n">rmse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">,</span> <span class="n">squared</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">mape</span> <span class="o">=</span> <span class="n">mean_absolute_percentage_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">)</span>
    <span class="n">r2</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">)</span>
    <span class="n">ljungbox</span><span class="p">,</span> <span class="n">jarquebera</span> <span class="o">=</span> <span class="n">residuos</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">)</span>   
    <span class="n">metricas</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
        <span class="s1">&#39;Modelo&#39;</span><span class="p">:</span> <span class="s1">&#39;Regresión Ridge&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Dias&#39;</span><span class="p">:</span> <span class="n">dias</span><span class="p">,</span>
        <span class="s1">&#39;Hora&#39;</span><span class="p">:</span> <span class="n">hora</span><span class="p">,</span>
        <span class="s1">&#39;MAPE&#39;</span><span class="p">:</span> <span class="n">mape</span><span class="p">,</span>
        <span class="s1">&#39;RMSE&#39;</span><span class="p">:</span> <span class="n">rmse</span><span class="p">,</span>
        <span class="s1">&#39;R^2&#39;</span><span class="p">:</span> <span class="n">r2</span><span class="p">,</span>
        <span class="s1">&#39;Ljung-Box p-value&#39;</span> <span class="p">:</span> <span class="n">ljungbox</span><span class="p">,</span>
        <span class="s1">&#39;Jarque-Bera p-value&#39;</span> <span class="p">:</span> <span class="n">jarquebera</span>
    <span class="p">})</span>   
    <span class="n">iniciotrain</span> <span class="o">=</span> <span class="n">fintrain</span>  
<span class="n">dataridge</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">metricas</span><span class="p">)</span>
<span class="n">dataridge</span> <span class="o">=</span> <span class="n">dataridge</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dataridge</span><span class="p">[</span><span class="s1">&#39;RMSE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">idxmin</span><span class="p">()]</span>
<span class="n">dataridge</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">dataridge</span><span class="p">)</span>
<span class="n">dataridge</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Modelo</th>
      <td>Regresión Ridge</td>
    </tr>
    <tr>
      <th>Dias</th>
      <td>21</td>
    </tr>
    <tr>
      <th>Hora</th>
      <td>24</td>
    </tr>
    <tr>
      <th>MAPE</th>
      <td>0.133779</td>
    </tr>
    <tr>
      <th>RMSE</th>
      <td>0.284339</td>
    </tr>
    <tr>
      <th>R^2</th>
      <td>0.874406</td>
    </tr>
    <tr>
      <th>Ljung-Box p-value</th>
      <td>0.370875</td>
    </tr>
    <tr>
      <th>Jarque-Bera p-value</th>
      <td>0.285062</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>En el modelo de regresión Ridge, el <strong>MAPE</strong> es de <code class="docutils literal notranslate"><span class="pre">0.13</span></code>, lo que indica que, en promedio, las predicciones del modelo se desvían un <code class="docutils literal notranslate"><span class="pre">13.37%</span></code> de los valores reales. El <strong>RMSE</strong> de <code class="docutils literal notranslate"><span class="pre">0.28</span></code> muestra que el error promedio en las predicciones es bajo, lo que sugiere que el modelo está haciendo un buen trabajo. Además, con un <strong>R²</strong> de <code class="docutils literal notranslate"><span class="pre">0.87</span></code>, el modelo logra explicar el <code class="docutils literal notranslate"><span class="pre">87.44%</span></code> de la variabilidad de los datos, lo que representa un buen ajuste.</p>
<p>Respecto a los residuos, el <strong>p-valor</strong> de la prueba de <strong>Ljung-Box</strong> es <code class="docutils literal notranslate"><span class="pre">0.37</span></code>, lo que indica que no hay autocorrelación en los residuos, lo cual es deseable ya que los errores son independientes. El <strong>p-valor</strong> de la prueba de <strong>Jarque-Bera</strong> es <code class="docutils literal notranslate"><span class="pre">0.28</span></code>, lo que sugiere que los residuos siguen una distribución normal, lo que refuerza la validez del modelo y de sus predicciones.</p>
</section>
</section>
<section id="regresion-lasso">
<h3><strong>REGRESIÓN LASSO</strong><a class="headerlink" href="#regresion-lasso" title="Link to this heading">#</a></h3>
<p>Primeramente se entrena el modelo y predice. Se imprimen las tablas que contienen las métricas predeterminadas para cada una de las 24 horas.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">modelolasso</span> <span class="o">=</span> <span class="n">Lasso</span><span class="p">()</span>
<span class="n">metricas</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">hora</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">25</span><span class="p">):</span>  <span class="c1"># Ciclo para calcular la tabla de errores para cada hora (puedes extender hasta 24)   </span>
    <span class="k">for</span> <span class="n">dias</span> <span class="ow">in</span> <span class="n">particiones</span><span class="p">:</span>  <span class="c1"># Ciclo que recorre las particiones para las ventanas        </span>
        <span class="n">iniciotrain</span> <span class="o">=</span> <span class="mi">0</span>        
        <span class="k">while</span> <span class="p">(</span><span class="n">iniciotrain</span> <span class="o">+</span> <span class="p">(</span><span class="n">dias</span> <span class="o">*</span> <span class="mi">24</span><span class="p">)</span> <span class="o">+</span> <span class="n">hora</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">):</span>  <span class="c1"># Mientras que el tamaño del pliegue más la hora sea menor que la longitud de los datos           </span>
            <span class="n">fintrain</span> <span class="o">=</span> <span class="n">iniciotrain</span> <span class="o">+</span> <span class="p">(</span><span class="n">dias</span> <span class="o">*</span> <span class="mi">24</span><span class="p">)</span>            
            <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">plieguess</span><span class="p">(</span><span class="n">iniciotrain</span><span class="p">,</span><span class="n">fintrain</span><span class="p">,</span><span class="n">hora</span><span class="p">)</span>          
            <span class="n">modelolasso</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
            <span class="n">y_prediccion</span><span class="o">=</span> <span class="n">modelolasso</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>               
            <span class="n">rmse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">,</span> <span class="n">squared</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="n">mape</span> <span class="o">=</span> <span class="n">mean_absolute_percentage_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">)</span>
            <span class="n">r2</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">)</span>
            <span class="n">metricas</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
                <span class="s1">&#39;Modelo&#39;</span><span class="p">:</span> <span class="s1">&#39;Regresión Lasso&#39;</span><span class="p">,</span>
                <span class="s1">&#39;Dias&#39;</span><span class="p">:</span> <span class="n">dias</span><span class="p">,</span>
                <span class="s1">&#39;Hora&#39;</span><span class="p">:</span> <span class="n">hora</span><span class="p">,</span>
                <span class="s1">&#39;RMSE&#39;</span><span class="p">:</span> <span class="n">rmse</span><span class="p">,</span>
                <span class="s1">&#39;MAPE&#39;</span><span class="p">:</span> <span class="n">mape</span><span class="p">,</span>
                <span class="s1">&#39;R^2&#39;</span><span class="p">:</span> <span class="n">r2</span><span class="p">,</span>
            <span class="p">})</span>           
            <span class="n">iniciotrain</span> <span class="o">=</span> <span class="n">fintrain</span>  <span class="c1"># Actualizar el inicio para el siguiente pliegue</span>
<span class="n">datalasso</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">metricas</span><span class="p">)</span>
<span class="n">datalasso</span> <span class="o">=</span> <span class="n">datalasso</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">datalasso</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;Modelo&#39;</span><span class="p">,</span> <span class="s1">&#39;Hora&#39;</span><span class="p">,</span> <span class="s1">&#39;Dias&#39;</span><span class="p">])[</span><span class="s1">&#39;RMSE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">idxmin</span><span class="p">()]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datalasso</span><span class="p">[</span><span class="n">datalasso</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>RMSE</th>
      <th>MAPE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Regresión Lasso</td>
      <td>7</td>
      <td>1</td>
      <td>0.368981</td>
      <td>0.168289</td>
      <td>0.452636</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Regresión Lasso</td>
      <td>14</td>
      <td>1</td>
      <td>0.399412</td>
      <td>0.110714</td>
      <td>0.468694</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Regresión Lasso</td>
      <td>21</td>
      <td>1</td>
      <td>0.396785</td>
      <td>0.265774</td>
      <td>0.887498</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Regresión Lasso</td>
      <td>28</td>
      <td>1</td>
      <td>0.401422</td>
      <td>0.105602</td>
      <td>0.463333</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datalasso</span><span class="p">[</span><span class="n">datalasso</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>RMSE</th>
      <th>MAPE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>4</th>
      <td>Regresión Lasso</td>
      <td>7</td>
      <td>2</td>
      <td>0.368618</td>
      <td>0.165260</td>
      <td>0.432809</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Regresión Lasso</td>
      <td>14</td>
      <td>2</td>
      <td>0.423962</td>
      <td>0.149215</td>
      <td>0.481896</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Regresión Lasso</td>
      <td>21</td>
      <td>2</td>
      <td>0.395329</td>
      <td>0.262716</td>
      <td>0.888162</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Regresión Lasso</td>
      <td>28</td>
      <td>2</td>
      <td>0.418688</td>
      <td>0.149074</td>
      <td>0.494708</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datalasso</span><span class="p">[</span><span class="n">datalasso</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">3</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>RMSE</th>
      <th>MAPE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>8</th>
      <td>Regresión Lasso</td>
      <td>7</td>
      <td>3</td>
      <td>0.374123</td>
      <td>0.166853</td>
      <td>0.421321</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Regresión Lasso</td>
      <td>14</td>
      <td>3</td>
      <td>0.428585</td>
      <td>0.213410</td>
      <td>0.240578</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Regresión Lasso</td>
      <td>21</td>
      <td>3</td>
      <td>0.389335</td>
      <td>0.255152</td>
      <td>0.889422</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Regresión Lasso</td>
      <td>28</td>
      <td>3</td>
      <td>0.463941</td>
      <td>0.164589</td>
      <td>0.409849</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datalasso</span><span class="p">[</span><span class="n">datalasso</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">4</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>RMSE</th>
      <th>MAPE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>12</th>
      <td>Regresión Lasso</td>
      <td>7</td>
      <td>4</td>
      <td>0.318170</td>
      <td>0.155022</td>
      <td>0.913595</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Regresión Lasso</td>
      <td>14</td>
      <td>4</td>
      <td>0.451624</td>
      <td>0.240959</td>
      <td>0.251506</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Regresión Lasso</td>
      <td>21</td>
      <td>4</td>
      <td>0.311801</td>
      <td>0.096583</td>
      <td>0.917019</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Regresión Lasso</td>
      <td>28</td>
      <td>4</td>
      <td>0.456726</td>
      <td>0.109916</td>
      <td>0.597868</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datalasso</span><span class="p">[</span><span class="n">datalasso</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">5</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>RMSE</th>
      <th>MAPE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>16</th>
      <td>Regresión Lasso</td>
      <td>7</td>
      <td>5</td>
      <td>0.319067</td>
      <td>0.149364</td>
      <td>0.909057</td>
    </tr>
    <tr>
      <th>17</th>
      <td>Regresión Lasso</td>
      <td>14</td>
      <td>5</td>
      <td>0.430070</td>
      <td>0.197111</td>
      <td>0.694667</td>
    </tr>
    <tr>
      <th>18</th>
      <td>Regresión Lasso</td>
      <td>21</td>
      <td>5</td>
      <td>0.317652</td>
      <td>0.096249</td>
      <td>0.909862</td>
    </tr>
    <tr>
      <th>19</th>
      <td>Regresión Lasso</td>
      <td>28</td>
      <td>5</td>
      <td>0.456057</td>
      <td>0.244318</td>
      <td>0.518794</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datalasso</span><span class="p">[</span><span class="n">datalasso</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">6</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>RMSE</th>
      <th>MAPE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>20</th>
      <td>Regresión Lasso</td>
      <td>7</td>
      <td>6</td>
      <td>0.305140</td>
      <td>0.139155</td>
      <td>0.782162</td>
    </tr>
    <tr>
      <th>21</th>
      <td>Regresión Lasso</td>
      <td>14</td>
      <td>6</td>
      <td>0.415432</td>
      <td>0.214048</td>
      <td>0.596229</td>
    </tr>
    <tr>
      <th>22</th>
      <td>Regresión Lasso</td>
      <td>21</td>
      <td>6</td>
      <td>0.317293</td>
      <td>0.094703</td>
      <td>0.908268</td>
    </tr>
    <tr>
      <th>23</th>
      <td>Regresión Lasso</td>
      <td>28</td>
      <td>6</td>
      <td>0.426467</td>
      <td>0.233496</td>
      <td>0.574495</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datalasso</span><span class="p">[</span><span class="n">datalasso</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">7</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>RMSE</th>
      <th>MAPE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>24</th>
      <td>Regresión Lasso</td>
      <td>7</td>
      <td>7</td>
      <td>0.300416</td>
      <td>0.126109</td>
      <td>0.913486</td>
    </tr>
    <tr>
      <th>25</th>
      <td>Regresión Lasso</td>
      <td>14</td>
      <td>7</td>
      <td>0.419248</td>
      <td>0.216781</td>
      <td>0.592273</td>
    </tr>
    <tr>
      <th>26</th>
      <td>Regresión Lasso</td>
      <td>21</td>
      <td>7</td>
      <td>0.309388</td>
      <td>0.080945</td>
      <td>0.908241</td>
    </tr>
    <tr>
      <th>27</th>
      <td>Regresión Lasso</td>
      <td>28</td>
      <td>7</td>
      <td>0.430497</td>
      <td>0.236362</td>
      <td>0.570100</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datalasso</span><span class="p">[</span><span class="n">datalasso</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">8</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>RMSE</th>
      <th>MAPE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>28</th>
      <td>Regresión Lasso</td>
      <td>7</td>
      <td>8</td>
      <td>0.307299</td>
      <td>1.384400e-01</td>
      <td>0.777806</td>
    </tr>
    <tr>
      <th>29</th>
      <td>Regresión Lasso</td>
      <td>14</td>
      <td>8</td>
      <td>0.415977</td>
      <td>2.129563e-01</td>
      <td>0.592855</td>
    </tr>
    <tr>
      <th>30</th>
      <td>Regresión Lasso</td>
      <td>21</td>
      <td>8</td>
      <td>0.402198</td>
      <td>2.395349e+14</td>
      <td>0.868745</td>
    </tr>
    <tr>
      <th>31</th>
      <td>Regresión Lasso</td>
      <td>28</td>
      <td>8</td>
      <td>0.422824</td>
      <td>1.736559e-01</td>
      <td>0.756157</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datalasso</span><span class="p">[</span><span class="n">datalasso</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">9</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>RMSE</th>
      <th>MAPE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>32</th>
      <td>Regresión Lasso</td>
      <td>7</td>
      <td>9</td>
      <td>0.323291</td>
      <td>1.518465e-01</td>
      <td>0.760334</td>
    </tr>
    <tr>
      <th>33</th>
      <td>Regresión Lasso</td>
      <td>14</td>
      <td>9</td>
      <td>0.432181</td>
      <td>1.542584e-01</td>
      <td>0.380695</td>
    </tr>
    <tr>
      <th>34</th>
      <td>Regresión Lasso</td>
      <td>21</td>
      <td>9</td>
      <td>0.410048</td>
      <td>2.395349e+14</td>
      <td>0.859033</td>
    </tr>
    <tr>
      <th>35</th>
      <td>Regresión Lasso</td>
      <td>28</td>
      <td>9</td>
      <td>0.418663</td>
      <td>1.681240e-01</td>
      <td>0.763398</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datalasso</span><span class="p">[</span><span class="n">datalasso</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">10</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>RMSE</th>
      <th>MAPE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>36</th>
      <td>Regresión Lasso</td>
      <td>7</td>
      <td>10</td>
      <td>0.321976</td>
      <td>1.495862e-01</td>
      <td>0.767246</td>
    </tr>
    <tr>
      <th>37</th>
      <td>Regresión Lasso</td>
      <td>14</td>
      <td>10</td>
      <td>0.436847</td>
      <td>1.527392e-01</td>
      <td>0.567308</td>
    </tr>
    <tr>
      <th>38</th>
      <td>Regresión Lasso</td>
      <td>21</td>
      <td>10</td>
      <td>0.409547</td>
      <td>2.395349e+14</td>
      <td>0.854340</td>
    </tr>
    <tr>
      <th>39</th>
      <td>Regresión Lasso</td>
      <td>28</td>
      <td>10</td>
      <td>0.423746</td>
      <td>1.687555e-01</td>
      <td>0.756062</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datalasso</span><span class="p">[</span><span class="n">datalasso</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">11</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>RMSE</th>
      <th>MAPE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>40</th>
      <td>Regresión Lasso</td>
      <td>7</td>
      <td>11</td>
      <td>0.323349</td>
      <td>0.153258</td>
      <td>0.768434</td>
    </tr>
    <tr>
      <th>41</th>
      <td>Regresión Lasso</td>
      <td>14</td>
      <td>11</td>
      <td>0.425532</td>
      <td>0.155849</td>
      <td>0.458121</td>
    </tr>
    <tr>
      <th>42</th>
      <td>Regresión Lasso</td>
      <td>21</td>
      <td>11</td>
      <td>0.448806</td>
      <td>0.189295</td>
      <td>0.231845</td>
    </tr>
    <tr>
      <th>43</th>
      <td>Regresión Lasso</td>
      <td>28</td>
      <td>11</td>
      <td>0.424228</td>
      <td>0.169126</td>
      <td>0.760285</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datalasso</span><span class="p">[</span><span class="n">datalasso</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">12</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>RMSE</th>
      <th>MAPE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>44</th>
      <td>Regresión Lasso</td>
      <td>7</td>
      <td>12</td>
      <td>0.323862</td>
      <td>0.151701</td>
      <td>0.760564</td>
    </tr>
    <tr>
      <th>45</th>
      <td>Regresión Lasso</td>
      <td>14</td>
      <td>12</td>
      <td>0.430762</td>
      <td>0.217817</td>
      <td>0.576410</td>
    </tr>
    <tr>
      <th>46</th>
      <td>Regresión Lasso</td>
      <td>21</td>
      <td>12</td>
      <td>0.438918</td>
      <td>0.161651</td>
      <td>0.402605</td>
    </tr>
    <tr>
      <th>47</th>
      <td>Regresión Lasso</td>
      <td>28</td>
      <td>12</td>
      <td>0.413283</td>
      <td>0.167845</td>
      <td>0.759691</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datalasso</span><span class="p">[</span><span class="n">datalasso</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">13</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>RMSE</th>
      <th>MAPE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>48</th>
      <td>Regresión Lasso</td>
      <td>7</td>
      <td>13</td>
      <td>0.323928</td>
      <td>0.151776</td>
      <td>0.760466</td>
    </tr>
    <tr>
      <th>49</th>
      <td>Regresión Lasso</td>
      <td>14</td>
      <td>13</td>
      <td>0.411266</td>
      <td>0.109840</td>
      <td>0.781241</td>
    </tr>
    <tr>
      <th>50</th>
      <td>Regresión Lasso</td>
      <td>21</td>
      <td>13</td>
      <td>0.452298</td>
      <td>0.243092</td>
      <td>0.532996</td>
    </tr>
    <tr>
      <th>51</th>
      <td>Regresión Lasso</td>
      <td>28</td>
      <td>13</td>
      <td>0.410531</td>
      <td>0.166050</td>
      <td>0.754634</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datalasso</span><span class="p">[</span><span class="n">datalasso</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">14</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>RMSE</th>
      <th>MAPE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>52</th>
      <td>Regresión Lasso</td>
      <td>7</td>
      <td>14</td>
      <td>0.339163</td>
      <td>0.171256</td>
      <td>0.756081</td>
    </tr>
    <tr>
      <th>53</th>
      <td>Regresión Lasso</td>
      <td>14</td>
      <td>14</td>
      <td>0.445802</td>
      <td>0.153290</td>
      <td>0.843562</td>
    </tr>
    <tr>
      <th>54</th>
      <td>Regresión Lasso</td>
      <td>21</td>
      <td>14</td>
      <td>0.450928</td>
      <td>0.321327</td>
      <td>0.558615</td>
    </tr>
    <tr>
      <th>55</th>
      <td>Regresión Lasso</td>
      <td>28</td>
      <td>14</td>
      <td>0.440404</td>
      <td>0.285712</td>
      <td>0.617075</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datalasso</span><span class="p">[</span><span class="n">datalasso</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">15</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>RMSE</th>
      <th>MAPE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>56</th>
      <td>Regresión Lasso</td>
      <td>7</td>
      <td>15</td>
      <td>0.341383</td>
      <td>0.177873</td>
      <td>0.769785</td>
    </tr>
    <tr>
      <th>57</th>
      <td>Regresión Lasso</td>
      <td>14</td>
      <td>15</td>
      <td>0.452397</td>
      <td>0.116035</td>
      <td>0.709240</td>
    </tr>
    <tr>
      <th>58</th>
      <td>Regresión Lasso</td>
      <td>21</td>
      <td>15</td>
      <td>0.439120</td>
      <td>0.200488</td>
      <td>0.198819</td>
    </tr>
    <tr>
      <th>59</th>
      <td>Regresión Lasso</td>
      <td>28</td>
      <td>15</td>
      <td>0.454461</td>
      <td>0.305376</td>
      <td>0.609237</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datalasso</span><span class="p">[</span><span class="n">datalasso</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">16</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>RMSE</th>
      <th>MAPE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>60</th>
      <td>Regresión Lasso</td>
      <td>7</td>
      <td>16</td>
      <td>0.399856</td>
      <td>1.922520e+14</td>
      <td>0.752589</td>
    </tr>
    <tr>
      <th>61</th>
      <td>Regresión Lasso</td>
      <td>14</td>
      <td>16</td>
      <td>0.418011</td>
      <td>1.130863e-01</td>
      <td>0.717595</td>
    </tr>
    <tr>
      <th>62</th>
      <td>Regresión Lasso</td>
      <td>21</td>
      <td>16</td>
      <td>0.420054</td>
      <td>2.996935e-01</td>
      <td>0.688845</td>
    </tr>
    <tr>
      <th>63</th>
      <td>Regresión Lasso</td>
      <td>28</td>
      <td>16</td>
      <td>0.424505</td>
      <td>1.586110e-01</td>
      <td>0.755286</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datalasso</span><span class="p">[</span><span class="n">datalasso</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">17</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>RMSE</th>
      <th>MAPE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>64</th>
      <td>Regresión Lasso</td>
      <td>7</td>
      <td>17</td>
      <td>0.426477</td>
      <td>0.127927</td>
      <td>0.319667</td>
    </tr>
    <tr>
      <th>65</th>
      <td>Regresión Lasso</td>
      <td>14</td>
      <td>17</td>
      <td>0.391981</td>
      <td>0.215983</td>
      <td>0.668929</td>
    </tr>
    <tr>
      <th>66</th>
      <td>Regresión Lasso</td>
      <td>21</td>
      <td>17</td>
      <td>0.410214</td>
      <td>0.229824</td>
      <td>0.637413</td>
    </tr>
    <tr>
      <th>67</th>
      <td>Regresión Lasso</td>
      <td>28</td>
      <td>17</td>
      <td>0.375944</td>
      <td>0.204339</td>
      <td>0.695464</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datalasso</span><span class="p">[</span><span class="n">datalasso</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">18</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>RMSE</th>
      <th>MAPE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>68</th>
      <td>Regresión Lasso</td>
      <td>7</td>
      <td>18</td>
      <td>0.439007</td>
      <td>0.186865</td>
      <td>0.638637</td>
    </tr>
    <tr>
      <th>69</th>
      <td>Regresión Lasso</td>
      <td>14</td>
      <td>18</td>
      <td>0.381775</td>
      <td>0.201099</td>
      <td>0.667473</td>
    </tr>
    <tr>
      <th>70</th>
      <td>Regresión Lasso</td>
      <td>21</td>
      <td>18</td>
      <td>0.398646</td>
      <td>0.213963</td>
      <td>0.637433</td>
    </tr>
    <tr>
      <th>71</th>
      <td>Regresión Lasso</td>
      <td>28</td>
      <td>18</td>
      <td>0.366928</td>
      <td>0.190000</td>
      <td>0.692834</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datalasso</span><span class="p">[</span><span class="n">datalasso</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">19</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>RMSE</th>
      <th>MAPE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>72</th>
      <td>Regresión Lasso</td>
      <td>7</td>
      <td>19</td>
      <td>0.443148</td>
      <td>0.141500</td>
      <td>0.379818</td>
    </tr>
    <tr>
      <th>73</th>
      <td>Regresión Lasso</td>
      <td>14</td>
      <td>19</td>
      <td>0.385675</td>
      <td>0.206322</td>
      <td>0.660966</td>
    </tr>
    <tr>
      <th>74</th>
      <td>Regresión Lasso</td>
      <td>21</td>
      <td>19</td>
      <td>0.399496</td>
      <td>0.290407</td>
      <td>0.726787</td>
    </tr>
    <tr>
      <th>75</th>
      <td>Regresión Lasso</td>
      <td>28</td>
      <td>19</td>
      <td>0.372554</td>
      <td>0.195331</td>
      <td>0.683642</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datalasso</span><span class="p">[</span><span class="n">datalasso</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">20</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>RMSE</th>
      <th>MAPE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>76</th>
      <td>Regresión Lasso</td>
      <td>7</td>
      <td>20</td>
      <td>0.426039</td>
      <td>0.138061</td>
      <td>0.347219</td>
    </tr>
    <tr>
      <th>77</th>
      <td>Regresión Lasso</td>
      <td>14</td>
      <td>20</td>
      <td>0.418930</td>
      <td>0.139000</td>
      <td>0.368822</td>
    </tr>
    <tr>
      <th>78</th>
      <td>Regresión Lasso</td>
      <td>21</td>
      <td>20</td>
      <td>0.413583</td>
      <td>0.297046</td>
      <td>0.707180</td>
    </tr>
    <tr>
      <th>79</th>
      <td>Regresión Lasso</td>
      <td>28</td>
      <td>20</td>
      <td>0.412628</td>
      <td>0.200703</td>
      <td>0.653399</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datalasso</span><span class="p">[</span><span class="n">datalasso</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">21</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>RMSE</th>
      <th>MAPE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>80</th>
      <td>Regresión Lasso</td>
      <td>7</td>
      <td>21</td>
      <td>0.420930</td>
      <td>0.292024</td>
      <td>0.873416</td>
    </tr>
    <tr>
      <th>81</th>
      <td>Regresión Lasso</td>
      <td>14</td>
      <td>21</td>
      <td>0.426938</td>
      <td>0.145776</td>
      <td>0.361331</td>
    </tr>
    <tr>
      <th>82</th>
      <td>Regresión Lasso</td>
      <td>21</td>
      <td>21</td>
      <td>0.412000</td>
      <td>0.167100</td>
      <td>0.269045</td>
    </tr>
    <tr>
      <th>83</th>
      <td>Regresión Lasso</td>
      <td>28</td>
      <td>21</td>
      <td>0.428843</td>
      <td>0.178188</td>
      <td>0.208060</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datalasso</span><span class="p">[</span><span class="n">datalasso</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">22</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>RMSE</th>
      <th>MAPE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>84</th>
      <td>Regresión Lasso</td>
      <td>7</td>
      <td>22</td>
      <td>0.404422</td>
      <td>0.189074</td>
      <td>0.603431</td>
    </tr>
    <tr>
      <th>85</th>
      <td>Regresión Lasso</td>
      <td>14</td>
      <td>22</td>
      <td>0.404536</td>
      <td>0.319797</td>
      <td>0.881733</td>
    </tr>
    <tr>
      <th>86</th>
      <td>Regresión Lasso</td>
      <td>21</td>
      <td>22</td>
      <td>0.388631</td>
      <td>0.144540</td>
      <td>0.186044</td>
    </tr>
    <tr>
      <th>87</th>
      <td>Regresión Lasso</td>
      <td>28</td>
      <td>22</td>
      <td>0.391008</td>
      <td>0.151126</td>
      <td>0.176058</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datalasso</span><span class="p">[</span><span class="n">datalasso</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">23</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>RMSE</th>
      <th>MAPE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>88</th>
      <td>Regresión Lasso</td>
      <td>7</td>
      <td>23</td>
      <td>0.411089</td>
      <td>0.281566</td>
      <td>0.877318</td>
    </tr>
    <tr>
      <th>89</th>
      <td>Regresión Lasso</td>
      <td>14</td>
      <td>23</td>
      <td>0.407402</td>
      <td>0.191968</td>
      <td>0.719740</td>
    </tr>
    <tr>
      <th>90</th>
      <td>Regresión Lasso</td>
      <td>21</td>
      <td>23</td>
      <td>0.417194</td>
      <td>0.202192</td>
      <td>0.706105</td>
    </tr>
    <tr>
      <th>91</th>
      <td>Regresión Lasso</td>
      <td>28</td>
      <td>23</td>
      <td>0.432371</td>
      <td>0.150714</td>
      <td>0.322895</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datalasso</span><span class="p">[</span><span class="n">datalasso</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">24</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>RMSE</th>
      <th>MAPE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>92</th>
      <td>Regresión Lasso</td>
      <td>7</td>
      <td>24</td>
      <td>0.379640</td>
      <td>0.252033</td>
      <td>0.891418</td>
    </tr>
    <tr>
      <th>93</th>
      <td>Regresión Lasso</td>
      <td>14</td>
      <td>24</td>
      <td>0.402607</td>
      <td>0.311397</td>
      <td>0.877882</td>
    </tr>
    <tr>
      <th>94</th>
      <td>Regresión Lasso</td>
      <td>21</td>
      <td>24</td>
      <td>0.426096</td>
      <td>0.231469</td>
      <td>0.717961</td>
    </tr>
    <tr>
      <th>95</th>
      <td>Regresión Lasso</td>
      <td>28</td>
      <td>24</td>
      <td>0.466937</td>
      <td>0.154161</td>
      <td>0.387238</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<section id="id3">
<h4><strong>MEJOR MODELO - CADA HORA</strong><a class="headerlink" href="#id3" title="Link to this heading">#</a></h4>
<p>Ahora mostraremos el  mejor modelo de cada hora.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mejorlassohora</span> <span class="o">=</span> <span class="n">mejormodelohora</span><span class="p">(</span><span class="n">particiones</span><span class="p">,</span> <span class="n">datalasso</span><span class="p">)</span>
<span class="n">mejorlassohora</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>RMSE</th>
      <th>MAPE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Regresión Lasso</td>
      <td>7</td>
      <td>1</td>
      <td>0.368981</td>
      <td>1.682892e-01</td>
      <td>0.452636</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Regresión Lasso</td>
      <td>7</td>
      <td>2</td>
      <td>0.368618</td>
      <td>1.652600e-01</td>
      <td>0.432809</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Regresión Lasso</td>
      <td>7</td>
      <td>3</td>
      <td>0.374123</td>
      <td>1.668525e-01</td>
      <td>0.421321</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Regresión Lasso</td>
      <td>21</td>
      <td>4</td>
      <td>0.311801</td>
      <td>9.658325e-02</td>
      <td>0.917019</td>
    </tr>
    <tr>
      <th>18</th>
      <td>Regresión Lasso</td>
      <td>21</td>
      <td>5</td>
      <td>0.317652</td>
      <td>9.624911e-02</td>
      <td>0.909862</td>
    </tr>
    <tr>
      <th>20</th>
      <td>Regresión Lasso</td>
      <td>7</td>
      <td>6</td>
      <td>0.305140</td>
      <td>1.391547e-01</td>
      <td>0.782162</td>
    </tr>
    <tr>
      <th>24</th>
      <td>Regresión Lasso</td>
      <td>7</td>
      <td>7</td>
      <td>0.300416</td>
      <td>1.261087e-01</td>
      <td>0.913486</td>
    </tr>
    <tr>
      <th>28</th>
      <td>Regresión Lasso</td>
      <td>7</td>
      <td>8</td>
      <td>0.307299</td>
      <td>1.384400e-01</td>
      <td>0.777806</td>
    </tr>
    <tr>
      <th>32</th>
      <td>Regresión Lasso</td>
      <td>7</td>
      <td>9</td>
      <td>0.323291</td>
      <td>1.518465e-01</td>
      <td>0.760334</td>
    </tr>
    <tr>
      <th>36</th>
      <td>Regresión Lasso</td>
      <td>7</td>
      <td>10</td>
      <td>0.321976</td>
      <td>1.495862e-01</td>
      <td>0.767246</td>
    </tr>
    <tr>
      <th>40</th>
      <td>Regresión Lasso</td>
      <td>7</td>
      <td>11</td>
      <td>0.323349</td>
      <td>1.532577e-01</td>
      <td>0.768434</td>
    </tr>
    <tr>
      <th>44</th>
      <td>Regresión Lasso</td>
      <td>7</td>
      <td>12</td>
      <td>0.323862</td>
      <td>1.517013e-01</td>
      <td>0.760564</td>
    </tr>
    <tr>
      <th>48</th>
      <td>Regresión Lasso</td>
      <td>7</td>
      <td>13</td>
      <td>0.323928</td>
      <td>1.517761e-01</td>
      <td>0.760466</td>
    </tr>
    <tr>
      <th>52</th>
      <td>Regresión Lasso</td>
      <td>7</td>
      <td>14</td>
      <td>0.339163</td>
      <td>1.712556e-01</td>
      <td>0.756081</td>
    </tr>
    <tr>
      <th>56</th>
      <td>Regresión Lasso</td>
      <td>7</td>
      <td>15</td>
      <td>0.341383</td>
      <td>1.778728e-01</td>
      <td>0.769785</td>
    </tr>
    <tr>
      <th>60</th>
      <td>Regresión Lasso</td>
      <td>7</td>
      <td>16</td>
      <td>0.399856</td>
      <td>1.922520e+14</td>
      <td>0.752589</td>
    </tr>
    <tr>
      <th>67</th>
      <td>Regresión Lasso</td>
      <td>28</td>
      <td>17</td>
      <td>0.375944</td>
      <td>2.043391e-01</td>
      <td>0.695464</td>
    </tr>
    <tr>
      <th>71</th>
      <td>Regresión Lasso</td>
      <td>28</td>
      <td>18</td>
      <td>0.366928</td>
      <td>1.900003e-01</td>
      <td>0.692834</td>
    </tr>
    <tr>
      <th>75</th>
      <td>Regresión Lasso</td>
      <td>28</td>
      <td>19</td>
      <td>0.372554</td>
      <td>1.953308e-01</td>
      <td>0.683642</td>
    </tr>
    <tr>
      <th>79</th>
      <td>Regresión Lasso</td>
      <td>28</td>
      <td>20</td>
      <td>0.412628</td>
      <td>2.007026e-01</td>
      <td>0.653399</td>
    </tr>
    <tr>
      <th>82</th>
      <td>Regresión Lasso</td>
      <td>21</td>
      <td>21</td>
      <td>0.412000</td>
      <td>1.671005e-01</td>
      <td>0.269045</td>
    </tr>
    <tr>
      <th>86</th>
      <td>Regresión Lasso</td>
      <td>21</td>
      <td>22</td>
      <td>0.388631</td>
      <td>1.445396e-01</td>
      <td>0.186044</td>
    </tr>
    <tr>
      <th>89</th>
      <td>Regresión Lasso</td>
      <td>14</td>
      <td>23</td>
      <td>0.407402</td>
      <td>1.919682e-01</td>
      <td>0.719740</td>
    </tr>
    <tr>
      <th>92</th>
      <td>Regresión Lasso</td>
      <td>7</td>
      <td>24</td>
      <td>0.379640</td>
      <td>2.520327e-01</td>
      <td>0.891418</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="hora-y-ventana-con-mejor-modelo-lasso">
<h4><strong>HORA Y VENTANA CON MEJOR MODELO LASSO</strong><a class="headerlink" href="#hora-y-ventana-con-mejor-modelo-lasso" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bestlasso</span> <span class="o">=</span> <span class="n">mejormodelotot</span><span class="p">(</span><span class="n">mejorlassohora</span><span class="p">)</span>
<span class="n">bestlasso</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>24</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Modelo</th>
      <td>Regresión Lasso</td>
    </tr>
    <tr>
      <th>Dias</th>
      <td>7</td>
    </tr>
    <tr>
      <th>Hora</th>
      <td>7</td>
    </tr>
    <tr>
      <th>RMSE</th>
      <td>0.300416</td>
    </tr>
    <tr>
      <th>MAPE</th>
      <td>0.126109</td>
    </tr>
    <tr>
      <th>R^2</th>
      <td>0.913486</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Es decir, para la <strong>Regresión Lasso</strong>, el mejor modelo se da cuando se trabaja con la <strong>HORA</strong>: <code class="docutils literal notranslate"><span class="pre">7</span></code> en la venta de predicción de <code class="docutils literal notranslate"><span class="pre">7</span> <span class="pre">días</span></code>. Veamos los valores de <strong>Ljung-Box p-value</strong> y <strong>Jarque-Bera p-value</strong>. Antes de ello, veamos cuáles son las pruebas de hipótesis para comprender mejor los p-valores que se nos arrojen.</p>
<ul class="simple">
<li><p><strong>Prueba de Ljung-Box</strong></p></li>
</ul>
<ul class="simple">
<li><p><strong>Hipótesis nula (H₀)</strong>: No hay autocorrelación en los residuos (es decir, los residuos son independientes entre sí).</p></li>
<li><p><strong>Hipótesis alternativa (H₁)</strong>: Hay autocorrelación en los residuos</p></li>
</ul>
<ul class="simple">
<li><p><strong>Prueba de Jarque-Bera</strong></p></li>
</ul>
<ul class="simple">
<li><p><strong>Hipótesis nula (H₀)</strong>: Los residuos tienen una distribución normal.</p></li>
<li><p><strong>Hipótesis alternativa (H₁)</strong>: Los residuos no tienen una distribución normal.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">metricas</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">dias</span> <span class="o">=</span> <span class="mi">7</span>
<span class="n">hora</span> <span class="o">=</span> <span class="mi">7</span>
<span class="n">iniciotrain</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">while</span> <span class="p">(</span><span class="n">iniciotrain</span> <span class="o">+</span> <span class="p">(</span><span class="n">dias</span> <span class="o">*</span> <span class="mi">24</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">):</span>  <span class="c1"># Mientras que el tamaño del pliegue más la hora sea menor que la longitud de los datos</span>
    <span class="n">fintrain</span> <span class="o">=</span> <span class="n">iniciotrain</span> <span class="o">+</span> <span class="p">(</span><span class="n">dias</span> <span class="o">*</span> <span class="mi">24</span><span class="p">)</span>   
    <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">plieguess</span><span class="p">(</span><span class="n">iniciotrain</span><span class="p">,</span> <span class="n">fintrain</span><span class="p">,</span> <span class="n">hora</span><span class="p">)</span>   
    <span class="n">modelolasso</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
    <span class="n">y_prediccion</span><span class="o">=</span> <span class="n">modelolasso</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>       
    <span class="n">rmse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">,</span> <span class="n">squared</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">mape</span> <span class="o">=</span> <span class="n">mean_absolute_percentage_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">)</span>
    <span class="n">r2</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">)</span>
    <span class="n">ljungbox</span><span class="p">,</span> <span class="n">jarquebera</span> <span class="o">=</span> <span class="n">residuos</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">)</span>   
    <span class="n">metricas</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
        <span class="s1">&#39;Modelo&#39;</span><span class="p">:</span> <span class="s1">&#39;Regresión Lasso&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Dias&#39;</span><span class="p">:</span> <span class="n">dias</span><span class="p">,</span>
        <span class="s1">&#39;Hora&#39;</span><span class="p">:</span> <span class="n">hora</span><span class="p">,</span>
        <span class="s1">&#39;MAPE&#39;</span><span class="p">:</span> <span class="n">mape</span><span class="p">,</span>
        <span class="s1">&#39;RMSE&#39;</span><span class="p">:</span> <span class="n">rmse</span><span class="p">,</span>
        <span class="s1">&#39;R^2&#39;</span><span class="p">:</span> <span class="n">r2</span><span class="p">,</span>
        <span class="s1">&#39;Ljung-Box p-value&#39;</span> <span class="p">:</span> <span class="n">ljungbox</span><span class="p">,</span>
        <span class="s1">&#39;Jarque-Bera p-value&#39;</span> <span class="p">:</span> <span class="n">jarquebera</span>
    <span class="p">})</span>   
    <span class="n">iniciotrain</span> <span class="o">=</span> <span class="n">fintrain</span>  <span class="c1"># Actualizar el inicio para el siguiente pliegue</span>
<span class="n">datalasso</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">metricas</span><span class="p">)</span>
<span class="n">datalasso</span> <span class="o">=</span> <span class="n">datalasso</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">datalasso</span><span class="p">[</span><span class="s1">&#39;RMSE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">idxmin</span><span class="p">()]</span>
<span class="n">datalasso</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">datalasso</span><span class="p">)</span>
<span class="n">datalasso</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>92</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Modelo</th>
      <td>Regresión Lasso</td>
    </tr>
    <tr>
      <th>Dias</th>
      <td>7</td>
    </tr>
    <tr>
      <th>Hora</th>
      <td>7</td>
    </tr>
    <tr>
      <th>MAPE</th>
      <td>0.126109</td>
    </tr>
    <tr>
      <th>RMSE</th>
      <td>0.300416</td>
    </tr>
    <tr>
      <th>R^2</th>
      <td>0.913486</td>
    </tr>
    <tr>
      <th>Ljung-Box p-value</th>
      <td>0.298656</td>
    </tr>
    <tr>
      <th>Jarque-Bera p-value</th>
      <td>0.110608</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>En el modelo de Regresión Lasso, observamos un <strong>MAPE</strong> de <code class="docutils literal notranslate"><span class="pre">0.12</span></code>, lo que indica que, en promedio, las predicciones del modelo se desvían un <code class="docutils literal notranslate"><span class="pre">12.61%</span></code> de los valores reales, lo que sugiere un rendimiento razonable. El <strong>RMSE</strong> es de <code class="docutils literal notranslate"><span class="pre">0.3</span></code>, lo que significa que el error promedio en las predicciones es bajo, y el modelo está prediciendo con bastante precisión. Además, el <strong>R²</strong> de <code class="docutils literal notranslate"><span class="pre">0.913486</span></code> muestra que el modelo explica aproximadamente el <code class="docutils literal notranslate"><span class="pre">91.35%</span></code> de la variabilidad de los datos.</p>
<p>Respecto a los residuos, el <strong>p-valor</strong> de la prueba de <strong>Ljung-Box</strong> es <code class="docutils literal notranslate"><span class="pre">0.29</span></code>, lo que indica que no hay autocorrelación significativa, lo cual es positivo ya que significa que los residuos son independientes. Por otro lado, el <strong>p-valor</strong> de la prueba de <strong>Jarque-Bera</strong> es <code class="docutils literal notranslate"><span class="pre">0.11</span></code>, lo que sugiere que no se puede rechazar la hipótesis de normalidad de los residuos, lo cual es deseable para validar las inferencias del modelo.</p>
</section>
</section>
</section>
<section id="mejores-modelos-de-regresion">
<h2><strong>MEJORES MODELOS DE REGRESIÓN</strong><a class="headerlink" href="#mejores-modelos-de-regresion" title="Link to this heading">#</a></h2>
<p>Ahora, veamos en una misma tabla, el mejor modelo resultante para cada uno de los 4 realizados.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">knn</span> <span class="o">=</span> <span class="n">mejorknnhora</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">mejorknnhora</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">8</span><span class="p">]</span>
<span class="n">lineal</span> <span class="o">=</span> <span class="n">mejorreglinhora</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">mejorreglinhora</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">24</span><span class="p">]</span>
<span class="n">ridge</span> <span class="o">=</span> <span class="n">mejorridgehora</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">mejorridgehora</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">24</span><span class="p">]</span>
<span class="n">lasso</span> <span class="o">=</span> <span class="n">mejorlassohora</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">mejorlassohora</span><span class="p">[</span><span class="s1">&#39;Hora&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">7</span><span class="p">]</span>

<span class="n">best</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">knn</span><span class="p">,</span> <span class="n">lineal</span><span class="p">,</span> <span class="n">ridge</span><span class="p">,</span> <span class="n">lasso</span><span class="p">])</span>
<span class="n">best</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>Dias</th>
      <th>Hora</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R^2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>31</th>
      <td>Regresión KNN</td>
      <td>28</td>
      <td>8</td>
      <td>0.139310</td>
      <td>0.372805</td>
      <td>0.846283</td>
    </tr>
    <tr>
      <th>94</th>
      <td>Regresión Lineal</td>
      <td>21</td>
      <td>24</td>
      <td>0.133838</td>
      <td>0.284638</td>
      <td>0.874142</td>
    </tr>
    <tr>
      <th>94</th>
      <td>Regresión Ridge</td>
      <td>21</td>
      <td>24</td>
      <td>0.133779</td>
      <td>0.284339</td>
      <td>0.874406</td>
    </tr>
    <tr>
      <th>24</th>
      <td>Regresión Lasso</td>
      <td>7</td>
      <td>7</td>
      <td>0.126109</td>
      <td>0.300416</td>
      <td>0.913486</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>La tabla resultante muestra los mejores modelos obtenidos en este ejercicio de entrenamiento. Cada modelo fue seleccionado en función de la métrica RMSE, eligiendo el modelo con el menor valor de RMSE dentro de cada una de las 4 ventanas de predicción y las 24 horas del día. De este modo, hemos identificado los modelos que mejor predicen la velocidad del viento para cada tipo de modelo de regresión. Ahora, entre estos, veamos cuál es el mejor, es decir, aquel que presente el menor RMSE de todos, destacando así el modelo que ofrece la mayor precisión en la predicción de la velocidad del viento horaria.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bestpred</span> <span class="o">=</span> <span class="n">mejormodelotot</span><span class="p">(</span><span class="n">best</span><span class="p">)</span>
<span class="n">bestpred</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>94</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Modelo</th>
      <td>Regresión Ridge</td>
    </tr>
    <tr>
      <th>Dias</th>
      <td>21</td>
    </tr>
    <tr>
      <th>Hora</th>
      <td>24</td>
    </tr>
    <tr>
      <th>MAPE</th>
      <td>0.133779</td>
    </tr>
    <tr>
      <th>RMSE</th>
      <td>0.284339</td>
    </tr>
    <tr>
      <th>R^2</th>
      <td>0.874406</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Observamos que entonces el mejor de los 4 fue <strong>Ridge</strong>.</p>
<p>El siguiente paso es aplicar el algoritmo de <strong>Optimización Bayesiana</strong> para ajustar los hiperparámetros de cada modelo y mejorar aún más su rendimiento. Para ello, utilizaremos la función <strong>gp_minimize</strong> de la librería previamente explicada en nuestro informe, la cual nos permitirá encontrar los mejores valores para los hiperparámetros de los modelos de manera eficiente.</p>
<section id="optimizacion-bayesiana">
<h3><strong>Optimización Bayesiana</strong><a class="headerlink" href="#optimizacion-bayesiana" title="Link to this heading">#</a></h3>
<p>Los siguientes algoritmos fueron construidos con base en diferentes fuentes consultadas en internet, tales como Medium y ChatGPT.</p>
<p>Cabe resaltar que al modelo de Regresión Lineal no se le aplica pues este no cuenta conn hiperparámetros.</p>
<section id="id4">
<h4><strong>MODELO KNN</strong><a class="headerlink" href="#id4" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Espacio de búsqueda</span>
<span class="n">espaciobusqueda_knn</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;n_neighbors&#39;</span><span class="p">),</span>  <span class="c1"># Número de vecinos en KNN</span>
    <span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;p&#39;</span><span class="p">),</span>  <span class="c1"># Parámetro para la métrica de distancia (1: Manhattan, 2: Euclidiana, etc.)</span>
<span class="p">]</span>

<span class="c1"># Función objetivo</span>
<span class="k">def</span> <span class="nf">funcionobjetivo_knn</span><span class="p">(</span><span class="n">params</span><span class="p">):</span>
    <span class="n">n_neighbors</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">mejorknn</span> <span class="o">=</span> <span class="n">KNeighborsRegressor</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="n">n_neighbors</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">)</span>
    
    <span class="c1"># Obtener los pliegues </span>
    <span class="n">conjuntopliegues</span> <span class="o">=</span> <span class="n">pliegues</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>  
    
    <span class="n">mse_total</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">num_pliegues</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">conjuntopliegues</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">train_indices</span><span class="p">,</span> <span class="n">test_indices</span> <span class="ow">in</span> <span class="n">conjuntopliegues</span><span class="p">:</span>
        
        <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">train_indices</span><span class="p">],</span> <span class="n">X</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">test_indices</span><span class="p">]</span>
        <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">train_indices</span><span class="p">],</span> <span class="n">y</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">test_indices</span><span class="p">]</span>
        
       
        <span class="n">mejorknn</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
        <span class="n">y_pred</span> <span class="o">=</span> <span class="n">mejorknn</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
        
        <span class="n">mse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="n">y_test</span> <span class="o">-</span> <span class="n">y_pred</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">mse_total</span> <span class="o">+=</span> <span class="n">mse</span>

    <span class="n">mse_promedio</span> <span class="o">=</span> <span class="n">mse_total</span> <span class="o">/</span> <span class="n">num_pliegues</span>
    
    <span class="c1"># Devolver el MSE promedio como la función de pérdida que gp_minimize minimizará</span>
    <span class="k">return</span> <span class="n">mse_promedio</span>

<span class="n">result</span> <span class="o">=</span> <span class="n">gp_minimize</span><span class="p">(</span><span class="n">funcionobjetivo_knn</span><span class="p">,</span> <span class="n">espaciobusqueda_knn</span><span class="p">,</span> <span class="n">n_calls</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>


<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mejores hiperparámetros: n_neighbors = </span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, p = </span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Mejores hiperparámetros: n_neighbors = 4, p = 3
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">modeloknn</span> <span class="o">=</span> <span class="n">KNeighborsRegressor</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">metricas</span><span class="o">=</span> <span class="p">[]</span>
<span class="n">dias</span> <span class="o">=</span> <span class="mi">28</span>
<span class="n">hora</span> <span class="o">=</span> <span class="mi">8</span>
<span class="n">iniciotrain</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># Se inicializa en 0 para que al realizar la suma no se vaya un día más.     </span>
<span class="k">while</span> <span class="p">(</span><span class="n">iniciotrain</span> <span class="o">+</span> <span class="p">(</span><span class="n">dias</span> <span class="o">*</span> <span class="mi">24</span><span class="p">)</span> <span class="o">+</span> <span class="n">hora</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">):</span>  <span class="c1"># Mientras que el tamaño del pliegue más la hora en la que se está iterando sea menor que la longitud de los datos           </span>
    <span class="n">fintrain</span> <span class="o">=</span> <span class="n">iniciotrain</span> <span class="o">+</span> <span class="p">(</span><span class="n">dias</span> <span class="o">*</span> <span class="mi">24</span><span class="p">)</span> <span class="c1"># Se suma con dias*24 porque es la cantidad de observaciones a escoger. La cantidad de horas totales teniendo en cuanta la cantidad de días.          </span>
    <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">plieguess</span><span class="p">(</span><span class="n">iniciotrain</span><span class="p">,</span> <span class="n">fintrain</span><span class="p">,</span> <span class="n">hora</span><span class="p">)</span>           
    <span class="n">modeloknn</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
    <span class="n">y_prediccion</span><span class="o">=</span> <span class="n">modeloknn</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>               
    <span class="n">rmse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">,</span> <span class="n">squared</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">mape</span> <span class="o">=</span> <span class="n">mean_absolute_percentage_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">)</span>
    <span class="n">r2</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">)</span>
    <span class="n">ljungbox</span><span class="p">,</span> <span class="n">jarquebera</span> <span class="o">=</span> <span class="n">residuos</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">)</span>         
    <span class="n">metricas</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
        <span class="s1">&#39;Modelo&#39;</span><span class="p">:</span> <span class="s1">&#39;Regresión KNN&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Dias&#39;</span><span class="p">:</span> <span class="n">dias</span><span class="p">,</span>
        <span class="s1">&#39;Hora&#39;</span><span class="p">:</span> <span class="n">hora</span><span class="p">,</span>
        <span class="s1">&#39;MAPE&#39;</span><span class="p">:</span> <span class="n">mape</span><span class="p">,</span>
        <span class="s1">&#39;RMSE&#39;</span><span class="p">:</span> <span class="n">rmse</span><span class="p">,</span>
        <span class="s1">&#39;R^2&#39;</span><span class="p">:</span> <span class="n">r2</span><span class="p">,</span>
        <span class="s1">&#39;Ljung-Box p-value&#39;</span> <span class="p">:</span> <span class="n">ljungbox</span><span class="p">,</span>
        <span class="s1">&#39;Jarque-Bera p-value&#39;</span> <span class="p">:</span> <span class="n">jarquebera</span>
    <span class="p">})</span>           
    <span class="n">iniciotrain</span> <span class="o">=</span> <span class="n">fintrain</span>  <span class="c1"># Se actualiza a la última posición del pliegue actual</span>
<span class="n">dataknn</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">metricas</span><span class="p">)</span>
<span class="n">dataknn</span> <span class="o">=</span> <span class="n">dataknn</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dataknn</span><span class="p">[</span><span class="s1">&#39;RMSE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">idxmin</span><span class="p">()]</span>
<span class="n">dataknn</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">dataknn</span><span class="p">)</span>
<span class="n">dataknn</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Modelo</th>
      <td>Regresión KNN</td>
    </tr>
    <tr>
      <th>Dias</th>
      <td>28</td>
    </tr>
    <tr>
      <th>Hora</th>
      <td>8</td>
    </tr>
    <tr>
      <th>MAPE</th>
      <td>0.160533</td>
    </tr>
    <tr>
      <th>RMSE</th>
      <td>0.406618</td>
    </tr>
    <tr>
      <th>R^2</th>
      <td>0.817134</td>
    </tr>
    <tr>
      <th>Ljung-Box p-value</th>
      <td>0.273939</td>
    </tr>
    <tr>
      <th>Jarque-Bera p-value</th>
      <td>0.322049</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">metricas</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">dias</span> <span class="o">=</span> <span class="mi">28</span>
<span class="n">hora</span> <span class="o">=</span> <span class="mi">8</span>
<span class="n">iniciotrain</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">while</span> <span class="p">(</span><span class="n">iniciotrain</span> <span class="o">+</span> <span class="p">(</span><span class="n">dias</span> <span class="o">*</span> <span class="mi">24</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">):</span>  <span class="c1"># Mientras que el tamaño del pliegue más la hora sea menor que la longitud de los datos</span>
    <span class="n">fintrain</span> <span class="o">=</span> <span class="n">iniciotrain</span> <span class="o">+</span> <span class="p">(</span><span class="n">dias</span> <span class="o">*</span> <span class="mi">24</span><span class="p">)</span>   
    <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">plieguess</span><span class="p">(</span><span class="n">iniciotrain</span><span class="p">,</span> <span class="n">fintrain</span><span class="p">,</span> <span class="n">hora</span><span class="p">)</span>   
    <span class="n">modeloknn</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
    
    <span class="c1"># Entrenamiento</span>
    <span class="n">y_predicciontrain</span> <span class="o">=</span> <span class="n">modeloridge</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
    <span class="n">rmsetrain</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_predicciontrain</span><span class="p">,</span> <span class="n">squared</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">mapetrain</span> <span class="o">=</span> <span class="n">mean_absolute_percentage_error</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_predicciontrain</span><span class="p">)</span>
    <span class="n">r2train</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_predicciontrain</span><span class="p">)</span>
    
    <span class="c1"># Test</span>
    <span class="n">y_prediccion</span> <span class="o">=</span> <span class="n">modeloridge</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>       
    <span class="n">rmse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">,</span> <span class="n">squared</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">mape</span> <span class="o">=</span> <span class="n">mean_absolute_percentage_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">)</span>
    <span class="n">r2</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">)</span>
    
    <span class="n">ljungbox</span><span class="p">,</span> <span class="n">jarquebera</span> <span class="o">=</span> <span class="n">residuos</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">)</span>   
    <span class="n">metricas</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
        <span class="s1">&#39;Modelo&#39;</span><span class="p">:</span> <span class="s1">&#39;Regresión KNN&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Dias&#39;</span><span class="p">:</span> <span class="n">dias</span><span class="p">,</span>
        <span class="s1">&#39;Hora&#39;</span><span class="p">:</span> <span class="n">hora</span><span class="p">,</span>
        <span class="s1">&#39;MAPE&#39;</span><span class="p">:</span> <span class="n">mape</span><span class="p">,</span>
        <span class="s1">&#39;RMSE&#39;</span><span class="p">:</span> <span class="n">rmse</span><span class="p">,</span>
        <span class="s1">&#39;R^2&#39;</span><span class="p">:</span> <span class="n">r2</span><span class="p">,</span>
        <span class="s1">&#39;Ljung-Box p-value&#39;</span><span class="p">:</span> <span class="n">ljungbox</span><span class="p">,</span>
        <span class="s1">&#39;Jarque-Bera p-value&#39;</span><span class="p">:</span> <span class="n">jarquebera</span>
    <span class="p">})</span>   
    <span class="n">iniciotrain</span> <span class="o">=</span> <span class="n">fintrain</span>  <span class="c1"># Actualizar el inicio para el siguiente pliegue</span>

<span class="c1"># Gráfico con lineplot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="c1"># Conjunto de entrenamiento</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y_train</span><span class="p">)),</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Velocidad del viento original&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y_predicciontrain</span><span class="p">)),</span> <span class="n">y_predicciontrain</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Velocidad del viento predicha&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#9A32CD&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Índice&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Velocidad del viento&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Regresión KNN (Entrenamiento)</span><span class="se">\n</span><span class="s2">R²: </span><span class="si">{</span><span class="n">r2train</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, RMSE: </span><span class="si">{</span><span class="n">rmsetrain</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="c1"># Conjunto de prueba</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y_test</span><span class="p">)),</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Velocidad del viento original&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y_prediccion</span><span class="p">)),</span> <span class="n">y_prediccion</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Velocidad del viento predicha&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#6B8E23&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Índice&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Velocidad del viento&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Regresión KNN (Prueba)</span><span class="se">\n</span><span class="s2">R²: </span><span class="si">{</span><span class="n">r2</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, RMSE: </span><span class="si">{</span><span class="n">rmse</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="c1"># Mostrar gráfico</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/d152407ec848c45d1e7a8048d6d762c7c1b85839e03c68d3fc62d7bcce486019.png" src="_images/d152407ec848c45d1e7a8048d6d762c7c1b85839e03c68d3fc62d7bcce486019.png" />
</div>
</div>
<p>Al observar la gráfica del conjunto de entrenamiento, podemos concluir que el modelo es bastante bueno, ya que presenta un coeficiente de determinación (R²) de <code class="docutils literal notranslate"><span class="pre">0.72</span></code> y un error cuadrático medio (RMSE) de <code class="docutils literal notranslate"><span class="pre">0.58</span></code>. Esto se refleja en que las líneas correspondientes a la velocidad del viento predicha siguen prácticamente la misma tendencia que los datos reales del conjunto de entrenamiento.</p>
<p>En cuanto al conjunto de prueba, el modelo presenta un R² de <code class="docutils literal notranslate"><span class="pre">0.72</span></code> y un RMSE de <code class="docutils literal notranslate"><span class="pre">0.54</span></code>. Aunque en su mayoría las predicciones siguen de manera coherente el comportamiento de los datos originales, se observan pequeños segmentos donde las predicciones se desvían ligeramente de la tendencia real.</p>
</section>
<section id="modelo-ridge">
<h4><strong>MODELO RIDGE</strong><a class="headerlink" href="#modelo-ridge" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># ESPACIO DE BÚSQUEDA</span>
<span class="n">espaciobusqueda</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">Real</span><span class="p">(</span><span class="mf">0.001</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;alpha&#39;</span><span class="p">),</span>  <span class="c1"># Alpha es el parámetro de regularización en Ridge</span>
<span class="p">]</span>

<span class="c1"># FUNCIÓN OBJETIVO</span>
<span class="k">def</span> <span class="nf">funcionobjetivo</span><span class="p">(</span><span class="n">params</span><span class="p">):</span>
    <span class="n">alpha</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># Parámetro es alpha</span>
    
    <span class="c1"># Modelo con parámetro</span>
    <span class="n">mejorridge</span> <span class="o">=</span> <span class="n">Ridge</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">)</span>
    
    <span class="c1"># Obtener los pliegues </span>
    <span class="n">conjuntopliegues</span> <span class="o">=</span> <span class="n">pliegues</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">21</span><span class="p">)</span>  
    
    <span class="n">mse_total</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">num_pliegues</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">conjuntopliegues</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">train_indices</span><span class="p">,</span> <span class="n">test_indices</span> <span class="ow">in</span> <span class="n">conjuntopliegues</span><span class="p">:</span>
        
        <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">train_indices</span><span class="p">],</span> <span class="n">X</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">test_indices</span><span class="p">]</span>
        <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">train_indices</span><span class="p">],</span> <span class="n">y</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">test_indices</span><span class="p">]</span>
        
       
        <span class="n">mejorridge</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
        <span class="n">y_pred</span> <span class="o">=</span> <span class="n">mejorridge</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
        
        <span class="n">mse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="n">y_test</span> <span class="o">-</span> <span class="n">y_pred</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">mse_total</span> <span class="o">+=</span> <span class="n">mse</span>

    <span class="n">mse_promedio</span> <span class="o">=</span> <span class="n">mse_total</span> <span class="o">/</span> <span class="n">num_pliegues</span>
    
    <span class="c1"># Devolver el MSE promedio como la función de pérdida que gp_minimize minimizará</span>
    <span class="k">return</span> <span class="n">mse_promedio</span>

<span class="n">result</span> <span class="o">=</span> <span class="n">gp_minimize</span><span class="p">(</span><span class="n">funcionobjetivo</span><span class="p">,</span> <span class="n">espaciobusqueda</span><span class="p">,</span> <span class="n">n_calls</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>


<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mejores hiperparámetros: alpha = </span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Mejores hiperparámetros: alpha = 10.0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">modeloridge</span> <span class="o">=</span> <span class="n">Ridge</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">metricas</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">dias</span> <span class="o">=</span> <span class="mi">21</span>
<span class="n">hora</span> <span class="o">=</span> <span class="mi">24</span>
<span class="n">iniciotrain</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">while</span> <span class="p">(</span><span class="n">iniciotrain</span> <span class="o">+</span> <span class="p">(</span><span class="n">dias</span> <span class="o">*</span> <span class="mi">24</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">):</span>  
    <span class="n">fintrain</span> <span class="o">=</span> <span class="n">iniciotrain</span> <span class="o">+</span> <span class="p">(</span><span class="n">dias</span> <span class="o">*</span> <span class="mi">24</span><span class="p">)</span>   
    <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">plieguess</span><span class="p">(</span><span class="n">iniciotrain</span><span class="p">,</span> <span class="n">fintrain</span><span class="p">,</span> <span class="n">hora</span><span class="p">)</span>   
    <span class="n">modeloridge</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
    <span class="n">y_prediccion</span><span class="o">=</span> <span class="n">modeloridge</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>       
    <span class="n">rmse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">,</span> <span class="n">squared</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">mape</span> <span class="o">=</span> <span class="n">mean_absolute_percentage_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">)</span>
    <span class="n">r2</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">)</span>
    <span class="n">ljungbox</span><span class="p">,</span> <span class="n">jarquebera</span> <span class="o">=</span> <span class="n">residuos</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">)</span>   
    <span class="n">metricas</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
        <span class="s1">&#39;Modelo&#39;</span><span class="p">:</span> <span class="s1">&#39;Regresión Ridge&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Dias&#39;</span><span class="p">:</span> <span class="n">dias</span><span class="p">,</span>
        <span class="s1">&#39;Hora&#39;</span><span class="p">:</span> <span class="n">hora</span><span class="p">,</span>
        <span class="s1">&#39;MAPE&#39;</span><span class="p">:</span> <span class="n">mape</span><span class="p">,</span>
        <span class="s1">&#39;RMSE&#39;</span><span class="p">:</span> <span class="n">rmse</span><span class="p">,</span>
        <span class="s1">&#39;R^2&#39;</span><span class="p">:</span> <span class="n">r2</span><span class="p">,</span>
        <span class="s1">&#39;Ljung-Box p-value&#39;</span> <span class="p">:</span> <span class="n">ljungbox</span><span class="p">,</span>
        <span class="s1">&#39;Jarque-Bera p-value&#39;</span> <span class="p">:</span> <span class="n">jarquebera</span>
    <span class="p">})</span>   
    <span class="n">iniciotrain</span> <span class="o">=</span> <span class="n">fintrain</span>  
<span class="n">dataridge</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">metricas</span><span class="p">)</span>
<span class="n">dataridge</span> <span class="o">=</span> <span class="n">dataridge</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dataridge</span><span class="p">[</span><span class="s1">&#39;RMSE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">idxmin</span><span class="p">()]</span>
<span class="n">dataridge</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">dataridge</span><span class="p">)</span>
<span class="n">dataridge</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Modelo</th>
      <td>Regresión Ridge</td>
    </tr>
    <tr>
      <th>Dias</th>
      <td>21</td>
    </tr>
    <tr>
      <th>Hora</th>
      <td>24</td>
    </tr>
    <tr>
      <th>MAPE</th>
      <td>0.133656</td>
    </tr>
    <tr>
      <th>RMSE</th>
      <td>0.283596</td>
    </tr>
    <tr>
      <th>R^2</th>
      <td>0.875062</td>
    </tr>
    <tr>
      <th>Ljung-Box p-value</th>
      <td>0.384846</td>
    </tr>
    <tr>
      <th>Jarque-Bera p-value</th>
      <td>0.195623</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">metricas</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">dias</span> <span class="o">=</span> <span class="mi">21</span>
<span class="n">hora</span> <span class="o">=</span> <span class="mi">24</span>
<span class="n">iniciotrain</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">while</span> <span class="p">(</span><span class="n">iniciotrain</span> <span class="o">+</span> <span class="p">(</span><span class="n">dias</span> <span class="o">*</span> <span class="mi">24</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">):</span>  <span class="c1"># Mientras que el tamaño del pliegue más la hora sea menor que la longitud de los datos</span>
    <span class="n">fintrain</span> <span class="o">=</span> <span class="n">iniciotrain</span> <span class="o">+</span> <span class="p">(</span><span class="n">dias</span> <span class="o">*</span> <span class="mi">24</span><span class="p">)</span>   
    <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">plieguess</span><span class="p">(</span><span class="n">iniciotrain</span><span class="p">,</span> <span class="n">fintrain</span><span class="p">,</span> <span class="n">hora</span><span class="p">)</span>   
    <span class="n">modeloridge</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
    
    <span class="c1"># Entrenamiento</span>
    <span class="n">y_predicciontrain</span> <span class="o">=</span> <span class="n">modeloridge</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
    <span class="n">rmsetrain</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_predicciontrain</span><span class="p">,</span> <span class="n">squared</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">mapetrain</span> <span class="o">=</span> <span class="n">mean_absolute_percentage_error</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_predicciontrain</span><span class="p">)</span>
    <span class="n">r2train</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_predicciontrain</span><span class="p">)</span>
    
    <span class="c1"># Test</span>
    <span class="n">y_prediccion</span> <span class="o">=</span> <span class="n">modeloridge</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>       
    <span class="n">rmse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">,</span> <span class="n">squared</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">mape</span> <span class="o">=</span> <span class="n">mean_absolute_percentage_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">)</span>
    <span class="n">r2</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">)</span>
    
    <span class="n">ljungbox</span><span class="p">,</span> <span class="n">jarquebera</span> <span class="o">=</span> <span class="n">residuos</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">)</span>   
    <span class="n">metricas</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
        <span class="s1">&#39;Modelo&#39;</span><span class="p">:</span> <span class="s1">&#39;Regresión Ridge&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Dias&#39;</span><span class="p">:</span> <span class="n">dias</span><span class="p">,</span>
        <span class="s1">&#39;Hora&#39;</span><span class="p">:</span> <span class="n">hora</span><span class="p">,</span>
        <span class="s1">&#39;MAPE&#39;</span><span class="p">:</span> <span class="n">mape</span><span class="p">,</span>
        <span class="s1">&#39;RMSE&#39;</span><span class="p">:</span> <span class="n">rmse</span><span class="p">,</span>
        <span class="s1">&#39;R^2&#39;</span><span class="p">:</span> <span class="n">r2</span><span class="p">,</span>
        <span class="s1">&#39;Ljung-Box p-value&#39;</span><span class="p">:</span> <span class="n">ljungbox</span><span class="p">,</span>
        <span class="s1">&#39;Jarque-Bera p-value&#39;</span><span class="p">:</span> <span class="n">jarquebera</span>
    <span class="p">})</span>   
    <span class="n">iniciotrain</span> <span class="o">=</span> <span class="n">fintrain</span>  <span class="c1"># Actualizar el inicio para el siguiente pliegue</span>

<span class="c1"># Gráfico con lineplot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="c1"># Conjunto de entrenamiento</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y_train</span><span class="p">)),</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Velocidad del viento original&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y_predicciontrain</span><span class="p">)),</span> <span class="n">y_predicciontrain</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Velocidad del viento predicha&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#9A32CD&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Índice&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Velocidad del viento&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Regresión Ridge (Entrenamiento)</span><span class="se">\n</span><span class="s2">R²: </span><span class="si">{</span><span class="n">r2train</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, RMSE: </span><span class="si">{</span><span class="n">rmsetrain</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="c1"># Conjunto de prueba</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y_test</span><span class="p">)),</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Velocidad del viento original&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y_prediccion</span><span class="p">)),</span> <span class="n">y_prediccion</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Velocidad del viento predicha&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#6B8E23&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Índice&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Velocidad del viento&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Regresión Ridge (Prueba)</span><span class="se">\n</span><span class="s2">R²: </span><span class="si">{</span><span class="n">r2</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, RMSE: </span><span class="si">{</span><span class="n">rmse</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="c1"># Mostrar gráfico</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/82ec4ae722ce4a0ff0485376bc7799f75945074a1668ac698012352cfad5c04e.png" src="_images/82ec4ae722ce4a0ff0485376bc7799f75945074a1668ac698012352cfad5c04e.png" />
</div>
</div>
<p>Al observar la gráfica del conjunto de entrenamiento, podemos concluir que el modelo es bastante bueno, ya que presenta un coeficiente de determinación (R²) de <code class="docutils literal notranslate"><span class="pre">0.69</span></code> y un error cuadrático medio (RMSE) de <code class="docutils literal notranslate"><span class="pre">0.58</span></code>. Esto se refleja en que las líneas correspondientes a la velocidad del viento predicha siguen prácticamente la misma tendencia que los datos reales del conjunto de entrenamiento.</p>
<p>En cuanto al conjunto de prueba, el modelo presenta un R² y un RMSE de <code class="docutils literal notranslate"><span class="pre">0.62</span></code> y Aunque en su mayoría las predicciones siguen de manera coherente el comportamiento de los datos originales, se observan pequeños segmentos donde las predicciones se desvían ligeramente de la tendencia real.</p>
</section>
<section id="modelo-lasso">
<h4><strong>MODELO LASSO</strong><a class="headerlink" href="#modelo-lasso" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># ESPACIO DE BÚSQUEDA</span>
<span class="n">espaciobusqueda</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">Real</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;alpha&#39;</span><span class="p">),</span>  <span class="c1"># Alpha es el parámetro de regularización en Lasso</span>
<span class="p">]</span>

<span class="c1"># FUNCIÓN OBJETIVO</span>
<span class="k">def</span> <span class="nf">funcionobjetivo</span><span class="p">(</span><span class="n">params</span><span class="p">):</span>
    <span class="n">alpha</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># Parámetro es alpha</span>
    
    <span class="c1"># Modelo Lasso con parámetro</span>
    <span class="n">mejorlasso</span> <span class="o">=</span> <span class="n">Lasso</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">)</span>
    
    <span class="c1"># Obtener los pliegues</span>
    <span class="n">conjuntopliegues</span> <span class="o">=</span> <span class="n">pliegues</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>  
    
    <span class="n">mse_total</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">num_pliegues</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">conjuntopliegues</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">train_indices</span><span class="p">,</span> <span class="n">test_indices</span> <span class="ow">in</span> <span class="n">conjuntopliegues</span><span class="p">:</span>
        
        <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">train_indices</span><span class="p">],</span> <span class="n">X</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">test_indices</span><span class="p">]</span>
        <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">train_indices</span><span class="p">],</span> <span class="n">y</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">test_indices</span><span class="p">]</span>
        
        <span class="c1"># Entrenar el modelo Lasso</span>
        <span class="n">mejorlasso</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
        <span class="n">y_pred</span> <span class="o">=</span> <span class="n">mejorlasso</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
        
        <span class="c1"># Calcular el error cuadrático medio (MSE)</span>
        <span class="n">mse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="n">y_test</span> <span class="o">-</span> <span class="n">y_pred</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">mse_total</span> <span class="o">+=</span> <span class="n">mse</span>

    <span class="n">mse_promedio</span> <span class="o">=</span> <span class="n">mse_total</span> <span class="o">/</span> <span class="n">num_pliegues</span>
    
    <span class="c1"># Devolver el MSE promedio como la función de pérdida que gp_minimize minimizará</span>
    <span class="k">return</span> <span class="n">mse_promedio</span>

<span class="c1"># Ejecutar la optimización bayesiana para minimizar el MSE promedio</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">gp_minimize</span><span class="p">(</span><span class="n">funcionobjetivo</span><span class="p">,</span> <span class="n">espaciobusqueda</span><span class="p">,</span> <span class="n">n_calls</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># Imprimir el mejor valor de alpha encontrado</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mejores hiperparámetros: alpha = </span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Mejores hiperparámetros: alpha = 0.1
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">modelolasso</span> <span class="o">=</span> <span class="n">Lasso</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="n">metricas</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">dias</span> <span class="o">=</span> <span class="mi">7</span>
<span class="n">hora</span> <span class="o">=</span> <span class="mi">7</span>
<span class="n">iniciotrain</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">while</span> <span class="p">(</span><span class="n">iniciotrain</span> <span class="o">+</span> <span class="p">(</span><span class="n">dias</span> <span class="o">*</span> <span class="mi">24</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">):</span>  
    <span class="n">fintrain</span> <span class="o">=</span> <span class="n">iniciotrain</span> <span class="o">+</span> <span class="p">(</span><span class="n">dias</span> <span class="o">*</span> <span class="mi">24</span><span class="p">)</span>   
    <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">plieguess</span><span class="p">(</span><span class="n">iniciotrain</span><span class="p">,</span> <span class="n">fintrain</span><span class="p">,</span> <span class="n">hora</span><span class="p">)</span>   
    <span class="n">modelolasso</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
    <span class="n">y_prediccion</span><span class="o">=</span> <span class="n">modelolasso</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>       
    <span class="n">rmse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">,</span> <span class="n">squared</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">mape</span> <span class="o">=</span> <span class="n">mean_absolute_percentage_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">)</span>
    <span class="n">r2</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">)</span>
    <span class="n">ljungbox</span><span class="p">,</span> <span class="n">jarquebera</span> <span class="o">=</span> <span class="n">residuos</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">)</span>   
    <span class="n">metricas</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
        <span class="s1">&#39;Modelo&#39;</span><span class="p">:</span> <span class="s1">&#39;Regresión Lasso&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Dias&#39;</span><span class="p">:</span> <span class="n">dias</span><span class="p">,</span>
        <span class="s1">&#39;Hora&#39;</span><span class="p">:</span> <span class="n">hora</span><span class="p">,</span>
        <span class="s1">&#39;MAPE&#39;</span><span class="p">:</span> <span class="n">mape</span><span class="p">,</span>
        <span class="s1">&#39;RMSE&#39;</span><span class="p">:</span> <span class="n">rmse</span><span class="p">,</span>
        <span class="s1">&#39;R^2&#39;</span><span class="p">:</span> <span class="n">r2</span><span class="p">,</span>
        <span class="s1">&#39;Ljung-Box p-value&#39;</span> <span class="p">:</span> <span class="n">ljungbox</span><span class="p">,</span>
        <span class="s1">&#39;Jarque-Bera p-value&#39;</span> <span class="p">:</span> <span class="n">jarquebera</span>
    <span class="p">})</span>   
    <span class="n">iniciotrain</span> <span class="o">=</span> <span class="n">fintrain</span>  
<span class="n">datalasso</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">metricas</span><span class="p">)</span>
<span class="n">datalasso</span> <span class="o">=</span> <span class="n">datalasso</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">datalasso</span><span class="p">[</span><span class="s1">&#39;RMSE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">idxmin</span><span class="p">()]</span>
<span class="n">datalasso</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">datalasso</span><span class="p">)</span>
<span class="n">datalasso</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>239</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Modelo</th>
      <td>Regresión Lasso</td>
    </tr>
    <tr>
      <th>Dias</th>
      <td>7</td>
    </tr>
    <tr>
      <th>Hora</th>
      <td>7</td>
    </tr>
    <tr>
      <th>MAPE</th>
      <td>0.137563</td>
    </tr>
    <tr>
      <th>RMSE</th>
      <td>0.333403</td>
    </tr>
    <tr>
      <th>R^2</th>
      <td>0.74215</td>
    </tr>
    <tr>
      <th>Ljung-Box p-value</th>
      <td>0.666188</td>
    </tr>
    <tr>
      <th>Jarque-Bera p-value</th>
      <td>0.802302</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">metricas</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">dias</span> <span class="o">=</span> <span class="mi">7</span>
<span class="n">hora</span> <span class="o">=</span> <span class="mi">7</span>
<span class="n">iniciotrain</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">while</span> <span class="p">(</span><span class="n">iniciotrain</span> <span class="o">+</span> <span class="p">(</span><span class="n">dias</span> <span class="o">*</span> <span class="mi">24</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">):</span>  <span class="c1"># Mientras que el tamaño del pliegue más la hora sea menor que la longitud de los datos</span>
    <span class="n">fintrain</span> <span class="o">=</span> <span class="n">iniciotrain</span> <span class="o">+</span> <span class="p">(</span><span class="n">dias</span> <span class="o">*</span> <span class="mi">24</span><span class="p">)</span>   
    <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">plieguess</span><span class="p">(</span><span class="n">iniciotrain</span><span class="p">,</span> <span class="n">fintrain</span><span class="p">,</span> <span class="n">hora</span><span class="p">)</span>   
    <span class="n">modelolasso</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
    
    <span class="c1"># Entrenamiento</span>
    <span class="n">y_predicciontrain</span> <span class="o">=</span> <span class="n">modelolasso</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
    <span class="n">rmsetrain</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_predicciontrain</span><span class="p">,</span> <span class="n">squared</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">mapetrain</span> <span class="o">=</span> <span class="n">mean_absolute_percentage_error</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_predicciontrain</span><span class="p">)</span>
    <span class="n">r2train</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_predicciontrain</span><span class="p">)</span>
    
    <span class="c1"># Test</span>
    <span class="n">y_prediccion</span> <span class="o">=</span> <span class="n">modelolasso</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>       
    <span class="n">rmse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">,</span> <span class="n">squared</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">mape</span> <span class="o">=</span> <span class="n">mean_absolute_percentage_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">)</span>
    <span class="n">r2</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">)</span>
    
    <span class="n">ljungbox</span><span class="p">,</span> <span class="n">jarquebera</span> <span class="o">=</span> <span class="n">residuos</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prediccion</span><span class="p">)</span>   
    <span class="n">metricas</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
        <span class="s1">&#39;Modelo&#39;</span><span class="p">:</span> <span class="s1">&#39;Regresión Lasso&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Dias&#39;</span><span class="p">:</span> <span class="n">dias</span><span class="p">,</span>
        <span class="s1">&#39;Hora&#39;</span><span class="p">:</span> <span class="n">hora</span><span class="p">,</span>
        <span class="s1">&#39;MAPE&#39;</span><span class="p">:</span> <span class="n">mape</span><span class="p">,</span>
        <span class="s1">&#39;RMSE&#39;</span><span class="p">:</span> <span class="n">rmse</span><span class="p">,</span>
        <span class="s1">&#39;R^2&#39;</span><span class="p">:</span> <span class="n">r2</span><span class="p">,</span>
        <span class="s1">&#39;Ljung-Box p-value&#39;</span><span class="p">:</span> <span class="n">ljungbox</span><span class="p">,</span>
        <span class="s1">&#39;Jarque-Bera p-value&#39;</span><span class="p">:</span> <span class="n">jarquebera</span>
    <span class="p">})</span>   
    <span class="n">iniciotrain</span> <span class="o">=</span> <span class="n">fintrain</span>  <span class="c1"># Actualizar el inicio para el siguiente pliegue</span>

<span class="c1"># Gráfico con lineplot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="c1"># Conjunto de entrenamiento</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y_train</span><span class="p">)),</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Velocidad del viento original&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y_predicciontrain</span><span class="p">)),</span> <span class="n">y_predicciontrain</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Velocidad del viento predicha&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#9A32CD&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Índice&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Velocidad del viento&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Regresión Lasso (Entrenamiento)</span><span class="se">\n</span><span class="s2">R²: </span><span class="si">{</span><span class="n">r2train</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, RMSE: </span><span class="si">{</span><span class="n">rmsetrain</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="c1"># Conjunto de prueba</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y_test</span><span class="p">)),</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Velocidad del viento original&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y_prediccion</span><span class="p">)),</span> <span class="n">y_prediccion</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Velocidad del viento predicha&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#6B8E23&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Índice&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Velocidad del viento&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Regresión Lasso (Prueba)</span><span class="se">\n</span><span class="s2">R²: </span><span class="si">{</span><span class="n">r2</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, RMSE: </span><span class="si">{</span><span class="n">rmse</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="c1"># Mostrar gráfico</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/4fce95b249160f021c340dcdc5da20143d6224b375ce2a96dd6be66351c6a4e5.png" src="_images/4fce95b249160f021c340dcdc5da20143d6224b375ce2a96dd6be66351c6a4e5.png" />
</div>
</div>
<p>Al observar la gráfica del conjunto de entrenamiento, podemos concluir que el modelo es bastante bueno, ya que presenta un coeficiente de determinación (R²) de <code class="docutils literal notranslate"><span class="pre">0.71</span></code> y un error cuadrático medio (RMSE) de <code class="docutils literal notranslate"><span class="pre">0.56</span></code>. Esto se refleja en que las líneas correspondientes a la velocidad del viento predicha siguen prácticamente la misma tendencia que los datos reales del conjunto de entrenamiento.</p>
<p>En cuanto al conjunto de prueba, el modelo presenta un R² de <code class="docutils literal notranslate"><span class="pre">0.79</span></code> y un RMSE de <code class="docutils literal notranslate"><span class="pre">0.37</span></code>. Podemos observar que la línea de velocidad del viento intenta seguir la tendencia de la original, sin embargo, falla en algunos segmentos. Esto significa que el modelo puede mejorar.</p>
</section>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="EDA%20-%20WIND%20SPEED.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><strong>WIND SPEED</strong></p>
      </div>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#metodos-utiles-para-los-modelos"><strong>MÉTODOS ÚTILES PARA LOS MODELOS</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#muestra-de-pliegues"><strong>MUESTRA DE PLIEGUES</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hora-1"><strong>HORA 1</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hora-5"><strong>HORA 5</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hora-10"><strong>HORA 10</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hora-15"><strong>HORA 15</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hora-20"><strong>HORA 20</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hora-24"><strong>HORA 24</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modelos"><strong>MODELOS</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-knn"><strong>MODELO KNN</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#mejor-modelo-cada-hora"><strong>MEJOR MODELO - CADA HORA</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#hora-y-ventana-con-mejor-modelo-knn"><strong>HORA Y VENTANA CON MEJOR MODELO KNN</strong></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#regresion-lineal"><strong>REGRESIÓN LINEAL</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id1"><strong>MEJOR MODELO - CADA HORA</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#hora-y-ventana-con-mejor-modelo-reg-lineal"><strong>HORA Y VENTANA CON MEJOR MODELO REG. LINEAL</strong></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#regresion-ridge"><strong>REGRESIÓN RIDGE</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id2"><strong>MEJOR MODELO - CADA HORA</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#hora-y-ventana-con-mejor-modelo-ridge"><strong>HORA Y VENTANA CON MEJOR MODELO RIDGE</strong></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#regresion-lasso"><strong>REGRESIÓN LASSO</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id3"><strong>MEJOR MODELO - CADA HORA</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#hora-y-ventana-con-mejor-modelo-lasso"><strong>HORA Y VENTANA CON MEJOR MODELO LASSO</strong></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mejores-modelos-de-regresion"><strong>MEJORES MODELOS DE REGRESIÓN</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#optimizacion-bayesiana"><strong>Optimización Bayesiana</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id4"><strong>MODELO KNN</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-ridge"><strong>MODELO RIDGE</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-lasso"><strong>MODELO LASSO</strong></a></li>
</ul>
</li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By The Jupyter Book Community
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>